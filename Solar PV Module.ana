{ Analytica Model Solar_PV, encoding="UTF-8" }
SoftwareVersion 6.3.6

{!-60000|Attribute AcpStyles}
Attribute UnoptimizedDef


AskAttribute UnoptimizedDef,Function,Yes
AskAttribute UnoptimizedDef,Module,Yes
AskAttribute UnoptimizedDef,Variable,Yes

LinkModule Solar_PV
Title: Solar PV
Author: Cory Welch
Date: Mon, Jan 8, 2018 10:24 AM
DefaultSize: 64,40
NodeSize: 64,56
NodeInfo: 1,0,0,1,1,1,1,,0,,0,,,
DiagState: 2,526,187,798,386,17,10
NodeColor: 65535,65535,65535
Pict: (000000000000003C003C0004A105000089504E470D0A1A0A0000000D494844520000003C0000003C08060000003AFCD972000000017352474200AECE1CE90000000467414D410000B18F0BFC6105000000097048597300000EC300000EC301C76FA86400000526494441546843ED99416C5455148659B2938DD1156165DC9068829105312E8869C206E306591062405116A2715117608D2114428325A61050AA682580C5D01810048A562481C4C6464158B481448AB1326D693B2D05C6FE93FCE4CC9DFFBD77DFEB7BD34E9DC5379DF9EF79EFDD73EFB9E7DCFB3AAF5028FCAF90E25C468A6991FFE5AB4D63A7776F536D338514D3E2CE87CFE7FFDDFCECD457DD3E1348312DE06CCDE119468A60F266CFD29123F587266FFDF98C6AF701D70FED5B7351B5F9F020F7D7A291631FB4DEBB7EA14EB527418A000FC2ECDCD9FA426E3A4E27E5617E7841AE69451FFA30D4B2AA5BD924418A0033CCA4830763B4955D16C05938C92531DEF3FD2A659704291284129DF6094D0CD2D8B9BD0D77BF7EF7DBE103EB3B2DD0C77F3DBE16CEA86B2DA32776EE7AE4ECD435CA262952B4149D9E0AEBA07AFAE0EEC093E8606EFBF27E76320A0C48D8BACC5F3ABA01039DB6B3408A3E3C9C9C988F596304100C0E66143900ED1828FCB6214A860F6E3C59E9FC20C528B09E5D078AD9B4F7F28BCA9EE03AECBE988CC8D84F07EA957D1648310C86383B8BF04C92D0E0A4BD4FA5B6A0520C02E1673B89D95276BEB8915209A7A5A84072B2A198D66600591B6B1CF744B4289B3491A2821B11802CAA6CA6C3FD7FFA9E567ADA48D105A14C67E1B8B2A916A4E8825083B32841086D65532D48D18235C65A3BDB0EF34990A205BB1D8673A5D6599648D182231E9C1D6C7EF9AA6AAF36A468A964C9A804C50F1CBFB8A1C05F5B76587B473BB6EEA1A6D8D6F173C363AF6F2F548277DA4EEDC9DF9B9CAFFA1145F1C3DDDB2249D1806D38085073F9AEFBFA4AD5B1527608CDE10DA105D072E672A25D5EF1C39E3F01D62D0DB0768B5A48FD5DF6516B373AF1D47B9FF463A6150BDF6ECEC166C996FD57553BA8DBD1D645871ADA7F6C5436AF341F3989F6859B3ECEDD1E1A895D22A568895AC3186976F29B4B57E49B891B03838B681336333652F05DD9209431B0B0A93F7C7697B209438A16CE3ED636CEC0B6CD3E1CB36CDB2C6D177AD6D291AE6B37028F9083A3E30B6817E60C07F9898D4DF9B8B32C45CBC495732B19EA788563DBECEC8639F2E6E7275AD9C1A864C3E5B1A2E950A76A07B8C7E2F7F7F6C1EEB5FD1D8F969F0F52B4F0ED2166D89E7B31B270000F5DDD722CB464B173614E10CCACCFE0D8F0EFB9F9B7F75B1329FAC08ECD06A206DC22C528908438BBB385A024E722C52830A2EAA13309D67E547E00520C03EB850FF129FECB1BBFBCC80EA976459C2417B73F520C83B38B7214D519B433F4E3D4CCCFCE776FA01361D99FC4E9931483F8E1F7DE3A7604B555D958D059DAFBAE311077D66CC588B2976210AC91BEE189AD203B8E4D85B209025B475CE79B815935A2B69C5254D830C34C2B1B1786DA735B3E8D7D96E6B57040B5BBC0499F2DA7145DB02E78B36A00E17DAD7F40BE9D2913143634AB85A0A55026B8D8841027D3DA7D76D0688761333CCA94B251E0C4C6E7AA2D67C90F0593011E1E960C5CE2AE4105F6DEB807F6E2AA3D0826579C9DDDB6921F2E18218E32C25AD9041137CB2AEC52C27656D928C2CED525862E9C259F826E895B4783B075DCA7EE5BD877B7849618596CA7B186F0705F1ADA3B1B79ED175DBFAD53363E9CFDA3F7A5C7DFDA3981FBBCDAD27E5CD9046173084A2AFD2A739470841211F4326EBDD02A80DD0794394A98ACA6458CB7905962935799A359C20E20FB2221599891817B5D9A48312BE8101C74DBA0D51CCE00296645CD6143CDE18C906256D41C36D41CCE082966051D527B73BE9A9D930E47E15E972652CC0A3B8B41F8FCC36D3A4871EE5298F71FE8237293758D89650000000049454E44AE426082)
FontStyle: Arial Narrow,19
NodeFont: Arial,16
FileInfo: 0,LinkModule Solar_PV,2,2,0,0,Solar PV Module.ana
AcpStyles: FrameNode: PV_Frame~
Show_Object:No

Module Adoption
Title: Adoption
Author: coryw
Date: Sun, Aug 5, 2018 9:08 AM
NodeLocation: 464,184,1
NodeSize: 72,64
DiagState: 2,139,7,1349,754,17,10
NodeColor: 65535,65535,65535
Pict: (000000000000002D003A00042505000089504E470D0A1A0A0000000D494844520000003A0000002D0806000000FF68780B000000017352474200AECE1CE90000000467414D410000B18F0BFC6105000000097048597300000EC300000EC301C76FA864000004AA494441546843ED994B48545118C7AD2804292CCA5C444A0B7355B6905A8449B810DC589BC645658BC06891D54608B24D480F7A8831663483AFCC34A6EC316294454E6246A25993144CD943CB48B3870FF49EEEFFD077B9733D9A3373EFDCABB5F83BC3DC73CF3DBFFB3FE7FBCE778C608CFD138A90CEC432487B61B6E93FE84CD087EFBE78C7B382BCBD77D3DDBB1B521BA1FC47D9CEC191FE686DDB19097AAFDB9509A875E5114CA42FBF7A00E477CF8C026DED6D4CB5DD4C6A23A0F5972287E020C0718D24BA774680C2A1BC87B62A024CAB8DEDA978713A77646C2852D45E24CB835E7FEDCC4EA98EEE27078BDBF38F040248B22C28020AA625B98880235A7BD3952541114DB7D4257A010837E1AAA85D20B21CE8CBAF6D493455010B6851BB40652950401124A6AA281F062BCB8022C064B8E27D80448E0C26E04C25CB80229AD274D5D349922540114D913A00DAD1D7BC41D42654590294D2083E45D7F590E9A088B28084A3A1E4C9BFC974D003F7335D003DF924F7B4E8FAA4FAF929567A732F5D6A3E7184B973AA58EDD64645F2356D7B5341B1190FC84DC03D2DC9952AD3DA68DC22B16FDD1372AFA9A05489A0A6145D27C139B8A686E163BE96E586A3D2F3CBD9EC9D2755D1D8F084D4641A28B9894A449833E5C172F71CC93E05AE286E8803BF76678A60A69269A0E426CA2DED35A9CB65F303C4F78ED21C36FC2DE8FC6A0A288A63A19B00C1742440AC45B8A7BA375899024A91D66F6DCA904A90B1AFEEE70EAAEE09556107F57C70A703D22FD2623D566734F3B1C8D354941E4255D84177B837344F70F3C62E970229480D7A28ACA0B4714795A2AC4DCFD1023E0679BAB2AFAF12B5F788E41BF026D6FBAA6CE80F1B0D3AEA24897272D840290041745287FC47CFE7B952730F841782E90E2840D0E67F2A898AF5B080C2012AA83160FEBBEC1EF2227FBE26F0A04CABE9B2E7A0F8D6424098110868E80BEDE8989324CACB8683E2ED52418D234BFE3B82CF9F08CB1E1C56F6B868AB3E102321E716B6E515C0D9606B5543413128DA18C01DE54DD376AE6CA317D0F81DEEA8A725A629DCD2AB08370C540D894F3E606CDB1AF639F933B19DFBDC9904172912437054B4C6429521A04248EC7AE4128A20117C301569ED627A1B75BA00E90EAA86C4E039A45C514817D6F4F067C99F701269815C4460E1ED04FDE9255D4191BFD4901F07BA562B7912CF901D1D1DEC8EA380833529DAD41B21DD40914228BA02B6CF5BB5D3AF0291EB469CB8531B4062EA8AFA3242BA80626DD15A3B787BA367B47E4F25F53B5EB1B9FD6ECBA163F42F0608DFF162447D19A5904191DFB843E573D88D2BC9CF257BC200072C5A39DC5497D1482F00829B7AFC1F2518050D4A6921A56C2E3B5E12C57ED8577DA7BEDA1D89BD19A5F3381C8476D89B8AFA0997020645C041C4DC5E1635E22859C8060B6325EAC35BB494ED762CE0705883475B72ECE19EA29369DAA06F3F3F49AEB9B3CD75F5FCE2B1F785CBF83DA4D6734BD8FE8B911C103B1A4C4FA3D345A09A003ADAD7B9F665C7B95C5FD3A1532F6E65D53D76267CF215C58CABC1A0BEC2185653BC88D99CF3F9F60E69625A4796264901C5C0D5205A0D9F5DCE9DAB70AEE82FB8B9C983BD294EF244958215A580CE5AE1D402A0F8236C305BC44159C46F6FC836BBF705ED2A0000000049454E44AE426082)
AcpStyles: FrameNode: PVAdoption_Frame

Variable Potential_PV_Adopter
Title: Potential PV Adopters
Units: PV_stock_basis_by_sector
Description: Market potential adopters of PV ... a function of total "eligible" buildings and the calculated long-run market share, less those who have already adopted (installed) a system.
Definition: MAX([0,  LRMS_by_PV_Time[System_Types=PV_Retrofit_Label] * Eligible_PV_Stock_fo - NC_and_Retro_Install])
NodeLocation: 314,336,1
NodeSize: 61,37
NodeInfo: 1,1,1,1,0,1,0,,0,,0,,,
WindState: 2,713,385,978,514
ValueState: 2,107,54,1700,703,1,MIDM
NodeColor: 65535,65535,65535
ReformVal: [Time_Solar_PV,Null]
NumberFormat: 2,F,4,2,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Spatial_ID,0,PV_Sectors,2,Time_Solar_PV,1]
Att_ColorRole: Null

Variable Retrofit_Installs
Title: Retrofit Installs
Units: PV_stock_basis_by_s / yr
Description: End-of-period incremental adoption from retrofit applications.
Definition: Adoption_from_Advert + Adoption_from_WOM
NodeLocation: 472,384,1
NodeSize: 64,32
NodeInfo: 1,1,1,1,1,1,0,0,0,0,,0,1,0
WindState: 2,102,82,1483,522
ValueState: 2,342,35,1260,656,1,MIDM
Aliases: Alias Al573537827
NodeColor: 9,52427,1
ReformVal: [Time_Solar_PV,Null]
NumberFormat: 2,F,4,2,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [PV_Spatial_ID,Area_Type,PV_Sectors]
Att_ResultSliceState: [PV_Sectors,0,PV_Spatial_ID,0,Area_Type,0,Time_Solar_PV,1]
Att_ColorRole: Null

Variable Adoption_from_Advert
Title: Adoption from Advertising
Units: PV_stock_basis_by_s / yr
Description: The incremental adoption stemming from marketing/advertising.
Definition: Potential_PV_Adopter * Applied_Ad_Strength
NodeLocation: 314,472,1
NodeSize: 64,40
ValueState: 2,124,86,1152,755,1,MIDM
ReformVal: [Time_Solar_PV,Null]
NumberFormat: 2,F,4,2,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,0,Time_Solar_PV,1]
Att_ColorRole: Null

Variable Adoption_from_WOM
Title: Adoption from Word of Mouth
Units: PV_stock_basis_by_s / yr
Description: The incremental adoption stemming from word-of-mouth effects.
Definition: TotRetro_Install_BOP * Applied_WOM_PV * Fraction_Remaining
NodeLocation: 632,536,1
NodeSize: 64,40
ValueState: 2,241,120,1041,785,1,MIDM
ReformVal: [Time_Solar_PV,Null]
NumberFormat: 2,F,4,2,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,0,Time_Solar_PV,1]
Att_ColorRole: Null

Variable Fraction_Remaining
Title: Fraction Remaining
Units: fraction
Description: The fraction of buildings remaining that would be suitable for PV installation by customers willing to adopt.
Definition: Divide(Potential_PV_Adopter, Eligible_PV_Stock_fo * LRMS_by_PV_Time[System_Types=PV_Retrofit_Label], True)
NodeLocation: 136,536,1
NodeSize: 64,40
WindState: 2,598,2,1096,350
ValueState: 2,70,116,859,739,1,MIDM
GraphSetup: Att_GraphValueRange Fraction_Remaining:1,,0,,,,,0,1,0
ReformVal: [Time_Solar_PV,PV_Sectors]
NumberFormat: 2,%,4,2,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,123,Time_Solar_PV,1]

Module New_Construction
Title: New Construction
Author: Cory Welch
Date: Mon, Jan 8, 2018 10:24 AM
NodeLocation: 136,200,1
NodeSize: 72,56
DiagState: 2,77,28,1364,626,17,10
Pict: (000000000000003B003B0004EC05000089504E470D0A1A0A0000000D494844520000003B0000003B0806000000C525F2B3000000017352474200AECE1CE90000000467414D410000B18F0BFC6105000000097048597300000EC300000EC301C76FA86400000571494441546843ED9A4F681D5514C623821457DD197161777625AD82D64D09A850C8A676635C2811140A5D1874935DBB291514AAA510716140436A69256803D182C65262288AA18A56411A504B2B8A11A586407C63BE937ED72F376766EEBC76DE9F98C5EFBCCCBD77EE9C2FF7CF3973DFEBC9B26C43F1DBDF577B3FBF36DDE7D5AD2BE85666AE4CED79E283ED9776BED39391C317F68FFCB9B4B0956DD6DDD48DBC71F1E02115A9E01FB0B4BCB805EDDC9BBB8957BF183A4A618F9DEEBD8A6B8CF2F0F981132C1FFBF6E810DABA1D740B073F1B1CA5208CE095BFE6B769FD3353BB66513730B9630ED76B6EEE16302D75E42046D72639F5FDC87ED43F3CBE6511D76B2ABB01083DF0F19E290AC5E8794201A778FFC4B6795CAF6BD0C940940AC5DFDC7C62BEFB7D6E074614ED30DD5166158D2FDF1C6A8CDCB7D078AD37AB95E3F72E6633878FA853A94028A62B85BEF8E9DE893CA1D8A028149F88BD28B74A38E13A5713742A156C3C1A4339521E1FCE9F18A050806BD699094E9C7976A231FBCA211771D6AD2F213BFBC26878CE8D87A700A1587374FED8DC70EECC78FF87D141B683608CB0D69B0922BE7977502B95D0A6A2B3819F66FAAADE8F69CAF001903C78ED800ADD7D72EB8297329A09423A4CAC0A78EBEB23C35E1B803A158ACDC96B672608E930B1C86D2180498187A68A98EEF37F5CDAEEB5036682900E13CB0C296F43D20C0A42E30C2AC64C10D2A123FBD0F81D4BE77F9EEC6739D632420F857AA9A2879920A4C3C4223E3E327EE775087A60ECB6C6CB170E1C4756A4BB73510615632608E930B160EAF2F8533B5784529C529441799809423A502C98BCFCF6D30F8EDDBE4C91CF7DB4FBDC273F4EECF5DA1661263881546EC5290FB6B1764E7D199692F2FEC889149009512CD6B2D7A60C332AA4D5A833656898E10B791556FF3876CFB2E7481D64F1B53883F50711100598C02BFA1E1BA7836598090F3EBD6FDACB6B2B41215E9D031D81E33856A110806C281E414D2191FFE6654B1E66D4C1B84155D8575C5E0404A8500D2D204E2A30E26C83CFE6424F9BC432B7C5487DF5EBEC2E9441D0F367FBA6F304634431F2A84382A175799869B7588E2A12062DC788EBC984EEC2FA9280D1D5FBF230D34EB17815A3D35E121F0BC6C6C5833400A1A9EBD64C3BC532992F7AB3890593D49C989869975888E0114A59DC44DB474FDD758D421F5F99FAA91B1331D32EB17AAEEBC554455FE748D5C4C24CBBC472B72DDA4D31A29A48BC746EDF7B4F9EB9FF22AFB15179F779986987588C241DCE4BEAE3B5CADD18D3574F1BF504B10833416C4DE80309632B622544796DF8F20EB00B6B9D9E3A2274E5F5A198F11CBC95E8030947A6E80D06C7A658CF58DB5E3D420EFF1929EBD74C70AA283716E7DDFA02E2876A6C65C6D42C9CE67186E5614645C40D888A8DEBAAC29D3535F329827D75A458AC2DC6D6781D56059B1C53CD94177A33AD14AB270E55B21F05F7713DA31F7CA6A48C665A29966B0C31D6AB2F02EFBC7A844AA1A9C985995689D5D89A9A0CE01E8429861905C9462DB9F1AD109B125B0976696C3A9CAA04A2D14F597AE961A65562CB622B4751B32382E9DFCCF1A962A615623152743C8EADB8D6FC9760A7C546D4EC461663A61562E31F73601A63DDEA4F07080ED45097920256C1CC3F26E2EE20E6A639D93F9B5DFF25AC2938CD7888DD14D398E74704D7282FFACA91B8CFCC437EC7B17AF3EB4EA39B45BE4AC15A53610AD62772DF2AA3E83EAF04DCB7E6E6C2DF54A4C20788D8783D6287C54E5B961707BFE272EFB90EA647FA58D369D1175BA9787D512CD62B1280D4E314F61597A7021FB48FD5C21B0575896D16F61597A7B22996059B622B52475F71792A9B6259B029B62275F41597A75228B6E83715A9D4D2975397C48A0FA18F58EC462688D59FC76E447044FC9FD8FF0559CFBF23C53F94183BF9530000000049454E44AE426082)
AcpStyles: FrameNode: PVAdoption1544977216

Variable PV_NewConst_Installs
Title: New Construction Installations
Units: PV stock units/yr
Description: End-of-period incremental adoption from new construction.
Definition: NewConstr_for_PV * NewConstr_MktShare * NewConst_Elig_Factor
NodeLocation: 672,296,1
NodeSize: 64,40
ValueState: 2,209,37,1161,757,1,MIDM
Aliases: Alias Al1661009443
NodeColor: 9,52427,1
ReformVal: [Time_Solar_PV,Null]
Att__TotalsIndex: []
Att_ResultSliceState: [PV_Sectors,22,PV_Spatial_ID,1,Time_Solar_PV,1]
Att_ColorRole: Null

Variable NewConstr_MktShare
Title: NewConstr Mkt Share
Units: market share
Definition: IF Force_NewCon_Market_[All_Sectors=PV_Sectors]   {If residential}~
THEN LinearInterp(EOY_Date_for_Econ_Yr[Annual_Econ_Time=Static_PV_Time], NewConstr_Mkt_Share[All_Sectors=PV_Sectors], Time_Solar_PV, Static_PV_Time)   {Then use historic and exogenous data}~
ELSE LRMS_by_PV_Time[System_Types=PV_Retrofit_Label, Installation_Types=Retrofit_Label]   {Else use calculated long-run market share}~
/*~
LinearInterp(EOY_Date_for_Econ_Yr[Annual_Econ_Time=Static_PV_Time], NewConstr_Mkt_Share[All_Sectors=PV_Sectors], Time_Solar_PV, Static_PV_Time)   {Then use historic and exogenous data}~

NodeLocation: 440,400,1
NodeSize: 64,40
WindState: 2,39,85,1218,343
ValueState: 2,67,16,1572,852,0,MIDM
GraphSetup: {!40000|Graph_ColorSeq:[12593,41891,0,65278,37008,6168,32639,32639,32639,0,0,0,34952,29298,56540,29298,53713,56540,56540,29298,55769,53456,44975,25186,65535,0,0,0,0,65535,65535,46003,65535,0,65535,65535,0,32896,0,65535,42405,0,0,0,35723,42405,10794,10794,65535,49344,52171,65535,65535,0,0,65535,0,32896,0,0,28784,32896,37008,0,32896,32896,32896,0,32896,37008,61166,37008,0,0,0]}
ReformVal: [Time_Solar_PV,PV_Sectors]
NumberFormat: 2,%,4,2,0,0,4,1,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [PV_Sectors,2,PV_Spatial_ID,1,Time_Solar_PV,1]
{!40700|Att_CellFormat: Undefined}

Variable NewConstr_for_PV
Title: New Construction for PV
Units: PV stock units/year
Description: This is an annualized construction rate (building units per year) for stocks applicable to PV. The stocks have been reduced to account for any suitability/eligibility adjustments. "bldg units" can be expressed in number of buildings or m2 of roofspace (the Stock_Basis_by_Sect setting determines the units basis for each sector).
Definition: Construction[Time=Time_Solar_PV, All_Sectors=PV_Sectors, All_Spatial_ID=PV_Spatial_ID] *  Usable_PV_stock_to_b
NodeLocation: 440,296,1
NodeSize: 64,40
WindState: 2,340,267,1153,482
ValueState: 2,71,75,1366,772,0,MIDM
GraphSetup: Att_GraphValueRange NewConstr_for_PV:1,,1,,,,,-50,0,0
Att_ResultSliceState: [PV_Spatial_ID,3,PV_Sectors,1,Time_Solar_PV,1]

Constant NewConstr_Mkt_Share
Title: NewConstr Market Share
Units: fraction
Description: The percentage of newly constructed residential buildings that are built with PV. 2009-2017 uses the historic PV market share of new construction specific to single-family homes in SDGE. 2018 and 2019 uses the average of 2016-2017 historic values. Historic values derived from # of new homes with solar (from NSHP @ https://www.newsolarhomes.org/WebPages/Public/Reports.aspx) and number of new housing starts from SDGE ("Housing Starts for Lumidyne.xlsx" from Dan Wilson; original source Moody's). Title 24 goes into effect on Jan 1 2020. 2020 is based on expectations from SunPower and reflects builders pulling permits before the code goes into effect in order to not comply (from https://www.greentechmedia.com/articles/read/everything-you-need-to-know-about-californias-new-solar-roof-mandate#gs.tyPyxtE). 2021 is based on what the CEC expects in the first year (2020), which is probably over-optimistic and probably a better estimate for the second year. By 2022, the third year, full compliance is assumed (though the eligibility factor will preclude some homes as unsuitable for PV due to shading and other siting issues).
Definition: Table(All_Sectors,Static_PV_Time)(~
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
NodeLocation: 440,520,1
NodeSize: 64,40
WindState: 2,8,156,1169,434
DefnState: 2,114,190,1613,633,0,DFNM
ValueState: 2,328,123,1253,510,1,MIDM
Aliases: Alias Al1, FormNode Fo6, FormNode Fo1541552777, FormNode Fo1544631509
NodeColor: 65535,65531,1
ReformDef: [Static_PV_Time,All_Sectors]
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
DisplayOutputs: Object Object, Object Decision
Att_EditSliceState: [New_Construction_Com,3,PV_Sectors,1,Static_PV_Time,1]
{!40700|Att_CellFormat: Undefined}

Alias Al1541540869
Title: New Construction Suitability
Definition: 1
NodeLocation: 440,64,1
NodeSize: 64,40
Original: PV_New_Construction_

Alias Al1541540874
Title: NewConstr Eligibility Factor
Definition: 1
NodeLocation: 440,192,1
NodeSize: 64,40
Original: NewConst_Elig_Factor

FormNode Fo1541540881
Title: New Construction Suitability
Definition: 0
NodeLocation: 448,116,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: PV_New_Construction_

Text Te1541551684
Description: When the model is expanded to look at new construction economics that differ from retrofit costs, this needs to be updated to slice out the new construction market share rather than the retrofit.
NodeLocation: 184,440,-1
NodeSize: 152,40
NodeInfo: 1,0,0,1,1,1,1,,0,,0,,,
NodeColor: 57311,57311,57311
NodeFont: Arial Narrow,15
AcpStyles: Show_Object:no

FormNode Fo1541552777
Title: NewConstr Market Share
Definition: 0
NodeLocation: 448,564,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: NewConstr_Mkt_Share

Index NC_Suitability_Scens
Att_PrevIndexValue: ['Low','Medium','High']
Title: NewConstr Suitability Scenarios
Description: Names for the scenarios related to the percentage of new construction that is subject to Title 24 building codes.
Definition: ['Low','Medium','High']
NodeLocation: 104,192,1
NodeSize: 64,40
Aliases: FormNode Fo1544641445
DisplayOutputs: Object Object, Object Decision

Decision Sel_NC_Suitable_Scen
Title: NewConst Applic Scenario
Description: Select the residential new construction PV applicability scenario (e.g., scenarios around the percentage of new construction homes that would use solar PV to help meet Title 24 requirements, since other options exist).
Definition: Choice(NC_Suitability_Scens,2,1)
NodeLocation: 272,192,1
NodeSize: 64,40
WindState: 2,2079,105,720,350
Aliases: FormNode Fo1544641123, FormNode Fo1544641554

FormNode Fo1544641123
Title: Selected NewConstr Suitability Scenario
Definition: 0
NodeLocation: 280,248,1
NodeSize: 72,16
NodeInfo: 1,0,0,0,0,0,0,102,0,,0,,,
Original: Sel_NC_Suitable_Scen

FormNode Fo1544641445
Title: NewConstr Suitability Scenarios
Definition: 0
NodeLocation: 104,236,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: NC_Suitability_Scens

Variable Tot_NC_Install_BOP
Title: Total NewCon Installed BOP
Units: PV stock units
Description: Cumulative beginning-of-period adoption from new construction.
Definition: Dynamic[Time_Solar_PV](0,~
Self[Time_Solar_PV-1] + PV_NewConst_Installs[Time_Solar_PV-1] * dT_PV_Data )
NodeLocation: 841,243,1
NodeSize: 65,38
NodeInfo: 1,1,1,1,0,1,0,,0,,0,,,
ValueState: 2,281,114,990,636,1,MIDM
Aliases: Alias Al1542240312
NodeColor: 65535,65535,65535
GraphSetup: Att_GraphValueRange Tot_NC_Install_BOP:1,,1,,,,,0,182618.08902025223,0
ReformVal: [Time_Solar_PV,PV_Sectors]
NumberFormat: 2,F,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [Time,PV_Spatial_ID]
Att_ResultSliceState: [PV_Spatial_ID,0,PV_Sectors,1,Time_Solar_PV,1]
{!40700|Att_CellFormat: Undefined}

Picture Pi1544889532
NodeLocation: 740,244,-1
NodeSize: 180,52
NodeInfo: 1,,,,,,0,0,,,,,,0
Pict: (000000000000005F016500049303000089504E470D0A1A0A0000000D49484452000001650000005F08060000003013D6C4000000017352474200AECE1CE90000000467414D410000B18F0BFC6105000000097048597300000EC300000EC301C76FA8640000031849444154785EEDD9C16E1A41104551FCFFFF6C472D65248220BC99E93C9A708E541B1BBCA8A9B91B5F7E00588628032C4494011622CA000B116580858832C04244196021A20C935C2E1763E2F9FEFEFE7D397F12659864BC6890F8FAFA1265F8D74499942843812893126528106552A20C05A24C4A94A1409449893214883229518602512625CA5020CAA444190A4499942843812893126528106552A20C05A24C4A94A1409449893214883229518602512625CA5020CAA444190A4499942843812893126528106552A20C05A24C4A94A1409449893214883229518602512625CA5020CAA444190A4499D4F4288FE3BB1E4094C94D8DF2BDC3738CE03D20372DCA7F3BBAF1BB7B039FC2BD933A15E5B38175A8FB5DEF3C1D5ECF73207538CA338ECCA11E93EECD7ED7E159907A699407C7BA5FB2337B3D6EEC6EF6FE3C0F522F8FF2E060F77BB6333B3D6EECEEDE9C71F6FB7C0E517E638FF6669FE78CFD3D9BBD8E7C87CF74FA1F7D3338D8E36E776797E78D1DEE9D6792CFC0B05494B70337E69DE79E473F875BA7A23C9C3D36C77ADEB643BB9C63EC71E66C7F1312A2FC9FB0C779C62EFFC540E27494877B07971EA3633D6FDBA15DCEB1DDEDACD9FE2624A64479B83EBADB037C7490F73E67CCBBCF3D8F7E0EB7A64579D873948E740E7B9D6FEC70EF3C937C0686A9517E66CF11F3DCA33DDAEF39D777FA68F63AF21D3E5335CACCF3EC251781E3B6F0DECE1967BFCFE710E53794BCE02270DC8C08DFF23C4889F21B4A5F7021588767414A94DFCC78B9F70EAFE73990126528106552A20C05A24C4A94A1409449893214883229518602512625CA5020CAA444190A4499942843812893126528106552A20C05A24C4A94A1409449893214883229518602512625CA5020CAA444190A4499942843812893126528106552A20C05A24C4A94A1409449893214883229518602512625CA5020CAA444190A4499942843812893126528106552A20C05A24C4A94A1409449893214883229518602512625CA5020CAA444190A4499942843812893126528185136261D51067803A20CB0105106588828032C4494011622CA000B116580858832C0327E7E7E0117C4252A572ADE6F0000000049454E44AE426082)

Text PVAdoption1544977216
NodeLocation: 1244,324,-1
NodeSize: 324,292
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus:yes~
Show_description:20

Decision Force_NewCon_Market_
Title: Force NewCon Market Share
Units: boolean
Description: NEED TO IMPORT~
~
Determines whether new construction market share for PV is forced (e.g., to meet a new construction code) or whether it is determined instead by the automated long run market share calculations.
Definition: Table(All_Sectors)(0,1,1,0)
NodeLocation: 664,520,1
NodeSize: 64,40
DefnState: 2,484,490,378,414,0,DFNM
NodeColor: 65535,65531,1
{!40300|DomainExpr: Boolean()}
TableCellDefault: 1

Close New_Construction

Module Market_Share
Title: Market Share
Author: Cory Welch
Date: Tue, Jan 9, 2018 9:49 AM
NodeLocation: 136,336,1
NodeSize: 72,56
DiagState: 2,357,14,1258,776,17,10
Pict: (000000000000003B003C00049806000089504E470D0A1A0A0000000D494844520000003C0000003B080600000027F9E9CA000000017352474200AECE1CE90000000467414D410000B18F0BFC6105000000097048597300000EC300000EC301C76FA8640000061D494441546843E59A4D68244514C7935B724B6EC9C9CDC9E4229B83B82749600F81BD249E928B240721E0C1C4832417379725078591458828EC207E8C8B0BA3228C2C9851240EB2E2E0FA312E2E445696F18B1D57D1D98565DAFED5E635D53D6F263D3DDD35A2815F927E555D55FFAE5755AFAA7BC8F3BCFF15AAD125AD2F5EDEF02E3D5636BCB3526A559EDB317CF3D6AAF7D7CF13DA3DFDA01A5DD27AF18166EB8509AF236F9CAEB6AE9CDFF27EF9FAA4767FAFA846978830D3C3A5F5027F3B3E840B0F1FB6AE1597B572E2A21A5D1288F1DD389476EFCE8811E73F84B60740AFFFB0BF10CA1F13D5E8928E826D8EC41BA19670E315B76F9C50EFE9806A74492CC1164638AE2DF7ED3DD8F07E3C98D3F26AA84697F42AD8408FFB1359C8D599EDB5BC1154633FFCF6777DE2DDEBF9D597BE3CBB034F5C9E2B0B6F5FDB5B8FE64F2458F07B961E9632BCCB4FE5D57C16AAB1570E7FAF4DBFFE6D6EE3F1D2A9CAEC6B435E2796DE9BAE45EFED4B30F863D81EDBDEC1B95D35DF11AA312E07374B0BCBEF9FAC6AE280347A56F29C299E388C96D1B760B8737B2C34A17559BA54E3715CFDB5720A2151814F7FB458C49D6FFE79189A39CF7EBA9ACF5430F851593099F963BBD344D666E8C61F771B635B9F2C176C91F41E639334ED1E7022186E7D3F1D8CE9571EAA33B945F3842EBAC138650C8AD0D39726EADA24A4E14CB04FEB7A693128939034921EBAE80463F5D18B630D117BBEBAB5DBAD47A3B8146C203CA54C5C3BB201096754604C8AD047DE1C69EEDF282E6AF9BAE15CB0BFD19072BDFD67F6ECB470C608F4AC88C585BFBB554DB463712E183E7E361788B6C2CFF68C47208E1E95864667DE5E188860263029DB1ACBED197D10478FD24844336169F9E23210C13EAD8B672A946D361947B6B64C60071349C66C948109BEFAEABA942F93575B26048A5862E1687A120625D8446052BE2F1E5B28C3DD7BCD111A45E35873B9B6D3933230C13E127DC9C62294C806407A370D57160629D81C0C22D8FFCB7590406F4A70C1180E6E4881810A96E5C9DF5C701D24D86B2E9B83E086148823D8B81C017FDAF88187A983D8DAAFAFAD512C47624B8B583DEC00EA0B2A16773EF7D97A28144B836E82E959AD7169236BB1A9F4CA4FE5391A04B876A84129D055B063CC2FD65B1A445495D65264F3AF138C1B67D9A06E82B7B7B777C7C7C71BC3C3C35E568C8E8E36A987FA4CA51CCDD0208E6DECC6A44537C133333335AD9159407DA652396DE4F8461A9226DD04974AA5057A401A353F3F5FDE49F1676969A948B9D4417DA6521A42839EFF7C236737262D44302B817652628BE62FD7D13C494134E54E4D4D99876D8CB215E4E8C6CE9C1676C84A14E752F4DADA5A5E3C876B6394ED60562E0DD2CBAE452394F25656568C36637CF2C385120DC96AD212E2882E168B8B34302DD193939375CADADCDC34C3D518BB4D2A691347743E9F5FB545572AC962FB5AAD362DE594CB6573306F1224F0802C028F28B2EEC715CD3A5DADF67E80281316F7379BF77599840F0E0BCBD200C24CFBA6ACB01F329EA51D12F62B5AD6789626B1995FF4AA9C5066B179E84496A2C927F75186D8830CF2CEC8C538B6B9F0D5EE562FA2594FFD9F638F8CED80A35EAFB33734F62083FD8621E9817B52ECBA3B8996F11847B4DDBB323B0BC13F4C1CE2D6C4D6762617A4295A7A9725C9EE5D086524B4944A5DF732A421BA50282C4B7A2E976BFBEE2374C1F7191266B25CD869AE4822BAD1B8BFAC215EB69AF4AE2C4536A10BB0E35E96AB68BA0B6CD16C38346FB345CFCECE56112D612448A011A5CDC012252FBE3B55E6825E454BCF82E6CA826AE498D67E7388AB6BF9B286F33569471CD1209B844EA846B0A32FC6B38B9053A317D1B8B6366E6D54A36007059C8A6831AF0BEC9704DAB75EBDA01A6DECDD0DEEED7A4C339CEC0FDEF85FCB1717D518C58E79712F57B3373D8B1B4BDDECD7FBF532D5A8C1DBC468E569BF8312587B6DCF82B43635AAB113D16FB58030540B0E92A009C5A3E27E0F1607D5781C3440223281999CA0A5D7EF4110497972366E83F8B41EA6A01AE3C032C52C6EBBB98017B0DD64EC03C3818305101B717BD45B04C4673539AAC65E6012212A42A0AC9749C0433826EEF78BA1E3508D49A1D7E94D5C91490D34712C2DA4F19078582E2339D5F8DFC51BFA07406134D3E5B7E3060000000049454E44AE426082)
AcpStyles: FrameNode: MktShare_Frame

Variable Applied_PV_LRMS
Title: Applied PV LRMS
Units: dmnl
Description: Long-run market share (i.e., % of eligible buildings installing a system)
Definition: IF (Use_PV_Decision_Var AND Include_LRMS) ~
THEN PV_LongRun_Mkt_Share ~
ELSE Stored_LRMS_PV[All_Spatial_ID=PV_Spatial_ID, All_Sectors=PV_Sectors{, Aggreg_PV_LRMS=Select_Ag_PV_LRMS}]
NodeLocation: 656,424,1
NodeSize: 64,40
WindState: 2,592,91,905,714
DefnState: 2,52,284,416,303,,DFNM
ValueState: 2,451,157,1138,606,1,MIDM
NodeColor: 57311,57311,57311
{!40300|DomainExpr: Continuous()}
AcpStyles: Show_object: no
UnoptimizedDef: 0.1

Alias Al1535520789
Title: Stored LRMS PV
Definition: 1
NodeLocation: 496,424,1
NodeSize: 64,40
NodeColor: 57311,57311,57311
Original: Stored_LRMS_PV

Alias Al3
Title: PV LongRun Mkt Share
Definition: 1
NodeLocation: 496,528,1
NodeSize: 64,40
NodeColor: 57311,57311,57311
Original: PV_LongRun_Mkt_Share

Decision Market_Share_Method
Title: Market Share Method
Description: Select the price metric used in the long-run market share model.
Definition: Table(All_Sectors)(Choice(Market_Share_Metric,2,1),Choice(Market_Share_Metric,1,1),Choice(Market_Share_Metric,1,1),Choice(Market_Share_Metric,1,1))
NodeLocation: 656,168,1
NodeSize: 64,40
DefnState: 2,936,73,520,805,0,DFNM
Aliases: FormNode Fo708228131
NodeColor: 65535,65531,1
TableCellDefault: Choice(Market_Share_Metric,1,1)
AcpStyles: Show_object: no

Variable LRMS_by_PV_Time
Title: LRMS by PV Time
Units: %
Description: The long-run expected market share of DERs (i.e., the expected long-run saturation of DER adoption, given sufficient time). The speed at which adoption approaches this long-run market share is determined by the diffusion coefficients.
Definition: IF Market_Share_Method[All_Sectors=PV_Sectors] = Payback_Label~
THEN MIN([1, Payback_LRMS * Total_Impact_Shape])~
ELSE IF Market_Share_Method[All_Sectors=PV_Sectors] = Cost_of_Elect_Label~
THEN LinearInterp(EOY_Date_for_Econ_Yr, Logit_LRMS, Time_Solar_PV, Annual_Econ_Time)~
ELSE LinearInterp(EOY_Date_for_Econ_Yr, Applied_PV_LRMS, Time_Solar_PV, Annual_Econ_Time)
NodeLocation: 656,296,1
NodeSize: 64,40
WindState: 2,319,13,1158,657
ValueState: 2,130,47,1230,712,1,MIDM
Aliases: Alias Al87752227
GraphSetup: Att_CatLineStyle Graph_Primary_Valdim:4~
Att_GraphIndexRange PV_Spatial_ID:1,1~
Att_GraphValueRange LRMS_by_PV_Time:1,,1,,,,,0,0.01937572926282883,0
ReformVal: [Time_Solar_PV,PV_Spatial_ID]
NumberFormat: 2,%,4,2,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [Area_Type,1,System_Types,1,PV_Sectors,1,PV_Spatial_ID,2,Time_Solar_PV,193]

Variable Payback_Accept_Curve
Title: Payback Acceptance Curve
Units: market share
Description: Long run market share as a function of simple payback time. Coefficient for this curve determined through best-fit calibration of aggregate adoption (service territory wide). Residential curve corresponds exactly with CEC assumptions. NonRes curve is slightly higher and is driven by the best fit through calibration of service territory wide adoption.
Definition: Exp(Applied_PV_Pybk_Coef * Payback_Intervals)[@PV_Spatial_ID=1]
NodeLocation: 288,528,1
NodeSize: 64,40
WindState: 2,38,103,984,451
ValueState: 2,442,187,1034,630,1,MIDM
GraphSetup: Att_GraphValueRange Payback_Accept_Curve:1,,1,,,,10,0,0.021246256306767464,0
ReformVal: [Payback_Intervals,PV_Payback_Coeff]
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att_GraphValueRange: 1,,,,,,10
Att_ResultSliceState: [PV_Sectors,2,Payback_Intervals,1]

Variable Payback_LRMS
Title: Payback LRMS
Units: market share
Description: The long-run market share based on a payback acceptance curve.
Definition: MIN([1, Exp(Applied_PV_Pybk_Coef * (Payback_Time + Applied_Payback_Adde))])
NodeLocation: 496,296,1
NodeSize: 64,40
WindState: 2,374,142,720,350
ValueState: 2,1976,18,1131,715,1,MIDM
GraphSetup: Att_GraphValueRange Payback_LRMS:1,,1,,,,,0,0.45950403809547424,0
ReformVal: [Time_Solar_PV,PV_Sectors]
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [Area_Type,1,System_Types,1,PV_Spatial_ID,1,PV_Sectors,1,Time_Solar_PV,1]

Variable Payback_Time
Title: Payback Time
Units: years
Description: The simple payback time by spatial ID.
Definition: Mthly_Simple_Payback[PV_Climate_Zone=Climate_Zone_Map, Time=Time_Solar_PV]
NodeLocation: 288,296,1
NodeSize: 64,40
ValueState: 2,606,67,980,679,1,MIDM
GraphSetup: Att_GraphIndexRange Time_Solar_PV:1,,0,,,,,43301.135061979294,49162.151701927185,0~
Att_GraphValueRange Payback_Time:1,,1,,,,,0,19.501038789749146,0
ReformVal: [Time_Solar_PV,PV_Sectors]
Att_ResultSliceState: [Area_Type,1,System_Types,1,PV_Spatial_ID,1,PV_Sectors,1,Time_Solar_PV,1]

Text Te1541771144
Title: Eventually these weights should be specific to new vs retrofit construction
NodeLocation: 140,1108,-1
NodeSize: 84,44
NodeInfo: 1,0,0,1,1,1,1,,0,,0,,,
NodeColor: 57311,57311,57311
NodeFont: Arial Narrow,15
AcpStyles: Show_Object:no

Alias Al1542052306
Title: Stored Payback Coefficient
Definition: 1
NodeLocation: 104,184,1
NodeSize: 64,40
Original: Stored_Pybk_SpatCoef

Alias Al1542052311
Title: Payback Spatial Coefficient
Definition: 1
NodeLocation: 104,72,1
NodeSize: 64,40
NodeColor: 57311,57311,57311
Original: Payback_Spatial_Coef

Variable Applied_Payback_Adde
Title: Applied Payback Adder
Units: year
Description: An spatial ID specific adjustment to the calculated payback that is used in calibration to account for differences in market share across spatial IDs. It effectively shifts the payback acceptance curve right or left. 
Definition: IF (Use_PV_Decision_Var AND Include_Payback_Spat) ~
THEN Payback_Spatial_Coef ~
ELSE Stored_Pybk_SpatCoef[All_Spatial_ID=PV_Spatial_ID, All_Sectors=PV_Sectors]
NodeLocation: 288,184,1
NodeSize: 64,40
WindState: 2,708,364,720,350
ValueState: 2,505,139,959,611,0,MIDM
GraphSetup: Att_GraphIndexRange PV_Spatial_ID:1,1~
Att_CatLineStyle Graph_Primary_Valdim:4
ReformVal: [PV_Spatial_ID,PV_Sectors]

Module Logit_Diagnostics
Title: Logit Diagnostics
Author: coryw
Date: Tue, Nov 13, 2018 9:08 AM
NodeLocation: 304,1104,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,2413,179,944,289,17,10
NodeColor: 57311,57311,57311
AcpStyles: Show_Object:no

Index COE_Ratio
Title: COE Ratio
Definition: Sequence(0,2,.05)
NodeLocation: 112,64,1
NodeSize: 64,40

Constant Logit_Price_Coeff_Te
Title: Logit Price Coeff Test
Definition: [-5,-6,-7,-8,-9]
NodeLocation: 112,272,1
NodeSize: 64,40

Constant Logit_Tech_Coeff_Tes
Title: Logit Tech Coeff Test
Definition: [2,3,4,5,6]
NodeLocation: 112,376,1
NodeSize: 64,40

Variable Utility1
Title: Utility
Definition: Logit_Tech_Coeff_Tes + COE_Ratio * Logit_Price_Coeff_Te
NodeLocation: 272,272,1
NodeSize: 64,40

Variable Mkt_Share_Example
Title: Mkt Share Example
Units: %
Definition: exp(Utility1) / (1 + exp(Utility1))
NodeLocation: 424,272,1
NodeSize: 64,40
ValueState: 2,2336,33,858,623,,MIDM
Aliases: FormNode Fo321238051
ReformVal: [COE_Ratio,Logit_Tech_Coeff_Tes]
NumberFormat: 2,%,4,0,0,0,4,0,$,0,"ABBREV",0,,,0,0,15,
Att_ResultSliceState: [Logit_Price_Coeff_Te,8,Logit_Tech_Coeff_Tes,4,COE_Ratio,1]

FormNode Fo321238051
Title: Mkt Share Example
Definition: 1
NodeLocation: 432,312,1
NodeSize: 56,16
NodeInfo: 1,,,0
Original: Mkt_Share_Example

Close Logit_Diagnostics

Alias Al1542130160
Title: PV Payback Coefficient
Definition: 1
NodeLocation: 104,528,1
NodeSize: 64,40
NodeColor: 57311,57311,57311
Original: PV_Payback_Coeff

Variable Applied_PV_Pybk_Coef
Title: Applied PV Pybk Coeff
Definition: IF (Use_PV_Decision_Var AND Include_Payback_Coef) ~
THEN PV_Payback_Coeff ~
ELSE Stored_Payback_Coeff[All_Spatial_ID=PV_Spatial_ID, All_Sectors=PV_Sectors]
NodeLocation: 288,408,1
NodeSize: 64,40
ValueState: 2,386,111,534,660,0,MIDM
ReformVal: [PV_Sectors,PV_Spatial_ID]

Alias Al1542302597
Title: Stored Pybk Coefficient
Definition: 1
NodeLocation: 104,408,1
NodeSize: 64,40
Original: Stored_Payback_Coeff

Module Misc
Title: Misc
Author: coryw
Date: Sun, Dec 16, 2018 8:10 AM
NodeLocation: 456,1104,1
NodeSize: 64,40
NodeInfo: 1,0,1,1,1,1,0,,0,,0,,,
DiagState: 2,120,89,944,484,17,10
NodeColor: 57311,57311,57311
AcpStyles: Show_Object:no

Decision Retro_Finish_Mkt_Sha
Title: Retro Finish Mkt Share
Units: dmnl
Description: Market share assumed at "final market share year" date
Definition: 0.06
NodeLocation: 408,256,1
NodeSize: 64,40
WindState: 2,884,291,720,501
DefnState: 2,536,538,747,303,,DFNM
Aliases: FormNode Fo1535473808
{!40300|DomainExpr: Continuous(0.01,1)}
UnoptimizedDef: 0.10

Decision Mkt_Share_Start_Year
Title: Mkt Share Start Year
Units: Date
Description: The starting date for the assumed ramp up of market share over time
Definition: PV_Sim_Start_Year
NodeLocation: 120,256,1
NodeSize: 64,40

Decision Mkt_Share_Fin_Year
Title: Mkt Share Fin Year
Units: date
Description: The finish date for the assumed ramp up of market share over time
Definition: Choice(Time_Solar_PV,338,0)
NodeLocation: 256,256,1
NodeSize: 64,40
Aliases: FormNode Fo1535473810

Chance PV_Mkt_Share_Uncerta
Title: PV Mkt Share Uncertainty
Description: Just a placheholder for graphics generation.
Definition: 1 {Lognormal(mean:1.25,stddev:0.3)}
NodeLocation: 120,352,1
NodeSize: 64,40
NodeColor: 65535,52427,52427

FormNode Fo1535473808
Title: Retro Finish Mkt Share
Definition: 0
NodeLocation: 408,300,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Retro_Finish_Mkt_Sha

FormNode Fo1535473810
Title: Mkt Share Fin Year
Definition: 0
NodeLocation: 260,300,1
NodeSize: 76,12
NodeInfo: 1,0,0,0,0,0,0,113,0,,0,,,
Original: Mkt_Share_Fin_Year

Variable Payback_Time_by_ID
Title: Payback Time by ID
Units: years
Description: The simple payback time by spatial ID.
Definition: Mthly_Simple_Payback[PV_Climate_Zone=Climate_Zone_Map]
NodeLocation: 112,64,1
NodeSize: 64,40
WindState: 2,573,262,720,350
ValueState: 2,36,55,1646,809,1,MIDM
ReformVal: [Time_Solar_PV,Null]
Att_ResultSliceState: [PV_Sectors,1,System_Types,1,PV_Spatial_ID,1,Annual_PV_Time,1]
Att_ColorRole: Null

Variable Ann_Hist_Installs
Title: Annual Historic Installs
Units: MW-AC/year
Description: The historic annual PV capacity installations.
Definition: Aggregate(Act_PV_Cap_Installs * dT_PV_Data, PV_Year_Map, Time_Solar_PV, Annual_Econ_Time)
NodeLocation: 112,160,1
NodeSize: 64,40
WindState: 2,102,82,1065,564
ValueState: 2,300,137,955,685,1,MIDM

Variable Act_PV_Cap_Installs
Title: Actual PV Capacity Install Rate
Units: MW-AC/year
Description: The actual PV capacity installation rate.
Definition: /*Replace_X_with_Y(IgnoreWarnings(Capacity_Installs[Interconnect_Date=Time_Solar_PV]), Null, 0) / dT_PV_Data
NodeLocation: 272,48,1
NodeSize: 64,40
WindState: 2,102,82,1131,395
ValueState: 2,201,179,1248,666,0,MIDM
Att__TotalsIndex: [PV_Spatial_ID]

Variable SDGE_Avg_PaybackTime
Title: SDGE Avg Payback Time
Units: years
Description: The weighted average simple payback time across SDGE.
Definition: Sum(Installation_Weights * Payback_Time_by_ID, PV_Spatial_ID)
NodeLocation: 520,64,1
NodeSize: 64,40
ValueState: 2,300,64,1031,690,1,MIDM

Index IRR1
Title: IRR
Definition: Sequence(.01,1,.01)
NodeLocation: 248,160,1
NodeSize: 64,40
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15

Variable Payback
Title: Payback
Definition: LN(2) / LN(1+IRR1)
NodeLocation: 560,184,1
NodeSize: 64,40
ValueState: 2,130,41,1026,716,1,MIDM
GraphSetup: Att_GraphValueRange Payback:1,,0,,,,,0,20.908528864383698,0

Close Misc

Module Logit_Calcs
Title: Logit Calcs
Author: coryw
Date: Sun, Dec 16, 2018 8:10 AM
NodeLocation: 496,168,1
NodeSize: 64,40
DiagState: 2,160,3,1554,787,17,10
NodeColor: 57311,57311,57311
AcpStyles: Show_Object: no

Variable Cost_Elect_Ratio_ID
Title: Cost of Electricity Ratio by ID
Units: post/pre ratio
Description: The post-system to pre-system ratio of the cost of electricity by spatial ID
Definition: Cost_of_Elect_Ratio[PV_Climate_Zone=Climate_Zone_Map]
NodeLocation: 96,136,1
NodeSize: 64,40
WindState: 2,102,82,1197,536
ValueState: 2,467,150,1100,626,1,MIDM
NodeColor: 65535,1,1
GraphSetup: Att_GraphIndexRange Annual_Econ_Time:1,,0,,,,10,2020.9203501939774,2031.8370641469955,0
ReformVal: [Annual_Econ_Time,PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,1,Area_Type,1,System_Types,1,PV_Spatial_ID,1,Annual_Econ_Time,1]

Variable Economic_Utility
Title: Economic Utility
Units: utility
Description: The utility derived from the economics of each system.
Definition: Cost_of_Elect_Ratios * Applied_Price_Coeffi
NodeLocation: 424,264,1
NodeSize: 64,40
ValueState: 2,168,170,964,607,1,MIDM
Att_ResultSliceState: [PV_Sectors,1,System_Types,1,PV_Spatial_ID,1,Annual_PV_Time,1]

Variable Applied_Geo_Utility
Title: Applied Geographic Utility
Units: utility
Description: The amount of utility that describes geographic differences in adoption regardless of relative economics. During an optimization stage seeking to optimize the spatial coefficient, this will use the decision variable. Otherwise, it will use the stored optimization solutions.
Definition: IF (Use_PV_Decision_Var AND IncludeLogSpatial_Co) ~
THEN Logit_Spatial_Coeff ~
ELSE Stored_Spatial_Coeff[All_Spatial_ID=PV_Spatial_ID, All_Sectors=PV_Sectors]
NodeLocation: 424,472,1
NodeSize: 64,40

Variable Total_Utility
Title: Total Utility
Units: utility
Description: The total economic and non-economic utility that each system provides to a customer.
Definition: Economic_Utility + Applied_Geo_Utility + Applied_Tech_Utility
NodeLocation: 576,368,1
NodeSize: 64,40
ValueState: 2,304,55,1254,784,1,MIDM
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Spatial_ID,0,System_Types,1,Area_Type,1,PV_Sectors,1,Annual_Econ_Time,1]

Variable Applied_Price_Coeffi
Title: Applied Price Coefficient
Units: utility/price metric
Description: The amount of utility derived per unit of the price metric (either cost ratio or years of payback). During an optimization stage seeking to optimize the price coefficient, this will use the decision variable. Otherwise, it will use the stored optimization solutions.
Definition: IF (Use_PV_Decision_Var AND IncludeLogitPrice_Co) ~
THEN Price_Coeff ~
ELSE Stored_Logit_Price_C[All_Sectors=PV_Sectors];~
Price_Coeff
NodeLocation: 424,160,1
NodeSize: 64,40
WindState: 2,307,314,909,350

Variable Logit_LRMS
Title: Logit LRMS
Units: market share
Description: The long-run market share by year.
Definition: exp(Total_Utility) / (1 + exp(Total_Utility))~
/*Logit_Market_Share(Total_Utility, 1, Competing_Systems)
NodeLocation: 728,368,1
NodeSize: 64,40
ValueState: 2,384,147,1122,648,1,MIDM
GraphSetup: Att_GraphIndexRange Annual_Econ_Time:1,,0,,,,10,2020.9252538084984,2032,0
ReformVal: [Annual_Econ_Time,PV_Spatial_ID]
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [System_Types,1,PV_Sectors,1,Equity_Test,2,Area_Type,1,PV_Spatial_ID,1,Annual_Econ_Time,1]

Variable Applied_Tech_Utility
Title: Applied Tech Utility
Units: utility
Description: The amount of utility derived per unit of the price metric (either cost ratio or years of payback). During an optimization stage seeking to optimize the price coefficient, this will use the decision variable. Otherwise, it will use the stored optimization solutions.
Definition: IF (Use_PV_Decision_Var AND IncludeLogTech_Coeff) ~
THEN Tech_Coeff ~
ELSE Stored_Tech_Coeff[All_Sectors=PV_Sectors];~
Tech_Coeff
NodeLocation: 424,368,1
NodeSize: 64,40
WindState: 2,102,82,909,350

Variable Avg_Cost_of_Elect_Ra
Title:  Avg Cost of Elect Ratio
Units: post/pre ratio
Description: The weighted average cost of electricity ratio across spatial IDs. These are weighted by historic installations. This will only be used during the calibration time horizon.
Definition: Sum(Installation_Weights * Cost_Elect_Ratio_ID, PV_Spatial_ID)
NodeLocation: 112,264,1
NodeSize: 64,40
ValueState: 2,298,54,1205,705,1,MIDM
ReformVal: [Annual_Econ_Time,PV_Sectors]
Att_ResultSliceState: [Retrofit_System_Type,1,PV_Sectors,1,Annual_Econ_Time,1]

Variable Installation_Weights
Title: Installation Weights
Units: fraction
Description: The fraction of total SDGE PV installations occuring in each spatial ID.
Definition: VAR weights:=Total_Building_Stock[Time=BOY_Date_for_Econ_Yr, All_Sectors=PV_Sectors, All_Spatial_ID=PV_Spatial_ID] * Usable_PV_stock_to_b * {Retrofit_Eligibility * } Non_Agg_Spatial_IDs;~
VAR totWeight:=Sum(weights, PV_Spatial_ID);~
~
Divide(weights, totWeight, True)
NodeLocation: 216,56,1
NodeSize: 64,40
WindState: 2,543,15,1312,494
ValueState: 2,31,1,1688,826,0,MIDM
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: []
Att_ResultSliceState: [PV_Spatial_ID,4,Area_Type,1,PV_Sectors,1,Annual_Econ_Time,1]

Variable Cost_of_Elect_Ratios
Title: Cost of Electricity Ratios
Units: post/pre ratio
Definition: VAR ratios:=IF PV_Spatial_ID = Aggregation_2_Label~
THEN Avg_Cost_of_Elect_Ra~
ELSE Cost_Elect_Ratio_ID;~
ratios~
~
/*IF Competing_Systems = Grid_Label~
THEN 1~
ELSE IF Construct_Type_Map[All_System_Types=Competing_Systems, New_or_Retrofit=Installation_Types]~
THEN ratios[System_Types=Competing_Systems]~
ELSE Null
NodeLocation: 280,264,1
NodeSize: 64,40
ValueState: 2,356,93,908,699,1,MIDM
GraphSetup: Att_GraphValueRange Cost_of_Elect_Ratios:1,,0,1,,,,0,4,0
ReformVal: [Annual_Econ_Time,PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,1,Area_Type,1,System_Types,1,PV_Spatial_ID,3,Annual_Econ_Time,1]

Alias Al1539126683
Title: Logit Price Coefficient
Definition: 1
NodeLocation: 424,64,1
NodeSize: 64,40
Original: Price_Coeff

Alias Al1539126684
Title: Logit Spatial Coefficient
Definition: 1
NodeLocation: 424,592,1
NodeSize: 64,40
Original: Logit_Spatial_Coeff

Alias Al1539126685
Title: Stored Spatial Coefficient
Definition: 1
NodeLocation: 272,592,1
NodeSize: 64,40
Original: Stored_Spatial_Coeff

Alias Al1539126686
Title: Stored Price Coefficient
Definition: 1
NodeLocation: 280,160,1
NodeSize: 64,40
Original: Stored_Logit_Price_C

Alias Al1539126687
Title: Logit Tech Coefficient
Definition: 1
NodeLocation: 272,368,1
NodeSize: 64,40
Original: Tech_Coeff

Alias Al1539126688
Title: Stored Tech Coefficient
Definition: 1
NodeLocation: 272,480,1
NodeSize: 64,40
Original: Stored_Tech_Coeff

Text Te1544886724
Title: Not currently tested or incorporated into model logic
NodeLocation: 1032,72,-1
NodeSize: 144,48
NodeColor: 65535,65535,65535

Module Illustrators
Title: Illustrators
Author: CWelch
Date: Sat, Apr 2, 2022 10:12 AM
NodeLocation: 592,592,1
NodeSize: 64,40
DiagState: 2,2624,49,1124,620,17,10

Index PPA_to_Value_Ratio1
Title: PPA to Value Ratio
Definition: [0.1,0.2,0.30000000000000004,0.4000000000000001,0.5000000000000001,0.6000000000000001,0.7000000000000001,0.8,0.9,1.0,1.1,1.2000000000000002,1.3000000000000003,1.4000000000000004,1.5000000000000004,1.6000000000000005,1.7000000000000006,1.8000000000000007,1.9000000000000008,2.000000000000001]
NodeLocation: 112,64,1
NodeSize: 64,40
NumberFormat: 2,F,2,1,0,0,2,1,$,0,"ABBREV",0,,,0,0,15,

Variable Long_Run_Market_Sha3
Title: Long-Run Market Share Illustrator
Units: %
Description: Illustration of calculated marketshare as a function of the ratio of LCOE to "value of solar" prices, showing the sensitivity to different input assumptions for price and technology sensitivities.
Definition: local utility:=PPA_to_Value_Ratio1 * Price_Coefficient_Il + Tech_Coefficient_Ill;~
exp(utility) / (1 + exp(utility))
NodeLocation: 528,64,1
NodeSize: 64,40
WindState: 2,438,332,720,350
ValueState: 2,2847,61,873,738,,MIDM
GraphSetup: Att_Stacked_Lines Graph_Primary_Valdim:0~
Graph_AxisLabelFont:,20,0~
{!50400|Att_AxisOrKeyTitle Long_Run_Market_Sha3:Long-Run Market Share}~
Flip:0
ReformVal: [PPA_to_Value_Ratio1,Tech_Coefficient_Ill]
NumberFormat: 2,%,4,0,0,0,4,0,$,0,"ABBREV",0,,,0,0,15,
Att_ResultSliceState: [Price_Coefficient_Il,2,Tech_Coefficient_Ill,4,PPA_to_Value_Ratio1,1]

Index Price_Coefficient_Il
Title: Price Coefficient Illustrator
Definition: [-5,-6,-7,-8,-9]
NodeLocation: 248,64,1
NodeSize: 64,40
{!40300|Att_SlicerPopupSize: 242,112}

Index Tech_Coefficient_Ill
Title: Tech Coefficient Illustrator
Definition: [3,4,5,6,7]
NodeLocation: 384,64,1
NodeSize: 64,40
{!40300|Att_SlicerPopupSize: 242,112}

Variable Market_Share_Functio
Title: Market Share Function
Units: %
Description: Calculated marketshare as a function of the ratio of LCOE to "value of solar" prices
Definition: local utility:=PPA_to_Value_Ratio1 * Price_Coeff + Tech_Coeff;~
exp(utility) / (1 + exp(utility))
NodeLocation: 528,160,1
NodeSize: 64,40
ValueState: 2,341,7,978,722,,MIDM
GraphSetup: Flip:0~
{!50400|Att_AxisOrKeyTitle PPA_to_Value_Ratio1:PPA (or LCOE) to Generation Value Ratio}~
Graph_AxisLabelFont:,20,0~
{!50400|Att_AxisOrKeyTitle Market_Share_Functio:Long Run Market Share}
NumberFormat: 2,%,4,0,0,0,4,1,$,0,"ABBREV",0,,,0,0,15,

Variable Potential_Adopters
Title: Potential Adopters
Definition: MAX([0,Long_Run_Market_Sha2 - Market_Adoption_Illu])
NodeLocation: 312,376,1
NodeSize: 64,40

Variable Market_Adoption_Illu
Title: Market Adoption Illustrator
Units: %
Description: Percent of total possible market that has adopted a technology. ~
~
This simulation illustrates adoption of a technology using a Bass diffusion approach implemented in a System Dynamics framework.
Definition: Dynamic[Year](Initial_Adoption,self[@Year=@Year-1] + dT1 * Adoption1[@Year=@Year-1])
NodeLocation: 712,376,1
NodeSize: 64,40
WindState: 2,2071,133,720,350
ValueState: 2,434,59,1042,743,,MIDM
GraphSetup: Att_Stacked_Lines Graph_Primary_Valdim:0~
Flip:0~
Graph_AxisLabelFont:,20,0~
Att_GraphValueRange Market_Adoption_Illu:1,,0,1,,,,0,1,0
ReformVal: [Year,Advertising_Coeffici]
NumberFormat: 2,%,4,2,0,0,4,0,$,0,"ABBREV",0,,,0,0,15,
Att_ResultSliceState: [Initial_Adoption,1,Word_of_Mouth_Coeff1,4,Long_Run_Market_Sha2,5,Advertising_Coeffici,4,Year,1]

Variable Adoption1
Title: Adoption
Definition: MAX([0,Adoption_from_Adver2 + Adoption_from_Word_o])
NodeLocation: 512,376,1
NodeSize: 64,40

Index Word_of_Mouth_Coeff1
Title: Word of Mouth Coefficient
Definition: [0.2,0.3,0.4,0.5,0.6]
NodeLocation: 184,616,1
NodeSize: 64,40

Index Advertising_Coeffici
Title: Advertising Coefficient
Definition: [0.005,0.01,0.02,0.03,0.04,0.05]
NodeLocation: 744,608,1
NodeSize: 64,40
NumberFormat: 2,F,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15,

Constant Initial_Adoption
Title: Initial Adoption
Units: %
Definition: [1%,5%,10%,20%,30%]
NodeLocation: 512,256,1
NodeSize: 64,40
NumberFormat: 2,%,2,0,0,0,2,0,$,0,"ABBREV",0,,,0,0,15,
{!40300|Att_SlicerPopupSize: 227,112}

Index Long_Run_Market_Sha2
Title: Long-Run Market Share
Definition: [40%,50%,60%,70%,80%,90%]
NodeLocation: 336,616,1
NodeSize: 64,40
NumberFormat: 2,%,2,0,0,0,2,1,$,0,"ABBREV",0,,,0,0,15,
{!40300|Att_SlicerPopupSize: 247,128}

Index Year
Title: Year
Definition: Sequence(0,20,dT1)
NodeLocation: 928,608,1
NodeSize: 64,40
ValueState: 2,2230,179,641,434,0,MIDM

Variable Fraction_Remaining2
Title: Fraction Remaining
Definition: 1- Market_Adoption_Illu / Long_Run_Market_Sha2 
NodeLocation: 728,488,1
NodeSize: 64,40

Variable Adoption_from_Adver2
Title: Adoption from Advertising
Definition: Potential_Adopters * Advertising_Coeffici
NodeLocation: 392,480,1
NodeSize: 64,40

Variable Adoption_from_Word_o
Title: Adoption from Word of Mouth
Definition: Market_Adoption_Illu * Word_of_Mouth_Coeff1 * Fraction_Remaining2
NodeLocation: 576,488,1
NodeSize: 64,40

Constant dT1
Title: dT
Units: years
Definition: 0.125
NodeLocation: 936,496,1
NodeSize: 64,40

Close Illustrators

Close Logit_Calcs

Text MktShare_Frame
NodeLocation: 1292,308,-1
NodeSize: 380,300
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus:yes~
Show_description:20

Module Market_Share_Adjustm
Title: Market Share Adjustments
Author: JamesMilford
Date: Fri, Nov 8, 2019 10:26 AM
NodeLocation: 816,296,1
NodeSize: 64,40
DiagState: 2,62,29,1685,646,17
AcpStyles: Framenode: MktShr_Adj_Frame

Variable Fract_Event_Peak
Title: Fractional Event Peak
Units: year
Description: The event peak impact date in fractional form.
Definition: VAR dates:=Event_Dates[All_Event_Names=Event_Names, Date_Type=Peak_Date_Label];~
VAR month:=DatePart(dates, 'M');~
VAR year:=DatePart(dates, 'Y');~
(year + (month-1)/12)
NodeLocation: 240,288,1
NodeSize: 64,40
DefnState: 2,372,378,536,303,0,DFNM
ValueState: 2,164,170,1191,320,0,MIDM
{!40300|DomainExpr: Continuous()}

Variable Length_Impact_Window
Title: Length of Impact Window
Units: years
Description: The length of time between the event start and end dates.
Definition: Fract_Event_End - Fract_Event_Start + dT_PV_Data
NodeLocation: 392,192,1
NodeSize: 64,40
ValueState: 2,92,242,1054,577,1,MIDM

Variable Std_Deviation
Title: Std Deviation
Units: years
Description: The standard deviation corresponding with the normal distribution applied to event impact adjustments. Note: 95% of the area under a normal distribution is contained within 4 standard deviations.
Definition: Length_Impact_Window / Width_of_Normal_Dist
NodeLocation: 544,192,1
NodeSize: 64,40
WindState: 2,213,526,720,350
ValueState: 2,405,412,623,509,0,MIDM

Variable Total_Impact_Shape
Title: Total Impact Shape
Units: dmnls
Description: The event impacts summed over all events.
Definition: Sum(Impact_Shape_byEvent-1, Event_Names) + 1
NodeLocation: 1160,288,1
NodeSize: 64,40
ValueState: 2,84,289,1484,559,1,MIDM

Decision Impact_Scaling
Title: Impact Scaling
Units: dmnls
Description: The peak impact associated with each event.~
~
SDGE Notes: ITC events are proportional to the expected decline in the ITC. Commercial response to ITC is about 1/3 of the residential response because of the ITC's reduced impact on the NPV of the system and bill savings.
Definition: Table(All_Event_Names,All_Sectors)(~
0,0,0,0,~
0,0,0,0,~
0,0,0,0,~
0,0,0,0,~
0,0,0,0)
NodeLocation: 704,480,1
NodeSize: 64,40
WindState: 2,66,28,852,442
DefnState: 2,448,285,1099,330,0,DFNM
ValueState: 2,577,463,488,303,0,MIDM
Aliases: FormNode Fo1573055309
NodeColor: 65535,65531,1
ReformDef: [All_Sectors,Event_Names]
NumberFormat: 2,%,4,2,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
{!40300|DomainExpr: Continuous(0,1)}
{!40200|OptDimensions: [Event_Names]}
{!50000|Att_ColumnWidths: [,Mkt_Share_ImpactType,\([,128])]}

Variable Impact_Shape_byEvent
Title: Impact Shape by Event
Units: dmnls
Description: The applied event impact shape for each event.
Definition: IF Event_Applicability[All_Sectors=PV_Sectors, All_Event_Names=Event_Names]~
THEN Impact_Shapes_by_Opt[Impact_Shape_Options=Selected_Impact_Shap, PV_Sim_Strt_Yr_Opt=Time_Solar_PV]~
ELSE 1
NodeLocation: 1008,288,1
NodeSize: 64,40
ValueState: 2,10,78,1376,741,0,MIDM
ReformVal: [Time_Solar_PV,Event_Names]
Att_ResultSliceState: [PV_Sectors,1,Event_Names,1,Time_Solar_PV,1]

Decision Event_Applicability
Title: Event Applicability
Units: boolean
Description: Specify which events are applicable to each sector.
Definition: Table(All_Event_Names,All_Sectors)(~
Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),~
Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),~
Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),~
Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),~
Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0))
NodeLocation: 1080,192,1
NodeSize: 64,40
DefnState: 2,372,378,949,305,0,DFNM
Aliases: FormNode Fo1573055257
NodeColor: 65535,65531,1
ReformDef: [All_Event_Names,All_Sectors]
TableCellDefault: Checkbox(0)

Variable Fractional_Time
Title: Fractional Time
Units: year
Description: The fractional year associated with each month in the "Time - Solar PV" index.
Definition: VAR month:=DatePart(PV_Sim_Strt_Yr_Opt, 'M');~
VAR year:=DatePart(PV_Sim_Strt_Yr_Opt, 'Y');~
year + (month-1)/12
NodeLocation: 544,288,1
NodeSize: 64,40
ValueState: 2,43,8,651,886,0,MIDM

Variable Fract_Event_Start
Title: Fractional Event Start
Units: year
Description: The event start date in fractional form.
Definition: VAR dates:=Event_Dates[All_Event_Names=Event_Names, Date_Type=Start_Date_Label2];~
VAR month:=DatePart(dates, 'M');~
VAR year:=DatePart(dates, 'Y');~
(year + (month-1)/12)
NodeLocation: 240,192,1
NodeSize: 64,40
WindState: 2,20,113,951,583
ValueState: 2,63,408,823,303,0,MIDM
{!40300|DomainExpr: Continuous()}

Variable Fract_Event_End
Title: Fractional Event End
Units: year
Description: The event end date in fractional form.
Definition: VAR dates:=Event_Dates[All_Event_Names=Event_Names, Date_Type=End_Date_Label2];~
VAR month:=DatePart(dates, 'M');~
VAR year:=DatePart(dates, 'Y');~
(year + (month-1)/12)
NodeLocation: 240,384,1
NodeSize: 64,40
DefnState: 2,96,288,416,303,0,DFNM
ValueState: 2,164,170,675,303,0,MIDM
{!40300|DomainExpr: Continuous()}

Decision Width_of_Normal_Dist
Title: Width of Normal Distrib
Units: std deviations
Description: The number of standard deviations included in the start and end periods of the normal distribution.
Definition: 5
NodeLocation: 544,96,1
NodeSize: 64,40
WindState: 2,8,81,720,350
Aliases: FormNode Fo1573055315
{!40300|DomainExpr: Continuous(0,10)}

Variable Normal_Impact_Shape
Title: Normal Impact Shape
Units: dmnls
Description: The user-defined shape associated with a normally distributed impact.
Definition: VAR shapes:=IF (Fractional_Time < Fract_Event_Start) OR (Fractional_Time > Fract_Event_End)~
   THEN 0~
   ELSE Create_Norm_Distrib(Fractional_Time, Fract_Event_Peak, Std_Deviation, PV_Sim_Strt_Yr_Opt);~
VAR area:=Sum(shapes, PV_Sim_Strt_Yr_Opt);~
VAR decrScaling:=Divide(area[Mkt_Share_ImpactType=Increase_Label], area[Mkt_Share_ImpactType=Decrease_Label], True);~
VAR scaledShape:=IF (Fractional_Time < Fract_Event_Start) OR (Fractional_Time > Fract_Event_End)~
   THEN 1~
   ELSE IF Mkt_Share_ImpactType = Increase_Label~
   THEN 1 + Impact_Scaling[All_Sectors=PV_Sectors, All_Event_Names=Event_Names] * shapes~
   ELSE 1 - decrScaling * Impact_Scaling[All_Sectors=PV_Sectors, All_Event_Names=Event_Names] * shapes;~
~
Product(scaledShape, Mkt_Share_ImpactType)
NodeLocation: 704,192,1
NodeSize: 64,40
WindState: 2,169,411,1274,511
ValueState: 2,42,11,1554,689,1,MIDM
ReformVal: [PV_Sim_Strt_Yr_Opt,Mkt_Share_ImpactType]
Att__TotalsIndex: [PV_Sim_Strt_Yr_Opt]
Att_ResultSliceState: [Mkt_Share_ImpactType,2,All_Event_Names,1,PV_Sim_Strt_Yr_Opt,1]

Variable Triang_Impact_Shape
Title: Triangular Impact Shape
Units: dmnls
Description: The user-defined shape associated with a triangular-shaped impact.
Definition: VAR shapes:=IF (Fractional_Time < Fract_Event_Start) OR (Fractional_Time > Fract_Event_End)~
   THEN 0~
   ELSE IF Fractional_Time <= Fract_Event_Peak~
   THEN (Fractional_Time - Fract_Event_Start + dt_PV_Data) / (Fract_Event_Peak - Fract_Event_Start + dt_PV_Data)~
   ELSE (Fract_Event_End - Fractional_Time + dt_PV_Data) / (Fract_Event_End - Fract_Event_Peak + dt_PV_Data);~
VAR area:=Sum(shapes, PV_Sim_Strt_Yr_Opt);~
VAR decrScaling:=Divide(area[Mkt_Share_ImpactType=Increase_Label], area[Mkt_Share_ImpactType=Decrease_Label], True);~
VAR scaledShape:=IF (Fractional_Time < Fract_Event_Start) OR (Fractional_Time > Fract_Event_End)~
   THEN 1~
   ELSE IF Mkt_Share_ImpactType = Increase_Label~
   THEN 1 + Impact_Scaling[All_Sectors=PV_Sectors, All_Event_Names=Event_Names] * shapes~
   ELSE 1 - decrScaling * Impact_Scaling[All_Sectors=PV_Sectors, All_Event_Names=Event_Names] * shapes;~
~
Product(scaledShape, Mkt_Share_ImpactType)
NodeLocation: 704,384,1
NodeSize: 64,40
ValueState: 2,0,2,1631,795,1,MIDM
Att_ResultSliceState: [Mkt_Share_ImpactType,2,All_Event_Names,1,PV_Sim_Strt_Yr_Opt,1]

Objective Impact_Shapes_by_Opt
Title: Impact Shapes by Option
Units: dmnls
Description: The impact shape for each shape option.
Definition: Table(Impact_Shape_Options)(Block_Impact_Shape,Triang_Impact_Shape,Normal_Impact_Shape)
NodeLocation: 856,288,1
NodeSize: 64,40
ValueState: 2,306,48,915,772,0,MIDM
NodeColor: 19661,48336,65535
ReformVal: [PV_Sim_Strt_Yr_Opt,All_Event_Names]
Att_ResultSliceState: [Impact_Shape_Options,3,Event_Names,2,PV_Sim_Strt_Yr_Opt,1]

Variable Block_Impact_Shape
Title: Block Impact Shape
Units: dmnls
Description: The user-defined shape associated with a block-shaped impact.
Definition: VAR shapes:=IF (Fractional_Time < Fract_Event_Start) OR (Fractional_Time > Fract_Event_End)~
   THEN 0~
   ELSE 1;~
VAR area:=Sum(shapes, PV_Sim_Strt_Yr_Opt);~
VAR decrScaling:=Divide(area[Mkt_Share_ImpactType=Increase_Label], area[Mkt_Share_ImpactType=Decrease_Label], True);~
VAR scaledShape:=IF (Fractional_Time < Fract_Event_Start) OR (Fractional_Time > Fract_Event_End)~
   THEN 1~
   ELSE IF Mkt_Share_ImpactType = Increase_Label~
   THEN 1 + Impact_Scaling[All_Sectors=PV_Sectors, All_Event_Names=Event_Names] * shapes~
   ELSE 1 - decrScaling * Impact_Scaling[All_Sectors=PV_Sectors, All_Event_Names=Event_Names] * shapes;~
~
Product(scaledShape, Mkt_Share_ImpactType)
NodeLocation: 704,288,1
NodeSize: 64,40
ValueState: 2,0,2,1631,795,1,MIDM
Att_ResultSliceState: [Mkt_Share_ImpactType,2,All_Event_Names,1,PV_Sim_Strt_Yr_Opt,1]

Decision Selected_Impact_Shap
Title: Selected Impact Shape
Description: Select which shape to use for the event impact adjustments.
Definition: Choice(Impact_Shape_Options,3,1)
NodeLocation: 928,192,1
NodeSize: 64,40
Aliases: FormNode Fo1572912162

FormNode Fo1572912162
Title: Selected Impact Shape
Definition: 0
NodeLocation: 940,144,1
NodeSize: 76,16
NodeInfo: 1,0,0,0,0,0,0,118,0,,0,,,
Original: Selected_Impact_Shap

Variable Impact_Ratio_byEvent
Title: Impact Ratio by Event
Units: ratio
Description: The ratio of the area under the positive impacts to the area under the negative impacts.
Definition: VAR incrArea:=Sum(MAX([1, Impact_Shape_byEvent])-1, Time_Solar_PV);~
VAR decrArea:=Sum(1-MIN([1, Impact_Shape_byEvent]), Time_Solar_PV);~
Divide(incrArea, decrArea, True)
NodeLocation: 1008,384,1
NodeSize: 64,40
ValueState: 2,21,150,1260,457,0,MIDM

Variable Total_Impact_Ratio
Title: Total Impact Ratio
Units: ratio
Description: The ratio of the area under the positive impacts to the area under the negative impacts.
Definition: VAR incrArea:=Sum(MAX([1, Total_Impact_Shape])-1, Time_Solar_PV);~
VAR decrArea:=Sum(1-MIN([1, Total_Impact_Shape]), Time_Solar_PV);~
Divide(incrArea, decrArea, True)
NodeLocation: 1160,384,1
NodeSize: 64,40
ValueState: 2,422,480,416,303,0,MIDM

FormNode Fo1573055257
Title: Event Applicability
Definition: 0
NodeLocation: 1088,140,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Event_Applicability

FormNode Fo1573055309
Title: Impact Scaling
Definition: 0
NodeLocation: 712,532,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,72,0,,0,,,0
Original: Impact_Scaling

FormNode Fo1573055315
Title: Width of Normal Distrib
Definition: 0
NodeLocation: 552,44,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Width_of_Normal_Dist

Module Impact_Auxiliary_Var
Title: Impact Auxiliary Variables
Author: JamesMilford
Date: Fri, Nov 8, 2019 10:26 AM
NodeLocation: 88,512,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,180,27,1055,480,17
NodeColor: 58982,58982,58982
AcpStyles: Show_Object: no

Function Create_Norm_Distrib(x, mean, stdDev; ind: Index)
Title: Create Normal Distrib
Description: Creates a normal distribution having a mean of [mean] and a standard deviation of [stdDev] along the the range of values specified by [x], which is indexed by [ind].~
~
[x]: the range of values over which the distribution is defined (these should be in the same units of measurement as the mean and standard deviation)~
[mean]; the mean value of the normal distribution~
[stdDev]: the standard deviation of the normal distribution~
[ind]: the index over which x is specified
Definition: VAR distrib:=1 / SQRT(2 * Pi * stdDev^2) * EXP(-((x - mean)^2) / (2 * stdDev^2));~
VAR mode:=Max(distrib, ind);~
distrib / mode
NodeLocation: 256,384,1
NodeSize: 64,40

Index All_Event_Names
Att_PrevIndexValue: ['2016 ITC Expiration','2016 NEM 2.0','2020 ITC Phaseout','2021 ITC Phaseout','2022 ITC Phaseout']
Title: All Event Names
Definition: ['2016 ITC Expiration','2016 NEM 2.0','2020 ITC Phaseout','2021 ITC Phaseout','2022 ITC Phaseout']
NodeLocation: 408,160,1
NodeSize: 64,40

Index Mkt_Share_ImpactType
Att_PrevIndexValue: ['Share Increase','Share Decrease']
Title: Mkt Share Impact Type
Definition: ['Share Increase','Share Decrease']
NodeLocation: 256,64,1
NodeSize: 64,40

Decision Increase_Label
Title: Increase Label
Definition: Choice(Mkt_Share_ImpactType,1,0)
NodeLocation: 256,160,1
NodeSize: 64,40
Aliases: FormNode Fo1573056619

Decision Decrease_Label
Title: Decrease Label
Definition: Choice(Mkt_Share_ImpactType,2,0)
NodeLocation: 256,272,1
NodeSize: 64,40
Aliases: FormNode Fo1573056620

Index Impact_Shape_Options
Att_PrevIndexValue: ['Block','Triangular','Normal Distrib']
Title: Impact Shape Options
Definition: ['Block','Triangular','Normal Distrib']
NodeLocation: 408,64,1
NodeSize: 64,40

Index Date_Type
Att_PrevIndexValue: ['Start','Peak','End']
Title: Date Type
Definition: ['Start','Peak','End']
NodeLocation: 104,64,1
NodeSize: 64,40

Decision Select_Event_Names
Title: Select Event Names
Description: Select the event names that will be included in the simulation. Note: if the simulation starts after one of the events, that event will not be considered.
Definition: MultiChoice(All_Event_Names,allowNone:0,returnList:1)
NodeLocation: 408,248,1
NodeSize: 64,40
Aliases: FormNode Fo1572915383

FormNode Fo1572915383
Title: Selected Impact Shape
Definition: 0
NodeLocation: 412,296,1
NodeSize: 76,16
NodeInfo: 1,0,0,0,0,0,0,118,0,,0,,,
Original: Select_Event_Names

Index Event_Names
Title: Event Names
Definition: CopyIndex(Select_Event_Names)
NodeLocation: 408,360,1
NodeSize: 64,40

FormNode Fo1573056619
Title: Increase Label
Definition: 0
NodeLocation: 268,208,1
NodeSize: 76,16
NodeInfo: 1,0,0,0,0,0,0,118,0,,0,,,
Original: Increase_Label

FormNode Fo1573056620
Title: Decrease Label
Definition: 0
NodeLocation: 268,320,1
NodeSize: 76,16
NodeInfo: 1,0,0,0,0,0,0,118,0,,0,,,0
Original: Decrease_Label

Decision Start_Date_Label2
Title: Start Date Label
Definition: Choice(Date_Type,1,0)
NodeLocation: 104,160,1
NodeSize: 64,40
Aliases: FormNode Fo1573070220

FormNode Fo1573070220
Title: Increase Label
Definition: 0
NodeLocation: 116,208,1
NodeSize: 76,16
NodeInfo: 1,0,0,0,0,0,0,118,0,,0,,,
Original: Start_Date_Label2

Decision Peak_Date_Label
Title: Peak Date Label
Definition: Choice(Date_Type,2,0)
NodeLocation: 104,272,1
NodeSize: 64,40
Aliases: FormNode Fo1573070241

FormNode Fo1573070241
Title: Increase Label
Definition: 0
NodeLocation: 116,320,1
NodeSize: 76,16
NodeInfo: 1,0,0,0,0,0,0,118,0,,0,,,
Original: Peak_Date_Label

Decision End_Date_Label2
Title: End Date Label
Definition: Choice(Date_Type,3,0)
NodeLocation: 104,384,1
NodeSize: 64,40
Aliases: FormNode Fo1573070245

FormNode Fo1573070245
Title: Increase Label
Definition: 0
NodeLocation: 116,432,1
NodeSize: 76,16
NodeInfo: 1,0,0,0,0,0,0,118,0,,0,,,
Original: End_Date_Label2

FormNode Fo1573057129
Title: Sim vs Act EV Stock
Definition: 1
NodeLocation: 716,44,1
NodeSize: 212,20
NodeInfo: 1,,,,,,0,70,,,,,,0
NodeColor: 65278,37008,6168
Original: Sim_vs_Act_PV_System

FormNode Fo1573057130
Title: Sim vs Act Net EV Sales
Definition: 1
NodeLocation: 716,84,1
NodeSize: 212,20
NodeColor: 65278,37008,6168
Original: Sim_vs_Act_PV_Rate

FormNode Fo1573237322
Title: Multi-D Forecasts
Definition: 1
NodeLocation: 716,164,1
NodeSize: 212,20
Original: Compare_Prior_Fcsts

Close Impact_Auxiliary_Var

Decision Event_Dates
Title: Event Dates
Units: fraction
Description: Dates for key events impacting PV adoption.
Definition: Table(All_Event_Names,Mkt_Share_ImpactType,Date_Type)(~
Choice(PV_Sim_Strt_Yr_Opt,156,0),Choice(PV_Sim_Strt_Yr_Opt,166,0),Choice(PV_Sim_Strt_Yr_Opt,168,0),~
Choice(PV_Sim_Strt_Yr_Opt,169,0),Choice(PV_Sim_Strt_Yr_Opt,181,0),Choice(PV_Sim_Strt_Yr_Opt,193,0),~
Choice(PV_Sim_Strt_Yr_Opt,162,0),Choice(PV_Sim_Strt_Yr_Opt,172,0),Choice(PV_Sim_Strt_Yr_Opt,174,0),~
Choice(PV_Sim_Strt_Yr_Opt,175,0),Choice(PV_Sim_Strt_Yr_Opt,187,0),Choice(PV_Sim_Strt_Yr_Opt,199,0),~
Choice(PV_Sim_Strt_Yr_Opt,204,0),Choice(PV_Sim_Strt_Yr_Opt,214,0),Choice(PV_Sim_Strt_Yr_Opt,216,0),~
Choice(PV_Sim_Strt_Yr_Opt,217,0),Choice(PV_Sim_Strt_Yr_Opt,229,0),Choice(PV_Sim_Strt_Yr_Opt,241,0),~
Choice(PV_Sim_Strt_Yr_Opt,216,0),Choice(PV_Sim_Strt_Yr_Opt,226,0),Choice(PV_Sim_Strt_Yr_Opt,228,0),~
Choice(PV_Sim_Strt_Yr_Opt,229,0),Choice(PV_Sim_Strt_Yr_Opt,241,0),Choice(PV_Sim_Strt_Yr_Opt,253,0),~
Choice(PV_Sim_Strt_Yr_Opt,228,0),Choice(PV_Sim_Strt_Yr_Opt,238,0),Choice(PV_Sim_Strt_Yr_Opt,240,0),~
Choice(PV_Sim_Strt_Yr_Opt,241,0),Choice(PV_Sim_Strt_Yr_Opt,253,0),Choice(PV_Sim_Strt_Yr_Opt,265,0))
NodeLocation: 80,288,1
NodeSize: 64,40
WindState: 2,98,82,936,615
DefnState: 2,966,3,571,425,0,DFNM
ValueState: 2,425,487,765,386,0,MIDM
Aliases: FormNode Fo1573069204
ReformDef: [Mkt_Share_ImpactType,All_Event_Names]
ReformVal: [Date_Type,Event_Names]
NumberFormat: 2,%,4,2,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
{!40300|DomainExpr: Continuous()}
TableCellDefault: Choice(PV_Sim_Strt_Yr_Opt,1,0)
Att_EditSliceState: [Date_Type,1,All_Event_Names,1,Mkt_Share_ImpactType,1]
{!50000|Att_ColumnWidths: [,Mkt_Share_ImpactType,\([,128])]}

FormNode Fo1573069204
Title: Impact Scaling
Definition: 0
NodeLocation: 88,340,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,72,0,,0,,,0
Original: Event_Dates

Variable Wtd_Avg_LRMS
Title: Wtd Avg LRMS
Units: fraction
Description: The average long-run market share, weighted by eligible buildings for retrofits.
Definition: Sum(LRMS_by_PV_Time[System_Types=PV_Retrofit_Label] * Eligible_PV_Stock_fo, PV_Spatial_ID) / Sum(Eligible_PV_Stock_fo, PV_Spatial_ID)
NodeLocation: 1160,472,1
NodeSize: 64,40
WindState: 2,235,557,720,350
ValueState: 2,72,43,1438,700,,MIDM
NumberFormat: 2,%,4,2,0,0,4,0,$,0,"ABBREV",0,,,0,0,15

Variable Wtd_Avg_Fract_Remain
Title: Wtd Avg Fraction Remaining
Units: fraction
Description: The average fraction of market potential remaining, weighted by market potential in each zip code.
Definition: Sum(Fraction_Remaining * Eligible_PV_Stock_fo * LRMS_by_PV_Time[System_Types=PV_Retrofit_Label], PV_Spatial_ID) / Sum(Eligible_PV_Stock_fo * LRMS_by_PV_Time[System_Types=PV_Retrofit_Label], PV_Spatial_ID)
NodeLocation: 1008,472,1
NodeSize: 64,40
ValueState: 2,426,223,972,679,,MIDM
NumberFormat: 2,%,4,2,0,0,4,0,$,0,"ABBREV",0,,,0,0,15

Text MktShr_Adj_Frame
NodeLocation: 1600,372,-1
NodeSize: 360,356
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus:yes~
Show_description:20

Variable Va3
Definition: PV_Sim_Strt_Yr_Opt=Time_Solar_PV
NodeLocation: 832,480,1
NodeSize: 64,40
ValueState: 2,187,38,1375,761,0,MIDM

Close Market_Share_Adjustm

Variable Va4
Definition: Mthly_Simple_Payback[PV_Climate_Zone=Climate_Zone_Map, Time=Time_Solar_PV]
NodeLocation: 312,88,1
NodeSize: 64,40
ValueState: 2,452,205,847,637,,MIDM
GraphSetup: Att_GraphValueRange Va4:1,,0,,,,,0.27402884140610695,3.626538634300232,0~
Att_GraphIndexRange Time_Solar_PV:1,,0,,,,,45929.995222091675,46752,0

FormNode Fo708228131
Title: Market Share Method
Definition: 0
NodeLocation: 660,216,1
NodeSize: 52,16
NodeInfo: 1,,,0,,,,70,,,,,,0
NodeColor: 65535,65531,1
Original: Market_Share_Method

Variable Payback_coefficient_
Title: Payback coefficient test
Definition: [-0.1,-0.2,-0.3,-0.4,-0.5]
NodeLocation: 168,632,1
NodeSize: 64,40

Close Market_Share

Module Word_of_Mouth
Title: Word of Mouth
Author: Cory Welch
Date: Tue, Jan 9, 2018 9:49 AM
NodeLocation: 632,648,1
NodeSize: 72,56
NodeInfo: 1,1,1,1,1,1,0,,0,,0,,,
DiagState: 2,524,2,1102,596,17,10
Pict: (000000000000003C003C00040605000089504E470D0A1A0A0000000D494844520000003C0000003C08060000003AFCD972000000017352474200AECE1CE90000000467414D410000B18F0BFC6105000000097048597300000EC300000EC301C76FA8640000048B494441546843ED994F4814511CC73D7AF4E82D6F790A3B449EC28307C18B75DA2E618760A143D221F6A617F1506048B051A0447F4C12B67FB021A441D8124A4B4699246C18B245A159940A32D37C87FD3DDECCFC76E78F33B3AF710F1FF6CD7BBF997DDF79BFF7DEEFF7A649D7F503055B9964D8CA24C3562619B632C9B0954986ADB433BF9EEF197E9DCE9E9BE99A4B3DED281EBDDDA447C5C9C7EDCBF89FCCCBD4E4B3D264EAD7EE660BD7A7A0B095C4D2F742273AC0752C2E4E4CB56C3E5A9DE8E7FA1704B672776FBB79AC9819B1FF394677F055FFC4F5B78343517165716014236CFFEFF3CF7BF23FFE965BB9FEFAC15101B1B2DB764FB796E15AA8B7DB46CDC2D7B9AE33F9CE02F505A35DFAB9DCCED97AC551218F2C4633EC391484F1772399E3F79AB7D127BC00CEC62B960BCC59128B454A6EAB37F032EADB83956C9AB3F18228C0656981821BD7C385DDB8F8A22F87FE61B483CE6751C0D6436F70762DD7271BA90244926B6381E36CDC1005B830BD3DD94035B05AA39F41E7B228D056805FD94035B06DA19F58B1B9763744A137D756C283F040D94035E4C5CBDEE60551A0878419D54401F6E686601F884243B0A23404FB44141A8215A521D827A270E0045350BE9FD42B0E42134CA921927ED94035EE7C181D084530652138DE910D5483B23AC4FE5CBB1BA280FC92DE9C0AC73AD5A0F3361CE372ED6E88C2C78D620709C6B9966CA40AF22145D0C5D57281F98B876101C30B90DBEA0D8E9C2885C528073D82B25CC095719E8587E2444125D7A6B90BF633188E0AD96D201EDB80DD264ED67F97DAE4B3E99AD36DE6C2843E7D6A4E9F1F1ED1567229CEC65101B0F4D3BE0CF07671D2B0DF4370AFE0B00E2F1EE2709443FDC094ABEACA5B6B6DDAD556DDC2546F41DFF864E9B3F526092FDF95B095B9CD258C10F7E9C40F5EBF2F69ABF93E7DF652164285E86B87B6F5F26227D9386E928118BC659AD71CB55C1E738D169A20C0CBB0FD04398386782D7B78D3147DB7BBA8EFED9803C31A7360C41176D2072FEA5435C1A897DD11F7D0073337F06905F7075D8909EDF36C8F18E937370650C71ABA0137AD2518EE476B007E311FED36B1F1F0741E82F5276773B8E68D5CA825588E7531C2F00CB93D6EB485B18C39C2378F9471CD1AB9514DB0FCE511735785E0457B7FBF9FDC1AD7AC911B76C1986B14A5014442B0E1EE8D9BD005E3C31B655A005B904A115AE882E595189F333DADAC7FBEF9DE668212BA60C2F3C1413E3D6976C0D832D8F6908944B09F74124180F9E74644C4B5870DF65F53B01184E09A35F20225E2D886B8F6AA20F4430710FD70ED61632414E60B4652615CF3461122BB18CA9C4D68188903626953B09141A18E378C1811DC23D68D6A2E436C65FA98414765A1E48DA306A95CE5CD9B6F1FE15FE1F290FE65BE8BC596E259B0D99A3133DC587ABE9C1B3B1F10171801398D73C14CEEEDCF30E263CE56608CACDD83AC0FA803DAD2ADB439C2E81CD76909FBCAAE8D1F2B39EC90FF1A0B94E9313B5B8E00C872A124C8632B198F098454DA8460A9CE0DB65239AA884EAE60C0884EB66060172D8967ED19D84AA5E144275A30A8B190B9C156FE174034655E3E4254B632B9E84DFF0053E352ED7ECC3F190000000049454E44AE426082)
AcpStyles: FrameNode: PVAdoption1544977287

Decision WOM_Fin_Year
Title: WOM Fin Year
Units: date
Description: The finish date for the assumed ramp up of word of mouth over time
Definition: {Choice(Time_Solar_PV,109,0)}~
PV_Calibration_End
NodeLocation: 480,392,1
NodeSize: 64,40
NodeColor: 57311,57311,57311
AcpStyles: Show_object: no

Decision WOM_Start_Year
Title: WOM Start Year
Units: Date
Description: The starting date for the assumed ramp up of word-of-mouth over time
Definition: {choice(Time_Solar_PV,0,0)}~
PV_Calibration_Start
NodeLocation: 328,392,1
NodeSize: 64,40
WindState: 2,773,134,720,350
NodeColor: 57311,57311,57311
AcpStyles: Show_object: no

Decision Retro_Finish_WOM
Title: Retro Finish WOM
Units: dmnl
Description: Word of mouth strength assumed at "final WOM year" date
Definition: 0.45
NodeLocation: 480,488,1
NodeSize: 64,40
DefnState: 2,104,106,1151,589,,DFNM
ValueState: 2,248,250,416,303,0,MIDM
NodeColor: 57311,57311,57311
ReformVal: [EV_Sectors,PV_Spatial_ID]
{!40300|DomainExpr: Continuous(0.1,1)}
TableCellDefault: 0.45
AcpStyles: Show_object: no
UnoptimizedDef: 0.3

Alias Al4
Title: PV Word of Mouth
Definition: 1
NodeLocation: 128,80,1
NodeSize: 64,40
NodeColor: 57311,57311,57311
Original: Word_of_Mouth2

Alias Al1535640950
Title: PV Ending WOM
Definition: 1
NodeLocation: 128,296,1
NodeSize: 64,40
NodeColor: 57311,57311,57311
Original: PV_Ending_WOM

Variable Applied_WOM_PV
Title: Applied Word of Mouth
Units: 1/year
Description: The applied word-of-mouth strength, which may be time changing depending on the calibration settings.
Definition: var slope:= ZIDZ((Applied_End_WOM - Applied_Start_WOM) , (WOM_Fin_Year - WOM_Start_Year)); {this construct permits enforcing the starting WOM to equal to ending WOM just by setting the WOM Fin Year to be the same as the WOM Start Year}~
~
var linear_WOM:=IF Time_Solar_PV <=WOM_Start_Year THEN Applied_Start_WOM~
	ELSE MIN([Applied_End_WOM, (Applied_Start_WOM + slope * (Time_Solar_PV - WOM_Start_Year))]); {calculates a linear growth of WOM consistent with the starting WOM & ending WOM}~
~
IF Use_Linear_WOM THEN linear_WOM ELSE Applied_Start_WOM {only uses the linear WOM if the Use Linear WOM box is checked}
NodeLocation: 480,264,1
NodeSize: 64,40
ValueState: 2,182,80,1221,753,0,MIDM
ReformVal: [PV_Sectors,PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,1,Time_Solar_PV,1]
Att_ColorRole: Null

Alias Al1535520633
Title: Stored WOM PV
Definition: 1
NodeLocation: 128,200,1
NodeSize: 64,40
Original: Stored_WOM_PV

Variable Applied_Start_WOM
Title: Applied Start WOM
Units: 1/year
Description: The applied starting word-of-mouth strength.
Definition: IF (Use_PV_Decision_Var AND Include_Start_WOM) ~
THEN Word_of_Mouth2 ~
ELSE Stored_WOM_PV[All_Spatial_ID=PV_Spatial_ID, All_Sectors=PV_Sectors]
NodeLocation: 296,200,1
NodeSize: 64,40
WindState: 2,395,550,720,350

Alias Al1535665647
Title: Stored End WOM PV
Definition: 1
NodeLocation: 128,408,1
NodeSize: 64,40
Original: Stored_End_WOM_PV

Variable Applied_End_WOM
Title: Applied End WOM
Units: 1/year
Description: The applied ending word-of-mouth strength.
Definition: IF (Use_PV_Decision_Var AND Include_End_WOM) ~
THEN PV_Ending_WOM ~
ELSE Stored_End_WOM_PV[All_Spatial_ID=PV_Spatial_ID, All_Sectors=PV_Sectors]
NodeLocation: 296,296,1
NodeSize: 64,40

Decision Use_Linear_WOM
Title: Use Linear WOM?
Units: boolean
Description: When checked, this will use a static word-of-mouth strength in the simulation. When unchecked, this will use a linear, but time-changing, word-of-mouth strength.
Definition: Checkbox(0)
NodeLocation: 480,80,1
NodeSize: 64,40
NodeColor: 57311,57311,57311
AcpStyles: Show_object: no

Text PVAdoption1544977287
NodeLocation: 916,332,-1
NodeSize: 324,292
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus:yes~
Show_description:20

Close Word_of_Mouth

Module Misc1
Title: Misc
Author: JamesMilford
Date: Tue, Dec 11, 2018 9:35 AM
NodeLocation: 136,648,1
NodeSize: 72,56
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,180,7,1446,648,17,10
Pict: (000000000000003C003C00047A06000089504E470D0A1A0A0000000D494844520000003C0000003C08060000003AFCD972000000017352474200AECE1CE90000000467414D410000B18F0BFC6105000000097048597300000EC300000EC301C76FA864000005FF494441546843E5984B681D5518C7036E2AB8881BC9AED9885D495D8845B46491452108D155DC485C08414183885C41BC5D58B2B0120D95041F09D6470C56AE8FC28D05138B4D2F6D82D1FA8885C2AD95105F1853D1B410663CFFE17E27DF9CF9E666E6CC39976B5CFCE0DEEF3CE67CE77BCE748461F8BF4214EE6644A1177EFD767FF8C9C395E06265401C6F11A2D0395BD7F6049377D68397BAC2E0D8DECDF0EF5FBAC4792D4014BA26F8F2D5E148D906E1E9E746A579AD40143A05D67DEDF635AE7064E56B1B9DE27CCF8842A7286B6ACB2E1C19D14A7FF7DEA038DF33A2D0191B57BA61CD485995B060D5D87F698D6744A1339095614D9EA84E3C30AF65CADD136B3C230A9DB0B67420520CD664498A27B0F0A7859ED89A16200A5D10BCD3BB1C29A61256CC9270F386C2509EAF6905A2B028C1A56A7F33A5286B87D5A16973CC37A2B010BC0C292B4B738299BE5AB3719F88C222C49A0C6569694EF8E183D5685C755FE2780E82CB7387A21CA19261C4DCD3E3CDDA5751688DCAC4C1F86DEB50A669D939F5C454A430E25B1ACF021A17DA4700972A3537B13F85E14D065E16A43980352089B1AC7065E129B032AC7BFC9E15BD379436D6C5FE144229A89B0A2A4388E7C5B192597E82DA0B87F5A1983C2B3C2942F1443D6FD2D16D4F2A8AD46490C5CD58A503D9C6B0CAEED17A654D715C4189D1B4726C922D481CD1010095216E71339EE9722C15D6351E593E257474F2543985CB63936C119B0CC9E234BF1167515665F2ACE8E73540EC26E62857D6E34C1E9B644370E1CD21FD702A43296D6504E23A6D2C2B780981059587D05EC80B7C8E1F85539A0CD1E2045CBD7190C2AF88D89B6ABA82BBB7178563D9B6F130147D92C1FA8935CC23D2E22F17ECD279AE70AF309A0C3329A5589CA3AD6F9BA10562CA359A0DF70AA3C863439694B8C5A396CF5CC3DCD93A7E25F8BE2A7F40E65661E9E092C54D5877E4F45DD8BBC254727852226560712936D9E79D3477B7C5AB4B8BEFBA195C35D35B940DBE93964E3ADC4A647174354693110177DF219959016BD2373228C63CCB89C2629301945523997A089F9F1837D7D9824B45D26CBC8A02B3DB2AAE708AEBEC084F6696ADA489F63252C84B6BC9AC2426A534C8DDF3AE6B02ED8737A2B43D8B29CCAD949294443224331B684FB37FE6145398AC84922325A514F4C7BA9CEB768214F1A330B3922E431910CB9723F4BE3E14D6098237193B810447DF96F2ACCB0829E25CE198957294136F4D4603BDB753855919CAD52CA085A4F2E5A80C9990224E15E656CA554E6CCB570E687F770AA30CA92E66E3E55BC2D90F7A164B5F0C4C3F72AA67BEAFD25DBFE3AD8EB0DDC0B9703E9CF3A34B538357AFAF77E6535859E9CC2B3787BDC76F08A407B43BBD27BAD6CED49E793193C257576BF796276FDAE21B1C9CE95CC70D4E7C5D3E9C89A5A78E8A7257D41E9D98F8F4BED989AF9E7D9E648F7D76A80A45F9B9CBAFDF18C24BB97E31654179E6D61F69415F65EFE585D56AF2CB451B53FF7365DF43D50335D2A1F4062AE2F6786C3294A389E593779FBBBEB5E9B47EB692B1F38F8F912E886B92EB0908747289FB3FDEB722298BDB3BBA343C0AF70647CE0D8D5FF8AD167D52691579CE8071E88390FCFD9F3504F3B6C2B805BA91C59FE713DF9BDEFE7E74F8AE77F76CD21C0E1E6ACEF741DE33E072683EE21C323DF8E4E7FD150C20C5938CE0AE0E2FC0E6B8655EA6DEBF389EF806ED12DB339095074EEE8F9A273D0037C600142719419781077157C76F6CC437F485ED1970291883A5F15F0F50FC4E7E335222993926B90D5C0563C01C7389ED1978A8E2BF1E20D7903634DD82D32C145C627B06BA8C848551B8D33644B2C018C0E6B3F5E981B92B957EB4722487EB98EB5C627B06BA0C842CFE2736C44D500AE7D042095C9254C65C93F70CF88F928471BA0C3D08252985C3DA24E7201EB0313D04B786986F85B2449E33203C31077AFDF0C772F4E6169B80B44E1BF92E33BEE1658C6A30484CA4E400101F927BB733B0F4D872698474405FCDAD9F58B0FA57BD9B37DF8801C40E6E091D58BB02B786817823023DA00FD72FA62C071B504CFF178195A5B88EFD3141A023F0A9E8B73B3867F9ECE054B3171A51B89B1185BB97B0E35FD04CAAD2B53AC7380000000049454E44AE426082)
AcpStyles: FrameNode: PVAdoption1544977242

Variable Eligible_PV_Stock_fo
Title: Eligible PV Stock for Retrofit
Units: PV stock units
Description: The beginning-of-period building stock that has the potential to be retrofitted with a supplemental system.
Definition: VAR currentStock:=Total_Building_Stock[All_Sectors=PV_Sectors, All_Spatial_ID=PV_Spatial_ID] * Usable_PV_stock_to_b;~
VAR previousStock:=currentStock[Time=Time_Solar_PV][@Time_Solar_PV=@Time_Solar_PV-1];~
IF @Time_Solar_PV=1 ~
THEN currentStock[Time=PV_Sim_Start_Minus_1] ~
ELSE previousStock
NodeLocation: 152,88,1
NodeSize: 64,40
WindState: 2,32,380,1355,538
ValueState: 2,453,45,1019,706,1,MIDM
Aliases: Alias Al1460632099, Alias Al1752410387, Alias Al555204899
NodeColor: 65535,65535,65535
GraphSetup: Att_GraphValueRange Eligible_PV_Stock_fo:1,,1,1,,,,0,700K,0
ReformVal: [Time_Solar_PV,PV_Sectors]
NumberFormat: 2,F,4,0,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: []
Att_ResultSliceState: [PV_Sectors,2,PV_Spatial_ID,20,Time_Solar_PV,1]

Variable Total_Install_Rate
Title: Total Install Rate
Units: bldg units/year
Description: The total (retrofit plus new construction) intallation rate for PV systems.
Definition: Table(New_or_Retrofit)(PV_NewConst_Installs,Retrofit_Installs)
NodeLocation: 488,312,1
NodeSize: 64,40
WindState: 2,161,341,1303,435
ValueState: 2,557,10,1014,711,1,MIDM
NodeColor: 19661,48336,65535
ReformVal: [Time_Solar_PV,Null]
Att__TotalsIndex: [PV_Spatial_ID,New_or_Retrofit]
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,0,New_or_Retrofit,0,Time_Solar_PV,1]
Att_ColorRole: Null

Variable Sim_Cumulative_PV
Title: Simulated Cumulative PV EOP
Units: systems or MW-AC
Description: Total cumulative end of period installations, including from retrofit stock and new construction building stock.
Definition: Sim_Cumul_PV_BOP + Sim_PV_Install_Rate * dT_PV_Data
NodeLocation: 488,432,1
NodeSize: 64,40
NodeInfo: 1,1,1,1,1,1,0,,0,,0,,,
WindState: 2,303,229,1154,454
ValueState: 2,223,36,1367,814,1,MIDM
Aliases: Alias Al1535486026, Alias Al1542206762
GraphSetup: Att_GraphIndexRange PV_Spatial_ID:1,1~
Att_CatLineStyle Graph_Primary_Valdim:4~
Att_ContLineStyle Graph_Primary_Valdim:5~
Graph_AxisLabelFont:,12,0
ReformVal: [Time_Solar_PV,PV_Spatial_ID]
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,0,Area_Type,1,PV_Spatial_ID,0,Time_Solar_PV,1]
Att_ColorRole: Null

Variable Sim_PV_Install_Rate
Title: Simulated PV Install Rate
Units: (systems or MW-AC)/year
Description: The total (retrofit plus new construction) intallation rate for PV systems.
Definition: VAR MWac:= Sum(Total_Install_Rate * PV_ACSystSize_byTime * MW_per_kW, New_or_Retrofit);~
~
{IF PV_Stock_Basis_by_Se[All_Sectors=PV_Sectors] = Buildings_Label~
THEN Sum(Total_Install_Rate, New_or_Retrofit)~
ELSE }MWac;~
~

NodeLocation: 336,312,1
NodeSize: 64,40
WindState: 2,125,0,1303,666
ValueState: 2,48,40,1550,719,1,MIDM
Aliases: Alias Al1535486018
ReformVal: [Time_Solar_PV,Null]
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,0,Rate_Escalation_Scen,1,Time_Solar_PV,1]
Att_ColorRole: Null

Objective Total_Cumul_Installs
Title: Total Cumulative Installs
Units: bldg units
Description: Total cumulative installations, including from retrofit stock and new construction building stock.
Definition: Table(New_or_Retrofit)(Tot_NC_Install_EOP,TotRetro_Install_EOP)
NodeLocation: 152,424,1
NodeSize: 64,40
NodeInfo: 1,1,1,1,1,1,0,,0,,0,,,
WindState: 2,10,373,720,350
ValueState: 2,192,30,1355,748,1,MIDM
NodeColor: 19661,48336,65535
ReformVal: [Time_Solar_PV,New_or_Retrofit]
NumberFormat: 2,F,4,2,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,0,New_or_Retrofit,2,Time_Solar_PV,1]

Variable Init_PV_Calib_Adopt
Title: Initial PV Calibration Adoption
Units: systems or MW-AC
Description: The initial adoption in the simulation start year represented in units used for calibration.
Definition: {IF PV_Stock_Basis_by_Se[All_Sectors=PV_Sectors] = Buildings_Label~
THEN Initial_PV_Adopters1   {building units}~
ELSE }Replace_X_with_Y(Cumul_Cap_Installs[Interconnect_Date=PV_Sim_Start_Minus_1], Null, 0)   {MW-AC}
NodeLocation: 336,536,1
NodeSize: 64,40
ValueState: 2,445,280,967,347,0,MIDM
NodeColor: 65535,39321,39321
ReformVal: [PV_Spatial_ID,PV_Sectors]

Variable Tot_NC_Install_EOP
Title: Total NewCon Installed EOP
Units: bldg units
Description: Cumulative end-of-period adoption from new construction.
Definition: Tot_NC_Install_BOP + PV_NewConst_Installs * dT_PV_Data
NodeLocation: 152,312,1
NodeSize: 64,40
ValueState: 2,332,16,905,786,1,MIDM
NodeColor: 65535,65535,65535
ReformVal: [Time_Solar_PV,PV_Spatial_ID]
NumberFormat: 2,F,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [Time,PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,0,Time_Solar_PV,1]
Att_ColorRole: Null
{!40700|Att_CellFormat: Undefined}

Variable TotRetro_Install_EOP
Title: Total Retrofits Installed EOP
Units: bldg units
Description: Cumulative end-of-period adoption from retrofit applications.
Definition: TotRetro_Install_BOP + Retrofit_Installs * dT_PV_Data
NodeLocation: 152,536,1
NodeSize: 64,40
WindState: 2,102,82,1506,540
ValueState: 2,73,27,1321,679,1,MIDM
NodeColor: 65535,65535,65535
ReformVal: [Time,Null]
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,2,PV_Spatial_ID,0,System_Types,1,Time_Solar_PV,1]
Att_ColorRole: Null

Variable Sim_Cumul_PV_BOP
Title: Simulated Cumulative PV BOP
Units: systems or MW-AC
Description: Total cumulative beginning-of-period installations, including from retrofit stock and new construction building stock.
Definition: Dynamic[Time_Solar_PV](Init_PV_Calib_Adopt,~
   Self[Time_Solar_PV-1] + Sim_PV_Install_Rate[Time_Solar_PV-1] * dT_PV_Data~
)
NodeLocation: 336,432,1
NodeSize: 64,40
NodeInfo: 1,1,1,1,1,1,0,,0,,0,,,
WindState: 2,303,229,1154,454
ValueState: 2,224,64,1355,748,1,MIDM
NodeColor: 65535,65535,65535
ReformVal: [Time_Solar_PV,PV_Sectors]
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,2,PV_Spatial_ID,0,Time_Solar_PV,1]

Text PVAdoption1544977242
NodeLocation: 1132,332,-1
NodeSize: 324,292
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus:yes~
Show_description:20

Alias Al464260131
Title: Cust Load Total by PV Clim Zone
Definition: 1
NodeLocation: 480,192,1
NodeSize: 64,40
Original: Cust_Load_Total_by_P

Index Included_Area_Types
Title: Included Area Types
Definition: MultiChoice(Area_Type,returnList:1)
NodeLocation: 672,312,1
NodeSize: 64,40
Aliases: FormNode Fo1962324515
{!40300|Att_SlicerPopupSize: 297,64}

FormNode Fo1962324515
Title: Included Area Types
Definition: 0
NodeLocation: 628,24,1
NodeSize: 156,16
NodeInfo: 1,,,,,,,120,,,,,,0
Original: Included_Area_Types

Close Misc1

Variable TotRetro_Install_BOP
Title: Total Retrofits Installed
Units: PV_stock_basis_by_sector
Description: Cumulative beginning-of-period adoption from retrofit applications.
Definition: Dynamic[Time_Solar_PV](Initial_PV_Adopters1,~
Self[Time_Solar_PV-1] + Retrofit_Installs[Time_Solar_PV-1] * dT_PV_Data)
NodeLocation: 632,336,1
NodeSize: 66,38
NodeInfo: 1,1,1,1,0,1,0,,0,,0,,,
WindState: 2,161,13,720,350
ValueState: 2,266,37,1207,695,1,MIDM
Aliases: Alias Al1542240311
NodeColor: 65535,65535,65535
GraphSetup: Graph_HLabelRotation:45~
Att_GraphIndexRange Time_Solar_PV:1,,1,,,,,42964.540197104216,43251.46899577975,0
ReformVal: [Time_Solar_PV,PV_Spatial_ID]
NumberFormat: 2,F,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: []
Att_ResultSliceState: [PV_Sectors,1,Area_Type,1,All_Utilities,1,PV_Spatial_ID,3,Time_Solar_PV,1]

Variable NC_and_Retro_Install
Title: New Constr + Retrofit Installs
Units: PV_stock_basis_by_s / yr
Description: The sum of cumulative building units that have installed solar during retrofit and new construction.
Definition: Tot_NC_Install_BOP + TotRetro_Install_BOP
NodeLocation: 314,200,1
NodeSize: 64,40
WindState: 2,11,316,720,350
ValueState: 2,200,51,1402,783,1,MIDM
Aliases: Alias Al1145062499
ReformVal: [Time_Solar_PV,PV_Spatial_ID]
NumberFormat: 2,F,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,0,Time_Solar_PV,1]

Text PVAdoption_Frame
NodeLocation: 1292,432,-1
NodeSize: 420,360
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus:yes~
Show_description:20

Picture Pi1544887978
NodeLocation: 480,336,-1
NodeSize: 232,48
NodeInfo: 1,,,,,,0,0,,,,,,0
Pict: (000000000000005801CC00044B04000089504E470D0A1A0A0000000D49484452000001CC000000580806000000785BC767000000017352474200AECE1CE90000000467414D410000B18F0BFC6105000000097048597300000EC300000EC301C76FA864000003D049444154785EEDD9D1492B611845D1782BB00A5FEDCD16629BE243EAD05C2628884CCC4E14942F6BC121CCE8938CFF66C8660F009C2498001008260004820900C12198BBDD6EBFD96CEC8AB7DD6E0F0F044C727373B3FABC9BADEDE5E5E5EDC9597708E6D3D3D3FEEEEEEE7083EBF3F8F8B87F787878BB82399660BEBEBEBE5DC171FFFEFD134C4E134CA6124C2AC124114CA6124C2AC124114CA6124C2AC124114CA6124C2AC124114CA6124C2AC124114CA6124C2AC124114CA6124C2AC124114CA6124C2AC124114CA6124C2AC124114CA6124C2AC124114CA6124C2AC124114CA6124C2AC124114CA6124C2AC124114CA6124C2AC124114CA6124C2AC124114CA6124C2AC124114CA6124C2AC124114CA6124C2AC124114CA6124C2AC124114CA6124C2AC124114CA6124C2AC124114CA6124C2AC124114CA6124C2AC124114CA6124C2AC124114CA6124C2AC124114CA6124C2AC124114CA6124C2AC124114CA6124C2AC12411CCD3369BCDD9E3F709269560920866532328967F876052092689603625846279B9256ECBDFEF270327985482492298DDA9200AE6E5DE83F979DF099E6052092689609E6739C4D71CBB4F732C981F776EFC04934A304904F37CCBE1FDD1E76BCE5782F979A7622898548249F25530D70E29B3BFB8B5300A26550AE6EDEDEDFEF9F95930AF9837CCCB2C87F4C74FBEE79237CCAFB6845230A95230DF1FAEFBFBFBB75B5C1BC1BCDCF2BFC3CFF8E960BE4F3029BC619208E66596C3F8E327DFE30D93DFE43B4C12DF61DA84AD855130A90493C41BE6F99603FAA3CFD79CEF9237CC5331144C2AC12411CCF32C07F59A63F7694A30CF8D9F60520926896076CBA1FD95533FE7B863C1FC4EF004934A304904B3590EEF53CAEFB0EE3D983F1938C1A4124C12C16C6A0C45F3EF104C2AC12411CCD396089E3B7E9F605209268960329560520926896032956052092689603295605209268960329560520926896032956052092689603295605209268960329560520926896032956052092689603295605209268960329560520926896032956052092689603295605209268960329560520926896032956052092689603295605209268960329560520926896032956052092689603295605209268960329560520926896032956052092689603295605209268960329560520926896032956052092689603295605209268960329560520926896032956052092689603295605209268960329560520926896032956052092689603295605209268960329560520926896032956052E560EE76BBFD66B3B12BDE76BB3D3C1030C912CCB5E7DD6C6D299800C0D704130002C10480403001E0A4FDFE3F7695323CC3C05EF30000000049454E44AE426082)

Module Advertising
Title: Advertising
Author: coryw
Date: Sun, Dec 16, 2018 8:10 AM
NodeLocation: 314,648,1
NodeSize: 72,56
DiagState: 2,397,151,1196,485,17,10
Pict: (000000000000003C003C00047205000089504E470D0A1A0A0000000D494844520000003C0000003C08060000003AFCD972000000017352474200AECE1CE90000000467414D410000B18F0BFC6105000000097048597300000EC300000EC301C76FA864000004F7494441546843ED9A4D685D4514C7B3CCB2CBECECCEAE242EC42CA4749145A09BE82A6EA42E844017962E4A566D37250B0B912044101AFCACA585A7B6F04AC0A422314803A1D13606034F2A257ED15845D34078D7FB1B726EE7CDFBDF9B9B176D6EC62E7E8477E6BCFBE67FE7CC396786742549F2BF421A63461A63461A63461A63461A63461A63461A63461A63461A63461ACF7D3D3CF1FC47DDEBCFBEDF95EC175EA9F7CD292D21D2A81EB81F087528A4D11E70EFCFC641355E355E9B3A32F344700ED2F84470C5D95BC17FFDDC934CBD3E995C796926B9FA6A2DF9E5DB5EE9F72FB2778253B1CD89A7D79A6FF624196F3DB55E567473F1DDE1E6CDF1113556C4DE094E571691C9272FD79B3F4C0F649F596DE5EFD19C7BE3AC7B41978E96AAA73EBB166C4D077F47BE1CBA78F3A79923CA2FA4F9DE0B4BAC70B2F9B03BB37DD8BFE056D9F30BC9C4A6BEC9C30707944FC86F7FAFF69C9F3F3176B476B0610B14FA28A4F1F2F2C4B0BD35E3833B632794AF8F13FCCE33AB2D7656BB40702762177F9DEBEBBFD2B36A737BF1B3434B7487CA37441A7D2E7C333A622BFEE9CAE431E59391262937F9AD7D48581785692762D966369F335F1D9BFC6363ADD4F70C690C21A4F901DEEAC6E67A16AE6DA4C9C9090859A90F86BE99D80BCF35CA8A85E39F0FD4990BE1ACC6B7431A15844C995576AB9A8A7062C8D869E66DF3F1C53EB85B3A317E777FA1B7D48B2F401A15B3F7EA03BB79B346A7628197CD1C48A46ABC0CD2A860EFF06384941A2FC36EC4C2DBB7CE9C650EFC55E365904685EDE38E5778AB26772A16A6EFD60699C3F8C2C8A81A2F83342AF8117E8C92A5C60BC9139BD66B56DD3526307B6EB428811165872F1D58FBCF5798644129E0C728F8CA27973CB1A93057B719F3A18ED38FFBCFF0D869190A91461F929515F932CD470B4561FCC5E9B16C6C75BECF95B4B45E6373870EDF3700D124B09337066B344806F985082C6A89A591879109E960100A653B998C6DF6AC6B3919BFFDF1A33267759CF6D4F3F5616E449ACD2B8FBCB06F3380FFC0A16BBD0BD71B1787945F2E269689DFFFFE90F2E145381F0E1966E7B4854DB4A26C256B3AD85EE414E6D5F87DC93D9F5525A921D422928B3D1B375A1E6A98587A56355E489A7832B145C7427B29B49D44006CB5A6E1E90AB1B6084A4408214FDB692F871C64636DCE60828BF6422E0826F16C770656676710E7675BD99D6E2B561CC144A97566D27157827702E19EAE662696D52681793ED65DF993F6710715CA59603738FCF07DDBD3D2E9B109DE060BE5302C7D5C2E20318A31830C6ECF900E55114C89611E45A15C46307B9EE7B0CAD2A12A82A9B3CC83B056E3E00493207F9C2DBC95A1C4B22DE46055045B1F901BCEE9FE6D4978051780646DC25A0E9AE0BD80FD66F3B0FB2AFB1CD2D69AA69F951FD859400EF2A3FE241E274A706EFF3E7D6AA245307B39A70FB70B8CB6812A4193C124A9A76A1C9ACBB5218467F7698816DD1DF9800EACC558352C0CCB1E07B30B06929857CFA9DFEC5FCE076D5FAA12B4B608267995BDC3E23042B7E6D8BA3CB4E683DE5B7EA94AB02A4C7647B71C6989726D6B1ADE7696B7FF10D05FA810242C3BFDE495A73C880AA203C176E0908E55C36E4C9938E1A97C42F88ED571FF5AAACDB1AAF8077FC213416A5F73D9E81F0DC317D4E25C75086FDBD306AB48EDA66DF4ED79E7E6960FFB055BC5F0AAC74A4F51EF2D8D31238D31238D31238D31238D31238D31238D31238D31238D31238DF19274FD03FBF331836D8AEF9C0000000049454E44AE426082)
AcpStyles: FrameNode: PVAdoption1544977261

Variable Applied_Ad_Strength
Title: Applied Advertising Strength
Units: 1/year
Description: The applied advertising strengh.
Definition: IF (Use_PV_Decision_Var AND Include_Ad_Effect) ~
THEN Ad_Effectiveness ~
ELSE Stored_AdEff_PV[All_Spatial_ID=PV_Spatial_ID, All_Sectors=PV_Sectors]
NodeLocation: 296,64,1
NodeSize: 64,40
WindState: 2,760,274,815,447
ValueState: 2,72,74,1121,596,0,MIDM
ReformVal: [PV_Sectors,PV_Spatial_ID]

Alias Al1535520388
Title: Stored AdEff PV
Definition: 1
NodeLocation: 120,64,1
NodeSize: 64,40
Original: Stored_AdEff_PV

Alias Al2
Title: PV Ad Effectiveness
Definition: 1
NodeLocation: 120,160,1
NodeSize: 64,40
NodeColor: 57311,57311,57311
Original: Ad_Effectiveness

Text PVAdoption1544977261
NodeLocation: 764,316,-1
NodeSize: 324,292
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus:yes~
Show_description:20

Close Advertising

Text Te1006482627
Title: Units: 
NodeLocation: 256,68,-1
NodeSize: 200,52
NodeInfo: 1,,,,1

FormNode Fo168015043
Title: Stock Basis by Sector
Definition: 1
NodeLocation: 248,80,1
NodeSize: 184,16
Original: PV_Stock_Basis_by_Se

Module Initial_PV_Adoption
Title: Initial PV Adoption
Author: CWelch
Date: Sun, Jan 9, 2022 3:29 PM
NodeLocation: 632,208,1
NodeSize: 72,56
DiagState: 2,316,47,1263,618,17,10

Variable Initial_PV_Adopters1
Title: Initial PV Adopters
Units: PV stock basis by sector
Description: Initial adopters of PV (by building units) at the start of the simulation (PV Simulation Start Year). ~
Building Units: Res - Housing Units; NonRes - m^2 of roofspace
Definition: IF Use_Hist_PV_Intercon THEN Initial_PV_Adopters ELSE Initial_PV_Adopters_
NodeLocation: 560,160,1
NodeSize: 72,40
NodeInfo: 1,1,1,1,1,1,0,0,0,0,,0,1,0
WindState: 2,249,104,1523,637
ValueState: 2,517,300,936,351,0,MIDM
GraphSetup: Att_CatLineStyle Graph_Primary_Valdim:4~
Att_GraphIndexRange PV_Spatial_ID:1,1
ReformVal: [PV_Spatial_ID,PV_Sectors]
NumberFormat: 2,F,4,2,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [Stored_ID_Interconn,All_Sectors,PV_Spatial_ID,Area_Type,PV_Sectors]
Att_ResultSliceState: [Area_Type,0,PV_Sectors,1,PV_Spatial_ID,1]

Alias Al1023728835
Title: Cumulative System Installations
Definition: 1
NodeLocation: 112,64,1
NodeSize: 64,40
Original: Cumul_Syst_Installs

Alias Al990174403
Title: Historic Cumul DC Capacity
Definition: 1
NodeLocation: 112,160,1
NodeSize: 64,40
Original: Hist_Cumul_DC_Cap

Constant PV_Init_Adop_Fractio
Title: PV Init Adop Fraction
Units: fraction
Description: Initial fraction of technical potential for PV that have already adopted PV at the beginning of the forecast simulation.
Definition: Table(Spatial_ID,All_PV_Sectors,Area_Type)(~
0,~
0,~
0)
NodeLocation: 112,472,1
NodeSize: 64,40
WindState: 2,375,58,720,350
DefnState: 2,362,159,766,674,0,DFNM
ValueState: 2,309,106,885,732,,MIDM
NodeColor: 65535,1,1
ReformDef: [Spatial_ID,All_PV_Sectors]
NumberFormat: 2,F,3,4,0,0,3,0,$,0,"ABBREV",0,,,0,0,15,
DisplayOutputs: Object Object, Object Decision
TableCellDefault: 0
Att_EditSliceState: [Area_Type,1,All_PV_Sectors,1,Spatial_ID,1]

Index All_PV_Sectors
Att_PrevIndexValue: ['Residential','Commercial','Industrial']
Title: All PV Sectors
Definition: ['Residential','Commercial','Industrial']
NodeLocation: 944,304,1
NodeSize: 64,40
ValueState: 2,510,101,448,662,0,MIDM
DisplayOutputs: Object Object, Object Variable, Object Decision
{!40300|Att_SlicerPopupSize: 357,434}

Variable Initial_PV_Adopters_
Title: Initial PV Adopters, InputFract Based
Units: PV stock basis by sector
Description: Initial adopters of PV (by PV building units) at the start of the simulation (PV Simulation Start Year). ~
Units are either buildings or m2 of roofspace, depending on the input by sector for "PV Stock Basis by Sector"
Definition: Initial_system_insta~
* Usable_PV_stock_to_b
NodeLocation: 312,360,1
NodeSize: 72,40
ValueState: 2,960,265,714,666,0,MIDM
ReformVal: [PV_Sectors,PV_Spatial_ID]
Att_ResultSliceState: [Area_Type,1,PV_Spatial_ID,1,PV_Sectors,1]

Alias Al263822787
Title: Building Stock Conversion
Definition: 1
NodeLocation: 112,360,1
NodeSize: 64,40
Original: Usable_PV_stock_to_b

Decision Use_Hist_PV_Intercon
Title: Use Hist PV Interconnect Data
Description: Check this box if the method for initializing PV adoption will be via an historical interconnection database, as opposed to assuming a percentage of technical potential adopted. 
Definition: Checkbox(1)
NodeLocation: 944,160,1
NodeSize: 64,40
Aliases: FormNode Fo1363428899, FormNode Fo1462076355
NodeColor: 65535,65531,1

FormNode Fo1462076355
Title: Initialize PV with Historical Data?
Definition: 0
NodeLocation: 988,224,1
NodeSize: 148,16
Original: Use_Hist_PV_Intercon

Variable Initial_PV_Adopters
Title: Initial PV Adopters, Historical Based
Units: PV stock basis by sector
Description: Initial adopters of PV (by building units) at the start of the simulation (PV Simulation Start Year). ~

Definition: VAR systems:= Cumul_Syst_Installs[Interconnect_Date=PV_Sim_Start_Minus_1];~
VAR area:= Hist_Cumul_DC_Cap[Interconnect_Date=PV_Sim_Start_Minus_1] * kW_per_MW * m2_usable_area_per_k;~
VAR initAdoption:={IF PV_Stock_Basis_by_Se[All_Sectors=PV_Sectors] = Buildings_Label~
   THEN systems~
   ELSE }area;~
IF IsNumber(initAdoption) THEN initAdoption ELSE 0;
NodeLocation: 312,160,1
NodeSize: 72,40
NodeInfo: 1,1,1,1,1,1,0,0,0,0,,0,1,0
WindState: 2,249,104,1523,637
ValueState: 2,860,185,690,672,1,MIDM
GraphSetup: Att_CatLineStyle Graph_Primary_Valdim:4~
Att_GraphIndexRange PV_Spatial_ID:1,1
ReformVal: [PV_Sectors,PV_Spatial_ID]
NumberFormat: 2,F,4,2,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [Stored_ID_Interconn,All_Sectors,PV_Spatial_ID]
Att_ResultSliceState: [Area_Type,1,PV_Spatial_ID,1,PV_Sectors,1]

Text Te1347115043
Title: Put on interface
NodeLocation: 1088,160,-1
NodeSize: 64,40

Variable Initial_PV_MW_DC_Inp
Title: Initial PV MW-DC,InputFrBsd
Units: MW-DC
Definition: Initial_PV_Adopters_* DC_Watts_per_m2_usab / 1E6
NodeLocation: 648,464,1
NodeSize: 72,40
ValueState: 2,291,228,885,598,,MIDM
Att_ResultSliceState: [Area_Type,1,PV_Spatial_ID,1,PV_Sectors,1]

Variable InitialPV_MW_AC_InpF
Title: InitialPV MW-AC,InpFrBsd
Units: MW-AC
Definition: Initial_PV_MW_DC_Inp / DC_to_AC_Ratio_by_PV
NodeLocation: 648,560,1
NodeSize: 64,40
ValueState: 2,524,268,774,499,,MIDM

Alias Al1088777763
Title: DC to AC Ratio by PVSpID
Definition: 1
NodeLocation: 488,560,1
NodeSize: 64,40
Original: DC_to_AC_Ratio_by_PV

Variable InitPV_MWAC_IFB_byIn
Title: InitPV MWAC,IFB,byIntDt
Units: MWAC
Definition: InitialPV_MW_AC_InpF * (Interconnect_Date=PV_Sim_Start_Minus_1)
NodeLocation: 824,560,1
NodeSize: 80,40
ValueState: 2,476,130,1048,698,1,MIDM
Aliases: Alias Al1523936803
Att__TotalsIndex: []
Att_ResultSliceState: [PV_Spatial_ID,1,Area_Type,1,PV_Sectors,1,Interconnect_Date,1]

Variable Initial_system_insta
Title: Initial system installs
Units: buildings
Definition: PV_Init_Adop_Fractio[All_PV_Sectors=PV_Sectors,Spatial_ID=PV_Spatial_ID] ~
* Bldg_Stock_by_Time[Time=PV_Sim_Start_Year,All_Spatial_ID=PV_Spatial_ID,All_Sectors=PV_Sectors]
NodeLocation: 312,472,1
NodeSize: 64,40

Close Initial_PV_Adoption

Variable Share_of_Tech_Potent
Title: Share of Tech Potential
Definition: TotRetro_Install_BOP / Eligible_PV_Stock_fo
NodeLocation: 800,336,1
NodeSize: 64,40
ValueState: 2,324,56,1010,704,1,MIDM
GraphSetup: Att_GraphValueRange Share_of_Tech_Potent:1,,0,,,,,0,1.0005547553300858,0
Att_ResultSliceState: [PV_Sectors,1,Area_Type,1,PV_Spatial_ID,3,Time_Solar_PV,1]

Close Adoption

Include 0,LinkModule PV_Calibration1,2,2,0,0,PV Calibration Module.ana

NodeLocation PV_Calibration1: 120,184,1
NodeSize PV_Calibration1: 72,64


Module PV_Details
Title: Details
Author: coryw
Date: Sun, Dec 9, 2018 10:46 AM
NodeLocation: 292,184,1
NodeSize: 72,64
DiagState: 2,362,111,1104,480,17,10
NodeColor: 65535,65535,65535
Pict: (000000000000003C003C0004B105000089504E470D0A1A0A0000000D494844520000003C0000003C08060000003AFCD972000000017352474200AECE1CE90000000467414D410000B18F0BFC6105000000097048597300000EC300000EC301C76FA86400000536494441546843ED994D68145910C773F4B0871CBD9983B039493CC80ACA12C48320887ACA5E34824AC083D18B39A91789B0B27E204456307E47511C57851145A3480C1231B85F598930A24854C4F8814641BAED7FBBD554BFF977F79BB63B938973F82533F5AABB5FD5AB5755AFA7C175DDEF0A2ACC0AE7DEEF9DEEC08E6E36562DA8302B9CFDB3269C3D33BD8F7CBC1A506156C0D8BAC155860A33A3D8D1E79C5E3A48C7AA0415FA8CDD9D8F09BB2FFE6EA1E393C19BC74DEE958DBDCEA3EB4BE8780AA8D0070F4248F6FC385E15A33FBE69740ECD2BF97338B17898EAA4800A7DBC15962C8B07FBDE667A1ACF31CEE0AFDBDD8B6B0AEED995FD1AC89D7F4EB5C3107AAD06C67A464A0E701E14DAA85E0AA8504028054647ED4518E0D5DA60352C804362C3F4E6D6DD813E9CC4745242851ADF68843569209C3F8F743807E78C69637CE01C73854D1D0F3F12DE3F471A2FBF2F1C9DB1B1800A13C1AA6295B40108416FA2CC80802703AD7E6EF01C185C9793615150612CDE5E0EED2F8472A57B0C4E311D3649465361249F3FCE708E2E1C9149FA2169938422701E169707390264989CA2A0C248D4AA64762840359010CFB0FC4441850C9C7C0263B1B2442735AF469BFD728666878D670815968150966CEC8534BE53BD1A800A4D9CA17D5DB2BAD8774CA756A04293A0A99862078134506108241559DD49AC977941851ABF0786B15EF9F896123455A0C210528AA64138032AD4C050188C96908DD71AFE1FBFC64AF1370E0A92B070821119E372A9AFEDE7D38DE3738F35B87983E71CFAABBB8BCD2389AF1FCCBE56856F60704C67F5F45DA9E9A7933326D8E4CA384E6429B9FEB8507189A4428D1C14E2427AF38DE50599C4BEE1AEEE03F7B76D3791D55F79A179848D0BAB2FCF1F84DEB2F3B347D93858E1DD033A6D975A2A6E45A930C4F95F8ABEC1DE7F36FEDFABE1163176D7DD4E1AF68800D139FEEFEE4EA623FCF1B0B71D7A70101B07FA9949F733A1C210789B81304759222D25BC8C0723A45F7E18F33C131E076204187AD6DFCA74046D0C1CC5748044D5E2B333C73E7D9EB06E75A950E31FE160305619077835863D24938BF3F4B6DBEDBDD081536C2627F9206E8F965E8F348B1EB611D361506108BC5043E242F6562FF2307178170F4CF2F2D24253097AEBAEB4F6B3719355C5AFFB38C9106C21E8C545970915DA8015C5C3A60A51F9C3840A9378FB69BC5156772A81FDCFE6ABA1C22424946C1EA2C3CE36B9607FDADE5F6FAD0DD796D04AA2A1C238B05724592053321D8DECC74A6BA6D46D647836AED1C933A919A1C238A41CD8240A785F9C63BBC704AC16AEDB71A7A3878D9B48794C722C1546A16BA48D01A8B9A25F691B880C6D6380605B22A9300A094FDB628F3650268144C774A210032AD9FB36CD4899200AEDC15A20AA86970918F096340FB542548E097D89423719034F8B563F4EEBFD6E93691912A25DB7DAFAD8384357119667425F18585DA973366548D04E425D653A49E0908FEB711C64E351C87530DCACE32145866E1C929A008DAC4EDC312F099DE52B497A718B145234490A8F38A471A8242A4C60A4189C74AC34D14752BD0DCB1435D83BB800934F6A32347AFFC6D5441BE4ED469AFBB066A44C49D093C679161EB665EFBD2D3BE5DA73A307D78A7CD7D0A6DF169CFAE19D8C99606CEBEDD587F5BDD65F5D740D63F8AFE53648F302CE3CE8E9805DD458207BB0DAB41CFDFFF337BEFC93C4478D0592ACD2104C320B32BA979CA4A8B179210F47CB698EE936D41CCB122ACC8BBAC18ABAC13941857951375851373827A8302FEA062BA6B5C1F8C905066A209BB60627615E9725549817F22B621CB63FB8A5850AA72F6EC317AB462B3073E6846E0000000049454E44AE426082)

Module Misc_Output
Title: Misc Output
Author: Cory Welch
Date: Fri, Jun 22, 2018 10:48 AM
NodeLocation: 112,384,1
NodeSize: 64,40
NodeInfo: 1,0,0
DiagState: 2,2259,75,944,575,17,10
NodeColor: 57311,57311,57311
AcpStyles: Show_Object:no

Variable Installs_by_Type
Title: Installs by Type
Units: systems/yr or MW-AC/yr
Description: Installations of systems on buildings due to both new construction and retrofit installations.
Definition: Table(Install_Type)(Retrofit_Installs * dT_PV_Data,PV_NewConst_Installs * dT_PV_Data)
NodeLocation: 304,240,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DefnState: 2,390,229,622,234,0,DFNM
ValueState: 2,269,118,1506,782,1,MIDM
Aliases: FormNode Fo1519235914, FormNode Fo1542903862
GraphSetup: Att_ContLineStyle Graph_Primary_Valdim:5~
Att_Stacked_Lines Graph_Primary_Valdim:1~
Att_AreaFill Graph_Primary_Valdim:1~
Att_GraphIndexRange Time:1,,0,,,,,38.717K,43.81K,0
ReformVal: [Time_Solar_PV,Install_Type]
NumberFormat: 2,F,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: []
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,135,Install_Type,1,Time_Solar_PV,1]
{!40600|Att_StackingIndex: Install_Type}
{!40600|Att_ClusterIndex: Null}

Index Install_Type
Att_PrevIndexValue: ['Retrofit','New Construction']
Title: Install Type
Definition: ['Retrofit','New Construction']
NodeLocation: 88,208,1
NodeSize: 64,40
{!40300|Att_SlicerPopupSize: 232,56}

Variable Share_of_Retrofit
Title: Share of Retrofit
Units: fraction
Description: Market share of systems installed on retrofit homes, as a percentage of total potential buildings for retrofit. This specifically excludes systems installed on new construction homes.
Definition: TotRetro_Install_EOP / Eligible_PV_Stock_fo
NodeLocation: 488,240,1
NodeSize: 64,40
ValueState: 2,286,93,1032,659,1,MIDM

Variable PV_Impact
Title: PV Impact
Units: MW
Definition: sum(Sim_Cumulative_PV * PV_system_impact, EV_Sectors) / 1000
NodeLocation: 688,160,1
NodeSize: 64,40
ValueState: 2,476,43,1064,640,1,MIDM

Constant PV_system_impact
Title: PV system impact
Units: kW/system
Description: just a temporary placeholder to permit creation of graphics. 			
Definition: -0.6
NodeLocation: 688,56,1
NodeSize: 64,40
NodeColor: 65535,32766,1

Variable Cumulative_PV_Instal
Title: Cumulative PV Installs by Type
Units: systems of MW-AC
Description: Total cumulative installations by install type. ~
~
Units:~
Residential: # of systems~
NonResidential: MW-AC
Definition: Table(Install_Type)(TotRetro_Install_EOP,Tot_NC_Install_EOP)
NodeLocation: 488,64,1
NodeSize: 64,40
ValueState: 2,373,74,1076,692,1,MIDM
Aliases: FormNode Fo1542903864
GraphSetup: Att_AreaFill Graph_Primary_Valdim:0~
Att_Stacked_Lines Graph_Primary_Valdim:0~
Att_ContLineStyle Graph_Primary_Valdim:5
ReformVal: [Time_Solar_PV,Install_Type]
NumberFormat: 2,F,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,0,Install_Type,1,PV_Cost_Scenario,1,Time_Solar_PV,1]
{!40600|Att_StackingIndex: DER_Cost_Scenario}
{!40600|Att_ClusterIndex: Null}

Alias Al1542240311
Title: Total Retrofits Installed
Definition: 1
NodeLocation: 304,144,1
NodeSize: 64,40
NodeColor: 65535,65535,65535
Original: TotRetro_Install_BOP

Alias Al1542240312
Title: Total NewCon Installed
Definition: 1
NodeLocation: 320,48,1
NodeSize: 64,40
NodeColor: 65535,65535,65535
Original: Tot_NC_Install_BOP

Variable Incremental_PV_Insta
Title: Incremental PV Installs by Type
NodeLocation: 656,352,1
NodeSize: 64,40

Close Misc_Output

Module PV_Adoption_Summary
Title: PV Adoption Summary
Author: JamesMilford
Date: Sun, Nov 18, 2018 11:53 PM
NodeLocation: 688,64,1
NodeSize: 64,40
NodeInfo: 1,0,0
DiagState: 2,124,19,1588,621,17,10
NodeColor: 65535,65535,65535
AcpStyles: FrameNode: FrameNode_1544919954

Variable PV_Adoption_Forecast
Title: PV Adoption Forecasts
Definition: Sum(PV_Adoption_Fcst_NR, New_or_Retrofit)
NodeLocation: 1192,248,1
NodeSize: 64,40
DefnState: 2,3135,235,416,303,,DFNM
ValueState: 2,2775,192,942,418,0,MIDM
Aliases: Alias Al1542347463, Alias Al1542352234
NodeColor: 19661,48336,65535
GraphSetup: Flip:0~
Att_GraphValueRange PV_Adoption_Forecast:1,,1,,,,,0,2000,0
ReformVal: [Time_Solar_PV,PV_Sectors]
Att__TotalsIndex: [Time_Solar_PV,PV_Spatial_ID,PV_Sectors]
Att_ResultSliceState: [PV_Sectors,2,PV_Adopt_Data_Types,8,Area_Type,1,PV_Spatial_ID,0,Time_Solar_PV,1]

Variable Increm_CEC_MW_Cap
Title: Increm CEC-MW Capacity
Units: CEC-MW-AC/period
Definition: Sum(Increm_CEC_MW_NR, New_or_Retrofit)
NodeLocation: 232,152,1
NodeSize: 64,40
WindState: 2,102,82,1076,488
ValueState: 2,255,287,1246,407,0,MIDM
ReformVal: [Time_Solar_PV,PV_Spatial_ID]
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,2,PV_Spatial_ID,0,Time_Solar_PV,1]
Att_ColorRole: Null

Variable Increm_DC_Capacity
Title: Increm DC Capacity
Units: MW-DC/period
Definition: Sum(Increm_DC_NR, New_or_Retrofit)
NodeLocation: 232,248,1
NodeSize: 64,40
ValueState: 2,396,318,950,452,1,MIDM
Aliases: Alias Al437134435
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,1,Area_Type,1,Test_PV_Incentive_W_,1,Time_Solar_PV,1]

Variable Increm_Non_Coinc_Cap
Title: Increm Non-Coinc Capacity
Units: MW-AC/period
Definition: Sum(Increm_Non_Coinc_NR, New_or_Retrofit)
NodeLocation: 232,344,1
NodeSize: 64,40

Variable Increm_Avg_Peak_Cap
Title: Increm Avg Peak Capacity
Units: MW-AC/period
Definition: Sum(Increm_Avg_Peak_NR, New_or_Retrofit)
NodeLocation: 232,440,1
NodeSize: 64,40

Variable Initial_CEC_MW_AC
Title: Initial CEC-MW-AC
Units: CEC-MW-AC
Definition: Replace_X_with_Y(Cumul_Cap_Installs[Interconnect_Date=PV_Sim_Start_Minus_1], Null, 0)
NodeLocation: 376,152,1
NodeSize: 64,40
ValueState: 2,409,168,1039,483,,MIDM

Variable Initial_MW_DC
Title: Initial MW-DC
Units: MW-DC
Definition: Replace_X_with_Y(Hist_Cumul_DC_Cap[Interconnect_Date=PV_Sim_Start_Minus_1], Null, 0)
NodeLocation: 376,248,1
NodeSize: 64,40

Variable Initial_Non_Coinc_MW
Title: Initial Non-Coinc MW-AC
Units: MW-AC
Definition: Replace_X_with_Y(Hist_CumulNonCoinCap[Interconnect_Date=PV_Sim_Start_Minus_1], Null, 0)
NodeLocation: 376,344,1
NodeSize: 64,40

Variable Initial_Avg_Peak_MW
Title: Initial Avg Peak MW
Units: MW-AC
Definition: Replace_X_with_Y(Hist_CumulAvgPeakCap[Interconnect_Date=PV_Sim_Start_Minus_1], Null, 0)
NodeLocation: 376,440,1
NodeSize: 64,40
ValueState: 2,84,286,1215,275,,MIDM

Variable Cumul_CEC_MW_Cap
Title: Cumul CEC-MW Capacity
Units: CEC-MW-AC
Definition: Sum(Cumul_CEC_MW_NR_EOP, New_or_Retrofit)
NodeLocation: 968,128,1
NodeSize: 64,40
WindState: 2,652,250,720,350
ValueState: 2,324,579,1514,404,0,MIDM
ReformVal: [Time_Solar_PV,PV_Spatial_ID]
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,0,Time_Solar_PV,1]
Att_ColorRole: Null

Variable Cumul_DC_Capacity_EO
Title: Cumul DC Capacity EOP
Units: MW-DC
Description: End of Period Cumulative Nameplate DC installed
Definition: Sum(Cumul_DC_NR_EOP, New_or_Retrofit)
NodeLocation: 1152,376,1
NodeSize: 64,40
ValueState: 2,2188,549,1130,246,0,MIDM
Aliases: Alias Al1579797635, Alias Al1159982589
GraphSetup: Att_GraphIndexRange Time_Solar_PV:1,,1,,,,,43415.391065359116,53275.479994773865,0
ReformVal: [Time_Solar_PV,PV_Sectors]
Att__TotalsIndex: [PV_Spatial_ID,PV_Sectors]
Att_ResultSliceState: [PV_Sectors,1,Area_Type,1,PV_Spatial_ID,0,Time_Solar_PV,1]

Variable Cumul_Non_Coinc_Cap
Title: Cumul Non-Coinc Capacity
Units: MW-AC
Definition: Sum(Cumul_NonCoincNR_EOP, New_or_Retrofit)
NodeLocation: 848,344,1
NodeSize: 64,40
ValueState: 2,1818,24,1130,800,1,MIDM
ReformVal: [Time_Solar_PV,Null]
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,2,PV_Spatial_ID,0,System_Types,1,Time_Solar_PV,1]
Att_ColorRole: Null

Variable Cumul_Avg_Peak_Cap
Title: Cumul Avg Peak Capacity
Units: MW-AC
Definition: Sum(Cumul_AvgPeak_NR_EOP, New_or_Retrofit)
NodeLocation: 848,440,1
NodeSize: 64,40
WindState: 2,1910,310,720,350
ValueState: 2,255,8,1130,800,1,MIDM
ReformVal: [Time_Solar_PV,Null]
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,2,PV_Spatial_ID,0,System_Types,1,Time_Solar_PV,1]
Att_ColorRole: Null

Variable Increm_Systems
Title: Increm Systems
Units: systems/period
Definition: Sum(Increm_Systems_NR, New_or_Retrofit)
NodeLocation: 232,56,1
NodeSize: 64,40
ValueState: 2,113,60,858,681,0,MIDM

Variable Cumulative_Systems
Title: Cumulative Systems
Units: systems
Definition: Sum(Cumul_Systems_NR, New_or_Retrofit)
NodeLocation: 848,56,1
NodeSize: 64,40
ValueState: 2,470,391,416,303,,MIDM

Variable Cumul_CEC_MW_NR_EOP
Title: Cumul CEC-MW Capacity EOP New/Ret
Units: CEC-MW-AC
Definition: Cumul_CEC_MW_BOP_NR + Increm_CEC_MW_NR
NodeLocation: 696,152,1
NodeSize: 64,40
WindState: 2,1851,281,720,350
ValueState: 2,472,353,1130,333,0,MIDM
Aliases: Alias Al175322275
GraphSetup: Att_GraphIndexRange Time_Solar_PV:1,,0,,,,,52862.197196006775,54593.02579498291,0
ReformVal: [Time_Solar_PV,PV_Sectors]
Att__TotalsIndex: [New_or_Retrofit,PV_Sectors]
Att_ResultSliceState: [PV_Sectors,0,PV_Spatial_ID,1,New_or_Retrofit,0,Area_Type,1,Time_Solar_PV,1]

Variable Cumul_DC_NR_EOP
Title: Cumul DC Capacity EOP New/Ret
Units: MW-DC
Definition: Cumul_DC_BOP_NR + Increm_DC_NR
NodeLocation: 1000,376,1
NodeSize: 64,40
ValueState: 2,512,68,1130,800,1,MIDM
ReformVal: [Time_Solar_PV,Null]
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,2,PV_Spatial_ID,0,System_Types,1,Time_Solar_PV,1]
Att_ColorRole: Null

Variable Cumul_NonCoincNR_EOP
Title: Cumul Non-Coinc Capacity EOP New/Ret
Units: MW-AC
Definition: Cumul_NonCoincBOP_NR + Increm_Non_Coinc_NR
NodeLocation: 696,344,1
NodeSize: 64,40
ValueState: 2,1818,24,1130,800,1,MIDM
ReformVal: [Time_Solar_PV,Null]
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,2,PV_Spatial_ID,0,System_Types,1,Time_Solar_PV,1]
Att_ColorRole: Null

Variable Cumul_AvgPeak_NR_EOP
Title: Cumul Avg Peak Capacity EOP New/Ret
Units: MW-AC
Definition: Cumul_AvgPeak_BOP_NR + Increm_Avg_Peak_NR
NodeLocation: 696,440,1
NodeSize: 64,40
WindState: 2,1910,310,720,350
ValueState: 2,1818,24,1130,800,1,MIDM
ReformVal: [Time_Solar_PV,Null]
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,2,PV_Spatial_ID,0,System_Types,1,Time_Solar_PV,1]
Att_ColorRole: Null

Variable Increm_CEC_MW_NR
Title: Increm CEC-MW Capacity New/Ret
Units: CEC-MW-AC/period
Definition: Total_Install_Rate * PV_ACSystSize_byTime * MW_per_kW * dT_PV_Data
NodeLocation: 80,152,1
NodeSize: 64,40
WindState: 2,102,82,1076,488
ValueState: 2,186,37,1246,679,1,MIDM
ReformVal: [Time_Solar_PV,PV_Spatial_ID]
Att__TotalsIndex: [PV_Spatial_ID,PV_Sectors,New_or_Retrofit,Area_Type]
Att_ResultSliceState: [PV_Sectors,0,New_or_Retrofit,0,Area_Type,0,PV_Spatial_ID,0,Time_Solar_PV,1]

Variable Increm_DC_NR
Title: Increm DC Capacity New/Ret
Units: MW-DC/period
Definition: Increm_CEC_MW_NR * DC_to_AC_Ratio[PV_Climate_Zone=Climate_Zone_Map,All_PV_Sectors=PV_Sectors]
NodeLocation: 80,248,1
NodeSize: 64,40
ValueState: 2,361,39,1185,846,,MIDM

Variable Increm_Non_Coinc_NR
Title: Increm Non-Coinc Capacity New/Ret
Units: MW-AC/period
Definition: VAR DCtoAC:=Divide(1, SAM_DC_to_AC_Ratio[All_Sectors=PV_Sectors], True);~
~
Increm_DC_NR * DCtoAC[PV_Climate_Zone=Climate_Zone_Map]
NodeLocation: 80,344,1
NodeSize: 64,40

Variable Increm_Avg_Peak_NR
Title: Increm Avg Peak Capacity New/Ret
Units: MW-AC/period
Definition: Increm_DC_NR * AvgPeakLoad_per_kWdc[PV_Climate_Zone=Climate_Zone_Map]
NodeLocation: 80,440,1
NodeSize: 64,40

Variable Increm_Systems_NR
Title: Increm Systems New/Ret
Units: systems/period
Definition: {IF PV_Stock_Basis_by_Se[All_Sectors=PV_Sectors] <> Buildings_Label~
THEN Null~
ELSE }Total_Install_Rate * dT_PV_Data
NodeLocation: 80,56,1
NodeSize: 64,40
ValueState: 2,113,60,858,681,1,MIDM

Variable Cumul_CEC_MW_BOP_NR
Title: Cumul CEC-MW Capacity BOP New/Ret
Units: CEC-MW-AC
Definition: Dynamic[Time_Solar_PV](IF New_or_Retrofit = Retrofit_Label THEN Initial_CEC_MW_AC ELSE 0,~
   Self[Time_Solar_PV-1] + Replace_X_with_Y(Increm_CEC_MW_NR[Time_Solar_PV-1], Null, 0)~
)
NodeLocation: 536,152,1
NodeSize: 64,40
WindState: 2,1851,281,720,350
ValueState: 2,492,50,1130,800,1,MIDM
NodeColor: 65535,65535,65535
ReformVal: [Time_Solar_PV,Null]
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,2,PV_Spatial_ID,0,System_Types,1,Time_Solar_PV,1]
Att_ColorRole: Null

Variable Cumul_DC_BOP_NR
Title: Cumul DC Capacity BOP New/Ret
Units: MW-DC
Definition: Dynamic[Time_Solar_PV](IF New_or_Retrofit = Retrofit_Label THEN Initial_MW_DC ELSE 0,~
   Self[Time_Solar_PV-1] + Replace_X_with_Y(Increm_DC_NR[Time_Solar_PV-1], Null, 0)~
)
NodeLocation: 536,248,1
NodeSize: 64,40
ValueState: 2,512,68,1130,800,1,MIDM
NodeColor: 65535,65535,65535
ReformVal: [Time_Solar_PV,Null]
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,2,PV_Spatial_ID,0,System_Types,1,Time_Solar_PV,1]
Att_ColorRole: Null

Variable Cumul_NonCoincBOP_NR
Title: Cumul Non-Coinc Capacity BOP New/Ret
Units: MW-AC
Definition: Dynamic[Time_Solar_PV](IF New_or_Retrofit = Retrofit_Label THEN Initial_Non_Coinc_MW ELSE 0,~
   Self[Time_Solar_PV-1] + Replace_X_with_Y(Increm_Non_Coinc_NR[Time_Solar_PV-1], Null, 0)~
)
NodeLocation: 536,344,1
NodeSize: 64,40
ValueState: 2,1818,24,1130,800,1,MIDM
NodeColor: 65535,65535,65535
ReformVal: [Time_Solar_PV,Null]
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,2,PV_Spatial_ID,0,System_Types,1,Time_Solar_PV,1]
Att_ColorRole: Null

Variable Cumul_AvgPeak_BOP_NR
Title: Cumul Avg Peak Capacity BOP New/Ret
Units: MW-AC
Definition: Dynamic[Time_Solar_PV](IF New_or_Retrofit = Retrofit_Label THEN Initial_Avg_Peak_MW ELSE 0,~
   Self[Time_Solar_PV-1] + Replace_X_with_Y(Increm_Avg_Peak_NR[Time_Solar_PV-1], Null, 0)~
)
NodeLocation: 536,440,1
NodeSize: 64,40
WindState: 2,1910,310,720,350
ValueState: 2,258,32,1130,800,1,MIDM
NodeColor: 65535,65535,65535
GraphSetup: Att_AreaFill Graph_Primary_Valdim:1~
Att_Stacked_Lines Graph_Primary_Valdim:1~
Att_ContLineStyle Graph_Primary_Valdim:1
ReformVal: [Time_Solar_PV,Installation_Type]
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,0,Installation_Type,1,Time_Solar_PV,1]

Variable Cumul_Systems_NR
Title: Cumulative Systems New/Ret
Units: systems
Definition: {IF PV_Stock_Basis_by_Se[All_Sectors=PV_Sectors] <> Buildings_Label~
THEN Null~
ELSE }Total_Cumul_Installs
NodeLocation: 696,56,1
NodeSize: 64,40
ValueState: 2,232,62,654,632,1,MIDM
NodeColor: 65535,1,1
Att_ResultSliceState: [PV_Sectors,2,New_or_Retrofit,1,PV_Spatial_ID,1,Time_Solar_PV,1]

Objective PV_Adoption_Fcst_NR
Title: PV Adoption Forecasts New/Ret
Definition: Table(PV_Adopt_Data_Types)(Increm_Systems_NR,Increm_CEC_MW_NR,Increm_Avg_Peak_NR,Cumul_Systems_NR,Cumul_CEC_MW_NR_EOP,Cumul_AvgPeak_NR_EOP,Increm_Non_Coinc_NR,Cumul_DC_NR_EOP,Cumul_NonCoincNR_EOP,Increm_DC_NR)
NodeLocation: 1032,248,1
NodeSize: 64,40
DefnState: 2,2984,349,691,306,0,DFNM
ValueState: 2,2692,239,965,361,0,MIDM
NodeColor: 19661,48336,65535
GraphSetup: Flip:0~
Att_GraphValueRange PV_Adoption_Fcst_NR:1,,1,,,,,0,2000,0
ReformVal: [Time_Solar_PV,PV_Sectors]
Att__TotalsIndex: [PV_Spatial_ID,New_or_Retrofit,PV_Sectors]
Att_ResultSliceState: [PV_Sectors,1,PV_Adopt_Data_Types,8,Area_Type,1,New_or_Retrofit,0,PV_Spatial_ID,0,Time_Solar_PV,1]

Text FrameNode_1544919954
NodeLocation: 1624,336,-20
NodeSize: 360,304
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus: yes~
Show_description:20

Close PV_Adoption_Summary

Module PV_Time
Title: PV Time
Author: Cory Welch
Date: Fri, Jun 22, 2018 10:48 AM
NodeLocation: 112,288,1
NodeSize: 64,40
NodeInfo: 1,0,0
DiagState: 2,228,75,1222,535,17,10
NodeColor: 57311,57311,57311
AcpStyles: Show_Object:no

Constant Max_PV_Simulation_Ye
Title: Max PV Simulation Year
Description: Must be in the form MM/DD/YYYY~
~
Make more robust. Tie to Time.
Definition: 1-Dec-2034
NodeLocation: 400,168,1
NodeSize: 64,40
NodeColor: 65535,1,1

Index Time_Solar_PV
Att_PrevIndexValue: [1-Jan-2023,1-Feb-2023,1-Mar-2023,1-Apr-2023,1-May-2023,1-Jun-2023,1-Jul-2023,1-Aug-2023,1-Sep-2023,1-Oct-2023,1-Nov-2023,1-Dec-2023,1-Jan-2024,1-Feb-2024,1-Mar-2024,1-Apr-2024,1-May-2024,1-Jun-2024,1-Jul-2024,1-Aug-2024,1-Sep-2024,1-Oct-2024,1-Nov-2024,1-Dec-2024,1-Jan-2025,1-Feb-2025,1-Mar-2025,1-Apr-2025,1-May-2025,1-Jun-2025,1-Jul-2025,1-Aug-2025,1-Sep-2025,1-Oct-2025,1-Nov-2025,1-Dec-2025,1-Jan-2026,1-Feb-2026,1-Mar-2026,1-Apr-2026,1-May-2026,1-Jun-2026,1-Jul-2026,1-Aug-2026,1-Sep-2026,1-Oct-2026,1-Nov-2026,1-Dec-2026,1-Jan-2027,1-Feb-2027,1-Mar-2027,1-Apr-2027,1-May-2027,1-Jun-2027,1-Jul-2027,1-Aug-2027,1-Sep-2027,1-Oct-2027,1-Nov-2027,1-Dec-2027,1-Jan-2028,1-Feb-2028,1-Mar-2028,1-Apr-2028,1-May-2028,1-Jun-2028,1-Jul-2028,1-Aug-2028,1-Sep-2028,1-Oct-2028,1-Nov-2028,1-Dec-2028,1-Jan-2029,1-Feb-2029,1-Mar-2029,1-Apr-2029,1-May-2029,1-Jun-2029,1-Jul-2029,1-Aug-2029,1-Sep-2029,1-Oct-2029,1-Nov-2029,1-Dec-2029,1-Jan-2030,1-Feb-2030,1-Mar-2030,1-Apr-2030,1-May-2030,1-Jun-2030,1-Jul-2030,1-Aug-2030,1-Sep-2030,1-Oct-2030,1-Nov-2030,1-Dec-2030,1-Jan-2031,1-Feb-2031,1-Mar-2031,1-Apr-2031,1-May-2031,1-Jun-2031,1-Jul-2031,1-Aug-2031,1-Sep-2031,1-Oct-2031,1-Nov-2031,1-Dec-2031,1-Jan-2032,1-Feb-2032,1-Mar-2032,1-Apr-2032,1-May-2032,1-Jun-2032,1-Jul-2032,1-Aug-2032,1-Sep-2032,1-Oct-2032,1-Nov-2032,1-Dec-2032,1-Jan-2033,1-Feb-2033,1-Mar-2033,1-Apr-2033,1-May-2033,1-Jun-2033,1-Jul-2033,1-Aug-2033,1-Sep-2033,1-Oct-2033,1-Nov-2033,1-Dec-2033,1-Jan-2034,1-Feb-2034,1-Mar-2034,1-Apr-2034,1-May-2034,1-Jun-2034,1-Jul-2034,1-Aug-2034,1-Sep-2034,1-Oct-2034,1-Nov-2034,1-Dec-2034]
Title: Time-Solar PV
Description: Ths is the time index used for simulating vehicle adoption. It is allowed to be different from other DERs, for instance, due to differences in the granularity of available historical data on adoption (e.g., solar PV data are monthly, whereas vehicle data are, at best, quarterly, or in some cases, annual)
Definition: Sequence(PV_Sim_Start_Year, PV_Sim_End_Year,step: Timestep_Months[Timestep_Options=PV_Data_dT_Choice],dateUnit: 'M')
NodeLocation: 376,488,1
NodeSize: 64,40
WindState: 2,289,23,1168,700
ValueState: 2,859,158,300,585,0,MIDM
NumberFormat: 2,F,4,4,0,0,4,0,$,0,"SHORT",0,,,0,0,15
DisplayOutputs: Object Object, Object Function, Object Variable, Function MultiStage_CalibrPV0, Function OG_Multi_Stage_Calib
{!50400|Att_AxisOrKeyTitle: ""}
{!40300|Att_SlicerPopupSize: 352,742}

Constant PV_Stock_Start_Year
Title: PV Stock Start Year
Description: The first date in which vehicle stock data are available. This must be input in date format (e.g., 1/1/2014). It must start on the first day of the month.
Definition: 1/1/2002
NodeLocation: 96,168,1
NodeSize: 64,40
WindState: 2,-22,410,720,412

Constant PV_Stock_End_Year
Title: PV Stock End Year
Description: The final date in which vehicle stock data are available. This must be input in date format (e.g., 1/1/2014).
Definition: 12/1/2031
NodeLocation: 248,168,1
NodeSize: 64,40
ValueState: 2,527,225,416,303,,MIDM
{!40300|DomainExpr: Integer()}

Decision PV_Data_dT_Choice
Title: PV Data dT Choice
Definition: Choice(Timestep_Options,1,0)
NodeLocation: 96,56,1
NodeSize: 64,40
Aliases: Alias Al1568697942, FormNode Fo1568697970, FormNode Fo1534871511

Variable dT_PV_Data
Title: dT PV Data
Units: Year
Description: The timestep (month, quarter, biannual, annual) of historical vehicle stock data, in numerical terms (as a fraction of a year)			
Definition: Timestep_Months[Timestep_Options=PV_Data_dT_Choice] / 12
NodeLocation: 248,56,1
NodeSize: 64,40

FormNode Fo1534871511
Title: Vehicle Data dT Choice
Definition: 0
NodeLocation: 100,100,1
NodeSize: 76,12
NodeInfo: 1,0,0,0,0,0,0,110,0,,0,,,0
Original: PV_Data_dT_Choice

Decision PV_Sim_Start_Year
Title: PV Sim Start Year
Description: The year in which you want the adoption simulation to start. The simulation will then use the appropriate starting point for instalaltions at this point in time. In some cases, depending on the data, you may not want to start the simulation as early as the stock data are available. Typically for PV, you will want to start the PV simulation exactly one period (e.g., month) after the latest reliable data are available regarding historical installations. That said, the latest month in the interconnection databases are typically unreliable due to previous applications that have not yet come through. So, it is typically wise to ignore the last month (or even two, depending on the time delays) of interconnection data. ~
~
During calibration, this time is set to an earlier period to "back cast" adoption and compare it with actual adoption for purposes of estimating diffusion coefficients.
Definition: Choice(PV_Sim_Strt_Yr_Opt,181,0)
NodeLocation: 96,272,1
NodeSize: 64,40
ValueState: 2,795,362,320,151,,MIDM
Aliases: Alias Al1568697943, FormNode Fo1568697971, FormNode Fo1542137499, FormNode Fo1534871512
NodeColor: 65535,65531,1
NumberFormat: 2,F,4,4,0,0,4,0,$,0,"MMM-yyyy",0,,,0,0,15

Index PV_Sim_Strt_Yr_Opt
Att_PrevIndexValue: [1-Jan-2002,1-Feb-2002,1-Mar-2002,1-Apr-2002,1-May-2002,1-Jun-2002,1-Jul-2002,1-Aug-2002,1-Sep-2002,1-Oct-2002,1-Nov-2002,1-Dec-2002,1-Jan-2003,1-Feb-2003,1-Mar-2003,1-Apr-2003,1-May-2003,1-Jun-2003,1-Jul-2003,1-Aug-2003,1-Sep-2003,1-Oct-2003,1-Nov-2003,1-Dec-2003,1-Jan-2004,1-Feb-2004,1-Mar-2004,1-Apr-2004,1-May-2004,1-Jun-2004,1-Jul-2004,1-Aug-2004,1-Sep-2004,1-Oct-2004,1-Nov-2004,1-Dec-2004,1-Jan-2005,1-Feb-2005,1-Mar-2005,1-Apr-2005,1-May-2005,1-Jun-2005,1-Jul-2005,1-Aug-2005,1-Sep-2005,1-Oct-2005,1-Nov-2005,1-Dec-2005,1-Jan-2006,1-Feb-2006,1-Mar-2006,1-Apr-2006,1-May-2006,1-Jun-2006,1-Jul-2006,1-Aug-2006,1-Sep-2006,1-Oct-2006,1-Nov-2006,1-Dec-2006,1-Jan-2007,1-Feb-2007,1-Mar-2007,1-Apr-2007,1-May-2007,1-Jun-2007,1-Jul-2007,1-Aug-2007,1-Sep-2007,1-Oct-2007,1-Nov-2007,1-Dec-2007,1-Jan-2008,1-Feb-2008,1-Mar-2008,1-Apr-2008,1-May-2008,1-Jun-2008,1-Jul-2008,1-Aug-2008,1-Sep-2008,1-Oct-2008,1-Nov-2008,1-Dec-2008,1-Jan-2009,1-Feb-2009,1-Mar-2009,1-Apr-2009,1-May-2009,1-Jun-2009,1-Jul-2009,1-Aug-2009,1-Sep-2009,1-Oct-2009,1-Nov-2009,1-Dec-2009,1-Jan-2010,1-Feb-2010,1-Mar-2010,1-Apr-2010,1-May-2010,1-Jun-2010,1-Jul-2010,1-Aug-2010,1-Sep-2010,1-Oct-2010,1-Nov-2010,1-Dec-2010,1-Jan-2011,1-Feb-2011,1-Mar-2011,1-Apr-2011,1-May-2011,1-Jun-2011,1-Jul-2011,1-Aug-2011,1-Sep-2011,1-Oct-2011,1-Nov-2011,1-Dec-2011,1-Jan-2012,1-Feb-2012,1-Mar-2012,1-Apr-2012,1-May-2012,1-Jun-2012,1-Jul-2012,1-Aug-2012,1-Sep-2012,1-Oct-2012,1-Nov-2012,1-Dec-2012,1-Jan-2013,1-Feb-2013,1-Mar-2013,1-Apr-2013,1-May-2013,1-Jun-2013,1-Jul-2013,1-Aug-2013,1-Sep-2013,1-Oct-2013,1-Nov-2013,1-Dec-2013,1-Jan-2014,1-Feb-2014,1-Mar-2014,1-Apr-2014,1-May-2014,1-Jun-2014,1-Jul-2014,1-Aug-2014,1-Sep-2014,1-Oct-2014,1-Nov-2014,1-Dec-2014,1-Jan-2015,1-Feb-2015,1-Mar-2015,1-Apr-2015,1-May-2015,1-Jun-2015,1-Jul-2015,1-Aug-2015,1-Sep-2015,1-Oct-2015,1-Nov-2015,1-Dec-2015,1-Jan-2016,1-Feb-2016,1-Mar-2016,1-Apr-2016,1-May-2016,1-Jun-2016,1-Jul-2016,1-Aug-2016,1-Sep-2016,1-Oct-2016,1-Nov-2016,1-Dec-2016,1-Jan-2017,1-Feb-2017,1-Mar-2017,1-Apr-2017,1-May-2017,1-Jun-2017,1-Jul-2017,1-Aug-2017,1-Sep-2017,1-Oct-2017,1-Nov-2017,1-Dec-2017,1-Jan-2018,1-Feb-2018,1-Mar-2018,1-Apr-2018,1-May-2018,1-Jun-2018,1-Jul-2018,1-Aug-2018,1-Sep-2018,1-Oct-2018,1-Nov-2018,1-Dec-2018,1-Jan-2019,1-Feb-2019,1-Mar-2019,1-Apr-2019,1-May-2019,1-Jun-2019,1-Jul-2019,1-Aug-2019,1-Sep-2019,1-Oct-2019,1-Nov-2019,1-Dec-2019,1-Jan-2020,1-Feb-2020,1-Mar-2020,1-Apr-2020,1-May-2020,1-Jun-2020,1-Jul-2020,1-Aug-2020,1-Sep-2020,1-Oct-2020,1-Nov-2020,1-Dec-2020,1-Jan-2021,1-Feb-2021,1-Mar-2021,1-Apr-2021,1-May-2021,1-Jun-2021,1-Jul-2021,1-Aug-2021,1-Sep-2021,1-Oct-2021,1-Nov-2021,1-Dec-2021,1-Jan-2022,1-Feb-2022,1-Mar-2022,1-Apr-2022,1-May-2022,1-Jun-2022,1-Jul-2022,1-Aug-2022,1-Sep-2022,1-Oct-2022,1-Nov-2022,1-Dec-2022,1-Jan-2023,1-Feb-2023,1-Mar-2023,1-Apr-2023,1-May-2023,1-Jun-2023,1-Jul-2023,1-Aug-2023,1-Sep-2023,1-Oct-2023,1-Nov-2023,1-Dec-2023,1-Jan-2024,1-Feb-2024,1-Mar-2024,1-Apr-2024,1-May-2024,1-Jun-2024,1-Jul-2024,1-Aug-2024,1-Sep-2024,1-Oct-2024,1-Nov-2024,1-Dec-2024,1-Jan-2025,1-Feb-2025,1-Mar-2025,1-Apr-2025,1-May-2025,1-Jun-2025,1-Jul-2025,1-Aug-2025,1-Sep-2025,1-Oct-2025,1-Nov-2025,1-Dec-2025,1-Jan-2026,1-Feb-2026,1-Mar-2026,1-Apr-2026,1-May-2026,1-Jun-2026,1-Jul-2026,1-Aug-2026,1-Sep-2026,1-Oct-2026,1-Nov-2026,1-Dec-2026,1-Jan-2027,1-Feb-2027,1-Mar-2027,1-Apr-2027,1-May-2027,1-Jun-2027,1-Jul-2027,1-Aug-2027,1-Sep-2027,1-Oct-2027,1-Nov-2027,1-Dec-2027,1-Jan-2028,1-Feb-2028,1-Mar-2028,1-Apr-2028,1-May-2028,1-Jun-2028,1-Jul-2028,1-Aug-2028,1-Sep-2028,1-Oct-2028,1-Nov-2028,1-Dec-2028,1-Jan-2029,1-Feb-2029,1-Mar-2029,1-Apr-2029,1-May-2029,1-Jun-2029,1-Jul-2029,1-Aug-2029,1-Sep-2029,1-Oct-2029,1-Nov-2029,1-Dec-2029,1-Jan-2030,1-Feb-2030,1-Mar-2030,1-Apr-2030,1-May-2030,1-Jun-2030,1-Jul-2030,1-Aug-2030,1-Sep-2030,1-Oct-2030,1-Nov-2030,1-Dec-2030,1-Jan-2031,1-Feb-2031,1-Mar-2031,1-Apr-2031,1-May-2031,1-Jun-2031,1-Jul-2031,1-Aug-2031,1-Sep-2031,1-Oct-2031,1-Nov-2031,1-Dec-2031]
Title: PV Sim Strt Yr Option
Description: The options permissible for when the vehicle simulation can be started.
Definition: Sequence(PV_Stock_Start_Year, PV_Stock_End_Year, step: Timestep_Months[Timestep_Options=PV_Data_dT_Choice], dateUnit: 'M')
NodeLocation: 88,488,1
NodeSize: 64,40
WindState: 2,518,302,720,350
ValueState: 2,586,141,258,345,0,MIDM

Decision PV_Sim_End_Year
Title: PV Sim End Year
Description: The final year of the vehicle simulated forecast.
Definition: Choice(PV_Sim_End_Yr_Option,252,0)
NodeLocation: 248,272,1
NodeSize: 64,40
WindState: 2,102,82,1083,701
ValueState: 2,72,74,416,303,,MIDM
Aliases: Alias Al1568697944, FormNode Fo1568697972, FormNode Fo1542137498, FormNode Fo1534871513
NodeColor: 65535,65531,1
NumberFormat: 2,F,4,4,0,0,4,0,$,0,"MMM-yyyy",0,,,0,0,15

Index PV_Sim_End_Yr_Option
Att_PrevIndexValue: [1-Jan-2002,1-Feb-2002,1-Mar-2002,1-Apr-2002,1-May-2002,1-Jun-2002,1-Jul-2002,1-Aug-2002,1-Sep-2002,1-Oct-2002,1-Nov-2002,1-Dec-2002,1-Jan-2003,1-Feb-2003,1-Mar-2003,1-Apr-2003,1-May-2003,1-Jun-2003,1-Jul-2003,1-Aug-2003,1-Sep-2003,1-Oct-2003,1-Nov-2003,1-Dec-2003,1-Jan-2004,1-Feb-2004,1-Mar-2004,1-Apr-2004,1-May-2004,1-Jun-2004,1-Jul-2004,1-Aug-2004,1-Sep-2004,1-Oct-2004,1-Nov-2004,1-Dec-2004,1-Jan-2005,1-Feb-2005,1-Mar-2005,1-Apr-2005,1-May-2005,1-Jun-2005,1-Jul-2005,1-Aug-2005,1-Sep-2005,1-Oct-2005,1-Nov-2005,1-Dec-2005,1-Jan-2006,1-Feb-2006,1-Mar-2006,1-Apr-2006,1-May-2006,1-Jun-2006,1-Jul-2006,1-Aug-2006,1-Sep-2006,1-Oct-2006,1-Nov-2006,1-Dec-2006,1-Jan-2007,1-Feb-2007,1-Mar-2007,1-Apr-2007,1-May-2007,1-Jun-2007,1-Jul-2007,1-Aug-2007,1-Sep-2007,1-Oct-2007,1-Nov-2007,1-Dec-2007,1-Jan-2008,1-Feb-2008,1-Mar-2008,1-Apr-2008,1-May-2008,1-Jun-2008,1-Jul-2008,1-Aug-2008,1-Sep-2008,1-Oct-2008,1-Nov-2008,1-Dec-2008,1-Jan-2009,1-Feb-2009,1-Mar-2009,1-Apr-2009,1-May-2009,1-Jun-2009,1-Jul-2009,1-Aug-2009,1-Sep-2009,1-Oct-2009,1-Nov-2009,1-Dec-2009,1-Jan-2010,1-Feb-2010,1-Mar-2010,1-Apr-2010,1-May-2010,1-Jun-2010,1-Jul-2010,1-Aug-2010,1-Sep-2010,1-Oct-2010,1-Nov-2010,1-Dec-2010,1-Jan-2011,1-Feb-2011,1-Mar-2011,1-Apr-2011,1-May-2011,1-Jun-2011,1-Jul-2011,1-Aug-2011,1-Sep-2011,1-Oct-2011,1-Nov-2011,1-Dec-2011,1-Jan-2012,1-Feb-2012,1-Mar-2012,1-Apr-2012,1-May-2012,1-Jun-2012,1-Jul-2012,1-Aug-2012,1-Sep-2012,1-Oct-2012,1-Nov-2012,1-Dec-2012,1-Jan-2013,1-Feb-2013,1-Mar-2013,1-Apr-2013,1-May-2013,1-Jun-2013,1-Jul-2013,1-Aug-2013,1-Sep-2013,1-Oct-2013,1-Nov-2013,1-Dec-2013,1-Jan-2014,1-Feb-2014,1-Mar-2014,1-Apr-2014,1-May-2014,1-Jun-2014,1-Jul-2014,1-Aug-2014,1-Sep-2014,1-Oct-2014,1-Nov-2014,1-Dec-2014,1-Jan-2015,1-Feb-2015,1-Mar-2015,1-Apr-2015,1-May-2015,1-Jun-2015,1-Jul-2015,1-Aug-2015,1-Sep-2015,1-Oct-2015,1-Nov-2015,1-Dec-2015,1-Jan-2016,1-Feb-2016,1-Mar-2016,1-Apr-2016,1-May-2016,1-Jun-2016,1-Jul-2016,1-Aug-2016,1-Sep-2016,1-Oct-2016,1-Nov-2016,1-Dec-2016,1-Jan-2017,1-Feb-2017,1-Mar-2017,1-Apr-2017,1-May-2017,1-Jun-2017,1-Jul-2017,1-Aug-2017,1-Sep-2017,1-Oct-2017,1-Nov-2017,1-Dec-2017,1-Jan-2018,1-Feb-2018,1-Mar-2018,1-Apr-2018,1-May-2018,1-Jun-2018,1-Jul-2018,1-Aug-2018,1-Sep-2018,1-Oct-2018,1-Nov-2018,1-Dec-2018,1-Jan-2019,1-Feb-2019,1-Mar-2019,1-Apr-2019,1-May-2019,1-Jun-2019,1-Jul-2019,1-Aug-2019,1-Sep-2019,1-Oct-2019,1-Nov-2019,1-Dec-2019,1-Jan-2020,1-Feb-2020,1-Mar-2020,1-Apr-2020,1-May-2020,1-Jun-2020,1-Jul-2020,1-Aug-2020,1-Sep-2020,1-Oct-2020,1-Nov-2020,1-Dec-2020,1-Jan-2021,1-Feb-2021,1-Mar-2021,1-Apr-2021,1-May-2021,1-Jun-2021,1-Jul-2021,1-Aug-2021,1-Sep-2021,1-Oct-2021,1-Nov-2021,1-Dec-2021,1-Jan-2022,1-Feb-2022,1-Mar-2022,1-Apr-2022,1-May-2022,1-Jun-2022,1-Jul-2022,1-Aug-2022,1-Sep-2022,1-Oct-2022,1-Nov-2022,1-Dec-2022,1-Jan-2023,1-Feb-2023,1-Mar-2023,1-Apr-2023,1-May-2023,1-Jun-2023,1-Jul-2023,1-Aug-2023,1-Sep-2023,1-Oct-2023,1-Nov-2023,1-Dec-2023,1-Jan-2024,1-Feb-2024,1-Mar-2024,1-Apr-2024,1-May-2024,1-Jun-2024,1-Jul-2024,1-Aug-2024,1-Sep-2024,1-Oct-2024,1-Nov-2024,1-Dec-2024,1-Jan-2025,1-Feb-2025,1-Mar-2025,1-Apr-2025,1-May-2025,1-Jun-2025,1-Jul-2025,1-Aug-2025,1-Sep-2025,1-Oct-2025,1-Nov-2025,1-Dec-2025,1-Jan-2026,1-Feb-2026,1-Mar-2026,1-Apr-2026,1-May-2026,1-Jun-2026,1-Jul-2026,1-Aug-2026,1-Sep-2026,1-Oct-2026,1-Nov-2026,1-Dec-2026,1-Jan-2027,1-Feb-2027,1-Mar-2027,1-Apr-2027,1-May-2027,1-Jun-2027,1-Jul-2027,1-Aug-2027,1-Sep-2027,1-Oct-2027,1-Nov-2027,1-Dec-2027,1-Jan-2028,1-Feb-2028,1-Mar-2028,1-Apr-2028,1-May-2028,1-Jun-2028,1-Jul-2028,1-Aug-2028,1-Sep-2028,1-Oct-2028,1-Nov-2028,1-Dec-2028,1-Jan-2029,1-Feb-2029,1-Mar-2029,1-Apr-2029,1-May-2029,1-Jun-2029,1-Jul-2029,1-Aug-2029,1-Sep-2029,1-Oct-2029,1-Nov-2029,1-Dec-2029,1-Jan-2030,1-Feb-2030,1-Mar-2030,1-Apr-2030,1-May-2030,1-Jun-2030,1-Jul-2030,1-Aug-2030,1-Sep-2030,1-Oct-2030,1-Nov-2030,1-Dec-2030,1-Jan-2031,1-Feb-2031,1-Mar-2031,1-Apr-2031,1-May-2031,1-Jun-2031,1-Jul-2031,1-Aug-2031,1-Sep-2031,1-Oct-2031,1-Nov-2031,1-Dec-2031,1-Jan-2032,1-Feb-2032,1-Mar-2032,1-Apr-2032,1-May-2032,1-Jun-2032,1-Jul-2032,1-Aug-2032,1-Sep-2032,1-Oct-2032,1-Nov-2032,1-Dec-2032,1-Jan-2033,1-Feb-2033,1-Mar-2033,1-Apr-2033,1-May-2033,1-Jun-2033,1-Jul-2033,1-Aug-2033,1-Sep-2033,1-Oct-2033,1-Nov-2033,1-Dec-2033,1-Jan-2034,1-Feb-2034,1-Mar-2034,1-Apr-2034,1-May-2034,1-Jun-2034,1-Jul-2034,1-Aug-2034,1-Sep-2034,1-Oct-2034,1-Nov-2034,1-Dec-2034]
Title: PV Sim End Yr Option
Units: Year
Description: The options permissible for when the vehicle simulation can be ended.
Definition: Sequence(PV_Stock_Start_Year, Max_PV_Simulation_Ye, step: Timestep_Months[Timestep_Options=PV_Data_dT_Choice], dateUnit: 'M')
NodeLocation: 232,488,1
NodeSize: 64,40
WindState: 2,102,82,720,529
ValueState: 2,723,0,358,910,0,MIDM

FormNode Fo1534871512
Title: Vehicle Sim Start Year
Definition: 0
NodeLocation: 92,324,1
NodeSize: 76,12
NodeInfo: 1,0,0,0,0,0,0,114,0,,0,,,0
Original: PV_Sim_Start_Year

FormNode Fo1534871513
Title: Vehicle Sim End Year
Definition: 0
NodeLocation: 252,324,1
NodeSize: 76,12
NodeInfo: 1,0,0,0,0,0,0,114,0,,0,,,0
Original: PV_Sim_End_Year

Text Te1534871511
Title: Notes:
Description: 1. Put above inputs in global data input file
NodeLocation: 656,152,-1
NodeSize: 176,40
NodeColor: 65535,65535,65535

Variable PV_Time_Fract_Year
Title: PV Time Fractional Year
Units: year
Description: The fractional year associated with each month in the "Time - Solar PV" index.
Definition: VAR month:=DatePart(Time_Solar_PV, 'M');~
VAR year:=DatePart(Time_Solar_PV, 'Y');~
year + (month-1)/12
NodeLocation: 248,392,1
NodeSize: 64,40
ValueState: 2,407,220,651,662,0,MIDM

Variable PV_Year_Map
Title: PV Year Map
Definition: DatePart(Time_Solar_PV, 'Y')
NodeLocation: 400,392,1
NodeSize: 64,40
WindState: 2,451,161,720,350
ValueState: 2,1190,221,514,600,0,MIDM

Variable PV_Sim_Start_Minus_1
Title: PV Sim Start Minus 1
Description: The time period prior to the PV simulation start year.
Definition: Slice(PV_Sim_Strt_Yr_Opt, PositionInIndex(PV_Sim_Strt_Yr_Opt, PV_Sim_Start_Year, PV_Sim_Strt_Yr_Opt) - 1)
NodeLocation: 400,272,1
NodeSize: 64,40
WindState: 2,102,82,909,350

Variable PV_Time_EOP_Map
Title: PV Time EOP Map
Definition: Time_EOP_Map[Time=Time_Solar_PV]
NodeLocation: 96,392,1
NodeSize: 64,40
ValueState: 2,440,132,416,613,0,MIDM

Variable PV_Timesteps_PerYear
Title: PV Timesteps Per Year
Description: The number of timesteps per year for the solar PV time index.
Definition: Divide(1, dT_PV_Data, True)
NodeLocation: 400,56,1
NodeSize: 64,40

Variable PV_CalStart_Minus1
Title: PV Calib Start Minus 1
Description: The time period prior to the PV calibration start year.
Definition: Slice(PV_Sim_Strt_Yr_Opt, PositionInIndex(PV_Sim_Strt_Yr_Opt, PV_Calibration_Start, PV_Sim_Strt_Yr_Opt) - 1)
NodeLocation: 552,272,1
NodeSize: 64,40
WindState: 2,102,82,909,350

Variable PV_Calib_End_Plus1
Title: PV Calib End Plus 1
Description: The time period after the PV calibration end year.
Definition: Slice(PV_Sim_Strt_Yr_Opt, PositionInIndex(PV_Sim_Strt_Yr_Opt, PV_Calibration_End, PV_Sim_Strt_Yr_Opt) + 1)
NodeLocation: 704,272,1
NodeSize: 64,40
WindState: 2,102,82,909,350

Close PV_Time

Module PV_Impacts
Title: PV Impacts
Author: JamesMilford
Date: Sun, Sep 2, 2018 8:12 PM
NodeLocation: 400,288,1
NodeSize: 64,40
NodeInfo: 1,0,0
DiagState: 2,0,81,1789,674,17,10
NodeColor: 57311,57311,57311
AcpStyles: Show_Object:no

Variable Solar_Hourly_Impact
Title: Solar Hourly Impact
Units: MW-AC
Definition: VAR installs:=LinearInterp(PV_Time_EOP_Map, Cumul_DC_Capacity_EO, Impact_Time_Map, Time_Solar_PV);~
(Solar_Shapes[PV_Climate_Zone=Climate_Zone_Map] * installs)[PV_Sectors=All_Sectors, PV_Spatial_ID=Spatial_ID]
NodeLocation: 744,152,1
NodeSize: 64,40
WindState: 2,102,82,1142,535
ValueState: 2,201,63,1656,785,1,MIDM
Aliases: Alias Al1579797921
GraphSetup: Graph_AxisTitleFont:Arial,18,1~
Graph_KeyFont:,18,0~
Graph_KeyTitleFont:,18,1~
Graph_AxisLabelFont:,18,0~
Att_CatLineStyle Graph_Primary_Valdim:5
ReformVal: [Profile_Hours,Impact_Year]
Att__TotalsIndex: [PV_Spatial_ID,PV_Sectors]
Att_ResultSliceState: [Month,6,Spatial_ID,1,All_Sectors,1,Impact_Year,1,Profile_Hours,1]

Variable Cumul_PV_MW_DC
Title: Cumul Installed PV MW-DC
Units: MW-DC
Definition: Cumul_DC_Capacity_EO
NodeLocation: 440,152,1
NodeSize: 64,40
ValueState: 2,421,57,1012,795,1,MIDM
ReformVal: [Impact_Year,Null]
Att__TotalsIndex: [Spatial_IDs,PV_Spatial_ID,PV_Sectors]
Att_ResultSliceState: [PV_Sectors,0,PV_Spatial_ID,0,Impact_Year,1]
Att_ColorRole: Null

Variable Annual_Solar_Product
Title: Annual Solar Production
Units: GWh/year
Definition: Sum(Solar_Hourly_Impact * Weeks_Per_Month, Profile_Hours, Month) / 1000
NodeLocation: 896,152,1
NodeSize: 64,40
ValueState: 2,254,29,1319,833,0,MIDM
ReformVal: [All_Sectors,Impact_Year]
NumberFormat: 2,F,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: []
Att_ResultSliceState: [Spatial_ID,1,All_Sectors,0,Area_Type,1,Impact_Year,1]
Att_ColorRole: Null

Index Start_of_Year
Title: Start of Year
Definition: DatePart(Subset(DatePart(Impact_Year, 'M') = 1), 'Y')
NodeLocation: 744,56,1
NodeSize: 64,40
ValueState: 2,472,375,416,402,0,MIDM
{!40300|Att_SlicerPopupSize: 267,280}

Decision Start_Time_for_Outpu
Title: Start Time for Output
Description: Select the start time for which results will be displayed.
Definition: Choice(Output_Start_Time,13,0)
NodeLocation: 1080,576,1
NodeSize: 64,40
Aliases: FormNode Fo1535749286

Index Output_Start_Time
Att_PrevIndexValue: [1-Jul-2010,1-Jan-2011,1-Jul-2011,1-Jan-2012,1-Jul-2012,1-Jan-2013,1-Jul-2013,1-Jan-2014,1-Jul-2014,1-Jan-2015,1-Jul-2015,1-Jan-2016,1-Jul-2016,1-Jan-2017,1-Jul-2017,1-Jan-2018,1-Jul-2018,1-Jan-2019,1-Jul-2019,1-Jan-2020,1-Jul-2020,1-Jan-2021,1-Jul-2021,1-Jan-2022,1-Jul-2022,1-Jan-2023,1-Feb-2023,1-Mar-2023,1-Apr-2023,1-May-2023,1-Jun-2023,1-Jul-2023,1-Aug-2023,1-Sep-2023,1-Oct-2023,1-Nov-2023,1-Dec-2023,1-Jan-2024,1-Feb-2024,1-Mar-2024,1-Apr-2024,1-May-2024,1-Jun-2024,1-Jul-2024,1-Aug-2024,1-Sep-2024,1-Oct-2024,1-Nov-2024,1-Dec-2024,1-Jan-2025,1-Feb-2025,1-Mar-2025,1-Apr-2025,1-May-2025,1-Jun-2025,1-Jul-2025,1-Aug-2025,1-Sep-2025,1-Oct-2025,1-Nov-2025,1-Dec-2025,1-Jan-2026,1-Feb-2026,1-Mar-2026,1-Apr-2026,1-May-2026,1-Jun-2026,1-Jul-2026,1-Aug-2026,1-Sep-2026,1-Oct-2026,1-Nov-2026,1-Dec-2026,1-Jan-2027,1-Feb-2027,1-Mar-2027,1-Apr-2027,1-May-2027,1-Jun-2027,1-Jul-2027,1-Aug-2027,1-Sep-2027,1-Oct-2027,1-Nov-2027,1-Dec-2027,1-Jan-2028,1-Feb-2028,1-Mar-2028,1-Apr-2028,1-May-2028,1-Jun-2028,1-Jul-2028,1-Aug-2028,1-Sep-2028,1-Oct-2028,1-Nov-2028,1-Dec-2028,1-Jan-2029,1-Feb-2029,1-Mar-2029,1-Apr-2029,1-May-2029,1-Jun-2029,1-Jul-2029,1-Aug-2029,1-Sep-2029,1-Oct-2029,1-Nov-2029,1-Dec-2029,1-Jan-2030,1-Feb-2030,1-Mar-2030,1-Apr-2030,1-May-2030,1-Jun-2030,1-Jul-2030,1-Aug-2030,1-Sep-2030,1-Oct-2030,1-Nov-2030,1-Dec-2030,1-Jan-2031,1-Feb-2031,1-Mar-2031,1-Apr-2031,1-May-2031,1-Jun-2031,1-Jul-2031,1-Aug-2031,1-Sep-2031,1-Oct-2031,1-Nov-2031,1-Dec-2031,1-Jan-2032,1-Feb-2032,1-Mar-2032,1-Apr-2032,1-May-2032,1-Jun-2032,1-Jul-2032,1-Aug-2032,1-Sep-2032,1-Oct-2032,1-Nov-2032,1-Dec-2032,1-Jan-2033,1-Feb-2033,1-Mar-2033,1-Apr-2033,1-May-2033,1-Jun-2033,1-Jul-2033,1-Aug-2033,1-Sep-2033,1-Oct-2033,1-Nov-2033,1-Dec-2033,1-Jan-2034,1-Feb-2034,1-Mar-2034,1-Apr-2034,1-May-2034,1-Jun-2034,1-Jul-2034,1-Aug-2034,1-Sep-2034,1-Oct-2034,1-Nov-2034,1-Dec-2034]
Title: Output Start Time
Definition: INDEX both:=Concat(Time_Vehicles, Time_Solar_PV);~
INDEX uniqTime:=Unique(both);~
SortIndex(uniqTime)
NodeLocation: 128,464,1
NodeSize: 64,40
ValueState: 2,104,106,416,740,0,MIDM

FormNode Fo1535749286
Title: Start Time for Output
Definition: 0
NodeLocation: 1084,628,1
NodeSize: 84,12
NodeInfo: 1,0,0,0,0,0,0,128,0,,0,,,
Original: Start_Time_for_Outpu

Decision End_Time_for_Output
Title: End Time for Output
Description: Select the end time for which results will be displayed.
Definition: Choice(Output_End_Time,26,0)
NodeLocation: 1248,576,1
NodeSize: 64,40
Aliases: FormNode Fo1535749361

FormNode Fo1535749361
Title: Start Time for Output
Definition: 0
NodeLocation: 1252,628,1
NodeSize: 84,12
NodeInfo: 1,0,0,0,0,0,0,128,0,,0,,,
Original: End_Time_for_Output

Index Output_End_Time
Att_PrevIndexValue: [1-Jul-2016,1-Jan-2017,1-Jul-2017,1-Jan-2018,1-Jul-2018,1-Jan-2019,1-Jul-2019,1-Jan-2020,1-Jul-2020,1-Jan-2021,1-Jul-2021,1-Jan-2022,1-Jul-2022,1-Jan-2023,1-Feb-2023,1-Mar-2023,1-Apr-2023,1-May-2023,1-Jun-2023,1-Jul-2023,1-Aug-2023,1-Sep-2023,1-Oct-2023,1-Nov-2023,1-Dec-2023,1-Jan-2024,1-Feb-2024,1-Mar-2024,1-Apr-2024,1-May-2024,1-Jun-2024,1-Jul-2024,1-Aug-2024,1-Sep-2024,1-Oct-2024,1-Nov-2024,1-Dec-2024,1-Jan-2025,1-Feb-2025,1-Mar-2025,1-Apr-2025,1-May-2025,1-Jun-2025,1-Jul-2025,1-Aug-2025,1-Sep-2025,1-Oct-2025,1-Nov-2025,1-Dec-2025,1-Jan-2026,1-Feb-2026,1-Mar-2026,1-Apr-2026,1-May-2026,1-Jun-2026,1-Jul-2026,1-Aug-2026,1-Sep-2026,1-Oct-2026,1-Nov-2026,1-Dec-2026,1-Jan-2027,1-Feb-2027,1-Mar-2027,1-Apr-2027,1-May-2027,1-Jun-2027,1-Jul-2027,1-Aug-2027,1-Sep-2027,1-Oct-2027,1-Nov-2027,1-Dec-2027,1-Jan-2028,1-Feb-2028,1-Mar-2028,1-Apr-2028,1-May-2028,1-Jun-2028,1-Jul-2028,1-Aug-2028,1-Sep-2028,1-Oct-2028,1-Nov-2028,1-Dec-2028,1-Jan-2029,1-Feb-2029,1-Mar-2029,1-Apr-2029,1-May-2029,1-Jun-2029,1-Jul-2029,1-Aug-2029,1-Sep-2029,1-Oct-2029,1-Nov-2029,1-Dec-2029,1-Jan-2030,1-Feb-2030,1-Mar-2030,1-Apr-2030,1-May-2030,1-Jun-2030,1-Jul-2030,1-Aug-2030,1-Sep-2030,1-Oct-2030,1-Nov-2030,1-Dec-2030,1-Jan-2031,1-Feb-2031,1-Mar-2031,1-Apr-2031,1-May-2031,1-Jun-2031,1-Jul-2031,1-Aug-2031,1-Sep-2031,1-Oct-2031,1-Nov-2031,1-Dec-2031,1-Jan-2032,1-Feb-2032,1-Mar-2032,1-Apr-2032,1-May-2032,1-Jun-2032,1-Jul-2032,1-Aug-2032,1-Sep-2032,1-Oct-2032,1-Nov-2032,1-Dec-2032,1-Jan-2033,1-Feb-2033,1-Mar-2033,1-Apr-2033,1-May-2033,1-Jun-2033,1-Jul-2033,1-Aug-2033,1-Sep-2033,1-Oct-2033,1-Nov-2033,1-Dec-2033,1-Jan-2034,1-Feb-2034,1-Mar-2034,1-Apr-2034,1-May-2034,1-Jun-2034,1-Jul-2034,1-Aug-2034,1-Sep-2034,1-Oct-2034,1-Nov-2034,1-Dec-2034]
Title: Output End Time
Definition: Subset(Output_Start_Time>=Start_Time_for_Outpu)
NodeLocation: 296,464,1
NodeSize: 64,40
ValueState: 2,1249,147,416,303,0,MIDM

Index Impact_Year
Title: Impact Year
Definition: VAR startDate:=DatePart(Forecast_Start_Perio, 'Y');~
VAR endDate:=DatePart(Forecast_End_Period, 'Y');~
Sequence(startDate, endDate, 1)
NodeLocation: 440,464,1
NodeSize: 64,40
WindState: 2,98,82,1283,700
ValueState: 2,764,18,270,680,0,MIDM
{!40300|Att_SlicerPopupSize: 307,196}

Index Spatial_IDs
Att_PrevIndexValue: [91.901K,91.902K,91.906K,91.91K,91.911K,91.913K,91.914K,91.915K,91.916K,91.917K,91.931K,91.932K,91.934K,91.935K,91.941K,91.942K,91.945K,91.948K,91.95K,91.962K,91.963K,91.977K,91.978K,91.98K,92.003K,92.004K,92.007K,92.008K,92.009K,92.01K,92.011K,92.014K,92.019K,92.02K,92.021K,92.024K,92.025K,92.026K,92.027K,92.028K,92.029K,92.036K,92.037K,92.04K,92.054K,92.055K,92.056K,92.057K,92.058K,92.059K,92.06K,92.061K,92.064K,92.065K,92.066K,92.067K,92.068K,92.069K,92.07K,92.071K,92.072K,92.075K,92.078K,92.081K,92.082K,92.083K,92.084K,92.085K,92.086K,92.091K,92.092K,92.093K,92.096K,92.101K,92.102K,92.103K,92.104K,92.105K,92.106K,92.107K,92.108K,92.109K,92.11K,92.111K,92.112K,92.113K,92.114K,92.115K,92.116K,92.117K,92.118K,92.119K,92.12K,92.121K,92.122K,92.123K,92.124K,92.126K,92.127K,92.128K,92.129K,92.13K,92.131K,92.132K,92.136K,92.139K,92.145K,92.152K,92.154K,92.158K,92.161K,92.173K,92.179K,92.182K,92.199K,92.536K,92.624K,92.629K,92.651K,92.653K,92.656K,92.672K,92.673K,92.674K,92.675K,92.676K,92.677K,92.679K,92.688K,92.69K,92.691K,92.692K,92.693K,92.694K,92.697K]
Title: Spatial IDs
Description: Select the spatial IDs for which you wish to view results.
Definition: MultiChoice(All_Spatial_ID,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,allowNone:0,returnList:1)
NodeLocation: 584,464,1
NodeSize: 64,40
WindState: 2,102,82,894,712
Aliases: FormNode Fo1535749767
{!40300|Att_SlicerPopupSize: 457,1001}
{!40600|Att_ColorSequence: [0xff319500,0xfffe9018,0xff7f7f7f,0xff000000,0xff8872dc,0xff72d1dc,0xffdc72d9,0xffd0af62,0xffff0000,0xff0000ff,0xffffb3ff,0xff00ffff,0xff008000,0xffffa500,0xff00008b,0xffa52a2a,0xffffc0cb,0xffffff00,0xff00ff00,0xff800000,0xff708090,0xff008080,0xff800080,0xff90ee90,0xff319500,0xfffe9018,0xff7f7f7f,0xff000000,0xff8872dc,0xff72d1dc,0xffdc72d9,0xffd0af62,0xffff0000,0xff0000ff,0xffffb3ff,0xff00ffff,0xff008000,0xffffa500,0xff00008b,0xffa52a2a,0xffffc0cb,0xffffff00,0xff00ff00,0xff800000,0xff708090,0xff008080,0xff800080,0xff90ee90,0xff319500,0xfffe9018,0xff7f7f7f,0xff000000,0xff8872dc,0xff72d1dc,0xffdc72d9,0xffd0af62,0xffff0000,0xff0000ff,0xffffb3ff,0xff00ffff,0xff008000,0xffffa500,0xff00008b,0xffa52a2a,0xffffc0cb,0xffffff00,0xff00ff00,0xff800000,0xff708090,0xff008080,0xff800080,0xff90ee90,0xff319500,0xfffe9018,0xff7f7f7f,0xff000000,0xff8872dc,0xff72d1dc,0xffdc72d9,0xffd0af62,0xffff0000,0xff0000ff,0xffffb3ff,0xff00ffff,0xff008000,0xffffa500,0xff00008b,0xffa52a2a,0xffffc0cb,0xffffff00,0xff00ff00,0xff800000,0xff708090,0xff008080,0xff800080,0xff90ee90,0xff319500,0xfffe9018,0xff7f7f7f,0xff000000,0xff8872dc,0xff72d1dc,0xffdc72d9,0xffd0af62,0xffff0000,0xff0000ff,0xffffb3ff,0xff00ffff,0xff008000,0xffffa500,0xff00008b,0xffa52a2a,0xffffc0cb,0xffffff00,0xff00ff00,0xff800000,0xff708090,0xff008080,0xff800080,0xff90ee90,0xff319500,0xfffe9018,0xff7f7f7f,0xff000000,0xff8872dc,0xff72d1dc,0xffdc72d9,0xffd0af62,0xffff0000,0xff0000ff,0xffffb3ff,0xff00ffff,0xff008000,0xffffa500,0xff00008b,0xff31a318]}

FormNode Fo1535749767
Title: Spatial IDs
Definition: 0
NodeLocation: 584,516,1
NodeSize: 80,12
NodeInfo: 1,0,0,0,0,0,0,120,0,,0,,,
Original: Spatial_IDs

Variable Annual_Time_Map
Title: Annual Time Map
Definition: INDEX date:=Subset(DatePart(Impact_Year, 'M') = 1);~
Slice(date, @Start_of_Year)~

NodeLocation: 592,56,1
NodeSize: 64,40
WindState: 2,102,82,720,350
ValueState: 2,456,292,416,469,0,MIDM

Index Spatial_IDs_with_Agg
Title: Spatial IDs
Definition: INDEX aggLabels:=Subset(All_Agg_Spatial_IDs);~
INDEX removeAgg:=Subset(NOT PositionInIndex(aggLabels, Spatial_IDs, aggLabels));~
Concat(aggLabels, removeAgg)
NodeLocation: 1496,376,1
NodeSize: 64,40
ValueState: 2,374,7,431,450,,MIDM
{!40300|Att_SlicerPopupSize: 297,1001}

Variable Peak_Periods
Title: Peak Periods
Definition: Periods_by_TOU_Sched[Weekday_or_Weekend=DayType_by_DayAndHr, Time_of_Day=Hour_by_Day_and_Hr, Rate_Names=Rate_Name_Peak_Prd, All_Data_Types=Data_Type_Peak_Prd] = 1
NodeLocation: 424,256,1
NodeSize: 64,40
ValueState: 2,257,82,975,714,,MIDM
ReformVal: [Month,Day_and_Hour]
Att_ResultSliceState: [Data_Type,2,Rate_Names,2,Day_and_Hour,1,Month,1]

Decision Rate_Name_Peak_Prd
Title: Rate Name for Peak Period
Description: Select the rate name that describes the peak period.
Definition: Choice(Rate_Names,8,0)
NodeLocation: 272,256,1
NodeSize: 64,40
Aliases: FormNode Fo1542261445

Decision Data_Type_Peak_Prd
Title: Data Type for Peak Period
Description: Select the data type that describes the peak period.
Definition: Choice(All_Data_Types,2,0)
NodeLocation: 424,352,1
NodeSize: 64,40
Aliases: FormNode Fo1542261446

FormNode Fo1542261445
Title: Rate Name for Peak Period
Definition: 0
NodeLocation: 272,304,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,
Original: Rate_Name_Peak_Prd

FormNode Fo1542261446
Title: Data Type for Peak Period
Definition: 0
NodeLocation: 424,400,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,0
Original: Data_Type_Peak_Prd

Text Te1542841273
Title: Need to update this capacity using pre-existing installation rates of a required unit type (eg, non-coincident kW-AC)
NodeLocation: 168,56,-3
NodeSize: 136,56
NodeInfo: 1,0,0,1,1,1,1,,0,,0,,,
NodeColor: 57311,57311,57311
NodeFont: Arial Narrow,15
AcpStyles: Show_Object:no

Alias Al1579797635
Title: Cumul DC Capacity
Definition: 1
NodeLocation: 592,152,1
NodeSize: 64,40
Original: Cumul_DC_Capacity_EO

Variable Solar_Shapes
Title: Solar Shapes
Units: kW-hr/kW-DC
Description: The PV load shapes per kW-DC of installed solar.
Definition: Divide(Levelized_Applied_So[@PV_Operating_Year=1], PV_DC_System_Size_fo, True)
NodeLocation: 592,256,1
NodeSize: 64,40
WindState: 2,359,22,720,350
ValueState: 2,102,159,1670,727,,MIDM
Att_ResultSliceState: [PV_Sectors,2,PV_Climate_Zone,1,Month,1,Profile_Hours,1]

Variable Forecast_Start_Perio
Title: Forecast Start Period
Description: The earliest calibration start period across all DERs.
Definition: MAX([BESS_Time_EOP_Map[Time_Storage=BESS_Sim_Start_Year], PV_Time_EOP_Map[Time_Solar_PV=PV_Sim_Start_Year], EV_Time_EOP_Map[Time_Vehicles=Vehicle_Sim_Start_Yr]])
NodeLocation: 440,608,1
NodeSize: 64,40
WindState: 2,10,12,720,350

Variable Forecast_End_Period
Title: Forecast End Period
Description: The latest calibration end period across all DERs.
Definition: MIN([BESS_TimeOpt_EOP_Map[BESS_Sim_Strt_Yr_Opt=BESS_Sim_End_Year], PV_Time_EOP_Map[Time_Solar_PV=PV_Sim_End_Year], EV_Time_EOP_Map[Time_Vehicles=Vehicle_Sim_End_Yr]])
NodeLocation: 584,608,1
NodeSize: 64,40
WindState: 2,10,12,720,350
ValueState: 2,843,448,416,303,,MIDM

Variable Impact_Time_Map
Title: Impact Time Map
Definition: VAR allDates:=MakeDate(Impact_Year, @Month, Floor(Days_Per_Month));~
IF (allDates < Forecast_Start_Perio) OR (allDates > Forecast_End_Period)~
THEN Null~
ELSE allDates
NodeLocation: 744,608,1
NodeSize: 64,40
ValueState: 2,231,414,1490,392,0,MIDM

Alias Al1911116963
Title: PV Production per kW DC
Definition: 1
NodeLocation: 896,360,1
NodeSize: 64,40
Original: PV_Production_per_kW

Variable Normalized_Solar_Pro
Title: Normalized Solar Profile
Definition: local x:=Select_Hrly_Profiles[Selected_Profiles=Solar_Profile_Map_of];~
x / sum(x,Hours_8784)
NodeLocation: 896,464,1
NodeSize: 64,40
ValueState: 2,1296,-11,476,835,0,MIDM
ReformVal: [PV_Sectors,Hours_8784]
NumberFormat: 2,F,2,8,0,0,2,0,$,0,"ABBREV",0,,,0,0,15,
Att__TotalsIndex: [Hours_8784]

Variable Solar_Hourly_Impact_
Title: Solar Hourly Impact Delta
Units: MWh
Definition: local x:=Delta_MW_DC_PV_Impac * PV_Production_per_kW[PV_Climate_Zone=Climate_Zone_Map] * Normalized_Solar_Pro[Hours_8784=A8760];~
x[Area_Type=Area_Type_for_Optimi]
NodeLocation: 1064,360,1
NodeSize: 64,40
ValueState: 2,2732,157,589,748,0,MIDM
Aliases: FormNode Fo1495487651
ReformVal: [PV_Sectors,Forecast_Year1]
NumberFormat: 2,F,2,3,1,0,2,0,$,0,"ABBREV",0,,,0,0,15,
Att__TotalsIndex: [PV_Sectors,A8760]
Att_ResultSliceState: [PV_Spatial_ID,1,PV_Climate_Zone,1,A8760,0,Forecast_Year1,1,PV_Sectors,0]
{!50000|Att_ColumnWidths: [,PV_Sectors,\([,,,137])]}

FormNode Fo2042975395
Title: Area Type for Optimization
Definition: 0
NodeLocation: 992,24,1
NodeSize: 160,16
NodeInfo: 1,,,,,,,101,,,,,,0
Original: Area_Type_for_Optimi

Index Impact_Year1
Title: Impact Year
Definition: 2021..2052
NodeLocation: 1504,472,1
NodeSize: 64,40

Variable PV_Time_of_ImpactYea
Title: PV Time of ImpactYear
NodeLocation: 1504,576,1
NodeSize: 64,40

Decision Last_PV_Period_b4_Fo
Title: Last PV Period b4 Forecast Delta
Definition: Choice(Time,240,0)
NodeLocation: 1064,144,1
NodeSize: 64,40
Aliases: FormNode Fo1646482595, FormNode Fo1590080675

Decision Last_Period_of_Forec
Title: Last Period of Forecast Delta
Definition: Choice(Time,600,0)
NodeLocation: 1208,144,1
NodeSize: 64,40
Aliases: FormNode Fo304305315, FormNode Fo1053209763

Index Forecast_Period
Title: Forecast Period
Definition: Subset((Time_Solar_PV>Last_PV_Period_b4_Fo) AND (Time_Solar_PV<=Last_Period_of_Forec))
NodeLocation: 1488,144,1
NodeSize: 64,40
ValueState: 2,1367,194,402,502,0,MIDM
NumberFormat: 2,F,2,2,0,0,2,0,$,0,"MMM-yyyy",0,,,0,0,15,

Variable Delta_MW_DC_Impact_f
Title: Delta MW-DC Impact fm PV
Definition: (Cumul_DC_Capacity_EO - Cumul_DC_Capacity_EO[Time_Solar_PV=Last_PV_Period_b4_Fo])[Time_Solar_PV=Forecast_Period]
NodeLocation: 888,248,1
NodeSize: 64,40
ValueState: 2,1995,92,489,691,0,MIDM
ReformVal: [PV_Sectors,Forecast_Period]
Att__TotalsIndex: [PV_Sectors]

Variable PV_Time_at_End_of_Fo
Title: PV Time at End of Forecast Yr
Definition: MakeDate(Forecast_Year1,12,1)
NodeLocation: 1208,248,1
NodeSize: 64,40
ValueState: 2,1535,88,238,667,0,MIDM
Aliases: Alias Al1740514403, Alias Al1896002723
DisplayOutputs: Object Object, Object Variable

Index Forecast_Year1
Att_PrevIndexValue: [2022,2023,2024,2025,2026,2027,2028,2029,2030,2031,2032,2033,2034,2035,2036,2037,2038,2039,2040,2041,2042,2043,2044,2045,2046,2047,2048,2049,2050,2051]
Title: Forecast Year
Definition: Datepart(Forecast_Period[@Forecast_Period=1],'Y')..Datepart(Forecast_Period[@Forecast_Period=size(Forecast_Period)],'Y')
NodeLocation: 1352,144,1
NodeSize: 64,40
ValueState: 2,1025,121,226,634,0,MIDM
{!40300|Att_SlicerPopupSize: 237,448}

Variable Delta_MW_DC_PV_Impac
Title: Delta MW-DC PV Impact by Forecast Yr
Definition: Delta_MW_DC_Impact_f[Forecast_Period=PV_Time_at_End_of_Fo]
NodeLocation: 1064,248,1
NodeSize: 64,40
ValueState: 2,1954,47,985,586,1,MIDM
GraphSetup: Att_GraphIndexRange Forecast_Year1:1,,1,,,,,2021.7528445087373,2040.1110556721687,0
ReformVal: [Forecast_Year1,PV_Sectors]
Att__TotalsIndex: [PV_Sectors]
Att_ResultSliceState: [Test_PV_Incentive_W_,7,PV_Spatial_ID,1,Area_Type,1,PV_Sectors,1,Forecast_Year1,1]

Index A8760
Title: 8760
Definition: 1..8760
NodeLocation: 1208,360,1
NodeSize: 64,40
{!40300|Att_SlicerPopupSize: 227,1001}

FormNode Fo1646482595
Title: Last PV Period b4 Forecast Delta
Definition: 0
NodeLocation: 1392,24,1
NodeSize: 200,16
NodeInfo: 1,,,,,,,128,,,,,,0
Original: Last_PV_Period_b4_Fo

FormNode Fo304305315
Title: Last Period of Forecast Delta
Definition: 0
NodeLocation: 1392,56,1
NodeSize: 200,16
NodeInfo: 1,,,,,,,128,,,,,,0
Original: Last_Period_of_Forec

FormNode Fo1495487651
Title: Solar Hourly Impact
Definition: 1
NodeLocation: 1172,448,1
NodeSize: 172,16
Original: Solar_Hourly_Impact_

Alias Al1740514403
Title: PV Time at End of Forecast Yr
Definition: 1
NodeLocation: 1512,272,1
NodeSize: 64,40
Original: PV_Time_at_End_of_Fo

Close PV_Impacts

Module PV_Outputs
Title: PV Outputs
Author: JamesMilford
Date: Fri, Aug 17, 2018 11:09 AM
NodeLocation: 256,384,1
NodeSize: 64,40
NodeInfo: 1,0,0
DiagState: 2,27,58,1066,581,17
NodeColor: 57311,57311,57311
AcpStyles: Show_Object:no

FormNode Fo1534435166
Title: Rate Data by TOU Schedule
Definition: 1
NodeLocation: 260,84,1
NodeSize: 204,20
NodeColor: 65278,37008,6168
Original: Rate_Data_TOU_Sched

FormNode Fo1534438380
Title: Pre and Post Customer Load
Definition: 1
NodeLocation: 260,204,1
NodeSize: 204,20
NodeColor: 65278,37008,6168
Original: PrePost_Load_by_OpYr

Text Te1534438799
Title: Solar PV Financial Results
NodeLocation: 264,280,-1
NodeSize: 224,248
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

FormNode Fo1539221198
Title: Percent of Load Met by Solar
Definition: 1
NodeLocation: 260,124,1
NodeSize: 204,20
NodeColor: 65278,37008,6168
Original: Pct_Load_Met_bySolar

FormNode Fo1539221213
Title: Scaled Annual Net Load
Definition: 1
NodeLocation: 260,164,1
NodeSize: 204,20
NodeColor: 65278,37008,6168
Original: Scaled_Ann_Net_Load

FormNode Fo1539221811
Title: Simple Payback Time
Definition: 1
NodeLocation: 260,444,1
NodeSize: 204,20
NodeColor: 65278,37008,6168
Original: Simple_Payback_Time

FormNode Fo1539221820
Title: Cost of Electricity Ratio
Definition: 1
NodeLocation: 260,404,1
NodeSize: 204,20
NodeColor: 65278,37008,6168
Original: Cost_of_Elect_Ratio

FormNode Fo1539221825
Title: Cost of Electricity Comparison
Definition: 1
NodeLocation: 260,364,1
NodeSize: 204,20
NodeColor: 65278,37008,6168
Original: CostOf_Elect_Compare

FormNode Fo1539276353
Title: Installed Equipment Price
Definition: 1
NodeLocation: 260,324,1
NodeSize: 204,20
NodeColor: 65278,37008,6168
Original: Base_Installed_Cost_

FormNode Fo1544373571
Title: Bill Component Comparison
Definition: 1
NodeLocation: 260,284,1
NodeSize: 204,20
NodeColor: 65278,37008,6168
Original: FirstYr_Bill_by_Vint

Close PV_Outputs

Module Solar_Energy_Product
Title: Solar Energy Production
Author: JamesMilford
Date: Tue, Aug 21, 2018 2:56 PM
NodeLocation: 256,64,1
NodeSize: 64,40
NodeInfo: 1,0,0
DiagState: 2,12,58,1572,672,17,10
NodeColor: 65535,65535,65535
AcpStyles: FrameNode: Solar_Frame

Variable FirstYr_Annual_Solar
Title: First-Year Annual Solar
Units: kWh/year-system
Description: The annual energy production from a PV system in its first year of operation.
Definition: Sum(Levelized_Applied_So / Levelized_Degradatio * Applied_Monthly_Mult[Static_Profile_Names=Solar_Profile_Map_of], Profile_Hours, Month)
NodeLocation: 720,304,1
NodeSize: 64,40
WindState: 2,2116,132,720,350
ValueState: 2,2303,139,719,660,0,MIDM
Aliases: Alias Al1380248099
NodeColor: 65535,1,1
GraphSetup: Att_CatLineStyle Graph_Primary_Valdim:9
ReformVal: [PV_Climate_Zone,Undefined]
NumberFormat: 2,F,2,0,1,0,2,0,$,0,"ABBREV",0,,,0,0,15,
Att__TotalsIndex: [PV_Sectors,PV_Climate_Zone]
Att_ResultSliceState: [Area_Type,1,PV_Sectors,1,PV_Climate_Zone,1]
Att_ColorRole: Null
{!40600|Att_ClusterIndex: Null}

Variable Pct_Load_Met_bySolar
Title: Percent of Load Met by Solar
Units: fraction
Description: The percentage of annual customer consumption met by solar production.
Definition: Divide(FirstYr_Annual_Solar, Scaled_Annual_Load, True)
NodeLocation: 880,304,1
NodeSize: 64,40
ValueState: 2,715,119,753,701,0,MIDM
Aliases: FormNode Fo1539221198, FormNode Fo1572476392
GraphSetup: Att_CatLineStyle Graph_Primary_Valdim:9
ReformVal: [PV_Climate_Zone,PV_Sectors]
NumberFormat: 2,%,2,0,0,0,2,0,$,0,"ABBREV",0,,,0,0,15,
Att_ResultSliceState: [Area_Type,2,PV_Sectors,1,PV_Climate_Zone,1]
Att_ColorRole: Null
{!40600|Att_ClusterIndex: Null}

Alias Al1534881034
Title: Annual Load
Definition: 1
NodeLocation: 880,400,1
NodeSize: 64,40
Original: Scaled_Annual_Load

Variable Levelized_Degradatio
Title: Levelized Degradation Factor
Units: dmnls
Description: A time-series of solar output degradation factors.
Definition: Average_degradation_
NodeLocation: 560,400,1
NodeSize: 64,40
ValueState: 2,184,186,854,540,1,MIDM

Constant PV_Degradation_Rate
Title: PV Degradation Rate
Units: fraction/year
Description: The annual rate at which PV production declines.
Definition: SubTable(Single_Cell_Inputs[SingCell_Input_Names=Degradation_Label])
NodeLocation: 408,400,1
NodeSize: 64,40
Aliases: Alias Al1550179301, FormNode Fo1550179305, FormNode Fo1539715757
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15

FormNode Fo1539715757
Title: PV Degradation Rate
Definition: 0
NodeLocation: 408,452,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: PV_Degradation_Rate

Text Solar_Frame
NodeLocation: 1384,316,-20
NodeSize: 424,300
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus: yes~
Show_description:20

Variable Monthly_Solar
Title: Monthly Solar
Units: kW-hr/system
Description: The scaled hourly solar profiles by month of year.
Definition: Scaled_Hourly_Solar[Hours_8784=Monthly_Profile_Map] 
NodeLocation: 248,208,1
NodeSize: 64,40
ValueState: 2,346,48,1375,781,,MIDM
Aliases: Alias Al1571850056
GraphSetup: Att_GraphValueRange Monthly_Solar:1,,1,,,,,-0.29800040274858475,5.434707164764404,0~
Att_GraphIndexRange Month_Day_and_Hour:1,,1,,,,,143,306,1
ReformVal: [Month_Day_and_Hour,Month]
Att_ResultSliceState: [PV_Sectors,1,PV_Climate_Zone,2,Month,1,Month_Day_and_Hour,1]

Variable Day_Type_Solar
Title: Day Type Solar
Units: kW-hr/system
Description: The scaled solar profile by weekday and weekend days for each month. This is bounded to not go negative (ie, we ignore the very small parasitic loads).
Definition: MAX([0, Daily_Prof_with_Peak[Static_Profile_Names=Solar_Profile_Map_of, All_Day_Types=DayType_for_Type_Hr, Time_of_Day=Hour_for_Type_and_Hr]]) * Solar_Scaling_Factor
NodeLocation: 248,400,1
NodeSize: 64,40
WindState: 2,595,12,720,350
ValueState: 2,57,9,1303,772,0,MIDM
Aliases: Alias Al1571850057
Att_ResultSliceState: [PV_Sectors,1,Month,1,Day_Type_and_Hour,1]

Variable Weekly_Solar
Title: Weekly Solar
Units: kW-hr/system
Description: The average weekly solar profile scaled to the assumed new system size.
Definition: PerKW_Week_SolarProf * PV_DC_System_Size_fo 
NodeLocation: 248,304,1
NodeSize: 64,40
WindState: 2,101,546,913,350
ValueState: 2,108,-7,1310,671,,MIDM
Aliases: Alias Al1571850058

Module Solar_Profile_Scalin
Title: Solar Profile Scaling
Author: JamesMilford
Date: Fri, Oct 25, 2019 8:28 AM
NodeLocation: 88,248,1
NodeSize: 64,40
DiagState: 2,102,55,1507,631,17,10
AcpStyles: FrameNode: Solar_Scale_Frame

Variable Normal_Solar_Profile
Title: Normalized Solar Profile
Units: kW-hr/(kWh/year)
Description: The energy-normalized solar profile. This can be converted to a system profile by multiplying by the annual production of a given system. This is bounded to not go negative (ie, we ignore the very small parasitic loads).
Definition: VAR profile:=MAX([0, Daily_Prof_with_Peak[Static_Profile_Names=Solar_Profile_Map_of, All_Day_Types=Day_of_Week]]);~
VAR annualSum:=Profile_Annual_Total[Static_Profile_Names=Solar_Profile_Map_of];~
~
Divide(profile, annualSum)
NodeLocation: 96,128,1
NodeSize: 64,40
WindState: 2,82,289,1112,590
ValueState: 2,2065,70,1286,641,1,MIDM
GraphSetup: Att_CatLineStyle Graph_Primary_Valdim:5
ReformVal: [Time_of_Day,PV_Climate_Zone]
Att_ResultSliceState: [Month,7,PV_Spatial_ID,3,Day_of_Week,1,Time_of_Day,1]

Variable Solar_Profile_Map_of
Title: Solar Profile Map of Utility Selected
Description: The hourly solar profiles names for each sector and climate zone.
Definition: Solar_Profile_Map1[All_Utilities=Selected_Utility,All_PV_Sectors=PV_Sectors]
NodeLocation: 96,336,1
NodeSize: 64,40
WindState: 2,98,82,720,458
DefnState: 2,649,199,1062,346,0,DFNM
ValueState: 2,371,101,1138,698,0,MIDM
ReformDef: [PV_Climate_Zone,All_Sectors]
ReformVal: [PV_Climate_Zone,All_Sectors]
DisplayOutputs: Object Object, Object Decision

Constant PV_Capacity_Factor
Title: PV Capacity Factor
Units: %
Description: The PV capacity factor, which is the ratio of kWh-AC/yr to the (kW-DC of the system (X8760)).~
~
kWhA/yr / kWDC*8760
Definition: Table(All_Utilities,All_PV_Sectors,PV_Climate_Zone,Area_Type)(~
0.1577804248858446,~
0.14609422077625514,~
0.14609422077625514,~
0.1577804248858446,~
0.14609422077625514,~
0.14609422077625514,~
0.17070686392694057,~
0.1598380138127859,~
0.1598380138127859,~
0.17070686392694057,~
0.1598380138127859,~
0.1598380138127859,~
0.16554826289954302,~
0.1571865562785388,~
0.1571865562785388,~
0.16554826289954302,~
0.1571865562785388,~
0.1571865562785388)
NodeLocation: 256,336,1
NodeSize: 64,40
WindState: 2,433,146,866,441
DefnState: 2,531,150,656,669,0,DFNM
ValueState: 2,2279,170,1025,195,0,MIDM
Aliases: Alias Al1550179326, FormNode Fo1550179326
ReformDef: [Area_Type,All_PV_Sectors]
ReformVal: [All_Sectors,PV_Climate_Zone]
NumberFormat: 2,%,4,2,0,0,4,1,$,0,"ABBREV",0,,,0,0,15,
DisplayOutputs: Object Object, Object Decision
Att_ResultSliceState: [Area_Type,1,PV_Climate_Zone,1,All_PV_Sectors,1]
Att_EditSliceState: [PV_Climate_Zone,4,All_PV_Sectors,1,Area_Type,2]

Variable PV_Production_per_kW
Title: PV Production per kW DC
Units: (kWh/year)/kW-DC
Description: The annual energy produced per kW-DC of installed solar.
Definition: PV_Capacity_Factor[All_PV_Sectors=PV_Sectors,All_Utilities=Selected_Utility] * Hours_per_Year
NodeLocation: 416,336,1
NodeSize: 64,40
ValueState: 2,2295,194,569,198,0,MIDM
Aliases: Alias Al1534084643, Alias Al1911116963, Alias Al1775675667
ReformVal: [Null,PV_Sectors]
NumberFormat: 2,F,2,1,1,0,2,0,$,0,"ABBREV",0,,,0,0,15,
DisplayOutputs: Object Object, Object Variable
Att__TotalsIndex: []
Att_ResultSliceState: [PV_Climate_Zone,1,Area_Type,1,PV_Sectors,1]

Variable Per_kW_SolarProfie
Title: Per-kW Solar Profile
Units: kW-hr/kW-DC
Description: The solar profile per kW-DC of rated capacity.
Definition: Normal_Solar_Profile * PV_Production_per_kW
NodeLocation: 416,128,1
NodeSize: 64,40
ValueState: 2,117,0,1399,658,1,MIDM
GraphSetup: Att_CatLineStyle Graph_Primary_Valdim:5
ReformVal: [Time_of_Day,PV_Spatial_ID]
Att_ResultSliceState: [Day_of_Week,1,PV_Sectors,2,PV_Climate_Zone,1,Month,1,Time_of_Day,1]

Variable PerKW_Week_SolarProf
Title: Per-kW Weekly Solar Profile
Units: kW-hr/kW-DC
Description: The weekly solar profile per kW-DC of installed capacity.
Definition: Reindex_to_Week(Per_kW_SolarProfie)
NodeLocation: 568,128,1
NodeSize: 64,40
ValueState: 2,351,200,1103,527,1,MIDM
ReformVal: [Day_and_Hour,Area_Type]
Att_GraphValueRange: 1,,,,,,10
Att_ResultSliceState: [Month,8,PV_Sectors,1,PV_Climate_Zone,1,Area_Type,3,Day_and_Hour,1]

Variable Avg_Daily_PV_by_Mth
Title: Avg Daily PV by Month
Units: kW-hr/customer
Description: The average daily solar profile within a given month.
Definition: VAR dayCnt_weight:=Divide(Solar_Day_Counts, Sum(Solar_Day_Counts, Day_of_Week), True);   {Weights representing the number of times a particular day shows up in a month}~
~
Sum(Per_kW_SolarProfie * PV_DC_System_Size_fo * dayCnt_weight, Day_of_Week)
NodeLocation: 568,232,1
NodeSize: 64,40
WindState: 2,241,362,720,350
ValueState: 2,210,85,978,688,1,MIDM
GraphSetup: Att_GraphValueRange Avg_Daily_PV_by_Mth:1,,1,,,,,0,0.7000000000000001,0
ReformVal: [Time_of_Day,Month]
Att_ResultSliceState: [PV_Sectors,1,PV_Climate_Zone,1,Month,7,Time_of_Day,1]

Variable Solar_Day_Counts
Title: Solar Day Counts
Units: days/year
Description: The day counts for the solar profiles.
Definition: Applied_Day_Counts[All_Day_Types=Day_of_Week, Static_Profile_Names=Solar_Profile_Map_of[All_Sectors=PV_Sectors]]
NodeLocation: 256,232,1
NodeSize: 64,40
WindState: 2,102,82,1124,434
ValueState: 2,72,74,727,525,,MIDM
Aliases: Alias Al1584657767
Att_ResultSliceState: [PV_Climate_Zone,1,All_Sectors,1,Day_of_Week,1,Month,1]

Variable AvgPeakLoad_per_kWdc
Title: Avg Peak Load per kW-DC
Units: kW-hr/kW-DC
Description: The average PV output per kW-DC of nameplate capacity during peak periods.
Definition: VAR load_in_peak:=IF Peak_Periods~
   THEN PerKW_Week_SolarProf~
   ELSE Null;~
~
Average(load_in_peak, Month, Day_and_Hour)
NodeLocation: 720,128,1
NodeSize: 64,40
WindState: 2,-3,77,720,350
ValueState: 2,224,134,829,627,0,MIDM
ReformVal: [Start_of_Year,Spatial_IDs]
Att__TotalsIndex: [Spatial_IDs]
Att_ResultSliceState: [Spatial_IDs,0,Start_of_Year,1]

Variable Solar_Scaling_Factor
Title: Solar Scaling Factor
Units: dimensionless
Description: A scaling factor to convert the annual energy represented by the 8760 solar profiles to the annual energy assumed for a new PV system.~
~
Maybe not right, but only applies to day or month optimization types
Definition: VAR totSolar:=Sum(Select_Hrly_Profiles[Selected_Profiles=Solar_Profile_Map1[All_PV_Sectors=PV_Sectors,All_Utilities=Selected_Utility]], Hours_8784);   {For normalizing by total annual energy production}~
~
Divide(PV_Production_per_kW * PV_DC_System_Size_fo, totSolar)   {Scaled by per-kW system production, per-system size, and normalized by total annual energy production}
NodeLocation: 568,464,1
NodeSize: 64,40
WindState: 2,-7,7,1503,350
ValueState: 2,906,197,737,684,0,MIDM
NodeColor: 65535,1,1
ReformVal: [PV_Climate_Zone,PV_Sectors]
Att__TotalsIndex: []
Att_ResultSliceState: [Area_Type,1,PV_Sectors,1,PV_Climate_Zone,1]

Alias Al1571850383
Title: PV DC System Size for Economics
Definition: 1
NodeLocation: 568,336,1
NodeSize: 64,40
Original: PV_DC_System_Size_fo

Text Solar_Scale_Frame
NodeLocation: 1224,316,-20
NodeSize: 424,300
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus: yes~
Show_description:20

Text Te749809187
Title: Maybe not right, but only applies to day or month optimization types
NodeLocation: 292,496,-1
NodeSize: 100,64

Variable Va17
NodeLocation: 712,400,1
NodeSize: 64,40

Constant Solar_Profile_Map1
Title: Solar Profile Map
Description: The hourly solar profiles names for each sector and climate zone.
Definition: Table(All_Utilities,All_PV_Sectors,PV_Climate_Zone)(~
'VA Res (W-hr/system)',~
'VA Non-Res (W-hr/system)',~
'VA Non-Res (W-hr/system)',~
'VA Res (W-hr/system)',~
'VA Non-Res (W-hr/system)',~
'VA Non-Res (W-hr/system)',~
'NC Res (W-hr/system)',~
'NC Non-Res (W-hr/system)',~
'NC Non-Res (W-hr/system)',~
'NC Res (W-hr/system)',~
'NC Non-Res (W-hr/system)',~
'NC Non-Res (W-hr/system)',~
'SC Res (W-hr/system)',~
'SC Non-Res (W-hr/system)',~
'SC Non-Res (W-hr/system)',~
'SC Res (W-hr/system)',~
'SC Non-Res (W-hr/system)',~
'SC Non-Res (W-hr/system)')
NodeLocation: 104,464,1
NodeSize: 64,40
WindState: 2,98,82,720,458
DefnState: 2,649,199,1062,346,0,DFNM
ValueState: 2,371,101,1138,698,0,MIDM
ReformDef: [PV_Climate_Zone,All_Sectors]
ReformVal: [All_PV_Sectors,All_Utilities]
Att_ResultSliceState: [PV_Climate_Zone,1,All_Utilities,1,All_PV_Sectors,1]
Att_EditSliceState: [All_PV_Sectors,1,All_Utilities,1,PV_Climate_Zone,1]

Close Solar_Profile_Scalin

Variable Scaled_Hourly_Solar
Title: Scaled Hourly Solar
Units: kW-hr/system
Description: The scaled solar profile by hour of the year. This is bounded to not go negative (ie, we ignore the very small parasitic loads).
Definition: VAR profile:=MAX([0, Select_Hrly_Profiles[Selected_Profiles=Solar_Profile_Map_of]]);~
~
profile * Solar_Scaling_Factor
NodeLocation: 248,112,1
NodeSize: 64,40
ValueState: 2,662,118,790,689,0,MIDM
ReformVal: [PV_Climate_Zone,PV_Sectors]
NumberFormat: 2,F,2,0,1,0,2,0,$,0,"ABBREV",0,,,0,0,15,
Att__TotalsIndex: [Hours_8784]
Att_ResultSliceState: [Hours_8784,0,PV_Sectors,2,PV_Climate_Zone,2]
Att_ColorRole: Null

Alias Al1571850213
Title: Selected Profile Granularity
Definition: 1
NodeLocation: 560,208,1
NodeSize: 64,40
Original: Sel_Profile_Granular

FormNode Fo1571850212
Title: Selected Profile Granularity
Definition: 0
NodeLocation: 564,152,1
NodeSize: 132,16
NodeInfo: 1,0,0,0,0,0,0,214,0,,0,,,0
Original: Sel_Profile_Granular

Alias Al1571850241
Title: Applied Solar Profile
Definition: 1
NodeLocation: 560,304,1
NodeSize: 64,40
Original: Levelized_Applied_So

Alias Al1571851253
Title: Solar Profile Handles
Definition: 1
NodeLocation: 408,304,1
NodeSize: 64,40
NodeColor: 19661,48336,65535
Original: Solar_Profile_Handle

Variable Lev_Solar_Profile
Title: Levelized Solar Profile
Units: lev kW-hr/system
Description: The solar profile levelized over all years in the system lifetime.
Definition: Levelized_Applied_So
NodeLocation: 720,400,1
NodeSize: 64,40
WindState: 2,517,8,1275,405
ValueState: 2,84,590,1591,811,0,MIDM
Aliases: Alias Al1571852559
NodeColor: 65535,1,1
ReformVal: [Profile_Hours,PV_Climate_Zone]
Att_ResultSliceState: [Month,7,PV_Sectors,29,PV_Climate_Zone,2,Profile_Hours,1]

Variable NPV_of_Solar_Product
Title: NPV of Solar Production
Units: level kWh/year/system
Definition: local annual_solar:=sum(Lev_Solar_Profile * Weeks_Per_Month, Month, Profile_Hours);~
PV(Nominal_Equity_Rate, Economic_Lifetime,-annual_solar )
NodeLocation: 720,512,1
NodeSize: 64,40
ValueState: 2,111,118,970,707,0,MIDM
Aliases: Alias Al1047325219
NodeColor: 65535,1,1
ReformVal: [PV_Climate_Zone,PV_Sectors]
NumberFormat: 2,F,2,0,1,0,2,0,$,0,"ABBREV",0,,,0,0,15,
Att__TotalsIndex: [PV_Climate_Zone,PV_Sectors,Area_Type]
Att_ResultSliceState: [Area_Type,0,PV_Sectors,1,PV_Climate_Zone,1]

Variable Average_degradation_
Title: Average degradation over life
Definition: Average((1-PV_Degradation_Rate)^(PV_Operating_Year-1),PV_Operating_Year)
NodeLocation: 560,512,1
NodeSize: 64,40
ValueState: 2,636,237,416,303,,MIDM

Variable Va27
Definition: FirstYr_Annual_Solar / Storage_Max_Power
NodeLocation: 888,528,1
NodeSize: 64,40
ValueState: 2,735,157,870,690,0,MIDM
ReformVal: [PV_Climate_Zone,PV_Sectors]
Att_ResultSliceState: [System_Types,2,Area_Type,2,PV_Sectors,1,PV_Climate_Zone,1]

Text Te1761380643
Title: Already levelized. Fix
NodeLocation: 696,72,-1
NodeSize: 64,40

Variable Va28
Definition: Sum(Levelized_Applied_So / Levelized_Degradatio * Applied_Monthly_Mult[Static_Profile_Names=Solar_Profile_Map_of[All_Sectors=PV_Sectors]], Profile_Hours, Month)
NodeLocation: 880,208,1
NodeSize: 64,40
ValueState: 2,459,262,1100,575,0,MIDM
ReformVal: [PV_Climate_Zone,PV_Sectors]
NumberFormat: 2,F,2,0,1,0,2,0,$,0,"ABBREV",0,,,0,0,15,

Close Solar_Energy_Product

Module Customer_Load
Title: Customer Load
Author: JamesMilford
Date: Tue, Aug 21, 2018 2:56 PM
NodeLocation: 112,64,1
NodeSize: 64,40
NodeInfo: 1,0,0
DiagState: 2,62,44,1734,589,17,10
Aliases: Alias Al1579800542
NodeColor: 65535,65535,65535
AcpStyles: FrameNode: Load_Frame

Variable Weekly_Customer_Load
Title: Weekly Customer Load
Units: kW-hr/customer
Description: The weekly customer load scaled to its final assumed levels.
Definition: Weekly_Nrml_Loadshap * Annual_Load
NodeLocation: 416,344,1
NodeSize: 64,40
WindState: 2,102,81,1099,351
ValueState: 2,12,56,1487,691,0,MIDM
Aliases: Alias Al1552430385
GraphSetup: Att_GraphValueRange Weekly_Customer_Load:1,,0,,,,,0,2624.838173389435,0~
Att_CatLineStyle Graph_Primary_Valdim:5~
Graph_AxisLabelFont:,18,0~
Graph_KeyTitleFont:,18,1~
Graph_KeyFont:,18,0~
Graph_AxisTitleFont:Arial,18,1
Att__TotalsIndex: [Day_and_Hour]
Att_ResultSliceState: [PV_Climate_Zone,3,Month,3,PV_Sectors,2,Day_and_Hour,1]

Variable Load_Net_of_Solar
Title: Load Net of Solar
Units: kW-hr/customer
Description: The load net of solar per system.
Definition: Applied_Load_Profile - Levelized_Applied_So
NodeLocation: 736,240,1
NodeSize: 64,40
WindState: 2,139,2,1190,503
ValueState: 2,155,293,1487,515,0,MIDM
GraphSetup: Graph_AxisTitleFont:Arial,18,1~
Graph_KeyFont:,18,0~
Graph_KeyTitleFont:,18,1~
Graph_AxisLabelFont:,14,0~
Att_CatLineStyle Graph_Primary_Valdim:5
ReformVal: [Profile_Hours,Month]
Att__TotalsIndex: [Day_and_Hour]
Att_ResultSliceState: [PV_Sectors,1,PV_Climate_Zone,1,Area_Type,1,Month,1,Profile_Hours,1]

Objective PrePost_Load_by_OpYr
Title: Pre/Post Load by OpYr
Units: kW-hr/customer
Description: Customer load before and after installation of a system. The PV Operating Year index captures PV system degradation over the life of the system, consistent with the input for PV_degradation_rate.
Definition: Table(Pre_and_Post_System)(Pre_System_Load,Net_Load)
NodeLocation: 1056,192,1
NodeSize: 64,40
WindState: 2,546,219,720,350
DefnState: 2,1094,392,416,303,0,DFNM
ValueState: 2,90,67,1695,643,1,MIDM
Aliases: FormNode Fo1534438380, Alias Al733264035, FormNode Fo1572476391
NodeColor: 19661,48336,65535
GraphSetup: Graph_AxisLabelFont:,14,0~
Att_CatLineStyle Graph_Primary_Valdim:5~
Att_AreaFill Graph_Primary_Valdim:0~
Att_Stacked_Lines Graph_Primary_Valdim:0~
Att_GraphValueRange PrePost_Load_by_OpYr:1,,1,,,,10,0,421.10850512981415,0
ReformVal: [Profile_Hours,Pre_and_Post_System]
Att__TotalsIndex: [Profile_Hours]
Att_GraphValueRange: 1,,,,,,10
Att_ResultSliceState: [PV_Climate_Zone,1,System_Types,3,PV_Sectors,2,Area_Type,1,Month,8,Pre_and_Post_System,1,Profile_Hours,1]

Variable Scaled_Annual_Load
Title: Scaled Annual Load
Units: kWh/year-customer
Description: The annual consumption per customer.
Definition: Sum(Applied_Load_Profile * Load_Monthly_Mults, Profile_Hours, Month)
NodeLocation: 896,344,1
NodeSize: 64,40
WindState: 2,2128,112,720,350
ValueState: 2,2710,131,970,667,0,MIDM
Aliases: Alias Al1534881034
GraphSetup: Att_CatLineStyle Graph_Primary_Valdim:9
ReformVal: [Undefined,PV_Sectors]
NumberFormat: 2,F,2,0,1,0,2,0,$,0,"ABBREV",0,,,0,0,15,
Att__TotalsIndex: [PV_Sectors,PV_Climate_Zone]
Att_ResultSliceState: [PV_Sectors,1,PV_Sectors,2,PV_Climate_Zone,1]
Att_ColorRole: Null
{!40600|Att_ClusterIndex: Null}

Variable Scaled_Ann_Net_Load
Title: Scaled Annual Net Load
Units: kWh/year-cust
Description: The annual net consumption per customer per year of the system lifetime.
Definition: Sum(PrePost_Load_by_OpYr * Load_Monthly_Mults, Profile_Hours, Month)
NodeLocation: 1056,344,1
NodeSize: 64,40
ValueState: 2,94,131,791,671,0,MIDM
Aliases: FormNode Fo1539221213, FormNode Fo1572476393
GraphSetup: Att_StackedBar Graph_Primary_Valdim:0~
Att_CatLineStyle Graph_Primary_Valdim:9
ReformVal: [PV_Climate_Zone,0]
NumberFormat: 2,F,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [PV_Sectors,1,Pre_and_Post_System,1,PV_Operating_Year,1,PV_Climate_Zone,1]
{!40600|Att_ClusterIndex: Energy_Met_by_Solar}

Variable Avg_DailyLoad_by_Mth
Title: Avg Daily Pre/Post Load by Month
Units: kW-hr/customer
Description: The average daily customer load within a given month and by weekday or weekend.
Definition: VAR agProfile:=Aggregate(PrePost_Load_by_OpYr, Map_Prof_DayType_Hr, Profile_Hours, Day_Type_and_Hour, type: "Average");~
~
agProfile[Day_Type_and_Hour=DayType_and_Hour_Map]
NodeLocation: 1056,88,1
NodeSize: 64,40
WindState: 2,320,19,1220,541
ValueState: 2,333,30,974,681,1,MIDM
GraphSetup: Att_GraphValueRange Avg_DailyLoad_by_Mth:1,,1,,,,,0,0.7000000000000001,0
ReformVal: [Time_of_Day,Pre_and_Post_System]
Att_ResultSliceState: [PV_Sectors,2,PV_Climate_Zone,1,PV_Operating_Year,1,Rate_Vintage,1,System_Types,1,Weekday_or_Weekend,2,Month,7,Pre_and_Post_System,2,Time_of_Day,1]

Text Load_Frame
NodeLocation: 1688,320,-20
NodeSize: 360,304
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus: yes~
Show_description:20

Variable Load_Net_of_Storage
Title: Load Net of Storage
Units: kW-hr/customer
Description: The customer load net of the impacts from storage. Results are only available for systems with storage.
Definition: VAR netOfStorage:=IF Estim_Storage_Add_On AND (Storage_Systems = Storage_Added_Label)~
   THEN Reindex_to_ProfileHr(StorageSyst_Net_Loa2[Opt_Storage_Systems=PV_Strg_Retro_Label, Opt_Sectors=PV_Sectors])~
   ELSE Reindex_to_ProfileHr(StorageSyst_Net_Loa2[Opt_Storage_Systems=Storage_Systems, Opt_Sectors=PV_Sectors]);~
~
IF System_with_Storage   {If a storage system}~
THEN netOfStorage[Storage_Systems=System_Types]   {Then use the load net of storage}~
ELSE Load_Net_of_Solar   {Else use the load net of solar}~

NodeLocation: 736,136,1
NodeSize: 64,40
WindState: 2,162,61,1683,659
ValueState: 2,259,91,1222,764,0,MIDM
ReformVal: [Profile_Hours,Month]
Att_ResultSliceState: [PV_Sectors,2,PV_Climate_Zone,1,System_Types,3,Area_Type,1,Rate_Vintage,1,Month,7,Profile_Hours,1]

Variable Net_Load
Title: Net Load
Units: kW-hr/customer
Description: The net customer load after solar and/or storage.~
~
!!Note: the storage optimization will actually change the definition of this variable to completely break the linkage to Load_Net_of_Storage with the effect being identical to the definition shown below!!
Definition: Load_Net_of_Solar
NodeLocation: 896,136,1
NodeSize: 64,40
WindState: 2,18,322,1163,505
ValueState: 2,200,45,1319,769,0,MIDM
ReformVal: [Profile_Hours,System_Types]
Att_ResultSliceState: [PV_Sectors,22,PV_Climate_Zone,2,Month,1,Area_Type,1,PV_Operating_Year,1,Profile_Hours,1]

Variable PrePost_Load_Strg
Title: Pre and Post Customer Load
Units: kW-hr/customer
Description: Customer load before and after installation of a system. The PV Operating Year index captures PV system degradation over the life of the system, consistent with the input for PV_degradation_rate.
Definition: PrePost_Load_by_OpYr[Rate_Vintage=RateVint_by_RateName, Pre_and_Post_System=Pre_or_Post_by_Syst, System_Types=SystType_for_System]
NodeLocation: 1216,240,1
NodeSize: 64,40
WindState: 2,394,15,1122,599
ValueState: 2,217,108,1179,665,0,MIDM
NodeColor: 19661,48336,65535
GraphSetup: Att_Stacked_Lines Graph_Primary_Valdim:0~
Att_AreaFill Graph_Primary_Valdim:0~
Att_CatLineStyle Graph_Primary_Valdim:5~
Graph_AxisLabelFont:,14,0~
Graph_AxisTitleFont:Arial,18,1~
Graph_KeyTitleFont:,18,1~
Graph_KeyFont:,18,0~
ShowKey:1
ReformVal: [Month,System_Type]
Att__TotalsIndex: []
Att_ResultSliceState: [PV_Sectors,1,PV_Climate_Zone,1,Rate_Names_and_Start,2,Area_Type,1,Profile_Hours,44,System_Type,1,Month,7]

Variable Pre_System_Load
Title: Pre System Load
Units: kW-hr/customer
Description: The customer load prior to installing the system specified.
Definition: IF System_Types = Storage_Added_Label~
THEN Load_Net_of_Solar~
ELSE Applied_Load_Profile
NodeLocation: 896,240,1
NodeSize: 64,40
WindState: 2,17,317,720,350
ValueState: 2,198,21,1430,555,0,MIDM
Aliases: Alias Al1571847186
ReformVal: [Month,System_Types]
Att__TotalsIndex: [Profile_Hours]
Att_ResultSliceState: [PV_Sectors,1,PV_Climate_Zone,1,Profile_Hours,0,System_Types,1,Month,1]

Variable PrePost_Load_Solar
Title: Pre and Post Customer Load
Units: kW-hr/customer
Description: Customer load before and after installation of a system in the first operating year (subsequent operating years account for degradation but are not shown in this particular output). Results shown here are for the rate vintage selected via the input "Rate Vintage for GUI," and is typically the latest rate.
Definition: PrePost_Load_by_OpYr[PV_Operating_Year=1, Rate_Vintage=RateVint_by_RateName]
NodeLocation: 1216,136,1
NodeSize: 64,40
ValueState: 2,2066,18,1535,841,1,MIDM
Aliases: FormNode Fo1582589389
GraphSetup: Att_CatLineStyle Graph_Primary_Valdim:5~
ShowKey:2~
Att_GraphValueRange PrePost_Load_Solar:1,,1,,,,,0,4073.3012557029724,0
ReformVal: [Profile_Hours,Pre_and_Post_System]
Att__TotalsIndex: []
Att_ResultSliceState: [Rate_Names_and_Start,6,Month,8,PV_Climate_Zone,1,PV_Sectors,1,System_Types,2,Area_Type,1,Pre_and_Post_System,2,Profile_Hours,1]

Module Profile_Creation
Title: Profile Creation
Author: JamesMilford
Date: Wed, May 1, 2019 11:53 AM
NodeLocation: 576,344,1
NodeSize: 64,40
NodeInfo: 1,1,0,1,1,1,0,,0,,0,,,
DiagState: 2,158,0,1612,650,17,10
AcpStyles: FrameNode: Profile_Frame

Alias Al1557428073
Title: Selected Profile Granularity
Definition: 1
NodeLocation: 560,80,1
NodeSize: 64,40
Original: Sel_Profile_Granular

FormNode Fo1557428073
Title: Selected Profile Granularity
Definition: 0
NodeLocation: 564,32,1
NodeSize: 132,16
NodeInfo: 1,0,0,0,0,0,0,214,0,,0,,,0
Original: Sel_Profile_Granular

Alias Al1552430385
Title: Scaled Weekly Customer Load
Definition: 1
NodeLocation: 256,176,1
NodeSize: 64,40
Original: Weekly_Customer_Load

Objective Load_Profile_Handles
Title: Load Profile Handles
Description: Handles to the load profiles for each profile granularity.
Definition: Table(Profile_Granularity)(Handle(Monthly_Cust_Load),Handle(Weekly_Customer_Load),Handle(DayType_Cust_Load))
NodeLocation: 408,176,1
NodeSize: 64,40
DefnState: 2,276,282,567,303,0,DFNM
NodeColor: 19661,48336,65535

Variable Applied_Load_Profile
Title: Applied Load Profile
Units: kW-hr/customer
Description: The customer load profile for the selected profile granularity.
Definition: LocalAlias hours:=Hours_Index_Handles[Profile_Granularity=Sel_Profile_Granular];~
VAR profile:=Load_Profile_Handles[Profile_Granularity=Sel_Profile_Granular];~
~
profile[hours=Profile_Hours]
NodeLocation: 560,176,1
NodeSize: 64,40
WindState: 2,98,82,796,378
ValueState: 2,244,189,1438,595,1,MIDM
Aliases: Alias Al1571846275
GraphSetup: Att_CatLineStyle Graph_Primary_Valdim:5~
{!50000|Graph_SortBySpread:0}
ReformVal: [Profile_Hours,PV_Sectors]
Att_ResultSliceState: [PV_Sectors,2,Month,1,PV_Climate_Zone,3,Profile_Hours,1]

Objective Solar_Profile_Handle
Title: Solar Profile Handles
Description: Handles to the solar profiles for each profile granularity
Definition: Table(Profile_Granularity)(Handle(Monthly_Solar),Handle(Weekly_Solar),Handle(Day_Type_Solar))
NodeLocation: 408,464,1
NodeSize: 64,40
ValueState: 2,2320,179,416,303,0,MIDM
Aliases: Alias Al1571851253
NodeColor: 19661,48336,65535

Variable Levelized_Applied_So
Title: Levelized Applied Solar Profile
Units: kW-hr/system
Description: The solar generation profile for the selected profile granularity. This includes degradation of solar output in each year of the system lifetime.
Definition: LocalAlias hours:=Hours_Index_Handles[Profile_Granularity=Sel_Profile_Granular];~
VAR profile:=Solar_Profile_Handle[Profile_Granularity=Sel_Profile_Granular];~
~
profile[hours=Profile_Hours] * Levelized_Degradatio
NodeLocation: 560,464,1
NodeSize: 64,40
WindState: 2,24,55,720,350
ValueState: 2,85,338,1447,602,0,MIDM
Aliases: Alias Al1571850241
ReformVal: [PV_Operating_Year,PV_Climate_Zone]
Att__TotalsIndex: [Profile_Hours]
Att_ResultSliceState: [PV_Sectors,29,Month,7,Area_Type,1,PV_Climate_Zone,1,Profile_Hours,0]

Objective Hours_Index_Handles
Title: Hours Index Handles
Description: Handles to the time dimensions used for each profile granularity.
Definition: Table(Profile_Granularity)(Handle(Month_Day_and_Hour),Handle(Day_and_Hour),Handle(Day_Type_and_Hour))
NodeLocation: 560,328,1
NodeSize: 64,40
WindState: 2,50,25,720,538
DefnState: 2,548,554,608,303,0,DFNM
ValueState: 2,909,439,416,303,0,MIDM
NodeColor: 19661,48336,65535

Index Profile_Hours
Att_PrevIndexValue: ['Sun:12am-1am','Sun:1am-2am','Sun:2am-3am','Sun:3am-4am','Sun:4am-5am','Sun:5am-6am','Sun:6am-7am','Sun:7am-8am','Sun:8am-9am','Sun:9am-10am','Sun:10am-11am','Sun:11am-12pm','Sun:12pm-1pm','Sun:1pm-2pm','Sun:2pm-3pm','Sun:3pm-4pm','Sun:4pm-5pm','Sun:5pm-6pm','Sun:6pm-7pm','Sun:7pm-8pm','Sun:8pm-9pm','Sun:9pm-10pm','Sun:10pm-11pm','Sun:11pm-12am','Mon:12am-1am','Mon:1am-2am','Mon:2am-3am','Mon:3am-4am','Mon:4am-5am','Mon:5am-6am','Mon:6am-7am','Mon:7am-8am','Mon:8am-9am','Mon:9am-10am','Mon:10am-11am','Mon:11am-12pm','Mon:12pm-1pm','Mon:1pm-2pm','Mon:2pm-3pm','Mon:3pm-4pm','Mon:4pm-5pm','Mon:5pm-6pm','Mon:6pm-7pm','Mon:7pm-8pm','Mon:8pm-9pm','Mon:9pm-10pm','Mon:10pm-11pm','Mon:11pm-12am','Tue:12am-1am','Tue:1am-2am','Tue:2am-3am','Tue:3am-4am','Tue:4am-5am','Tue:5am-6am','Tue:6am-7am','Tue:7am-8am','Tue:8am-9am','Tue:9am-10am','Tue:10am-11am','Tue:11am-12pm','Tue:12pm-1pm','Tue:1pm-2pm','Tue:2pm-3pm','Tue:3pm-4pm','Tue:4pm-5pm','Tue:5pm-6pm','Tue:6pm-7pm','Tue:7pm-8pm','Tue:8pm-9pm','Tue:9pm-10pm','Tue:10pm-11pm','Tue:11pm-12am','Wed:12am-1am','Wed:1am-2am','Wed:2am-3am','Wed:3am-4am','Wed:4am-5am','Wed:5am-6am','Wed:6am-7am','Wed:7am-8am','Wed:8am-9am','Wed:9am-10am','Wed:10am-11am','Wed:11am-12pm','Wed:12pm-1pm','Wed:1pm-2pm','Wed:2pm-3pm','Wed:3pm-4pm','Wed:4pm-5pm','Wed:5pm-6pm','Wed:6pm-7pm','Wed:7pm-8pm','Wed:8pm-9pm','Wed:9pm-10pm','Wed:10pm-11pm','Wed:11pm-12am','Thu:12am-1am','Thu:1am-2am','Thu:2am-3am','Thu:3am-4am','Thu:4am-5am','Thu:5am-6am','Thu:6am-7am','Thu:7am-8am','Thu:8am-9am','Thu:9am-10am','Thu:10am-11am','Thu:11am-12pm','Thu:12pm-1pm','Thu:1pm-2pm','Thu:2pm-3pm','Thu:3pm-4pm','Thu:4pm-5pm','Thu:5pm-6pm','Thu:6pm-7pm','Thu:7pm-8pm','Thu:8pm-9pm','Thu:9pm-10pm','Thu:10pm-11pm','Thu:11pm-12am','Fri:12am-1am','Fri:1am-2am','Fri:2am-3am','Fri:3am-4am','Fri:4am-5am','Fri:5am-6am','Fri:6am-7am','Fri:7am-8am','Fri:8am-9am','Fri:9am-10am','Fri:10am-11am','Fri:11am-12pm','Fri:12pm-1pm','Fri:1pm-2pm','Fri:2pm-3pm','Fri:3pm-4pm','Fri:4pm-5pm','Fri:5pm-6pm','Fri:6pm-7pm','Fri:7pm-8pm','Fri:8pm-9pm','Fri:9pm-10pm','Fri:10pm-11pm','Fri:11pm-12am','Sat:12am-1am','Sat:1am-2am','Sat:2am-3am','Sat:3am-4am','Sat:4am-5am','Sat:5am-6am','Sat:6am-7am','Sat:7am-8am','Sat:8am-9am','Sat:9am-10am','Sat:10am-11am','Sat:11am-12pm','Sat:12pm-1pm','Sat:1pm-2pm','Sat:2pm-3pm','Sat:3pm-4pm','Sat:4pm-5pm','Sat:5pm-6pm','Sat:6pm-7pm','Sat:7pm-8pm','Sat:8pm-9pm','Sat:9pm-10pm','Sat:10pm-11pm','Sat:11pm-12am']
Title: Profile Hours
Description: The profile hours selected for use in the dispatch routines.
Definition: VAR hours:=Hours_Index_Handles[Profile_Granularity=Sel_Profile_Granular];~
~
CopyIndex(hours)
NodeLocation: 416,328,1
NodeSize: 64,40
ValueState: 2,558,319,591,533,0,MIDM
{!40300|Att_SlicerPopupSize: 232,1001}

Variable DayType_Day_Counts
Title: Day Type Day Counts
Units: days/month
Description: The count of days per month by Day Type. This is for an average year (e.g., 365.25 days/year).
Definition: DaysPerMonth_DayType[Weekday_or_Weekend=DayType_for_Type_Hr] * Applied_Avg_to_Peak[All_Day_Types=DayType_for_Type_Hr]
NodeLocation: 256,872,1
NodeSize: 64,40
WindState: 2,98,82,915,350
ValueState: 2,10,9,1803,662,0,MIDM

Objective Day_Count_Handles
Title: Day Count Handles
Description: Handles to the day counts for each profile granularity.
Definition: Table(Profile_Granularity)(Handle(Monthly_Day_Counts),Handle(Weekly_Day_Counts),Handle(DayType_Day_Counts))
NodeLocation: 408,776,1
NodeSize: 64,40
DefnState: 2,500,506,470,303,0,DFNM
NodeColor: 19661,48336,65535

Variable Load_Monthly_Mults
Title: Load Monthly Mults
Units: dimensionless
Description: Multipliers to adjust the modeled hours in the optimization window to the number of similar hours that would occur across the entire month.
Definition: Applied_Monthly_Mult[Static_Profile_Names=Loadshape_Map_of_Uti[All_Sectors=PV_Sectors]]
NodeLocation: 712,776,1
NodeSize: 64,40
ValueState: 2,225,104,1438,668,0,MIDM
ReformVal: [Profile_Hours,Month]
Att_ResultSliceState: [PV_Sectors,30,Month,1,Profile_Hours,1]

Variable Monthly_Day_Counts
Title: Monthly Day Counts
Units: days/month
Description: The count of days per month for each day in a month. This does not require any dimensionality because it does not vary by month.
Definition: 1
NodeLocation: 256,680,1
NodeSize: 64,40

Variable Monthly_Mults_SeqOpt
Title: Monthly Mults for Seq Opt
Units: dimensionless
Description: Multipliers to adjust the modeled hours in the optimization window to the number of similar hours that would occur across the entire month. These are reindexed to the dimensionality of the sequential optimization.
Definition: Load_Monthly_Mults[Profile_Hours=Opt_Hours_for_SeqOpt]
NodeLocation: 864,776,1
NodeSize: 64,40
WindState: 2,90,421,1074,502
ValueState: 2,245,206,1410,539,0,MIDM
Att_ResultSliceState: [Seq_Opt_Number,1,Month,1,Opt_Hours,1]

Module Profile_Time_Maps
Title: Profile Time Maps
Author: JamesMilford
Date: Tue, Oct 22, 2019 3:50 PM
NodeLocation: 744,56,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,211,62,1427,403,17

Variable Day_of_Month_8784
Title: Day of Month 8784
Units: day of month
Description: Day of month for each of the 8784 hours of the year. This accounts for extra days included in hourly profiles coming from leap years. 
Definition: DatePart(Date_By_8784, 'D') * Nulls_for_NonLeapYr
NodeLocation: 112,192,1
NodeSize: 64,40
WindState: 2,98,82,909,449
ValueState: 2,71,294,1095,587,0,MIDM
ReformVal: [Selected_Profiles,Hours_8784]

Variable Time_of_Day_by_Month
Title: Time of Day by Month Hour
Description: Maps time of day to the Month Day and Hour index.
Definition: SelectText(Month_Day_and_Hour, FindInText(Time_Separator, Month_Day_and_Hour) + 1)
NodeLocation: 112,88,1
NodeSize: 64,40
ValueState: 2,126,90,646,674,0,MIDM

Variable Day_of_Month_byMonth
Title: Day of Month by Month Hour
Units: day of month
Description: The day of the month mapped to the Day of Month and Hour index.
Definition: ParseNumber(TextReplace(SelectText(Month_Day_and_Hour, 1, FindInText(Time_Separator, Month_Day_and_Hour) - 1), Day_Label, ""))
NodeLocation: 264,88,1
NodeSize: 64,40
WindState: 2,98,82,1311,393
ValueState: 2,415,369,611,556,1,MIDM

Variable Time_of_Day_8784
Title: Time of Day 8784
Description: The time of day for each hour of the year.
Definition: Slice(Time_of_Day, Hour_of_Day_8784)
NodeLocation: 416,88,1
NodeSize: 64,40
ValueState: 2,30,58,1075,546,0,MIDM
ReformVal: [Selected_Profiles,Hours_8784]

Variable Monthly_Profile_Map
Title: Monthly Profile Map
Description: A mapping of hour of year to months and day and hour of the month.
Definition: VAR dateStamp:=Month & Time_Separator & Day_of_Month_byMonth & Time_Separator & Time_of_Day_by_Month;~
VAR stamp8784:=Month_8784 & Time_Separator & Day_of_Month_8784 & Time_Separator & Time_of_Day_8784;~
~
SubIndex(stamp8784, dateStamp, Hours_8784)[Selected_Profiles=Loadshape_Map_of_Uti[All_Sectors=PV_Sectors]]
NodeLocation: 264,192,1
NodeSize: 64,40
ValueState: 2,168,45,1254,693,0,MIDM
Att_ResultSliceState: [PV_Sectors,2,Month,1,Month_Day_and_Hour,1]

Alias Al1556770471
Title: Day of Week 8784
Definition: 1
NodeLocation: 264,296,1
NodeSize: 64,40
Original: Day_of_Week_8784

Variable Day_of_Week_in_Month
Title: Day of Week in Month
Units: day & time in week
Description: The day of week and time of day for each day in the month, based on the year from which customer load is derived.
Definition: VAR day:=Day_of_Week_8784[Selected_Profiles=Loadshape_Map_of_Uti[All_Sectors=PV_Sectors], Hours_8784=Monthly_Profile_Map];~
VAR hour:=SelectText(Month_Day_and_Hour, FindInText(Time_Separator,  Month_Day_and_Hour)+1);  {Returns the hour for each element of the Day Type and Hour index}~
~
IF day = Null~
THEN Null~
ELSE day & Time_Separator & hour;
NodeLocation: 416,192,1
NodeSize: 64,40
ValueState: 2,326,58,1553,818,0,MIDM
ReformVal: [Month,Month_Day_and_Hour]
Att_ResultSliceState: [PV_Sectors,1,Month_Day_and_Hour,1,Month,1]

Variable Day_of_Week_DayType
Title: Day of Week for Day Type
Description: The assumed day of week for each day type. Since this mapping is only used for retail rates, it doesn't matter which weekday and weekend day we assign to each day type.
Definition: VAR dayType:=SelectText(Day_Type_and_Hour, 1, FindInText(Time_Separator,  Day_Type_and_Hour)-1);  {Returns the day type for each element of Day Type and Hour index}~
VAR hour:=SelectText(Day_Type_and_Hour, FindInText(Time_Separator,  Day_Type_and_Hour)+1);  {Returns the hour for each element of Day Type and Hour index}~
INDEX days:=CopyIndex(Day_by_Day_and_Hr);   {Returns the day of week for each element of the Day and Hour index}~
VAR dayTypeByDay:=DayType_by_DayAndHr[@Day_and_Hour=@days];   {Reindexes day type map by days}~
VAR day:=IF SelectText(Day_Type_and_Hour, 1, FindInText(Time_Separator,  Day_Type_and_Hour)-1) = Weekday_Label~
   THEN SubIndex(dayTypeByDay, Weekday_Label, days)~
   ELSE SubIndex(dayTypeByDay, Weekend_Label, days);~
~
day & Time_Separator & hour~

NodeLocation: 416,296,1
NodeSize: 64,40
WindState: 2,422,7,977,486
ValueState: 2,82,303,851,601,0,MIDM

Objective Day_Map_Handles
Title: Day Map Handles
Description: Handles to the day maps for each profile granularity option.
Definition: Table(Profile_Granularity)(Handle(Day_of_Week_in_Month),Handle(Day_and_Hour),Handle(Day_of_Week_DayType))
NodeLocation: 576,248,1
NodeSize: 64,40
DefnState: 2,68,74,590,303,0,DFNM

Variable Applied_Day_Map
Title: Applied Day & Hour Map
Description: A mapping of the Profile Hours to the day of the week (eg, Mon, Tues, etc) and hour. This should only be used to map daily energy prices to the Profile Hours index.
Definition: LocalAlias hours:=Hours_Index_Handles[Profile_Granularity=Sel_Profile_Granular];~
VAR profile:=Day_Map_Handles[Profile_Granularity=Sel_Profile_Granular];~
~
profile[hours=Profile_Hours]
NodeLocation: 728,248,1
NodeSize: 64,40
WindState: 2,317,340,720,350
ValueState: 2,36,5,1438,692,0,MIDM
ReformVal: [Month,Profile_Hours]
Att_ResultSliceState: [PV_Sectors,1,PV_Climate_Zone,3,Month,1,Profile_Hours,1]

Variable Day_Hour_Map_SeqOpt
Title: Day & Hour Map for Seq Opt
Description: A mapping of Number of Opt Hours to the day and hour.
Definition: Applied_Day_Map[Profile_Hours=Opt_Hours_for_SeqOpt]
NodeLocation: 880,248,1
NodeSize: 64,40
WindState: 2,231,429,720,350
ValueState: 2,277,216,1410,663,0,MIDM

Variable TimeOfDay_ProfileHrs
Title: Time of Day for Profile
Description: The time of day for the applied profile hours.
Definition: SelectText(Profile_Hours, FindInText(Time_Separator, Profile_Hours) + 1)
NodeLocation: 568,88,1
NodeSize: 64,40
ValueState: 2,308,314,577,576,0,MIDM

Variable Day_of_Week_for_Prof
Title: Day of Week for Profile Hour
Description: The day of the week for each hour in the Profile Hours
Definition: SelectText(Applied_Day_Map, 1, FindInText(Time_Separator, Applied_Day_Map) - 1)
NodeLocation: 728,88,1
NodeSize: 64,40
ValueState: 2,212,88,705,708,0,MIDM
ReformVal: [Month,Profile_Hours]

Variable Day_Type_for_Profile
Title: Day Type for Profile Hour
Description: The day type (weekday or weekend) for each hour in the Profile Hours
Definition: Day_Type_by_Weekday[Day_of_Week=Day_of_Week_for_Prof]
NodeLocation: 880,88,1
NodeSize: 64,40
ValueState: 2,212,88,705,708,0,MIDM

Variable Map_Prof_DayTyp_Time
Title: Map Profile to DayType & Time
Units: boolean
Description: A mapping of profile hours to weekday/weekends and time of day.
Definition: (Day_Type_for_Profile=Weekday_or_Weekend) AND (TimeOfDay_ProfileHrs=Time_of_Day)
NodeLocation: 1032,88,1
NodeSize: 64,40
ValueState: 2,220,219,1345,687,0,MIDM
Att_ResultSliceState: [Weekday_or_Weekend,1,Time_of_Day,1,Profile_Hours,1]

Variable Map_Prof_DayType_Hr
Title: Map Profile to DayType & Hour
Description: A mapping of profile hours to the Day Type and Hour index.
Definition: IF (Day_Type_for_Profile = Null) OR (TimeOfDay_ProfileHrs = Null)~
THEN Null~
ELSE Day_Type_for_Profile & Time_Separator & TimeOfDay_ProfileHrs
NodeLocation: 1184,88,1
NodeSize: 64,40
ValueState: 2,292,298,1007,479,0,MIDM

Close Profile_Time_Maps

Module Energy_Diagnostics
Title: Energy Diagnostics
Author: JamesMilford
Date: Tue, Oct 22, 2019 3:50 PM
NodeLocation: 744,152,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,912,28,584,712,17,10
NodeColor: 58982,58982,58982

Variable Annual_Load_Monthly
Title: Annual Load, Monthly
Units: kWh/year
Description: The annual load energy found from monthly load profiles.
Definition: Sum(Monthly_Cust_Load, Month, Month_Day_and_Hour)
NodeLocation: 272,64,1
NodeSize: 64,40
WindState: 2,6,439,720,350
ValueState: 2,106,156,471,462,0,MIDM

Variable Annual_Load_DayType
Title: Annual Load, Day Type
Units: kWh/yr
Description: The annual load energy found from day type load profiles.
Definition: Sum(DayType_Cust_Load * Day_Type_Day_Counts[Weekday_or_Weekend=DayType_for_Type_Hr], Month, Day_Type_and_Hour)
NodeLocation: 272,256,1
NodeSize: 64,40
ValueState: 2,201,332,416,303,0,MIDM

Variable Day_Type_Day_Counts
Title: Day Type Day Counts
Units: days/month
Description: The count of days per month for each day type. This can differ by profile depending on the year of data used for each profile.
Definition: Applied_Day_Counts[Static_Profile_Names=Loadshape_Map_of_Uti[All_Sectors=PV_Sectors], All_Day_Types=Weekday_or_Weekend]
NodeLocation: 104,256,1
NodeSize: 64,40
WindState: 2,98,82,1272,363
ValueState: 2,516,72,793,457,0,MIDM
ReformVal: [Weekday_or_Weekend,Month]
Att__TotalsIndex: [Weekday_or_Weekend]

Variable Day_of_Week_Day_Cnt
Title: Day of Week Day Counts
Units: days/month
Description: The count of days per day of week. This can differ by profile depending on the year of data used for each profile.
Definition: Applied_Day_Counts[Static_Profile_Names=Loadshape_Map_of_Uti[All_Sectors=PV_Sectors], All_Day_Types=Day_of_Week]
NodeLocation: 104,160,1
NodeSize: 64,40
ValueState: 2,344,273,934,376,0,MIDM

Variable Annual_Load_Weekly
Title: Annual Load, Weekly
Units: kWh/yr
Description: The annual load energy found from weekly load profiles.
Definition: Sum(Weekly_Customer_Load * Day_of_Week_Day_Cnt[Day_of_Week=Day_by_Day_and_Hr], Month, Day_and_Hour)
NodeLocation: 272,160,1
NodeSize: 64,40
ValueState: 2,49,-2,532,505,0,MIDM

Variable Ann_Solar_Energy_Day
Title: Annual Solar Energy, Day Type
Units: kWh/year
Description: The annual solar energy found from day type solar profiles.
Definition: Sum(Day_Type_Solar * Solar_DayTyo_DayCnt[Weekday_or_Weekend=DayType_for_Type_Hr], Month, Day_Type_and_Hour)
NodeLocation: 272,560,1
NodeSize: 64,40
ValueState: 2,42,192,470,242,0,MIDM

Variable Ann_Solar_Energy_Wk
Title: Annual Solar Energy, Weekly
Units: kWh/year
Description: The annual solar energy found from weekly solar profiles.
Definition: Sum(Weekly_Solar * Solar_Day_Counts[Day_of_Week=Day_by_Day_and_Hr], Month, Day_and_Hour)
NodeLocation: 272,456,1
NodeSize: 64,40
ValueState: 2,37,373,532,220,0,MIDM

Variable Ann_Solar_Energy_Mth
Title: Annual Solar Energy, Monthly
Units: kWh/year
Description: The annual solar energy found from monthly solar profiles.
Definition: Sum(Monthly_Solar, Month, Month_Day_and_Hour)
NodeLocation: 272,352,1
NodeSize: 64,40
WindState: 2,7,39,720,350
ValueState: 2,41,36,623,217,0,MIDM

Objective Compare_Annual_Solar
Title: Compare Annual Solar Energy
Units: kWh/year
Description: A comparison of the annual solar energy found from all granularities of solar profiles. These should be equal or else the day type counts and other scaling factors might be off.
Definition: Table(Profile_Granularity)(Ann_Solar_Energy_Mth, Ann_Solar_Energy_Wk, Ann_Solar_Energy_Day)
NodeLocation: 424,456,1
NodeSize: 64,40
WindState: 2,55,53,720,350
ValueState: 2,349,314,806,326,0,MIDM
NodeColor: 19661,48336,65535
ReformVal: [PV_Sectors,Profile_Granularity]
Att__TotalsIndex: [PV_Sectors,PV_Climate_Zone,Area_Type]
Att_ResultSliceState: [Area_Type,0,PV_Climate_Zone,0,Profile_Granularity,1,PV_Sectors,1]

Objective Compare_Annual_Load
Title: Compare Annual Load
Units: kWh/year
Description: A comparison of the annual load energy found from all granularities of load profiles. These should be equal or else the day type counts and other scaling factors might be off.
Definition: Table(Profile_Granularity)(Annual_Load_Monthly, Annual_Load_Weekly, Annual_Load_DayType)
NodeLocation: 424,168,1
NodeSize: 64,40
WindState: 2,55,53,720,350
ValueState: 2,344,203,781,526,0,MIDM
NodeColor: 19661,48336,65535
Att_ResultSliceState: [PV_Sectors,1,Profile_Granularity,1,PV_Climate_Zone,1]

Variable Solar_DayTyo_DayCnt
Title: Solar Day Type Day Counts
Units: days/month
Description: The count of days per month for each day type. This can differ by profile depending on the year of data used for each profile.
Definition: Applied_Day_Counts[Static_Profile_Names=Solar_Profile_Map_of, All_Day_Types=Weekday_or_Weekend]
NodeLocation: 104,560,1
NodeSize: 64,40
WindState: 2,98,82,1272,363
ValueState: 2,516,72,793,457,0,MIDM
ReformVal: [Weekday_or_Weekend,Month]
Att__TotalsIndex: [Weekday_or_Weekend]

Alias Al1584657767
Title: Solar Day Counts
Definition: 1
NodeLocation: 104,456,1
NodeSize: 64,40
Original: Solar_Day_Counts

Close Energy_Diagnostics

Alias Al1571845135
Title: Monthly Profiles
Definition: 1
NodeLocation: 256,80,1
NodeSize: 64,40
Original: Monthly_Cust_Load

Alias Al1571845136
Title: Day Type Profiles
Definition: 1
NodeLocation: 256,272,1
NodeSize: 64,40
Original: DayType_Cust_Load

Text Profile_Frame
NodeLocation: 1264,320,-20
NodeSize: 432,304
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus: yes~
Show_description:20

Alias Al1571850056
Title: Monthly Solar
Definition: 1
NodeLocation: 256,368,1
NodeSize: 64,40
Original: Monthly_Solar

Alias Al1571850057
Title: Day Type Solar
Definition: 1
NodeLocation: 256,560,1
NodeSize: 64,40
Original: Day_Type_Solar

Alias Al1571850058
Title: Weekly Solar
Definition: 1
NodeLocation: 256,464,1
NodeSize: 64,40
Original: Weekly_Solar

Variable Weekly_Day_Counts
Title: Weekly Day Counts
Units: days/month
Description: The count of days per month by Day Type. This is for an average year (e.g., 365.25 days/year).
Definition: Weeks_Per_Month * Applied_Avg_to_Peak[All_Day_Types=Day_by_Day_and_Hr]
NodeLocation: 256,776,1
NodeSize: 64,40
WindState: 2,98,82,915,350
ValueState: 2,10,9,1803,662,0,MIDM
Att_ResultSliceState: [Month,2,Static_Profile_Names,1,Day_and_Hour,1]

Variable Applied_Monthly_Mult
Title: Applied Monthly Mults
Units: dimensionless
Description: Multipliers to adjust the modeled hours in the optimization window to the number of similar hours that would occur across the entire month.
Definition: LocalAlias hours:=Hours_Index_Handles[Profile_Granularity=Sel_Profile_Granular];~
VAR profile:=Day_Count_Handles[Profile_Granularity=Sel_Profile_Granular];~
~
profile[hours=Profile_Hours]
NodeLocation: 568,680,1
NodeSize: 64,40
ValueState: 2,222,90,1438,792,1,MIDM
ReformVal: [Profile_Hours,Month]
Att_ResultSliceState: [Static_Profile_Names,5,Month,1,Profile_Hours,1]

Variable Generic_DayTyp_Cnt
Title: Generic Day Type Day Counts
Units: days/month
Description: The count of days per month by Day Type. This is for an average year (e.g., 365.25 days/year).
Definition: DaysPerMonth_DayType[Weekday_or_Weekend=DayType_for_Type_Hr]
NodeLocation: 256,1096,1
NodeSize: 64,40
WindState: 2,98,82,915,350
ValueState: 2,10,9,1803,662,0,MIDM

Objective Generic_DayCntHandle
Title: Generic Day Count Handles
Description: Handles to the day counts for each profile granularity.
Definition: Table(Profile_Granularity)(Handle(Generic_Mthly_DayCnt),Handle(Weeks_Per_Month),Handle(Generic_DayTyp_Cnt))
NodeLocation: 408,1048,1
NodeSize: 64,40
DefnState: 2,500,506,470,303,0,DFNM
NodeColor: 19661,48336,65535

Variable Generic_Mthly_DayCnt
Title: Generic Monthly Day Counts
Units: days/month
Description: The count of days per month for each day in a month. This does not require any dimensionality because it does not vary by month.
Definition: 1
NodeLocation: 256,1000,1
NodeSize: 64,40

Variable Generic_Monthly_Mult
Title: Generic Monthly Mults
Units: dimensionless
Description: Multipliers to adjust the modeled hours in the optimization window to the number of similar hours that would occur across the entire month.
Definition: LocalAlias hours:=Hours_Index_Handles[Profile_Granularity=Sel_Profile_Granular];~
VAR profile:=Generic_DayCntHandle[Profile_Granularity=Sel_Profile_Granular];~
~
profile[hours=Profile_Hours]
NodeLocation: 560,1048,1
NodeSize: 64,40
ValueState: 2,222,90,1438,792,1,MIDM
ReformVal: [Profile_Hours,Month]
Att_ResultSliceState: [Static_Profile_Names,5,Month,1,Profile_Hours,1]

Text Te1584725416
Title: Day Counts for Profiles including Peak Days
NodeLocation: 564,764,-1
NodeSize: 388,156
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Text Te1584725475
Title: Day Counts for Generic Profile
NodeLocation: 564,1040,-1
NodeSize: 388,112
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Close Profile_Creation

Variable Monthly_Cust_Load
Title: Monthly Customer Load
Units: kW-hr/customer
Description: The scaled load profiles by month.
Definition: Select_Hrly_Profiles[Selected_Profiles=Loadshape_Map_of_Uti[All_Sectors=PV_Sectors], Hours_8784=Monthly_Profile_Map] * Annual_Load
NodeLocation: 416,248,1
NodeSize: 64,40
WindState: 2,98,82,719,350
ValueState: 2,830,79,416,693,0,MIDM
Aliases: Alias Al1571845135
ReformVal: [Null,PV_Sectors]
NumberFormat: 2,F,2,0,1,0,2,0,$,0,"ABBREV",0,,,0,0,15,
Att__TotalsIndex: [Month_Day_and_Hour]
Att_ResultSliceState: [PV_Climate_Zone,2,Month_Day_and_Hour,0,Month,1,PV_Sectors,1]

Variable DayType_Cust_Load
Title: Day Type Customer Load
Units: kW-hr/customer
Description: The scaled load profiles by day type.
Definition: Daily_Prof_with_Peak[Static_Profile_Names=Loadshape_Map_of_Uti[All_Sectors=PV_Sectors], All_Day_Types=DayType_for_Type_Hr, Time_of_Day=Hour_for_Type_and_Hr] * Annual_Load
NodeLocation: 416,440,1
NodeSize: 64,40
WindState: 2,98,82,1084,697
ValueState: 2,57,9,1610,533,0,MIDM
Aliases: Alias Al1571845136
Att_ResultSliceState: [PV_Sectors,2,PV_Climate_Zone,2,Month,1,Day_Type_and_Hour,1]

Module Load_Profile_Scaling
Title: Load Profile Scaling
Description: For some segments, you may wish to assume that the load used for calculating PV system economics is a certain percentage of overall system load (e.g., for residential sectors). This input is a binary that determine whether to do that or not for each customer segment. 
Author: JamesMilford
Date: Fri, Oct 25, 2019 8:28 AM
NodeLocation: 88,344,1
NodeSize: 64,40
DiagState: 2,190,11,1363,625,17,10
AcpStyles: Frame_Node: Scaling_Frame

Variable Normalized_Load_Shap
Title:  Normalized Load Shape
Units: kW-hr/kW
Description: The imported customer load profile prior to any scaling.
Definition: Daily_Prof_with_Peak[Static_Profile_Names=Loadshape_Map_of_Uti[All_Sectors=PV_Sectors], All_Day_Types=Day_of_Week]~

NodeLocation: 112,328,1
NodeSize: 64,40
WindState: 2,107,230,720,350
ValueState: 2,305,355,1039,455,0,MIDM
GraphSetup: Att_CatLineStyle Graph_Primary_Valdim:5
ReformVal: [PV_Sectors,Month]
Att__TotalsIndex: [Day_of_Week,Month,Time_of_Day]
Att_ResultSliceState: [Day_of_Week,0,Time_of_Day,0,Month,7,PV_Sectors,2]

Variable Annual_Load
Title: Annual Load
Units: kWh/year-customer
Description: The annual consumption per customer.
Definition: local x:=Sum(Weekly_Nrml_Loadshap * Weekly_Day_Counts[Static_Profile_Names=Loadshape_Map_of_Uti[All_Sectors=PV_Sectors]], Day_and_Hour, Month)~
* Cust_Load_Total_by_P / Customer_count_by_cl;~
IF x=null THEN 1 ELSE x {to avoid errors if no sector data}
NodeLocation: 424,192,1
NodeSize: 64,40
ValueState: 2,503,254,899,384,0,MIDM
ReformVal: [PV_Climate_Zone,PV_Sectors]
NumberFormat: 2,F,4,2,0,0,4,0,$,0,"ABBREV",0,,,0,0,15,
{!40700|Att_CellFormat: Undefined}

Text Scaling_Frame
NodeLocation: 1344,320,-20
NodeSize: 432,304
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus: yes~
Show_description:20

Index Solar_Scaling_Param
Att_PrevIndexValue: ['Fraction of Load Covered by PV','Is Load Adjusted by Fraction Covered?']
Title: Solar Scaling Param
Definition: ['Fraction of Load Covered by PV','Is Load Adjusted by Fraction Covered?']
NodeLocation: 120,88,1
NodeSize: 64,40
ReformVal: [Undefined,Self]

Decision Fraction_Load_Label
Title: Fraction Load Label
Definition: Choice(Solar_Scaling_Param,1,0)
NodeLocation: 648,88,1
NodeSize: 64,40

Decision Is_Load_Adj_Label
Title: Is Load Adjusted to PV size Label
Definition: Choice(Solar_Scaling_Param,2,0)
NodeLocation: 800,88,1
NodeSize: 64,40

Alias Al1841032387
Title: Loadshape Map
Definition: 1
NodeLocation: 112,192,1
NodeSize: 64,40
Original: Loadshape_Map_of_Uti

Variable Cust_Load_Total_by_P
Title: Cust Load Total by PV Clim Zone
Units: kWh/year
Definition: local x:=Aggregate(Consumption_by_Sect2[All_PV_Sectors=PV_Sectors,Spatial_ID=PV_Spatial_ID],All_Spatial_ID_to_CZ[All_Spatial_ID=PV_Spatial_ID],PV_Spatial_ID,PV_Climate_Zone);~
IF x=0 THEN 1 ELSE x {put in a nominal value to avoid downstream errors if no load for a given sector/spatial ID combination}
NodeLocation: 424,88,1
NodeSize: 64,40
ValueState: 2,292,117,889,662,0,MIDM
Aliases: Alias Al464260131, Alias Al497814563
ReformVal: [PV_Climate_Zone,PV_Sectors]
NumberFormat: 2,F,2,0,1,0,2,0,$,0,"ABBREV",0,,,0,0,15,
Att__TotalsIndex: [PV_Sectors,PV_Climate_Zone]

Variable Va18
NodeLocation: 424,448,1
NodeSize: 64,40

Alias Al1159025699
Title: Spatial ID to CZ Map
Definition: 1
NodeLocation: 280,88,1
NodeSize: 64,40
Original: All_Spatial_ID_to_CZ

Alias Al1615680547
Title: Weekly Normalized Cust Load Shape
Definition: 1
NodeLocation: 424,328,1
NodeSize: 64,40
Original: Weekly_Nrml_Loadshap

Variable Customer_count_by_cl
Title: Customer count by climate zone
Definition: Aggregate(Applied_Building_Stk[All_Sectors=PV_Sectors,All_Spatial_ID=PV_Spatial_ID,Building_Stock_Year=Year_of_Consump_Data],All_Spatial_ID_to_CZ[All_Spatial_ID=PV_Spatial_ID],PV_Spatial_ID,PV_Climate_Zone)
NodeLocation: 648,192,1
NodeSize: 64,40
ValueState: 2,758,137,872,692,0,MIDM
ReformVal: [PV_Climate_Zone,PV_Sectors]
NumberFormat: 2,E,5,3,0,0,5,1,$,0,"ABBREV",0,,,0,0,15,

Alias Al497814563
Title: Cust Load Total by PV Clim Zone
Definition: 1
NodeLocation: 808,456,1
NodeSize: 64,40
Original: Cust_Load_Total_by_P

Close Load_Profile_Scaling

Variable Weekly_Nrml_Loadshap
Title: Weekly Normalized Cust Load Shape
Units: kW-hr/customer
Description: A representative week of customer load for each month. These have not yet been scaled to represent the load of buildings installing solar.
Definition: Reindex_to_Week(Normalized_Load_Shap)
NodeLocation: 256,344,1
NodeSize: 64,40
WindState: 2,293,348,1527,555
ValueState: 2,2103,8,1296,818,1,MIDM
Aliases: Alias Al1615680547
GraphSetup: Att_GraphValueRange Weekly_Nrml_Loadshap:1,,1,,,,,0.5903269767761231,0.9016096115112305,0~
Att_GraphIndexRange Day_and_Hour:1,,0,,,,10,25,73,1~
Att_CatLineStyle Graph_Primary_Valdim:5~
Graph_AxisLabelFont:,18,0~
Graph_KeyTitleFont:,18,1~
Graph_KeyFont:,18,0~
Graph_AxisTitleFont:Arial,18,1~
ShowKey:2
ReformVal: [Day_and_Hour,Month]
Att__TotalsIndex: [Day_and_Hour]
Att_ResultSliceState: [Month,8,PV_Sectors,2,Day_and_Hour,0]

Alias Al1571846275
Title: Applied Load Profile
Definition: 1
NodeLocation: 736,344,1
NodeSize: 64,40
Original: Applied_Load_Profile

Alias Al1571846328
Title: Selected Profile Granularity
Definition: 1
NodeLocation: 736,448,1
NodeSize: 64,40
Original: Sel_Profile_Granular

FormNode Fo1571846329
Title: Selected Profile Granularity
Definition: 0
NodeLocation: 740,504,1
NodeSize: 132,16
NodeInfo: 1,0,0,0,0,0,0,214,0,,0,,,0
Original: Sel_Profile_Granular

Variable Peak_Load
Title: Peak Load
Units: kW
Definition: Max(Applied_Load_Profile,Profile_Hours,Month)
NodeLocation: 976,448,1
NodeSize: 64,40
ValueState: 2,876,333,545,330,0,MIDM
Aliases: Alias Al1968755747
ReformVal: [PV_Climate_Zone,PV_Sectors]
NumberFormat: 2,F,4,1,0,0,4,0,$,0,"ABBREV",0,,,0,0,15,

Close Customer_Load

Module Energy_and_Demand
Title: Energy and Demand
Author: JamesMilford
Date: Tue, Aug 21, 2018 2:56 PM
NodeLocation: 112,152,1
NodeSize: 64,40
NodeInfo: 1,0,0
DiagState: 2,72,23,1554,607,17,10
Aliases: Alias Al1548967138
NodeColor: 65535,65535,65535
AcpStyles: FrameNode: FrameNode_1544919985

Text Te1534877580
Description: This is not robust to intra-day changes in the max attribute associated with tier levels
NodeLocation: 628,264,2
NodeSize: 100,32
NodeInfo: 1,0,0,1,1,1,1,,0,,0,,,
NodeColor: 57311,57311,57311
NodeFont: Arial Narrow,13
AcpStyles: Show_Object:no

Variable Consumption_by_TOU
Title: Consumption by TOU
Units: kWh
Description: The total energy consumption by time of use.
Definition: VAR agProfile:=Aggregate(PrePost_Load_by_OpYr * Load_Monthly_Mults, Map_Prof_DayType_Hr, Profile_Hours, Day_Type_and_Hour, type: "Sum");~
~
agProfile[Day_Type_and_Hour=DayType_and_Hour_Map]~

NodeLocation: 128,168,1
NodeSize: 64,40
WindState: 2,8,223,1320,752
ValueState: 2,41,27,1451,828,1,MIDM
GraphSetup: Att_CatLineStyle Graph_Primary_Valdim:5
ReformVal: [Time_of_Day,Weekday_or_Weekend]
Att_ResultSliceState: [PV_Sectors,22,PV_Climate_Zone,1,Month,7,Pre_and_Post_System,1,System_Types,1,PV_Operating_Year,1,Area_Type,1,Weekday_or_Weekend,1,Time_of_Day,1]

Variable Max_Energy_for_Tiers
Title: Max Energy for Tiers
Units: kWh/month
Description: The maximum amount of energy that can be consumed at the prices associated with a given tier. Consumption exceeding this amount will be charged at the subsequent tiers' rates.
Definition: VAR max_energy:=ignorewarnings(Weekly_Rate_Data[Data_Attribute=Max_Attribute_Label, All_Tiers=Tiers, All_Data_Types=Energy_Rate_Label, Rate_Names=Selected_Cust_Rates]);~
IF max_energy <> max_energy[@Day_and_Hour=1]   {If the maximum energy is not the same across all hours of the day}~
THEN MsgBox("The 'max' attribute used to define the tiers of time-of-use rates changes by hour of day, and the current model logic does not accomodate this level of granularity. Please ensure that the 'max' attribute is properly specified, or modify the logic in Max_Energy_for_Tiers.", 0, "Error: Granularity of Max Attribute in Retail Rates")~
ELSE Null;~
~
Replace_X_with_Y(max_energy[@Day_and_Hour=1] * {Avg_Days_per_Month: OLD} 1, Null, 10^48);~
~

NodeLocation: 344,264,1
NodeSize: 64,40
WindState: 2,265,349,1178,470
ValueState: 2,931,233,764,544,0,MIDM
Aliases: Alias Al1907669155
NodeColor: 57311,57311,57311
ReformVal: [Pre_and_Post_System,Month]
Att__TotalsIndex: []
Att_ResultSliceState: [PV_Sectors,2,PV_Climate_Zone,1,Rate_Vintage,1,Rate_Shape_Scenario,1,Tiers,1,System_Types,1,Area_Type,1,Rate_Names,159,Month,1,Pre_and_Post_System,1]
AcpStyles: Show_Object:no

Variable Mthly_Consump_Tier
Title: Monthly Consumption By Tier
Units: kWh/month
Description: The amount of monthly energy consumption falling in each of the tier levels.
Definition: VAR increm:=0;~
VAR cumul:=0;~
VAR lastTier:=0;~
FOR J:=Tiers DO (~
   VAR minim:=MIN([Monthly_Consump - cumul, Max_Energy_for_Tiers[Tiers=J] - lastTier]);~
   lastTier:=Max_Energy_for_Tiers[Tiers=J];~
   increm[Tiers=J]:=minim;~
   cumul:=cumul + minim;~
);~
increm~
~

NodeLocation: 448,168,1
NodeSize: 64,40
WindState: 2,102,82,1052,482
ValueState: 2,217,275,1067,447,0,MIDM
Aliases: Alias Al162838691
ReformVal: [Month,PV_Sectors]
Att__TotalsIndex: [Month]
Att_ResultSliceState: [Pre_and_Post_System,1,PV_Climate_Zone,1,Rate_Vintage,1,System_Types,1,Tiers,1,Area_Type,1,PV_Sectors,1,Month,1]

Variable Pct_Consump_by_Tier
Title: Pct Consumption by Tier
Units: fraction
Description: The percentage of total consumption falling in each tier.
Definition: Divide(1, Sum(Mthly_Consump_Tier, Tiers), True) * Mthly_Consump_Tier
NodeLocation: 600,168,1
NodeSize: 64,40
ValueState: 2,483,266,971,424,0,MIDM
Aliases: Alias Al1236580515
ReformVal: [Month,Tiers]
Att_ResultSliceState: [PV_Sectors,1,Rate_Vintage,1,PV_Climate_Zone,1,Pre_and_Post_System,2,System_Types,2,Area_Type,1,Tiers,1,Month,1]

Variable Consum_by_Tier_Prd
Title: Consumption by Tier & Period
Units: kWh
Description: The consumption by tier and period.
Definition: Consum_by_TOU_Prd * Pct_Consump_by_Tier
NodeLocation: 648,72,1
NodeSize: 64,40
ValueState: 2,108,191,1089,672,0,MIDM
Aliases: Alias Al699709603
GraphSetup: Graph_SymbolKey:1~
Att_CatLineStyle Graph_Primary_Valdim:5
ReformVal: [Month,PV_Operating_Year]
Att__TotalsIndex: [Day_and_Hour,Month]
Att_ResultSliceState: [PV_Sectors,22,PV_Climate_Zone,3,Rate_Vintage,1,System_Types,2,Pre_and_Post_System,2,Tiers,1,Periods,2,Area_Type,3,PV_Operating_Year,1,Month,0]
Att_ColorRole: Periods
Att_SymbolRole: Tiers

Variable Monthly_Consump
Title: Monthly Consumption
Units: kWh/month
Description: The total energy consumption in each month.
Definition: Sum(Consum_by_TOU_Prd, Periods)
NodeLocation: 280,168,1
NodeSize: 64,40
WindState: 2,972,34,720,350
ValueState: 2,47,8,1154,630,0,MIDM
Aliases: Alias Al1773451427
ReformVal: [Month,PV_Sectors]
Att__TotalsIndex: [Month]
Att_ResultSliceState: [Rate_Vintage,1,PV_Climate_Zone,2,PV_Operating_Year,5,System_Types,3,Area_Type,2,Pre_and_Post_System,1,PV_Sectors,22,Month,1]

Variable Non_Coinc_Annual_Max
Title: Non-Coinc Annual Max Demand
Units: kW
Description: The maximum non-coincident demand across the year.
Definition: Max(Demand_by_Tier[Demand_Data_Types=Flat_Demand_Label], Month)
NodeLocation: 440,400,1
NodeSize: 64,40
ValueState: 2,40,42,1377,746,1,MIDM
GraphSetup: Att_StackedBar Graph_Primary_Valdim:0~
Att_CatLineStyle Graph_Primary_Valdim:9
ReformVal: [System_Types,Pre_and_Post_System]
Att_ResultSliceState: [PV_Sectors,2,Rate_Vintage,4,PV_Climate_Zone,1,Pre_and_Post_System,1,Tiers,1,PV_Operating_Year,1,Periods,1,System_Types,1]

Variable Max_Demand_for_Tiers
Title: Max Demand for Tiers
Units: kW
Description: The maximum demand for each tier. Demand exceeding this amount will be charged at the subsequent tiers' rates.
Definition: VAR max_dmd:=Weekly_Rate_Data[Data_Attribute=Max_Attribute_Label, All_Tiers=Tiers, All_Data_Types=Demand_Data_Types, Rate_Names=Selected_Cust_Rates];~
IF max_dmd <> max_dmd[@Day_and_Hour=1]   {If the maximum demand is not the same across all hours of the day}~
THEN MsgBox("The 'max' attribute used to define the tiers of time-of-use rates changes by hour of day, and the current model logic does not accomodate this level of granularity. Please ensure that the 'max' attribute is properly specified, or modify the logic in Max_TOU_Dmd_for_Tier.", 0, "Error: Granularity of Max Attribute in Retail Rates")~
ELSE Null;~
~
Replace_X_with_Y(max_dmd[@Day_and_Hour=1], Null, 10^24);
NodeLocation: 288,608,1
NodeSize: 64,40
WindState: 2,436,336,1132,470
ValueState: 2,-2,22,1416,638,0,MIDM
ReformVal: [Tiers,Month]
Att__TotalsIndex: [Demand_Data_Types]
Att_ResultSliceState: [PV_Climate_Zone,1,Pre_and_Post_System,1,Demand_Data_Types,0,Rate_Vintage,1,PV_Sectors,1,Tiers,1]

Variable Demand_by_Tier
Title: Demand by Tier
Units: kW
Description: The demand that will be charged at each tier's price.
Definition: VAR increm:=0;~
VAR cumul:=0;~
VAR lastTier:=0;~
FOR J:=Tiers DO (~
   VAR minim:=MIN([Max_Dmd_by_TOU_Prd - cumul, Max_Demand_for_Tiers[Tiers=J] - lastTier]);~
   lastTier:=Max_Demand_for_Tiers[Tiers=J];~
   increm[Tiers=J]:=minim;~
   cumul:=cumul + minim;~
);~
increm
NodeLocation: 360,504,1
NodeSize: 64,40
WindState: 2,66,72,1283,492
ValueState: 2,448,45,1135,629,0,MIDM
ReformVal: [Month,Tiers]
Att__TotalsIndex: []
Att_ResultSliceState: [PV_Sectors,1,Rate_Vintage,1,PV_Climate_Zone,1,Pre_and_Post_System,1,Demand_Data_Types,2,System_Types,1,Area_Type,1,All_Utilities,1,Periods,1,Tiers,1,Month,1]

Variable Half_Annual_Max_Dmd
Title: Half Annual Max Demand
Units: kW
Description: Half of the maximum non-coincident demand across the year.
Definition: VAR map:=FOR J:=Periods DO (~
   Sum(Period_by_DayType_Hr[Data_Types=Flat_Demand_Label] = J, Weekday_or_Weekend, Time_of_Day) > 0   {Have to map the annual max demand back to the appropriate months to ensure the max is zeroed out where it's not relevant}~
);   ~
Non_Coinc_Annual_Max * 50% * map
NodeLocation: 600,400,1
NodeSize: 64,40
WindState: 2,40,468,1385,333
ValueState: 2,443,85,1235,761,,MIDM
GraphSetup: Att_StackedBar Graph_Primary_Valdim:0~
Att_CatLineStyle Graph_Primary_Valdim:9
ReformVal: [System_Types,Pre_and_Post_System]
Att_ResultSliceState: [PV_Sectors,2,Rate_Vintage,4,PV_Climate_Zone,1,PV_Operating_Year,1,Periods,1,Tiers,1,Month,1,Pre_and_Post_System,1,System_Types,1]

Variable Non_Coincident_Dema1
Title: Non-Coincident Demand
Units: kW
Description: ~
The Non-Coincident Demand Charge shall be based on the higher of the Maximum Monthly Demand or 50% of the Maximum Annual Demand. (source: http://regarchive.sdge.com/tm2/pdf/ELEC_ELEC-SCHEDS_AL-TOU.pdf)
Definition: MAX([Demand_by_Tier[Demand_Data_Types=Flat_Demand_Label], Half_Annual_Max_Dmd])
NodeLocation: 728,504,1
NodeSize: 64,40
WindState: 2,318,40,720,350
ValueState: 2,429,231,1120,655,0,MIDM
ReformVal: [Month,Pre_and_Post_System]
Att_ResultSliceState: [PV_Sectors,22,Periods,14,Tiers,1,PV_Climate_Zone,1,PV_Operating_Year,1,Rate_Vintage,1,System_Types,4,Area_Type,1,Pre_and_Post_System,1,Month,9]

Variable On_Peak_Demand
Title: On-Peak Demand
Units: kW
Description: ~
The On-Peak Period Demand Charge shall be based on the Maximum On-Peak Period Demand. (http://regarchive.sdge.com/tm2/pdf/ELEC_ELEC-SCHEDS_AL-TOU.pdf)
Definition: Demand_by_Tier[Demand_Data_Types=Demand_Rate_Label]
NodeLocation: 728,600,1
NodeSize: 64,40
WindState: 2,335,135,916,507
ValueState: 2,154,136,1341,699,0,MIDM
ReformVal: [Month,Pre_and_Post_System]
Att_ResultSliceState: [PV_Sectors,1,Tiers,1,PV_Climate_Zone,1,Rate_Vintage,1,System_Types,1,Area_Type,1,Periods,2,All_Utilities,1,Pre_and_Post_System,1,Month,1]

Text Te1534952533
Title: Energy Consumption
NodeLocation: 408,168,-1
NodeSize: 392,152
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Text Te1534952585
Title: Max Demand
NodeLocation: 408,496,-1
NodeSize: 392,160
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Text Te1534993872
Description: This is not robust to intra-day changes in the max attribute associated with tier levels
NodeLocation: 244,400,2
NodeSize: 100,32
NodeInfo: 1,0,0,1,1,1,1,,0,,0,,,
NodeColor: 57311,57311,57311
NodeFont: Arial Narrow,13
AcpStyles: Show_Object:no

Text FrameNode_1544919985
NodeLocation: 1176,320,-20
NodeSize: 360,304
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus: yes~
Show_description:20

Variable Pct_Demand_by_Tier
Title: Pct of Demand by Tier
Units: fraction
Description: The percentage of demand occuring in each tier.
Definition: Divide(1, Sum(Demand_by_Tier, Tiers), True) * Demand_by_Tier
NodeLocation: 448,608,1
NodeSize: 64,40
WindState: 2,0,0,720,350
ValueState: 2,25,147,1004,690,,MIDM
ReformVal: [Month,Tiers]
NumberFormat: 2,%,4,2,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [PV_Sectors,2,Rate_Vintage,3,PV_Climate_Zone,1,PV_Operating_Year,1,Pre_and_Post_System,1,Periods,1,Demand_Data_Types,1,System_Types,1,Month,1,Tiers,1]

Variable Max_Demand_by_TOU
Title: Max Demand by TOU
Units: kW
Description: The maximum demand by time of use.
Definition: VAR agProfile:=Aggregate(PrePost_Load_by_OpYr, Map_Prof_DayType_Hr, Profile_Hours, Day_Type_and_Hour, type: "Max");~
~
agProfile[Day_Type_and_Hour=DayType_and_Hour_Map]
NodeLocation: 120,608,1
NodeSize: 64,40
WindState: 2,102,82,1015,350
ValueState: 2,463,18,1294,669,1,MIDM
GraphSetup: Att_CatLineStyle Graph_Primary_Valdim:5
ReformVal: [Time_of_Day,Weekday_or_Weekend]
Att_ResultSliceState: [PV_Sectors,2,PV_Climate_Zone,1,Rate_Vintage,4,PV_Operating_Year,1,Month,8,Pre_and_Post_System,1,System_Types,1,Weekday_or_Weekend,1,Time_of_Day,1]

Variable Consum_by_TOU_Prd
Title: Consumption by TOU Period
Units: kWh
Description: The total energy consumption by TOU period.
Definition: Aggregate(PrePost_Load_by_OpYr * Load_Monthly_Mults, Periods_by_ProfileHr[Data_Types=Energy_Rate_Label], Profile_Hours, Periods)
NodeLocation: 280,72,1
NodeSize: 64,40
ValueState: 2,277,61,1207,664,0,MIDM
Aliases: Alias Al380942499
GraphSetup: Att_CatLineStyle Graph_Primary_Valdim:5~
{!40600|Att_WaterfallBar Graph_Primary_Valdim:0}
ReformVal: [Month,Periods]
Att_ResultSliceState: [PV_Sectors,1,Rate_Vintage,1,PV_Climate_Zone,1,System_Types,3,Pre_and_Post_System,1,Area_Type,1,Periods,1,Month,1]

Variable Max_Dmd_by_TOU_Prd
Title: Max Demand by TOU Period
Units: kW
Description: The maximum demand by TOU period.
Definition: IF Include_demand_charg  THEN  {zeros out demand charges if they are not accounted for in the analysis}~
Replace_X_with_Y(Aggregate(PrePost_Load_by_OpYr, Periods_by_ProfileHr[Data_Types=Demand_Data_Types], Profile_Hours, Periods, 'Max'), Null, 0)~
ELSE 0
NodeLocation: 200,504,1
NodeSize: 64,40
WindState: 2,102,82,1015,350
ValueState: 2,398,175,1294,669,0,MIDM
GraphSetup: Att_CatLineStyle Graph_Primary_Valdim:5
ReformVal: [Month,Periods]
Att__TotalsIndex: []
Att_ResultSliceState: [PV_Climate_Zone,1,Rate_Vintage,1,Pre_and_Post_System,2,System_Types,1,Demand_Data_Types,2,Area_Type,1,PV_Sectors,2,All_Utilities,1,Periods,1,Month,1]

Text Te1571966012
Description: Not sure if this should be indexed by Periods. It doesnt matter for current rates, since there's only one tier.
NodeLocation: 460,684,2
NodeSize: 100,36
NodeInfo: 1,0,0,1,1,1,1,,0,,0,,,
NodeColor: 57311,57311,57311
NodeFont: Arial Narrow,13
AcpStyles: Show_Object:no

Text Te1584659946
Description: By scaling day counts to account for peak day loads, the PV output will be slightly lower than desired
NodeLocation: 132,248,2
NodeSize: 100,32
NodeInfo: 1,0,0,1,1,1,1,,0,,0,,,
NodeColor: 57311,57311,57311
NodeFont: Arial Narrow,13
AcpStyles: Show_Object:no

Variable Va19
Definition: VAR max_dmd:=Weekly_Rate_Data[Data_Attribute=Max_Attribute_Label, All_Tiers=Tiers, All_Data_Types=Demand_Data_Types, Rate_Names=Selected_Cust_Rates];~
IF max_dmd <> max_dmd[@Day_and_Hour=1]   {If the maximum demand is not the same across all hours of the day}~
THEN MsgBox("The 'max' attribute used to define the tiers of time-of-use rates changes by hour of day, and the current model logic does not accomodate this level of granularity. Please ensure that the 'max' attribute is properly specified, or modify the logic in Max_TOU_Dmd_for_Tier.", 0 , "Error: Granularity of Max Attribute in Retail Rates")~
ELSE Null;~
~
Replace_X_with_Y(max_dmd[@Day_and_Hour=1], Null, 10^24);
NodeLocation: 288,704,1
NodeSize: 64,40
ValueState: 2,91,65,808,769,0,MIDM
ReformVal: [PV_Climate_Zone,PV_Sectors]
Att__TotalsIndex: []
Att_ResultSliceState: [Rate_Vintage,1,Pre_and_Post_System,2,Tiers,1,Demand_Data_Types,2,Month,1,PV_Sectors,1,PV_Climate_Zone,1]

Variable Va21
Definition: Replace_X_with_Y(Va19[@Day_and_Hour=1], Null, 10^24);
NodeLocation: 432,776,1
NodeSize: 64,40
ValueState: 2,390,134,994,567,,MIDM
ReformVal: [PV_Climate_Zone,PV_Sectors]
Att__TotalsIndex: [Demand_Data_Types]
Att_ResultSliceState: [Rate_Vintage,1,Pre_and_Post_System,1,Tiers,1,Demand_Data_Types,0,PV_Sectors,1,PV_Climate_Zone,1]

Decision Include_demand_charg
Title: Include demand charges?
Description: If demand charges need not be accounted for in the analysis, unchecking this box will speed model run time considerably.
Definition: Checkbox(1)
NodeLocation: 880,648,1
NodeSize: 64,40
Aliases: FormNode Fo606900515
NodeColor: 65535,65531,1

FormNode Fo606900515
Title: Include demand charges?
Definition: 0
NodeLocation: 1124,664,1
NodeSize: 124,16
Original: Include_demand_charg

Variable Va24
Definition: PrePost_Load_by_OpYr * Load_Monthly_Mults
NodeLocation: 760,344,1
NodeSize: 64,40
ValueState: 2,503,63,1138,788,,MIDM

Variable Energy_Units_Convers
Title: Energy Units Conversion Table
Units: various
Definition: Table(Max_Attribute_Units)(1,Monthly_Peak_Demand,Avg_Days_per_Month,0)
NodeLocation: 912,88,1
NodeSize: 64,40
DefnState: 2,1340,383,416,303,0,DFNM
ValueState: 2,1380,151,478,497,0,MIDM
ReformVal: [Max_Attribute_Units,Month]
Att_ResultSliceState: [PV_Sectors,2,Rate_Vintage,1,PV_Climate_Zone,1,System_Types,1,Pre_and_Post_System,1,Area_Type,1,Rate_Shape_Scenario,1,Month,1,Max_Attribute_Units,1]

Index In2
NodeLocation: 1264,72,1
NodeSize: 64,40

Index Max_Attribute_Units
Att_PrevIndexValue: ['kWh/month','kWh/kW','kWh/day','kWh/month/period']
Title: Max Attribute Units
Definition: ['kWh/month','kWh/kW','kWh/day','kWh/month/period']
NodeLocation: 1128,72,1
NodeSize: 64,40

Variable Monthly_Peak_Demand
Title: Monthly Peak Demand
Units: kW
Description: Maximum Peak Demand over all hours over the entire month. This is only used for calculating tiering of energy charges if the tier "max" attribute has units of "kWh/kW," which then requires multiplying the input max attribute by the peak kW to get that actual kWh threshold for the energy tier. 
Definition: local x:=Replace_X_with_Y(Aggregate(PrePost_Load_by_OpYr, Periods_by_ProfileHr[Data_Types=Energy_Rate_Label], Profile_Hours, Periods, 'Max'), Null, 0);~
MAX(x,Periods)
NodeLocation: 912,200,1
NodeSize: 64,40
ValueState: 2,725,223,471,524,0,MIDM
GraphSetup: Att_CatLineStyle Graph_Primary_Valdim:5
ReformVal: [Pre_and_Post_System,Month]
Att_ResultSliceState: [PV_Sectors,2,Rate_Vintage,1,PV_Climate_Zone,1,Area_Type,1,Rate_Shape_Scenario,1,System_Types,3,Pre_and_Post_System,1,Month,1]

Constant Units_of_Max_Energy_
Title: Units of "Max" Energy Attribute for Tier
Definition: Table(Rate_Names)(Choice(Max_Attribute_Units,1,0),Choice(Max_Attribute_Units,1,0),Choice(Max_Attribute_Units,1,0),Choice(Max_Attribute_Units,1,0),Choice(Max_Attribute_Units,1,0),Choice(Max_Attribute_Units,1,0),Choice(Max_Attribute_Units,1,0),Choice(Max_Attribute_Units,1,0),Choice(Max_Attribute_Units,1,0),Choice(Max_Attribute_Units,1,0),Choice(Max_Attribute_Units,1,0),Choice(Max_Attribute_Units,1,0),Choice(Max_Attribute_Units,1,0),Choice(Max_Attribute_Units,2,0),Choice(Max_Attribute_Units,1,0),Choice(Max_Attribute_Units,1,0),Choice(Max_Attribute_Units,1,0))
NodeLocation: 1088,200,1
NodeSize: 64,56
DefnState: 2,583,182,930,541,0,DFNM
Aliases: FormNode Fo775011603, FormNode Fo825343251
NodeColor: 65535,65531,1
TableCellDefault: Choice(Max_Attribute_Units,1,0)

FormNode Fo775011603
Title: Units of "Max" Energy Attribute for Tier
Definition: 0
NodeLocation: 1284,224,1
NodeSize: 188,16
NodeColor: 65535,65531,1
Original: Units_of_Max_Energy_

Variable Energy_Units_Conver1
Title: Energy Units Conversion
Units: various
Description: A multiplier of the "max" attribute for energy price tiers that ensures that the kWh calculated for each tier for purpose of bucketing energy into the tiers is correct.
Definition: Energy_Units_Convers[Max_Attribute_Units=Units_of_Max_Energy_]
NodeLocation: 1064,336,1
NodeSize: 64,40
WindState: 2,492,168,972,271
ValueState: 2,385,20,1333,804,0,MIDM
ReformVal: [Month,Rate_Names]
Att_ResultSliceState: [PV_Sectors,2,Rate_Vintage,1,PV_Climate_Zone,1,System_Types,1,Pre_and_Post_System,2,Area_Type,1,Rate_Shape_Scenario,1,Rate_Names,1,Month,1]

Close Energy_and_Demand

Module Energy_and_Demand_Co
Title: Energy and Demand Costs
Author: JamesMilford
Date: Thu, Aug 23, 2018 5:16 PM
NodeLocation: 256,152,1
NodeSize: 64,40
NodeInfo: 1,0,0
DiagState: 2,114,23,1649,733,17,10
Aliases: Alias Al1548967139
NodeColor: 65535,65535,65535
AcpStyles: FrameNode: FrameNode_1544920029

Variable Energy_Cost_Tier_Prd
Title: Energy Cost by Tier and Period
Units: $
Description: The volumetric energy cost by tier and period.
Definition: IF Any_non_net_metering THEN Energy_Cost_w_Sell ELSE Energy_Cost_Tier_Pr1~
/*Consum_by_Tier_Prd * Energy_Price
NodeLocation: 408,200,1
NodeSize: 64,40
ValueState: 2,698,318,1051,446,0,MIDM
GraphSetup: Graph_SymbolKey:1~
Att_CatLineStyle Graph_Primary_Valdim:5
ReformVal: [Month,Periods]
NumberFormat: 2,F,2,0,1,0,2,0,$,0,"ABBREV",0,,,0,0,15,
Att__TotalsIndex: [Month,Tiers,Periods]
Att_ResultSliceState: [Tiers,0,PV_Sectors,2,System_Types,3,Area_Type,1,PV_Climate_Zone,1,Pre_and_Post_System,2,Rate_Vintage,1,Periods,1,Month,0]
Att_ColorRole: Pre_and_Post_System
Att_SymbolRole: Tiers
{!40600|Att_StackingIndex: Tiers}
{!40600|Att_ClusterIndex: Null}

Variable Monthly_Energy_Cost
Title: Monthly Energy Cost
Units: $
Description: The monthly cost associated with volumetric energy charges.
Definition: Sum(Energy_Cost_Tier_Prd, Periods, Tiers)
NodeLocation: 408,104,1
NodeSize: 64,40
ValueState: 2,257,9,1295,794,1,MIDM
ReformVal: [Month,Pre_and_Post_System]
Att__TotalsIndex: [Month,PV_Sectors,PV_Climate_Zone,Area_Type]
Att_ResultSliceState: [PV_Sectors,0,Rate_Vintage,1,PV_Climate_Zone,0,PV_Operating_Year,1,System_Types,2,Area_Type,0,Comm_Adder_test,1,Pre_and_Post_System,1,Month,1]

Variable Annual_Energy_Cost
Title: Annual Energy Cost
Units: $
Description: The annual cost associated with volumetric energy charges.
Definition: Sum(Monthly_Energy_Cost, Month)
NodeLocation: 568,104,1
NodeSize: 64,40
ValueState: 2,622,372,1109,364,0,MIDM
ReformVal: [Pre_and_Post_System,Rate_Vintage]
Att_ResultSliceState: [PV_Sectors,2,PV_Climate_Zone,1,System_Types,3,Area_Type,1,Rate_Vintage,1,Pre_and_Post_System,1]
{!40600|Att_ClusterIndex: Null}

Variable Selected_Cust_Rates
Title: Selected Customer Rates
Description: The rate tariffs selected for each sector and climate zone.
Definition: Select_Customer_Rate[All_Sectors=PV_Sectors, Rate_Setting=Name_Setting_Label,All_Utilities=Selected_Utility]
NodeLocation: 96,312,1
NodeSize: 64,40
WindState: 2,184,82,859,463
DefnState: 2,36,149,1304,440,0,DFNM
ValueState: 2,278,273,1426,367,0,MIDM
ReformVal: [PV_Climate_Zone,Rate_Vintage]
Att_ResultSliceState: [PV_Sectors,2,Pre_and_Post_System,2,Rate_Vintage,1,PV_Climate_Zone,1]
Att_EditSliceState: [Pre_and_Post_System,2,All_Sectors,1,PV_Climate_Zone,1]

Variable Energy_Price
Title: Energy Price (excluding sell)
Units: $/kWh
Description: The volumnetric energy charges by tier and period.
Definition: (Replace_X_with_Y(Sum(Data_by_Tier_Period[Rate_Names=Selected_Cust_Rates, All_Data_Types=Energy_DataType, All_Periods=Periods, All_Tiers=Tiers] * Incl_Energy_Attribs * (Data_Attribute<>Sell_Price_Label), Data_Attribute), Null, 0) {+ sum(Additional_Value[Additional_Value_Sce=Additional_Value_Sc1],Value_Type)} )  {only applicable for NYPA situation with Value Stack assumptions, full net metering independent of load}~
* OpYr_Inflate_Factor
NodeLocation: 256,312,1
NodeSize: 64,40
WindState: 2,102,82,1080,350
ValueState: 2,1182,420,669,287,0,MIDM
Aliases: Alias Al144060707
GraphSetup: Att_CatLineStyle Graph_Primary_Valdim:6
ReformVal: [Periods,Tiers]
NumberFormat: 2,F,4,3,0,0,4,0,$,0,"ABBREV",0,,,0,0,15,
Att_ResultSliceState: [Pre_and_Post_System,2,PV_Climate_Zone,1,PV_Sectors,2,Rate_Vintage,1,Tiers,1,Periods,1]

Variable Non_Coinc_Dmd_Price
Title: Non-Coincident Demand Price
Units: $/kW
Description: The charges for non-coincident demand.
Definition: Replace_X_with_Y(Sum(Data_by_Tier_Period[Rate_Names=Selected_Cust_Rates, All_Data_Types=NonCoincDmd_DataType, All_Periods=Periods, All_Tiers=Tiers] * Incl_NC_Dmd_Attribs, Data_Attribute), Null, 0) * OpYr_Inflate_Factor
NodeLocation: 256,464,1
NodeSize: 64,40
ValueState: 2,209,99,1230,640,0,MIDM
Aliases: Alias Al1553346851
ReformVal: [PV_Operating_Year,Periods]
Att_ResultSliceState: [PV_Sectors,2,Rate_Vintage,1,PV_Climate_Zone,1,Pre_and_Post_System,1,Tiers,1,Periods,1,PV_Operating_Year,1]

Variable On_Peak_Demand_Price
Title: On-Peak Demand Price
Units: $/kW
Description: The charges for on-peak demand.
Definition: Replace_X_with_Y(Sum(Data_by_Tier_Period[Rate_Names=Selected_Cust_Rates, All_Data_Types=OnPeakDmd_DataType, All_Periods=Periods, All_Tiers=Tiers] * Incl_OnPkDmd_Attribs, Data_Attribute), Null, 0) * OpYr_Inflate_Factor
NodeLocation: 256,576,1
NodeSize: 64,40
WindState: 2,102,82,1160,350
ValueState: 2,162,140,1592,528,0,MIDM
Aliases: Alias Al177615139
Att__TotalsIndex: [Tiers]
Att_ResultSliceState: [Rate_Vintage,1,PV_Climate_Zone,1,Pre_and_Post_System,2,Periods,2,PV_Sectors,2,Tiers,0]

Variable Non_Coinc_Dmd_Cost
Title: Non-Coinc Demand Cost
Units: $
Description: The monthly cost associated with non-coincident demand charges.
Definition: Sum(NC_Dmd_Cost_Tier_Prd, Periods, Tiers)
NodeLocation: 560,464,1
NodeSize: 64,40
WindState: 2,31,245,720,350
ValueState: 2,114,265,1043,604,0,MIDM
ReformVal: [Month,Pre_and_Post_System]
Att_ResultSliceState: [PV_Sectors,1,PV_Climate_Zone,1,Rate_Vintage,4,PV_Operating_Year,1,System_Types,1,Pre_and_Post_System,1,Month,1]

Variable On_Peak_Demand_Cost
Title: On-Peak Demand Cost
Units: $
Description: The monthly cost associated with on-peak demand charges.
Definition: Sum(OnPkDmd_Cost_TierPrd, Tiers, Periods)
NodeLocation: 560,576,1
NodeSize: 64,40
ValueState: 2,710,236,1032,654,1,MIDM
ReformVal: [Month,Pre_and_Post_System]
Att_ResultSliceState: [PV_Sectors,2,Rate_Vintage,4,PV_Climate_Zone,1,PV_Operating_Year,1,System_Types,1,Pre_and_Post_System,1,Month,1]

Variable NC_Dmd_Cost_Tier_Prd
Title: Non-Coinc Demand Cost by Tier and Period
Units: $
Description: The cost associated with non-coincident demand charges.
Definition: Non_Coinc_Dmd_Price * Non_Coincident_Dema1
NodeLocation: 408,464,1
NodeSize: 64,40
ValueState: 2,289,78,1172,764,1,MIDM
GraphSetup: Graph_SymbolKey:1~
Att_CatLineStyle Graph_Primary_Valdim:5
ReformVal: [Month,Periods]
Att_ResultSliceState: [PV_Sectors,2,Rate_Vintage,4,PV_Climate_Zone,1,PV_Operating_Year,1,System_Types,1,Pre_and_Post_System,2,Periods,1,Month,1]
Att_ColorRole: Periods
Att_SymbolRole: Tiers

Variable OnPkDmd_Cost_TierPrd
Title: On-Peak Demand Cost by Tier and Period
Units: $
Description: The cost associated with on-peak demand charges.
Definition: On_Peak_Demand_Price * On_Peak_Demand
NodeLocation: 408,576,1
NodeSize: 64,40
WindState: 2,98,82,1250,785
ValueState: 2,136,138,1240,704,0,MIDM
GraphSetup: Graph_SymbolKey:1
ReformVal: [Month,Periods]
Att_ResultSliceState: [PV_Sectors,2,Rate_Vintage,4,PV_Climate_Zone,1,System_Types,1,Pre_and_Post_System,1,PV_Operating_Year,1,Tiers,1,Periods,1,Month,6]
Att_SymbolRole: Tiers

Variable Mthly_Minimum_Charge
Title: Monthly Minimum Charge
Units: $
Description: The additional monthly charges to ensure the monthly minimum billing charge is met.
Definition: IF Monthly_Energy_Cost >= Monthly_Minimum~
THEN  0~
ELSE IF Monthly_Energy_Cost > 0~
THEN Monthly_Minimum - Monthly_Energy_Cost~
ELSE Monthly_Minimum
NodeLocation: 568,208,1
NodeSize: 64,40
ValueState: 2,229,76,1172,682,,MIDM
ReformVal: [Month,Rate_Vintage]
Att_ResultSliceState: [PV_Sectors,2,PV_Climate_Zone,1,System_Types,2,Pre_and_Post_System,2,PV_Operating_Year,1,Rate_Vintage,1,Month,1]

Variable Basic_Service_Fees
Title: Basic Service Fees
Units: $/month
Definition: Replace_X_with_Y(Fixed_Charges[Rate_Names=Selected_Cust_Rates], Null, 0) * OpYr_Inflate_Factor
NodeLocation: 768,704,1
NodeSize: 64,40
ValueState: 2,176,135,1542,620,1,MIDM
Aliases: Alias Al1989554467
GraphSetup: Att_StackedBar Graph_Primary_Valdim:0
ReformVal: [Pre_and_Post_System,PV_Sectors]
Att_ResultSliceState: [PV_Sectors,2,Pre_and_Post_System,1,PV_Climate_Zone,1,Rate_Vintage,1,PV_Operating_Year,1]
{!40600|Att_ClusterIndex: PV_Sectors}

Variable Monthly_Minimum
Title: Monthly Minimum
Units: $
Description: The monthly minimum billing charge.
Definition: Replace_X_with_Y(Minimum_Charges[Rate_Names=Selected_Cust_Rates], Null, 0) / Avg_Days_per_Month * Days_Per_Month * OpYr_Inflate_Factor
NodeLocation: 568,312,1
NodeSize: 64,40
WindState: 2,72,277,1236,444
ValueState: 2,229,37,1130,666,1,MIDM
Aliases: Alias Al345387299
ReformVal: [Month,PV_Operating_Year]
Att__TotalsIndex: [Day_of_Week]
Att_ResultSliceState: [PV_Climate_Zone,1,Pre_and_Post_System,1,Rate_Vintage,1,PV_Sectors,1,Month,1]

Text Te1534994142
Title: Energy Costs
NodeLocation: 336,184,-1
NodeSize: 328,176
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Text Te1534994263
Description: Demand Costs
NodeLocation: 336,496,-1
NodeSize: 328,128
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Text Te1535048878
Title: Basic Service Fees
NodeLocation: 768,752,-1
NodeSize: 88,120
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Decision Select_Customer_Rate
Title: Select Customer Rate
Description: NOTE: CHANGING THIS RATE WILL NOT AUTOMATICALLY UPDATE THE HOURLY STORAGE DISPATCH, WHICH MAY CHANGE AS A RESULT OF DIFFERENT HOURLY RATES. ~
~
Select the rate tariffs for each system type. For each rate tariff, specify the start date when the rate became effective (the date you select does not have to match the date included in the rate name). If you wish to apply rate escalation to any of the rates, you can do so by checking the box. Escalation will use the start date as the base year for inflation (ie, inflation factors are 1.0 in the base year). Generally, the first and last rates (on a chronological basis) will apply (de)escalation to fill in the missing years on the outer edges of the simulation horizon. For example, say you have two rate vintages, where the first rate starts in 1/1/2019 and the second rate starts in 1/1/2020. If you choose to apply escalation to each of these rates, any simulated time period prior to 1/1/2019 will apply de-escalation rates (eg, if the escalation rate is 2%, then the rates applied to 1/1/2018 will include a de-escalation multiplier of 1/[1+2%]). Moreover, any simulated time period after 1/1/2020 will apply escalation rates (eg, if the escalation rate is 2%, then the rates applied to 1/1/2021 will include an escalation multiplier of [1+2%]). Rates in the middle of the chronological order may not require escalation if it is known with certainty that the rates were constant from the start date until the subsequent rate's start date.~
~

Definition: Table(All_Sectors,All_Utilities,Rate_Vintage,PV_Climate_Zone,Pre_and_Post_System,Rate_Setting)(~
Choice(Rate_Names_with_None,13,0),1-Jan-2022,1,~
Choice(Rate_Names_with_None,14,0),1-Jan-2022,1,~
Null,Null,Null,~
Null,Null,Null,~
Choice(Rate_Names_with_None,4,0),1-Jan-2022,1,~
Choice(Rate_Names_with_None,4,0),1-Jan-2022,1,~
Null,Null,Null,~
Null,Null,Null,~
Choice(Rate_Names_with_None,11,0),1-May-2023,1,~
Choice(Rate_Names_with_None,10,0),1-May-2023,1,~
Null,Null,Null,~
Null,Null,Null,~
Choice(Rate_Names_with_None,15,0),1-Jan-2022,1,~
Choice(Rate_Names_with_None,15,0),1-Jan-2022,1,~
Null,Null,Null,~
Null,Null,Null,~
Choice(Rate_Names_with_None,5,0),1-Jan-2022,1,~
Choice(Rate_Names_with_None,5,0),1-Jan-2022,1,~
Null,Null,Null,~
Null,Null,Null,~
Choice(Rate_Names_with_None,12,0),1-May-2023,1,~
Choice(Rate_Names_with_None,7,0),1-May-2023,1,~
Null,Null,Null,~
Null,Null,Null,~
Choice(Rate_Names_with_None,17,0),1-Jan-2022,1,~
Choice(Rate_Names_with_None,18,0),1-Jan-2022,1,~
Null,Null,Null,~
Null,Null,Null,~
Choice(Rate_Names_with_None,6,0),1-Jan-2022,1,~
Choice(Rate_Names_with_None,6,0),1-Jan-2022,1,~
Null,Null,Null,~
Null,Null,Null,~
Choice(Rate_Names_with_None,8,0),1-May-2023,1,~
Choice(Rate_Names_with_None,9,0),1-May-2023,1,~
Null,Null,Null,~
Null,Null,Null,~
Null,Null,Null,~
Null,Null,Null,~
Null,Null,Null,~
Null,Null,Null,~
Null,Null,Null,~
Null,Null,Null,~
Null,Null,Null,~
Null,Null,Null,~
Null,Null,Null,~
Null,Null,Null,~
Null,Null,Null,~
Null,Null,Null)
NodeLocation: 96,216,1
NodeSize: 64,40
WindState: 2,2043,162,1402,650
DefnState: 2,512,425,1149,292,0,DFNM
ValueState: 2,302,51,935,658,0,MIDM
Aliases: FormNode Fo1547766909, FormNode Fo1547828216
NodeColor: 65535,65531,1
ReformDef: [Pre_and_Post_System,All_Sectors]
ReformVal: [Pre_and_Post_System,Rate_Vintage]
TableCellDefault: Rate_Setting_Default
Att_ResultSliceState: [All_Sectors,1,PV_Climate_Zone,1,Rate_Setting,2,Rate_Vintage,1,Pre_and_Post_System,1]
Att_EditSliceState: [PV_Climate_Zone,1,Rate_Vintage,1,Rate_Setting,1,All_Utilities,1,All_Sectors,1,Pre_and_Post_System,2]
{!50000|Att_ColumnWidths: [,Rate_Vintage,\([])]}

Decision Allow_Rate_Inflation
Title: Allow Rate Inflation
Units: boolean
Description: Allows all cost components of retail rates to escalate over the system's economic horizon.
Definition: Checkbox(0)
NodeLocation: 384,816,1
NodeSize: 64,40
Aliases: FormNode Fo929231395, FormNode Fo1785176339
NodeColor: 65535,65531,1
{!40300|Att_SlicerPopupSize: 227,64}

Variable OpYr_Inflate_Factor
Title: Op Year Inflation Factor
Units: dmnls
Description: A factor to inflate costs over the PV operating year dimension. This uses the inflation rate, rather than the retail rate escalation rate because we aren't calculating costs for each simulation period, and we would only want user-defined retail rate escalation rates to be applied after the calibration period. Any discrepancies between inflation rates and retail rate escalation rates will only manifest itself if levelized cost values are used in the long-run market share calculations.
Definition: IF Allow_Rate_Inflation THEN Levelized_Inflation_ ELSE 1
NodeLocation: 536,816,1
NodeSize: 64,40
NodeInfo: 1,1,0,1,1,1,0,,0,,0,,,
WindState: 2,102,82,754,554
ValueState: 2,733,433,625,371,,MIDM

Text Te1540235805
Title: Rate Inflation (applies to all cost components)
NodeLocation: 336,752,-1
NodeSize: 328,120
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Module Rate_Vintage_Mapping
Title: Rate Vintage Mapping
Author: JamesMilford
Date: Wed, Oct 24, 2018 4:58 PM
NodeLocation: 944,704,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,274,139,1524,512,17,10
AcpStyles: FrameNode: FrameNode_1545067302

Decision Rate_Setting_Default
Title: Rate Setting Default
Definition: Table(Rate_Setting)(Choice(Rate_Names_with_None,1,0),Choice(PV_Sim_Strt_Yr_Opt,85,0),Checkbox(1))
NodeLocation: 72,376,1
NodeSize: 64,40
DefnState: 2,912,355,553,345,0,DFNM

Variable Rate_Start_Dates
Title: Rate Start Dates
Description: The start date when a particular rate vintage became effective.
Definition: IF Selected_Cust_Rates = None_Label~
THEN Null~
ELSE Select_Customer_Rate[All_Sectors=PV_Sectors, Rate_Setting=Rate_Date_Label,All_Utilities=Selected_Utility]
NodeLocation: 200,176,1
NodeSize: 64,40
ValueState: 2,184,186,952,554,0,MIDM
Att_ResultSliceState: [Pre_and_Post_System,1,PV_Climate_Zone,3,PV_Sectors,1,Rate_Vintage,1]

Variable Sorted_Vintages
Title: Sorted Vintages
Units: vintage #
Description: The rate vintages sorted in chronological order.
Definition: SortIndex(Rate_Start_Dates, Rate_Vintage)
NodeLocation: 392,176,1
NodeSize: 64,40
ValueState: 2,112,187,765,387,0,MIDM
Att_ResultSliceState: [Pre_and_Post_System,1,PV_Climate_Zone,1,PV_Sectors,2,Rate_Vintage,1]

Variable Sorted_Start_Dates
Title: Sorted Start Dates
Description: The start date when a particular rate vintage became effective. These are sorted in chronological order along the Rate Vintage index.
Definition: Rate_Start_Dates[Rate_Vintage=Sorted_Vintages]
NodeLocation: 72,56,1
NodeSize: 64,40
ValueState: 2,101,10,879,460,0,MIDM
Att_ResultSliceState: [PV_Sectors,1,Pre_and_Post_System,1,PV_Climate_Zone,1,Rate_Vintage,1]

Variable Decimal_Start_Year
Title: Decimal Start Year
Units: year
Description: The start date when a particular rate vintage became effective. These are sorted in chronological order along the Rate Vintage index and are converted to decimal form (eg, June 2018 converts to 2018.5).
Definition: LinearInterp(BOY_Date_StaticPV_Yr, Static_PV_Time, Sorted_Start_Dates, Static_PV_Time)
NodeLocation: 72,280,1
NodeSize: 64,40
ValueState: 2,137,63,1505,572,0,MIDM
NumberFormat: 2,F,6,2,0,0,6,1,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [PV_Sectors,1,Pre_and_Post_System,2,PV_Climate_Zone,1,Rate_Vintage,1]
{!50000|Att_ColumnWidths: [,Rate_Vintage,\([62])]}

Variable Sorted_Rate_Vintage
Title: Sorted Rate Vintage by Time
Units: sorted vintage
Description: The sorted rate vintage number corresponding to each period in the simulation.
Definition: StepInterp(Sorted_Start_Dates, Rate_Vintage, Time, Rate_Vintage, LeftLookup: True)
NodeLocation: 392,56,1
NodeSize: 64,40
WindState: 2,374,394,1388,546
ValueState: 2,21,412,1577,444,0,MIDM
NumberFormat: 2,G,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [Rate_Vintage]
Att_ResultSliceState: [PV_Climate_Zone,3,Pre_and_Post_System,2,PV_Sectors,1,Time,1]
{!50000|Att_ColumnWidths: [,Annual_Econ_Time,\([,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,])]}

Variable Rate_Escalate_byVint
Title: Rate Escalation by Vintage
Units: dmnls
Description: An escalation factor applied to each rate vintage. The base year for inflation is the start date of the rate vintage. This is to estimate rates outside of the range of historic data. A different escalation factor is applied to account for inflation within the lifetime of an installed system. Generally, escalation is only applied to the first and last rate vintages when ordered chronologically.
Definition: VAR equivEscalateRate:=(1+Applied_RateEscalate)^(1/Timesteps_Per_Year)-1;   {The compounding monthly equivalent of the annual escalation rate}~
~
IF Select_Customer_Rate[All_Sectors=PV_Sectors, Rate_Setting=Rate_Escalate_Label,All_Utilities=Selected_Utility]~
THEN Rate_adjustment * (1 + equivEscalateRate)^((Time_Fractional_Year - Decimal_Start_Year[Rate_Vintage=Sorted_Vintages])*Timesteps_Per_Year)~
ELSE 1;~

NodeLocation: 560,280,1
NodeSize: 64,40
WindState: 2,240,134,1116,635
ValueState: 2,123,227,1408,406,0,MIDM
ReformVal: [Time_Solar_PV,Rate_Escalation_Scen]
NumberFormat: 2,F,2,4,0,0,2,0,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [PV_Climate_Zone,1,Pre_and_Post_System,2,Rate_Vintage,1,PV_Sectors,1,Time,1]

Variable Vint_to_Prd_AllocEsc
Title: Vintage to Period Allocations and Escalation
Units: dmnls
Description: Multipliers to map rate vintages to time periods and to account for rate escalation.
Definition: VAR finalStartYear:=Max(Decimal_Start_Year, Rate_Vintage);~
~
IF Time_Fractional_Year  > (finalStartYear + 11/Timesteps_Per_Year)   {Holds the last vintage flat for 1 year before escalating}~
THEN Rate_Escalate_byVint * (Rate_Vintage_by_Time=Rate_Vintage)~
ELSE MIN([1, Rate_Escalate_byVint * (Rate_Vintage_by_Time=Rate_Vintage)])
NodeLocation: 560,176,1
NodeSize: 64,40
WindState: 2,164,23,1526,625
ValueState: 2,108,63,1526,697,0,MIDM
Att__TotalsIndex: []
Att_ResultSliceState: [Pre_and_Post_System,1,PV_Climate_Zone,1,Rate_Vintage,2,PV_Sectors,1,Time,1]

Variable Rate_Vintage_by_Time
Title: Rate Vintage by Time
Units: vintage
Description: The rate vintage for each period in the simulation.
Definition: Sorted_Vintages[Rate_Vintage=Sorted_Rate_Vintage]
NodeLocation: 560,56,1
NodeSize: 64,40
WindState: 2,669,28,970,350
ValueState: 2,260,43,1299,584,0,MIDM
Att_ResultSliceState: [Pre_and_Post_System,2,PV_Climate_Zone,3,PV_Sectors,1,Time,1]

Text FrameNode_1545067302
NodeLocation: 1008,320,-20
NodeSize: 360,304
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus: yes~
Show_description:20

Constant Rate_adjustment
Title: Rate adjustment (manual correction)
Description: For JEA we obtained rates in 2022 and are assuming rates at the end of March 2018 (when net metering changed) are lower due to 2.1% assumed inflation from April 2018 to beginning of 2022.
Definition: 1
NodeLocation: 376,384,1
NodeSize: 80,40
Aliases: FormNode Fo2109940899
NodeColor: 65535,65531,1

Close Rate_Vintage_Mapping

Decision Retail_Rate_Escalate
Title: Retail Rate Escalation
Units: fract/year
Description: The nominal annual rate at which retail rates will escalate into the future. Note that the inflation rate is assumed to be around 2.1%/year. This escalation rate must be greater than the inflation rate in order for retail rates to be escalating in real terms.
Definition: Table(Rate_Escalation_Scen)(0.01,0.021,0.035)
NodeLocation: 384,704,1
NodeSize: 64,40
WindState: 2,321,147,1008,424
DefnState: 2,853,409,416,303,0,DFNM
ValueState: 2,356,362,416,303,0,MIDM
Aliases: FormNode Fo1544567172, FormNode Fo1544570136, FormNode Fo1548967848
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15

Index Rate_Escalation_Scen
Att_PrevIndexValue: ['Low','Medium','High']
Title: Rate Escalation Scenarios
Definition: ['Low','Medium','High']
NodeLocation: 96,704,1
NodeSize: 64,40
Aliases: FormNode Fo1544567481

Decision Select_Rate_Escalate
Title: Rate Escalation Scenario
Description: Select the retail rates escalation scenario to apply. This will impact how retail rates escalate into the future.
Definition: Choice(Rate_Escalation_Scen,2,1)
NodeLocation: 240,704,1
NodeSize: 64,40
WindState: 2,102,113,720,319
Aliases: FormNode Fo1544567173, FormNode Fo1544570137, FormNode Fo1548967849

FormNode Fo1544567172
Title: Retail Rate Escalation
Definition: 0
NodeLocation: 392,756,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Retail_Rate_Escalate

FormNode Fo1544567173
Title: Selected Rate Escalation
Definition: 0
NodeLocation: 248,756,1
NodeSize: 72,12
NodeInfo: 1,0,0,0,0,0,0,102,0,,0,,,
Original: Select_Rate_Escalate

Variable Applied_RateEscalate
Title: Applied Rate Escalation
Units: fraction/year
Description: The applied retail rate escalation, per the user-selected scenario(s). This uses the inflation rate prior to the final calibration end period. The selected escalation rates will not be applied to calculations that escalate rates over the PV system lifetime, because we want those values (which aren't dimensioned by simulation time) to stay fixed during the calibration period regardless of the rate scenario. Any discrepancies between inflation rates and retail rate escalation rates will only manifest itself if levelized cost values are used in the long-run market share calculations.
Definition: IF NOT Allow_Rate_Inflation~
THEN 0~
ELSE IF Time <= PV_Calibration_End   {If during the calibration period}~
THEN Inflation_Rate   {Then use the inflation rate, to ensure that calibrated results aren't subject to changes in retail rate escalation scenarios}~
ELSE Retail_Rate_Escalate[Rate_Escalation_Scen=Select_Rate_Escalate]   {Else use the user-selected rate escalation}
NodeLocation: 536,704,1
NodeSize: 64,40
WindState: 2,312,35,1084,369
ValueState: 2,364,156,1281,718,0,MIDM

FormNode Fo1544567481
Title: Rate Escalation Scenarios
Definition: 0
NodeLocation: 96,756,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Rate_Escalation_Scen

Text FrameNode_1544920029
NodeLocation: 1040,312,-20
NodeSize: 360,304
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus: yes~
Show_description:20

Decision NonCoincDmd_Attribs
Title: Non-Coinc Demand Rate Attributes
Description: For each rate vintage, system type, climate zone, and sector, map the non-coincident demand rates to a particular data type. Additionally, specify which of the rate attributes are applicable to the given rate. If more than one attribute is selected, they will be summed together. These settings should coincide with how the rates are actually defined. For example, if a residential rate doesn't include any values for the 'adj' attribute, then including the 'adj' attribute in these selections will have no impact on the rates. To view the rate names assigned to each rate vintage, see the "Select Customer Rate" (Select_Customer_Rate) input table.~
~
Data Type options:~
"flatdemandstructure" -- typically used to define demand charges that can change by month, but not time of day.~
"demandratestucture" -- typically used to define demand charges that can change by time of day.~
"energyratestructure" -- used to define energy charges that can change by time of day~
~
Attribute options:~
"rate" - typically used to define the baseline charge (or credit if negative).~
"adj" - typically used to define an adjustment charge (or credit if negative). Often this is additive with the 'rate' charge.~
"sell" - typically used to define a compensation rate for energy exported to the grid when the export rate is different from some combination of the "rate" or "adj" attributes (ie, full net-metering)
Definition: Table(Rate_Vintage,PV_Climate_Zone,Pre_and_Post_System,All_Sectors,Rate_Attribute_Setti)(~
Choice(All_Data_Types,1,0),Checkbox(1),Checkbox(1),Checkbox(0),~
Choice(All_Data_Types,1,0),Checkbox(1),Checkbox(1),Checkbox(0),~
Choice(All_Data_Types,1,0),Checkbox(1),Checkbox(1),Checkbox(0),~
Choice(All_Data_Types,1,0),Checkbox(1),Checkbox(1),Checkbox(0),~
Choice(All_Data_Types,1,0),Checkbox(1),Checkbox(1),Checkbox(0),~
Choice(All_Data_Types,1,0),Checkbox(1),Checkbox(1),Checkbox(0),~
Choice(All_Data_Types,1,0),Checkbox(1),Checkbox(1),Checkbox(0),~
Choice(All_Data_Types,1,0),Checkbox(1),Checkbox(1),Checkbox(0))
NodeLocation: 96,464,1
NodeSize: 64,40
WindState: 2,52,379,1347,518
DefnState: 2,642,410,1081,431,0,DFNM
Aliases: FormNode Fo1547764385, Alias Al1547766712, FormNode Fo1547766739, FormNode Fo1547828218
NodeColor: 65535,65531,1
ReformDef: [Rate_Attribute_Setti,PV_Climate_Zone]
TableCellDefault: NonCoinc_Dmd_Default
Att_EditSliceState: [All_Sectors,2,Rate_Vintage,1,Pre_and_Post_System,1,PV_Climate_Zone,1,Rate_Attribute_Setti,1]

FormNode Fo1547764385
Title: Non-Coinc Demand Rate Attributes
Definition: 0
NodeLocation: 96,412,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: NonCoincDmd_Attribs

Decision OnPeak_Dmd_Attribs
Title: On-Peak Demand Rate Attributes
Description: For each rate vintage, system type, climate zone, and sector, map the on-peak demand rates to a particular data type. Additionally, specify which of the rate attributes are applicable to the given rate. If more than one attribute is selected, they will be summed together. These settings should coincide with how the rates are actually defined. For example, if a residential rate doesn't include any values for the 'adj' attribute, then including the 'adj' attribute in these selections will have no impact on the rates. To view the rate names assigned to each rate vintage, see the "Select Customer Rate" (Select_Customer_Rate) input table.~
~
Data Type options:~
"flatdemandstructure" -- typically used to define demand charges that can change by month, but not time of day.~
"demandratestucture" -- typically used to define demand charges that can change by time of day.~
"energyratestructure" -- used to define energy charges that can change by time of day~
~
Attribute options:~
"rate" - typically used to define the baseline charge (or credit if negative).~
"adj" - typically used to define an adjustment charge (or credit if negative). Often this is additive with the 'rate' charge.~
"sell" - typically used to define a compensation rate for energy exported to the grid when the export rate is different from some combination of the "rate" or "adj" attributes (ie, full net-metering)
Definition: Table(Rate_Vintage,PV_Climate_Zone,Pre_and_Post_System,All_Sectors,Rate_Attribute_Setti)(~
Choice(All_Data_Types,2,0),Checkbox(1),Checkbox(1),Checkbox(0),~
Choice(All_Data_Types,2,0),Checkbox(1),Checkbox(1),Checkbox(0),~
Choice(All_Data_Types,2,0),Checkbox(1),Checkbox(1),Checkbox(0),~
Choice(All_Data_Types,2,0),Checkbox(1),Checkbox(1),Checkbox(0),~
Choice(All_Data_Types,2,0),Checkbox(1),Checkbox(1),Checkbox(0),~
Choice(All_Data_Types,2,0),Checkbox(1),Checkbox(1),Checkbox(0),~
Choice(All_Data_Types,2,0),Checkbox(1),Checkbox(1),Checkbox(0),~
Choice(All_Data_Types,2,0),Checkbox(1),Checkbox(1),Checkbox(0))
NodeLocation: 96,576,1
NodeSize: 64,40
WindState: 2,126,248,1003,603
DefnState: 2,331,295,1081,431,0,DFNM
Aliases: FormNode Fo1547765306, Alias Al1547766713, FormNode Fo1547766740, FormNode Fo1547828219
NodeColor: 65535,65531,1
ReformDef: [Rate_Attribute_Setti,PV_Climate_Zone]
TableCellDefault: On_Peak_Dmd_Default
Att_EditSliceState: [All_Sectors,2,Rate_Vintage,1,Pre_and_Post_System,2,PV_Climate_Zone,1,Rate_Attribute_Setti,1]

FormNode Fo1547765306
Title: Non-Coinc Demand Rate Attributes
Definition: 0
NodeLocation: 96,524,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: OnPeak_Dmd_Attribs

Decision Energy_Rate_Attribs
Title: Energy Rate Attributes
Description: For each rate vintage, system type, climate zone, and sector, map the energy rates to a particular data type. Additionally, specify which of the rate attributes are applicable to the given rate. If more than one attribute is selected, they will be summed together. These settings should coincide with how the rates are actually defined. For example, if a residential rate doesn't include any values for the 'adj' attribute, then including the 'adj' attribute in these selections will have no impact on the rates. To view the rate names assigned to each rate vintage, see the "Select Customer Rate" (Select_Customer_Rate) input table.~
~
Data Type options:~
"flatdemandstructure" -- typically used to define demand charges that can change by month, but not time of day.~
"demandratestucture" -- typically used to define demand charges that can change by time of day.~
"energyratestructure" -- used to define energy charges that can change by time of day~
~
Attribute options:~
"rate" - typically used to define the baseline charge (or credit if negative).~
"adj" - typically used to define an adjustment charge (or credit if negative). Often this is additive with the 'rate' charge.~
"sell" - typically used to define a compensation rate for energy exported to the grid when the export rate is different from some combination of the "rate" or "adj" attributes (ie, full net-metering)
Definition: Table(Rate_Vintage,PV_Climate_Zone,Pre_and_Post_System,All_Sectors,Rate_Attribute_Setti)(~
Choice(All_Data_Types,3,0),Checkbox(1),Checkbox(1),Checkbox(1),~
Choice(All_Data_Types,3,0),Checkbox(1),Checkbox(1),Checkbox(1),~
Choice(All_Data_Types,3,0),Checkbox(1),Checkbox(1),Checkbox(1),~
Choice(All_Data_Types,3,0),Checkbox(1),Checkbox(1),Checkbox(1),~
Choice(All_Data_Types,3,0),Checkbox(1),Checkbox(1),Checkbox(1),~
Choice(All_Data_Types,3,0),Checkbox(1),Checkbox(1),Checkbox(1),~
Choice(All_Data_Types,3,0),Checkbox(1),Checkbox(1),Checkbox(1),~
Choice(All_Data_Types,3,0),Checkbox(1),Checkbox(1),Checkbox(1))
NodeLocation: 408,312,1
NodeSize: 64,40
WindState: 2,358,80,1224,565
DefnState: 2,457,405,1083,246,0,DFNM
Aliases: FormNode Fo1547766195, Alias Al1547767161, FormNode Fo1547767167, FormNode Fo1547828220
NodeColor: 65535,65531,1
ReformDef: [Rate_Attribute_Setti,Pre_and_Post_System]
TableCellDefault: Energy_DefaultAttrib
Att_EditSliceState: [All_Sectors,2,PV_Climate_Zone,1,Rate_Vintage,1,Pre_and_Post_System,2,Rate_Attribute_Setti,1]

Module Rate_Attribute_Mappi
Title: Rate Attribute Mapping
Author: JamesMilford
Date: Thu, Jan 24, 2019 11:22 AM
NodeLocation: 944,800,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,1,0,791,594,17,10

Decision NonCoinc_Dmd_Default
Title: Non-Coinc Dmd Default Attributes
Description: Default data attribute assignments for non-coincident demand rates.
Definition: Table(Rate_Attribute_Setti)(Choice(All_Data_Types,1,0),Checkbox(1),Checkbox(1),Checkbox(0))
NodeLocation: 96,200,1
NodeSize: 64,40
WindState: 2,1803,82,720,350
DefnState: 2,107,348,416,303,,DFNM

Variable NonCoincDmd_DataType
Title: Non-Coinc Dmd Data Type
Description: The data type used for non-coincident demand rates.
Definition: NonCoincDmd_Attribs[All_Sectors=PV_Sectors, Rate_Attribute_Setti=Rate_Structure_Label]
NodeLocation: 400,200,1
NodeSize: 64,40
ValueState: 2,264,266,818,480,,MIDM

Decision Map_Attrib_toSetting
Title: Map Attributes to Settings
Description: Map the rate attributes to each of the rate attibute settings.
Definition: Table(Included_Attributes)(Choice(Data_Attribute,1,0),Choice(Data_Attribute,3,0),Choice(Data_Attribute,4,0))
NodeLocation: 400,96,1
NodeSize: 64,40
WindState: 2,7,555,720,350
DefnState: 2,194,175,1081,431,0,DFNM
ReformDef: [Rate_Attribute_Setti,PV_Climate_Zone]
TableCellDefault: Choice(Data_Attribute,1,0)
Att_EditSliceState: [All_Sectors,1,Rate_Vintage,1,Pre_and_Post_System,2,PV_Climate_Zone,1,Rate_Attribute_Setti,1]

Variable Incl_NC_Dmd_Attribs
Title: Included Non-Coinc Dmd Attributes
Description: The rate attributes considered for non-coincident demand rates. If more than one attribute is selected, they will be summed together.
Definition: NonCoincDmd_Attribs[All_Sectors=PV_Sectors, Rate_Attribute_Setti=Map_Setting_toAttrib]
NodeLocation: 552,200,1
NodeSize: 64,40
ValueState: 2,194,293,818,480,0,MIDM
Att_ResultSliceState: [PV_Sectors,2,Pre_and_Post_System,1,Data_Attribute,3,PV_Climate_Zone,1,Rate_Vintage,1]

Variable Map_Setting_toAttrib
Title: Map Settings to Attributes
Description: A map of rate attribute settings associated with each generalized rate attribute.
Definition: SubIndex(Map_Attrib_toSetting, Data_Attribute, Included_Attributes)
NodeLocation: 552,96,1
NodeSize: 64,40

Decision On_Peak_Dmd_Default
Title: On-Peak Dmd Default Attributes
Description: Default data attribute assignments for on-peak demand rates.
Definition: Table(Rate_Attribute_Setti)(Choice(All_Data_Types,2,0),Checkbox(1),Checkbox(1),Checkbox(0))
NodeLocation: 96,312,1
NodeSize: 64,40
WindState: 2,82,526,720,350
DefnState: 2,896,241,416,303,0,DFNM

Variable OnPeakDmd_DataType
Title: On-Peak Dmd Data Type
Description: The data type used for on-peak demand rates.
Definition: OnPeak_Dmd_Attribs[All_Sectors=PV_Sectors, Rate_Attribute_Setti=Rate_Structure_Label]
NodeLocation: 400,312,1
NodeSize: 64,40
ValueState: 2,264,266,818,480,0,MIDM

Variable Incl_OnPkDmd_Attribs
Title: Included On-Peak Dmd Attributes
Description: The rate attributes considered for on-peak demand rates. If more than one attribute is selected, they will be summed together.
Definition: OnPeak_Dmd_Attribs[All_Sectors=PV_Sectors, Rate_Attribute_Setti=Map_Setting_toAttrib]
NodeLocation: 552,312,1
NodeSize: 64,40
ValueState: 2,194,293,818,480,0,MIDM
Att_ResultSliceState: [PV_Sectors,2,Pre_and_Post_System,1,Data_Attribute,3,PV_Climate_Zone,1,Rate_Vintage,1]

Decision Energy_DefaultAttrib
Title: Energy Default Attributes
Description: Default data attribute assignments for energy rates.
Definition: Table(Rate_Attribute_Setti)(Choice(All_Data_Types,3,0),Checkbox(1),Checkbox(1),Checkbox(1))
NodeLocation: 96,424,1
NodeSize: 64,40
WindState: 2,1803,82,720,350
DefnState: 2,107,348,416,303,,DFNM

FormNode Fo1547766195
Title: Non-Coinc Demand Rate Attributes
Definition: 0
NodeLocation: 248,372,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Energy_Rate_Attribs

Variable Energy_DataType
Title: Energy Data Type
Description: The data type used for energy rates.
Definition: Energy_Rate_Attribs[All_Sectors=PV_Sectors, Rate_Attribute_Setti=Rate_Structure_Label]
NodeLocation: 400,424,1
NodeSize: 64,40
WindState: 2,76,498,1502,350
ValueState: 2,264,266,818,480,0,MIDM
Att_ResultSliceState: [PV_Sectors,1,Pre_and_Post_System,1,PV_Climate_Zone,1,Rate_Vintage,1]

Variable Incl_Energy_Attribs
Title: Included Energy Attributes
Description: The rate attributes considered for energy rates. If more than one attribute is selected, they will be summed together.
Definition: Energy_Rate_Attribs[All_Sectors=PV_Sectors, Rate_Attribute_Setti=Map_Setting_toAttrib]
NodeLocation: 552,424,1
NodeSize: 64,40
WindState: 2,2308,78,720,740
ValueState: 2,1098,433,608,296,0,MIDM
Aliases: Alias Al387627171
ReformVal: [Data_Attribute,Pre_and_Post_System]
Att_ResultSliceState: [PV_Climate_Zone,1,Rate_Vintage,1,PV_Sectors,2,Pre_and_Post_System,2,Data_Attribute,3]

Alias Al1547766712
Title: Non-Coinc Demand Rate Attributes
Definition: 1
NodeLocation: 248,200,1
NodeSize: 64,40
Original: NonCoincDmd_Attribs

Alias Al1547766713
Title: On-Peak Demand Rate Attributes
Definition: 1
NodeLocation: 248,312,1
NodeSize: 64,40
Original: OnPeak_Dmd_Attribs

FormNode Fo1547766739
Title: Non-Coinc Demand Rate Attributes
Definition: 0
NodeLocation: 248,148,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: NonCoincDmd_Attribs

FormNode Fo1547766740
Title: Non-Coinc Demand Rate Attributes
Definition: 0
NodeLocation: 248,260,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: OnPeak_Dmd_Attribs

Alias Al1547767161
Title: Energy Rate Attributes
Definition: 1
NodeLocation: 248,424,-3
NodeSize: 64,40
Original: Energy_Rate_Attribs

Close Rate_Attribute_Mappi

FormNode Fo1547766909
Title: Select Customer Rate
Definition: 0
NodeLocation: 104,164,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Select_Customer_Rate

FormNode Fo1547767167
Title: Non-Coinc Demand Rate Attributes
Definition: 0
NodeLocation: 416,268,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Energy_Rate_Attribs

FormNode Fo929231395
Title: Allow Rate Inflation
Definition: 0
NodeLocation: 340,888,1
NodeSize: 180,16
NodeInfo: 1,,,,,,,80,,,,,,0
Original: Allow_Rate_Inflation

Constant Additional_Value
Title: Additional Value
Units: $/kWh
Description: Environmental and other adders (e.g. community credit or other envisioned adders) are a constant $/kWh for every hour of the day. ~
~
Although LSRV values would actually vary by hour of day, we offer the ability to input an overall average LSRV for simplicity of data input.
Definition: Table(Additional_Value_Sce,Value_Type,PV_Climate_Zone)(~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0)
NodeLocation: 784,192,1
NodeSize: 64,40
WindState: 2,437,262,720,350
DefnState: 2,570,220,578,215,0,DFNM
Aliases: FormNode Fo48726307
NodeColor: 65535,1,1
ReformDef: [Value_Type,PV_Climate_Zone]
NumberFormat: 2,F,3,4,0,1,3,0,$,0,"ABBREV",0,,,0,0,15,
Att_EditSliceState: [Additional_Value_Sce,1,PV_Climate_Zone,1,Value_Type,1]
{!40700|Att_CellFormat: CellAlignment('Center')}
{!50000|Att_ColumnWidths: [,Value_Type,\([,164,92])]}

Index Value_Type
Att_PrevIndexValue: ['Environmental','Other Adder','LSRV']
Title: Value Type
Definition: ['Environmental','Other Adder','LSRV']
NodeLocation: 992,248,1
NodeSize: 64,40

Text Te1681974819
Title: Note this additional value adder is really only applicable to the NYPA study where all value is effectively net metered per the value stack, and load is irrelevant. 
NodeLocation: 1096,416,-1
NodeSize: 152,104

Module Mo3
Author: CWelch
Date: Fri, Apr 1, 2022 12:17 PM
NodeLocation: 1112,768,1
NodeSize: 64,40
NodeInfo: 1,0,0
DiagState: 2,2025,-9,944,480,17,10

Alias Al144060707
Title: Energy Price
Definition: 1
NodeLocation: 192,64,1
NodeSize: 64,40
Original: Energy_Price

Alias Al345387299
Title: Monthly Minimum
Definition: 1
NodeLocation: 184,168,1
NodeSize: 64,40
Original: Monthly_Minimum

Alias Al1553346851
Title: Non-Coincident Demand Price
Definition: 1
NodeLocation: 176,264,1
NodeSize: 64,40
Original: Non_Coinc_Dmd_Price

Alias Al177615139
Title: On-Peak Demand Price
Definition: 1
NodeLocation: 176,360,1
NodeSize: 64,40
Original: On_Peak_Demand_Price

Alias Al1989554467
Title: Basic Service Fees
Definition: 1
NodeLocation: 360,360,1
NodeSize: 64,40
Original: Basic_Service_Fees

Close Mo3

Variable Levelized_Inflation_
Title: Levelized Inflation Multiplier
Definition: local x:=(1+ Inflation_Rate)^(PV_Operating_Year-1);~
PMT(Nominal_Equity_Rate, Economic_Lifetime, -NPV(Nominal_Equity_Rate, x, PV_Operating_Year))~

NodeLocation: 672,936,1
NodeSize: 64,40
ValueState: 2,872,310,416,303,0,MIDM

Index Additional_Value_Sce
Att_PrevIndexValue: ['Low','Medium','High']
Title: Additional Value Scenario
Definition: ['Low','Medium','High']
NodeLocation: 784,312,1
NodeSize: 64,40
DisplayOutputs: Object Object, Object Decision
{!40300|Att_SlicerPopupSize: 227,109}

Decision Additional_Value_Sc1
Title: Additional Value Scenario
Definition: Choice(Additional_Value_Sce,2,1)
NodeLocation: 784,416,1
NodeSize: 64,40

Module Non_Net_Metering_Ene
Title: Non Net Metering Energy Costs
Author: CWelch
Date: Thu, May 26, 2022 4:01 PM
NodeLocation: 256,104,1
NodeSize: 64,40
DiagState: 2,41,56,1581,545,17,10

Variable Energy_Cost_by_Tier_
Title: Energy Cost by Tier,Pd,BuySell
Units: $
Description: The volumetric energy cost by tier and period.
Definition: Consumption_by_Tier_ * Energy_Price_Buy_Se1
NodeLocation: 672,168,1
NodeSize: 72,40
ValueState: 2,1067,304,453,395,0,MIDM
GraphSetup: Graph_SymbolKey:1~
Att_CatLineStyle Graph_Primary_Valdim:5
ReformVal: [Pre_and_Post_System,Buy_or_Sell_]
NumberFormat: 2,F,2,0,1,0,2,0,$,0,"ABBREV",0,,,0,0,15,
Att__TotalsIndex: [Buy_or_Sell_,Periods,Month,Tiers]
Att_ResultSliceState: [PV_Sectors,2,Rate_Vintage,1,System_Types,1,Tiers,0,Month,0,Area_Type,1,Periods,0,PV_Climate_Zone,1,Buy_or_Sell_,1,Pre_and_Post_System,1]
Att_ColorRole: Periods
Att_SymbolRole: Tiers
{!40600|Att_StackingIndex: Tiers}
{!40600|Att_ClusterIndex: Null}

Alias Al380942499
Title: Consumption by TOU Period
Definition: 1
NodeLocation: 96,168,1
NodeSize: 64,40
Original: Consum_by_TOU_Prd

Alias Al1907669155
Title: Max Energy for Tiers
Definition: 1
NodeLocation: 104,376,1
NodeSize: 64,40
NodeColor: 57311,57311,57311
Original: Max_Energy_for_Tiers

Alias Al162838691
Title: Monthly Consumption By Tier
Definition: 1
NodeLocation: 264,264,1
NodeSize: 64,40
Original: Mthly_Consump_Tier

Alias Al1236580515
Title: Pct Consumption by Tier
Definition: 1
NodeLocation: 416,264,1
NodeSize: 64,40
Original: Pct_Consump_by_Tier

Alias Al699709603
Title: Consumption by Tier & Period
Definition: 1
NodeLocation: 304,168,1
NodeSize: 64,40
Original: Consum_by_Tier_Prd

Alias Al1773451427
Title: Monthly Consumption
Definition: 1
NodeLocation: 96,264,1
NodeSize: 64,40
Original: Monthly_Consump

Alias Al733264035
Title: Pre/Post Load by OpYr
Definition: 1
NodeLocation: 88,64,1
NodeSize: 64,40
NodeColor: 19661,48336,65535
Original: PrePost_Load_by_OpYr

Index Buy_or_Sell_
Title: Buy or Sell?
Definition: ['Buy','Sell']
NodeLocation: 1248,72,1
NodeSize: 64,40
{!40300|Att_SlicerPopupSize: 232,48}

Alias Al737458339
Title: Energy Rate Attributes
Definition: 1
NodeLocation: 1360,240,1
NodeSize: 64,40
Original: Energy_Rate_Attribut

Alias Al1053604003
Title: Format Rate Values
Definition: 1
NodeLocation: 728,488,1
NodeSize: 64,40
Original: Format_Rate_Values

Variable Energy_Price_Buy_Se1
Title: Energy Price Buy Sell
Definition: local sell_if_nonnull:=Data_by_Tier_Period[Rate_Names=Selected_Cust_Rates, All_Data_Types=Energy_DataType, All_Periods=Periods, All_Tiers=Tiers,Data_Attribute=Sell_Attribute_Label] * OpYr_Inflate_Factor;~
local buy:=Sum(Data_by_Tier_Period[Rate_Names=Selected_Cust_Rates, All_Data_Types=Energy_DataType, All_Periods=Periods, All_Tiers=Tiers] * Incl_Energy_Attribs * (Data_Attribute<>Sell_Attribute_Label), Data_Attribute);~
local sell:=IF sell_if_nonnull=null THEN buy else sell_if_nonnull;~
local price:=IF Buy_or_Sell_=Sell_Price_Label THEN sell ELSE ~
buy;~
Replace_X_with_Y(price,null,0) * OpYr_Inflate_Factor
NodeLocation: 672,288,1
NodeSize: 64,40
ValueState: 2,528,188,604,284,0,MIDM
ReformVal: [Buy_or_Sell_,Periods]
NumberFormat: 2,F,2,3,0,0,2,0,$,0,"ABBREV",0,,,0,0,15,
Att_ResultSliceState: [PV_Climate_Zone,1,Tiers,1,PV_Sectors,2,Rate_Vintage,1,Pre_and_Post_System,2,Periods,1,Buy_or_Sell_,2]

Alias Al1960622243
Title: Data by Tier & Period
Definition: 1
NodeLocation: 520,496,1
NodeSize: 64,40
NodeColor: 65535,39321,39321
Original: Data_by_Tier_Period

Variable PrePost_Load_BuySell
Title: PrePost Load, BuySell
Definition: IF Buy_or_Sell_=Sell_Price_Label THEN PrePost_Load_by_OpYr * (PrePost_Load_by_OpYr<0) ELSE~
PrePost_Load_by_OpYr * (PrePost_Load_by_OpYr>=0)
NodeLocation: 248,64,1
NodeSize: 64,40
ValueState: 2,226,42,1234,766,0,MIDM
ReformVal: [Profile_Hours,Buy_or_Sell_]
Att_ResultSliceState: [PV_Sectors,1,Rate_Vintage,1,PV_Climate_Zone,1,System_Types,1,Pre_and_Post_System,2,Area_Type,1,Month,8,Buy_or_Sell_,1,Profile_Hours,1]
{!40600|Att_StackingIndex: Buy_or_Sell_}
{!40600|Att_ClusterIndex: Null}

Variable Consumption_by_Tier_
Title: Consumption by Tier,Pd,BuySell
Definition: Aggregate(PrePost_Load_BuySell * Load_Monthly_Mults, Periods_by_ProfileHr[Data_Types=Energy_Rate_Label], Profile_Hours, Periods) * Pct_Consump_by_Tier
NodeLocation: 464,104,1
NodeSize: 72,40
ValueState: 2,274,45,1125,832,,MIDM
GraphSetup: {!50000|Graph_SortBySpread:0}~
Att_StackedBar Graph_Primary_Valdim:0~
{!50007|Graph_BarOutline:1}
ReformVal: [Month,Buy_or_Sell_]
Att__TotalsIndex: [Periods,Tiers]
Att_ResultSliceState: [PV_Sectors,2,Rate_Vintage,1,PV_Climate_Zone,1,System_Types,1,Pre_and_Post_System,2,Periods,0,Tiers,0,Area_Type,1,Buy_or_Sell_,1,Month,1]
{!40600|Att_StackingIndex: Buy_or_Sell_}
{!40600|Att_ClusterIndex: Null}

Variable Energy_Cost_w_Sell
Title: Energy Cost by Tier, Pd accting for sell attr
Definition: sum(Energy_Cost_by_Tier_,Buy_or_Sell_)
NodeLocation: 848,168,1
NodeSize: 72,40
ValueState: 2,370,147,1222,724,0,MIDM
GraphSetup: {!50000|Graph_SortBySpread:0}~
Att_StackedBar Graph_Primary_Valdim:0
ReformVal: [Month,Pre_and_Post_System]
Att__TotalsIndex: [Month,Periods,Tiers]
Att_ResultSliceState: [PV_Sectors,1,PV_Climate_Zone,1,System_Types,1,Area_Type,1,Periods,0,Tiers,0,Rate_Vintage,1,Pre_and_Post_System,2,Month,1]
{!40600|Att_StackingIndex: Pre_and_Post_System}
{!40600|Att_ClusterIndex: Rate_Vintage}

Alias Al387627171
Title: Included Energy Attributes
Definition: 1
NodeLocation: 376,376,1
NodeSize: 64,40
Original: Incl_Energy_Attribs

Variable Any_non_net_metering
Title: Any non net-metering?
Definition: Incl_Energy_Attribs[Data_Attribute='sell']=1
NodeLocation: 872,376,1
NodeSize: 64,40
ValueState: 2,860,527,816,236,0,MIDM
NodeColor: 65535,1,1
Att_ResultSliceState: [PV_Climate_Zone,1,Pre_and_Post_System,2,Rate_Vintage,1,PV_Sectors,1]

Variable Va46
Definition: Energy_Price_Buy_Se1[ Buy_or_Sell_='Buy'] <> Energy_Price_Buy_Se1[ Buy_or_Sell_='Sell'] 
NodeLocation: 872,280,1
NodeSize: 64,40
ValueState: 2,73,244,610,334,0,MIDM

Text Te335955107
Title: Need to apply inflation properly here?
NodeLocation: 1204,376,-1
NodeSize: 172,24

Decision Sell_Price_Label
Title: Sell Price Label
Definition: Choice(Buy_or_Sell_,2,0)
NodeLocation: 1088,72,1
NodeSize: 64,40
NodeInfo: 1,,,,,,,0,,,,,,0
Aliases: FormNode Fo1332143267

FormNode Fo1332143267
Title: Sell Attribute Label
Definition: 0
NodeLocation: 1092,120,1
NodeSize: 52,16
NodeInfo: 1,,,0,,,,74
Original: Sell_Price_Label

Decision Buy_Price_Label
Title: Buy Price Label
Definition: Choice(Buy_or_Sell_,1,0)
NodeLocation: 1080,184,1
NodeSize: 64,40
NodeInfo: 1,,,,,,,0,,,,,,0
Aliases: FormNode Fo1016521891

FormNode Fo1016521891
Title: Buy Price Label
Definition: 0
NodeLocation: 1096,232,1
NodeSize: 48,16
NodeInfo: 1,,,0
Original: Buy_Price_Label

Text Te40345875
NodeLocation: 1504,128,-1
NodeSize: 64,40

FormNode Fo1785176339
Title: Allow Rate Inflation
Definition: 0
NodeLocation: 996,440,1
NodeSize: 180,16
NodeInfo: 1,,,,,,,80,,,,,,0
Original: Allow_Rate_Inflation

Close Non_Net_Metering_Ene

Variable Energy_Cost_Tier_Pr1
Title: Energy Cost by Tier and Period
Units: $
Description: The volumetric energy cost by tier and period.
Definition: Consum_by_Tier_Prd * Energy_Price 
NodeLocation: 256,200,1
NodeSize: 64,40
ValueState: 2,522,152,1050,385,0,MIDM
GraphSetup: Graph_SymbolKey:1~
Att_CatLineStyle Graph_Primary_Valdim:5
ReformVal: [Month,Periods]
NumberFormat: 2,F,2,0,1,0,2,0,$,0,"ABBREV",0,,,0,0,15,
Att__TotalsIndex: [Periods,Month]
Att_ResultSliceState: [PV_Sectors,1,Rate_Vintage,1,System_Types,1,Tiers,1,Area_Type,1,PV_Climate_Zone,1,Pre_and_Post_System,2,Periods,0,Month,8]
Att_ColorRole: Periods
Att_SymbolRole: Tiers
{!40600|Att_StackingIndex: Tiers}
{!40600|Att_ClusterIndex: Null}

Text Te230344979
Title: Need to factor in net metering rules that don't allow negative charges for the year for a particular TOU period (e.g., for excess solar generation in that period)
NodeLocation: 960,92,-1
NodeSize: 280,44
NodeColor: 65535,1,1

Close Energy_and_Demand_Co

Module Utility_Bills_and_Bi
Title: Utility Bills and Bill Ratios
Author: JamesMilford
Date: Thu, Aug 23, 2018 5:16 PM
NodeLocation: 400,152,1
NodeSize: 64,40
NodeInfo: 1,0,0
DiagState: 2,153,34,1549,650,17,10
Aliases: Alias Al1548967140
NodeColor: 65535,65535,65535
AcpStyles: FrameNode: FrameNode_1544920081

Objective Mthly_Bill_Component
Title: Monthly Bill Components
Units: $
Definition: Table(Bill_Components)(Basic_Service_Fees,Mthly_Minimum_Charge,Energy_Costs_by_Comp,Energy_Costs_by_Comp,Energy_Costs_by_Comp,Energy_Costs_by_Comp,Energy_Costs_by_Comp,Energy_Costs_by_Comp,Energy_Costs_by_Comp,Energy_Costs_by_Comp,Energy_Costs_by_Comp,Energy_Costs_by_Comp,Non_Coinc_Dmd_Cost,Sum(OnPkDmd_Cost_TierPrd[Periods='period1'],Tiers),Sum(OnPkDmd_Cost_TierPrd[Periods='period2'],Tiers),0)
NodeLocation: 240,184,1
NodeSize: 64,40
NodeInfo: 1,1,1,1,1,1,0,,0,,0,,,
WindState: 2,64,-13,1152,529
DefnState: 2,427,483,1366,400,0,DFNM
ValueState: 2,531,319,843,613,0,MIDM
NodeColor: 19661,48336,65535
GraphSetup: {!40600|Att_WaterfallBar Graph_Primary_Valdim:1}~
Att_CatLineStyle Graph_Primary_Valdim:9~
Att_StackedBar Graph_Primary_Valdim:1
ReformVal: [Pre_and_Post_System,Bill_Components]
Att__TotalsIndex: [Month,Bill_Components]
Att_ResultSliceState: [PV_Sectors,1,PV_Climate_Zone,1,Month,0,Rate_Vintage,1,PV_Operating_Year,11,System_Types,1,Area_Type,1,Bill_Components,1,Pre_and_Post_System,1]
{!40600|Att_StackingIndex: Bill_Components}
{!40600|Att_ClusterIndex: Null}
{!50000|Att_ColumnWidths: [1075]}

Variable Monthly_Utility_Bill
Title: Monthly Utility Bill
Units: $/system
Definition: Monthly_Energy_Cost + Non_Coinc_Dmd_Cost + On_Peak_Demand_Cost + Basic_Service_Fees + Mthly_Minimum_Charge
NodeLocation: 88,72,1
NodeSize: 64,40
WindState: 2,49,30,720,350
ValueState: 2,753,63,805,761,0,MIDM
ReformVal: [Pre_and_Post_System,PV_Sectors]
Att__TotalsIndex: [Month]
Att_ResultSliceState: [System_Types,1,Month,0,PV_Climate_Zone,2,PV_Operating_Year,1,Rate_Vintage,1,Area_Type,1,PV_Sectors,2,Pre_and_Post_System,2]

Variable Annual_Utility_Bill
Title: Annual Utility Bill
Units: $/year-system
Definition: Sum(Monthly_Utility_Bill, Month)
NodeLocation: 240,48,1
NodeSize: 64,40
ValueState: 2,966,559,485,234,0,MIDM
GraphSetup: Att_StackedBar Graph_Primary_Valdim:0~
Att_CatLineStyle Graph_Primary_Valdim:9
ReformVal: [System_Types,Area_Type]
NumberFormat: 2,F,2,0,1,0,2,0,$,0,"ABBREV",0,,,0,0,15,
Att_ResultSliceState: [PV_Sectors,2,PV_Climate_Zone,1,Pre_and_Post_System,1,Rate_Vintage,2,Area_Type,1,System_Types,2]
{!40600|Att_StackingIndex: PV_Climate_Zone}
{!40600|Att_ClusterIndex: System_Types}

Variable FirstYr_Bill_by_Vint
Title: First-Year Bill Comparison by Vintage
Units: $
Description: Comparison of the components of electric bill (utility bill only, exclusive of any system financing or lease payments) before and after system installation.
Definition: IF NOT Map_Charges_to_Sect[All_Sectors=PV_Sectors]~
THEN Null~
ELSE IF System_Comparison = Cost_Savings_Label~
THEN Bill_Savings_by_Comp~
ELSE Mthly_Bill_Component[Pre_and_Post_System=System_Comparison, PV_Operating_Year=1]
NodeLocation: 392,296,1
NodeSize: 64,40
ValueState: 2,416,96,1001,648,1,MIDM
Aliases: FormNode Fo1544373571, FormNode Fo1572476404
GraphSetup: Att_ForceCategorical Graph_Primary_Valdim:1~
Att_StackedBar Graph_Primary_Valdim:1~
Graph_AxisTitleFont:Arial,18,1~
Graph_AxisLabelFont:,18,0~
Graph_KeyTitleFont:,18,1~
Graph_KeyFont:,18,0~
Graph_HLabelRotation:0~
{!40600|Att_WaterfallBar Graph_Primary_Valdim:1}~
Att_CatLineStyle Graph_Primary_Valdim:9
ReformVal: [System_Comparison,Bill_Components]
NumberFormat: 2,F,2,0,1,0,2,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [Bill_Components,Month]
Att_ResultSliceState: [PV_Sectors,2,Month,0,PV_Climate_Zone,1,System_Types,1,Rate_Vintage,5,Bill_Components,0,System_Comparison,3]
{!40600|Att_StackingIndex: Rate_Vintage}
{!40600|Att_ClusterIndex: Rate_Vintage}
{!40700|Att_CellFormat: Undefined}

Variable Bill_Savings_by_Comp
Title: Bill Savings by Component
Units: $/month
Description: The bill savings by rate component.
Definition: VAR negatePost:=IF Pre_and_Post_System=Post_System_Label~
   THEN -1~
   ELSE 1;~
Sum(Mthly_Bill_Component[@PV_Operating_Year=1] * negatePost, Pre_and_Post_System)
NodeLocation: 392,184,1
NodeSize: 64,40
ValueState: 2,461,303,608,587,0,MIDM
ReformVal: [Rate_Vintage,Bill_Components]
Att__TotalsIndex: [Month,Bill_Components]
Att_ResultSliceState: [PV_Sectors,1,PV_Climate_Zone,1,PV_Operating_Year,1,System_Types,1,Month,0,Bill_Components,1,Rate_Vintage,1]
{!40600|Att_ClusterIndex: Bill_Components}

Variable Lev_Ann_Bill_byYr
Title: Levelized Annual Bill by Year
Units: $/year-system
Description: The levelized annual utility bill after accounting for inflation over the time dimension.
Definition: Aggregate(Lev_Ann_Bill_Time, Time_Year_Map, Time, Annual_Econ_Time, "Average", noMapError: True)
NodeLocation: 728,48,1
NodeSize: 64,40
WindState: 2,102,82,879,350
ValueState: 2,217,83,1103,699,0,MIDM
Aliases: Alias Al1538108395, Alias Al1538109016
ReformVal: [Annual_Econ_Time,System_Types]
Att_ResultSliceState: [PV_Sectors,2,Pre_and_Post_System,2,PV_Climate_Zone,2,Area_Type,1,System_Types,1,Annual_Econ_Time,1]

Variable Inflate_FirstYr_Bill
Title: Inflated First Year Utility Bill
Units: $/year-system
Description: The first-year utility bill inflated over time.
Definition: Sum(First_Year_Utility_B * Vint_to_Prd_AllocEsc, Rate_Vintage)
NodeLocation: 720,184,1
NodeSize: 64,40
WindState: 2,168,286,720,350
ValueState: 2,642,124,1052,613,1,MIDM
ReformVal: [Annual_Econ_Time,Pre_and_Post_System]
NumberFormat: 2,F,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [PV_Sectors,1,PV_Climate_Zone,1,System_Types,1,Pre_and_Post_System,1,Time_Solar_PV,1]

Variable FirstYr_BillSav_Time
Title: First Year Bill Savings by Time
Units: $/year-system
Description: The first-year bill savings between post-system and pre-system conditions.
Definition: Inflate_FirstYr_Bill[Pre_and_Post_System=Pre_System_Label] - Inflate_FirstYr_Bill[Pre_and_Post_System=Post_System_Label]
NodeLocation: 872,184,1
NodeSize: 64,40
ValueState: 2,2391,126,1138,759,0,MIDM
ReformVal: [Time,PV_Sectors]
NumberFormat: 2,F,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [System_Types,2,PV_Climate_Zone,1,Area_Type,1,PV_Sectors,2,Time,1]
{!40700|Att_CellFormat: Undefined}

Variable Lev_BaseYr_Bill
Title: Levelized Base Year Bill by Vintage
Units: $/year-system
Description: The levelized annual utility bill in the base year. These will later be inflated over the time dimension to account for bills in years other than the base year.
Definition: Annual_Utility_Bill/*PMT(Nominal_Equity_Rate, Economic_Lifetime, -NPV(Nominal_Equity_Rate, Annual_Utility_Bill, PV_Operating_Year))
NodeLocation: 392,48,1
NodeSize: 64,40
WindState: 2,102,82,1300,499
ValueState: 2,2647,151,927,581,0,MIDM
NodeColor: 65535,39321,39321
ReformVal: [Pre_and_Post_System,System_Types]
NumberFormat: 2,F,2,0,1,0,2,0,$,0,"ABBREV",0,,,0,0,15,
Att_ResultSliceState: [PV_Sectors,2,PV_Climate_Zone,1,Rate_Vintage,4,System_Types,1,Pre_and_Post_System,1]

Variable FirstYr_BillSav_byYr
Title: First Year Bill Savings by Year
Units: $/year-system
Description: The first-year bill savings between post-system and pre-system conditions.
Definition: Aggregate(FirstYr_BillSav_Time, Time_Year_Map, Time, Annual_Econ_Time, "Average", noMapError: True)
NodeLocation: 1024,184,1
NodeSize: 64,40
WindState: 2,112,499,720,350
ValueState: 2,431,228,744,645,,MIDM
Att_ResultSliceState: [PV_Sectors,1,System_Types,2,PV_Climate_Zone,1,Area_Type,1,Annual_Econ_Time,1]

Variable Lev_Ann_Bill_Time
Title: Levelized Annual Bill by Time
Units: $/year-system
Description: The levelized annual utility bill after accounting for inflation over the time dimension.
Definition: Sum(Lev_BaseYr_Bill * Vint_to_Prd_AllocEsc, Rate_Vintage)
NodeLocation: 552,48,1
NodeSize: 64,40
WindState: 2,102,82,879,350
ValueState: 2,543,115,1103,744,1,MIDM
ReformVal: [Time_Solar_PV,Rate_Escalation_Scen]
Att_ResultSliceState: [PV_Sectors,1,Pre_and_Post_System,1,PV_Climate_Zone,1,Annual_Econ_Time,1]

Text FrameNode_1544920081
NodeLocation: 1440,320,-20
NodeSize: 360,304
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus: yes~
Show_description:20

Variable FirstYr_Bill_Compare
Title: First-Year Bill Comparison
Units: $
Description: Comparison of the components of the electric bill (utility bill only, exclusive of any system financing or lease payments) before and after system installation. When viewing, ensure that the selected sector and climate zone is appropriate for the selected rate name. The date included in the rate name indicates the year to which the bills apply.
Definition: IF System_Type = No_System_Label~
THEN IF PositionInIndex(Pre_and_Post_System, System_Comparison, Pre_and_Post_System)~
   THEN FirstYr_Bill_by_Vint[Rate_Vintage=RateVint_by_RateName, System_Types=SystType_for_System, System_Comparison=Pre_System_Label]~
   ELSE Null~
ELSE FirstYr_Bill_by_Vint[Rate_Vintage=RateVint_by_RateName, System_Types=SystType_for_System]
NodeLocation: 544,296,1
NodeSize: 64,40
WindState: 2,26,31,897,461
ValueState: 2,270,24,1331,784,0,MIDM
Aliases: FormNode Fo1582589317
GraphSetup: Grid:0~
Graph_KeyFont:,16,0~
Att_CatLineStyle Graph_Primary_Valdim:9~
{!40600|Att_WaterfallBar Graph_Primary_Valdim:1}~
Graph_AxisLabelFont:,18,0~
Att_StackedBar Graph_Primary_Valdim:1~
Graph_HLabelRotation:0
ReformVal: [System_Comparison,Bill_Components]
NumberFormat: 2,F,2,0,1,1,2,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [Bill_Components,Month]
Att_GraphValueRange: 1,,,,,,10
Att_ResultSliceState: [PV_Sectors,2,PV_Climate_Zone,1,Rate_Names_and_Start,3,System_Type,4,Area_Type,1,Month,0,Bill_Components,1,System_Comparison,3]
{!40600|Att_StackingIndex: Bill_Components}
{!40600|Att_ClusterIndex: Bill_Components}
{!40700|Att_CellFormat: Undefined}

Decision Map_Component_to_Prd
Title: Map Component to Period
Description: Maps the TOU billing components' names to each TOU period.
Definition: Table(All_Sectors,Rate_Vintage,All_Periods,Pre_and_Post_System)(~
Choice(Bill_Components_None,9,0),Choice(Bill_Components_None,9,0),~
Choice(Bill_Components_None,4,0),Choice(Bill_Components_None,4,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,9,0),Choice(Bill_Components_None,9,0),~
Choice(Bill_Components_None,4,0),Choice(Bill_Components_None,4,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0),~
Choice(Bill_Components_None,1,0),Choice(Bill_Components_None,1,0))
NodeLocation: 88,184,1
NodeSize: 64,40
WindState: 2,841,241,720,490
DefnState: 2,1091,316,678,468,0,DFNM
ValueState: 2,194,195,975,518,0,MIDM
Aliases: FormNode Fo1574745288, FormNode Fo50776339
NodeColor: 65535,65531,1
ReformDef: [All_Sectors,All_Periods]
ReformVal: [All_Periods,Rate_Vintage]
TableCellDefault: Choice(Bill_Components_None,1,0)
Att_EditSliceState: [Rate_Vintage,1,Pre_and_Post_System,1,All_Periods,1,All_Sectors,29]

Variable Energy_Costs_by_Comp
Title: Energy Costs by Component
Units: $
Description: The energy costs mapped to the named time-of-use periods.
Definition: Sum(Energy_Cost_Tier_Prd, Tiers)[Periods=Map_Prd_to_Component]
NodeLocation: 240,296,1
NodeSize: 64,40
WindState: 2,98,71,720,361
ValueState: 2,973,265,543,538,0,MIDM
ReformVal: [Pre_and_Post_System,Bill_Components]
Att__TotalsIndex: [Month]
Att_ResultSliceState: [PV_Sectors,1,Rate_Vintage,1,PV_Climate_Zone,1,System_Types,1,Area_Type,1,Bill_Components,1,Pre_and_Post_System,1]

Variable Map_Prd_to_Component
Title: Map Period to Component
Description: Maps bill components to TOU periods.
Definition: SubIndex(Map_Component_to_Prd[All_Sectors=PV_Sectors, All_Periods=Periods], Bill_Components, Periods)
NodeLocation: 88,296,1
NodeSize: 64,40
ValueState: 2,138,490,1169,435,0,MIDM
ReformVal: [Pre_and_Post_System,Bill_Components]
Att_ResultSliceState: [PV_Sectors,1,Rate_Vintage,2,Bill_Components,1,Pre_and_Post_System,1]

FormNode Fo1574745288
Title: Map Component to Period
Definition: 0
NodeLocation: 88,132,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Map_Component_to_Prd

Variable size1
Title: size
Definition: SIZE(Lev_BaseYr_Bill)
NodeLocation: 704,368,1
NodeSize: 64,40

Text Te244511267
Title: What would I lose?
Description: FirstYr_Bill_Compare~
~
Need to add storage of: ~
MWh impact? Peak Demand, etc? 
NodeLocation: 220,412,-1
NodeSize: 156,36

Variable First_Year_Utility_B
Title: First Year Utility Bill
Units: $/year-system
Description: The first-year utility bill 
Definition: Annual_Utility_Bill / OpYr_Inflate_Factor/*Annual_Utility_Bill[@PV_Operating_Year=1]
NodeLocation: 544,184,1
NodeSize: 64,40
ValueState: 2,551,210,949,578,,MIDM
NodeColor: 65535,39321,39321
GraphSetup: Att_ForceCategorical Graph_Primary_Valdim:1~
Att_StackedBar Graph_Primary_Valdim:0~
{!50007|Graph_BarOutline:0}~
{!50000|Graph_SortBySpread:0}
ReformVal: [Rate_Vintage,Pre_and_Post_System]
Att_ResultSliceState: [Pre_and_Post_System,1,System_Types,1,PV_Climate_Zone,1,PV_Sectors,1,Area_Type,1,Allow_Rate_Inflation,1,Rate_Vintage,1]
{!40600|Att_ClusterIndex: Pre_and_Post_System}

Alias Al1380248099
Title: First-Year Annual Solar
Definition: 1
NodeLocation: 872,296,1
NodeSize: 64,40
Original: FirstYr_Annual_Solar

Variable First_year_kWh_value
Title: First year $/kWh value of solar generation
Units: $/kWh
Definition: ZIDZ(FirstYr_BillSav_Time , FirstYr_Annual_Solar)
NodeLocation: 1008,392,1
NodeSize: 72,40
ValueState: 2,2254,98,1055,700,1,MIDM
Aliases: Alias Al1203148323
GraphSetup: Att_GraphIndexRange Time:1,,1,,,,,43131.962047845125,47336.95826971531,0
ReformVal: [Time,PV_Sectors]
NumberFormat: 2,F,3,3,0,1,3,1,$,0,"ABBREV",0,,,0,0,15,
Att_ResultSliceState: [Area_Type,1,PV_Climate_Zone,1,System_Types,1,PV_Sectors,1,Time,145]

Alias Al130260515
Title: Time Fractional Year
Definition: 1
NodeLocation: 752,512,1
NodeSize: 64,40
Original: Time_Fractional_Year

Variable Value_of_generation
Title: Value of generation
Units: $/kWh
Description: Average $/kWh value of solar or paired solar + storage systems per VDER calculations, inclusive of energy, capacity, DRV, & environmental value streams. ~
Community adders and LSRV values are included only if manually input in the "additional adders" input.
Definition: LinearInterp( Time_Fractional_Year, First_year_kWh_value, Annual_Econ_Time,Time,1) 
NodeLocation: 920,512,1
NodeSize: 64,40
WindState: 2,325,165,720,350
ValueState: 2,380,32,1169,661,1,MIDM
Aliases: Alias Al497262115
GraphSetup: Att_GraphIndexRange Annual_Econ_Time:1,,1,,,,10,2011.7081689089537,2040.6881594657898,0~
Att_GraphValueRange Value_of_generation:1,,1,,,,,0.015885363817214965,0.12646059036254884,0
ReformVal: [Annual_Econ_Time,PV_Sectors]
NumberFormat: 2,F,4,3,0,1,4,1,$,0,"ABBREV",0,,,0,0,15,
Att__TotalsIndex: []
Att_ResultSliceState: [Area_Type,1,PV_Climate_Zone,1,System_Types,1,PV_Sectors,1,Annual_Econ_Time,1]

Variable Value_of_generation1
Title: Value of Generation
Units: $/kWh
Description: Average annual $/kWh value of solar or paired solar + storage systems per VDER calculations, inclusive of energy, capacity, DRV, & environmental value streams. ~
Community adders and LSRV values are included only if manually input in the "additional adders" input.
Definition: Value_of_generation[Annual_Econ_Time=Cost_Forecast_Year,@PV_Sectors=1,@Area_Type=1]  {with the inputs in the NYPA model, all sectors and area types have the same effective generation value, so only one slice is shown here for ease of visualization}
NodeLocation: 920,608,1
NodeSize: 64,40
WindState: 2,325,165,720,350
ValueState: 2,964,90,763,705,1,MIDM
GraphSetup: SymbolSize:11~
Graph_AxisLabelFont:,20,0~
Att_GraphValueRange Value_of_generation1:1,,1,,,,,0.06274843454360962,0.0676537173986435,0~
Att_GraphIndexRange Annual_Econ_Time:1,,1,,,,10,2021.1195932030678,2031.6274712085724,0
ReformVal: [Cost_Forecast_Year,PV_Climate_Zone]
NumberFormat: 2,F,4,3,0,1,4,1,$,0,"ABBREV",0,,,0,0,15,
Att__TotalsIndex: []
Att_ResultSliceState: [System_Types,1,PV_Climate_Zone,1,Cost_Forecast_Year,1]

Close Utility_Bills_and_Bi

Module System_Economics
Title: System Economics
Author: JamesMilford
Date: Thu, Oct 4, 2018 8:27 AM
NodeLocation: 400,64,1
NodeSize: 64,40
NodeInfo: 1,0,0
DiagState: 2,379,166,981,315,17,10
Aliases: Alias Al1548967117
NodeColor: 65535,65535,65535

Module Financing
Title: Financing
Author: JamesMilford
Date: Thu, Oct 4, 2018 8:27 AM
NodeLocation: 128,96,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,373,145,1116,454,17,10
AcpStyles: FrameNode: FrameNode_1544920171

Constant Debt_Equity_Rates
Title: Debt and Equity Rates
Units: fraction/year
Description: The interest rates for debt and equity financing.~
~
The cost of equity financing is the consumer discount rate in the case of a residential customer. Note that the residential opportunity cost may be lower than a residential customer's implied discount rate, but implied discount rates are premised on having to make an upfront investment, which is not the case for a 100% debt-financed investment.
Definition: Table(All_PV_Sectors,Debt_or_Equity)(~
0.089,0.089,~
0.089,0.089,~
0.089,0.089)
NodeLocation: 112,64,1
NodeSize: 64,40
WindState: 2,496,161,720,350
DefnState: 2,556,88,553,722,0,DFNM
ValueState: 2,150,305,542,312,0,MIDM
Aliases: Alias Al1550187543, FormNode Fo1550187544, FormNode Fo1545167068, FormNode Fo1567092877
NodeColor: 65535,1,1
ReformDef: [Debt_or_Equity,All_PV_Sectors]
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
DisplayOutputs: Object Object, Object Decision

Variable Monthly_Loan_Factor
Title: Monthly Loan Factor
Units: ($/month)/$
Description: A factor used to convert a loan amount into its corresponding monthly principal+interest payment.
Definition: PMT(Debt_Rates/Months_per_Year, Loan_Term, -1)
NodeLocation: 576,64,1
NodeSize: 64,40
ValueState: 2,380,192,544,419,,MIDM

Variable Loan_Term
Title: Loan Term
Units: months
Description: The number of months in the term of the loan.
Definition: Economic_Lifetime * Months_per_Year
NodeLocation: 424,64,1
NodeSize: 64,40

Constant Inflation_Rate
Title: Inflation Rate
Units: fraction/year
Description: The rate of inflation.
Definition: SubTable(Single_Cell_Inputs[SingCell_Input_Names=Inflation_Label])
NodeLocation: 112,184,1
NodeSize: 64,40
Aliases: Alias Al1550187544, FormNode Fo1550187545, FormNode Fo1545167070
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15

Variable Debt_Rates
Title: Debt Rates
Units: fraction/year
Description: The interest rate for debt financing.
Definition: Debt_Equity_Rates[Debt_or_Equity=Debt_Label, All_Sectors=PV_Sectors]
NodeLocation: 272,64,1
NodeSize: 64,40
ValueState: 2,516,522,416,303,0,MIDM

Variable Interest_Pmnt_Factor
Title: Interest Payment Factor
Units: ($/month)/$
Description: A factor used to convert a loan amount into its corresponding annual interest payment. The units are $/month of interest per $ of debt-financed capital. This is only relevant to commercial tax entities that can deduct the interest expenses.
Definition: IPMT(Debt_Rates/Months_per_Year, Loan_Term_Months, Loan_Term, -1) * Com_Tax_Entity
NodeLocation: 424,176,1
NodeSize: 64,40
WindState: 2,218,361,965,350
ValueState: 2,20,124,1188,500,,MIDM
Att__TotalsIndex: [Sys_LocalIndex('months')]

Variable NPV_Interest_Factor
Title: NPV of Interest Factors
Units: $/$
Description: The net present value of interest per dollar of debt-financed capital.
Definition: VAR equivEquityRate:=(1+Nominal_Equity_Rate)^(1/Months_per_Year)-1;   {The compounding monthly equivalent of the annual equity rate}~
NPV(equivEquityRate, Interest_Pmnt_Factor, Loan_Term_Months)
NodeLocation: 576,176,1
NodeSize: 64,40
WindState: 2,223,320,1131,472
ValueState: 2,587,357,416,303,0,MIDM

Variable Nominal_Equity_Rate
Title: Nominal Equity Rate
Units: fraction/year
Description: The nominal cost of equity financing, or opportunity costs (eg, average stock market returns) in the case of a residential customer. Note that the residential opportunity cost may be lower than a residential customer's implied discount rate, but implied discount rates are premised on having to make an upfront investment, which is not the case for a 100% debt-financed investment.
Definition: Debt_Equity_Rates[Debt_or_Equity=Equity_Label, All_PV_Sectors=PV_Sectors]
NodeLocation: 424,280,1
NodeSize: 64,40
WindState: 2,-1,292,720,350
ValueState: 2,22,425,648,303,0,MIDM
NodeColor: 65535,39321,39321

Variable Annual_Loan_Factor
Title: Annual Loan Factor
Units: ($/year)/$
Description: A factor used to convert a loan amount into its corresponding annual (non-discounted) principal+interest payment.
Definition: Monthly_Loan_Factor * Months_per_Year
NodeLocation: 728,64,1
NodeSize: 64,40
WindState: 2,102,82,878,375

Text FrameNode_1544920171
NodeLocation: 1176,328,-20
NodeSize: 360,304
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus: yes~
Show_description:20

FormNode Fo1545167068
Title: Debt Rate
Definition: 0
NodeLocation: 112,120,1
NodeSize: 56,16
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Debt_Equity_Rates

FormNode Fo1545167070
Title: Inflation Rate
Definition: 0
NodeLocation: 112,240,1
NodeSize: 56,16
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Inflation_Rate

Variable Equity_Test
Title: Equity Test
Definition: 0.06
NodeLocation: 272,280,1
NodeSize: 64,40
{!40300|Att_SlicerPopupSize: 237,64}

Close Financing

Module Incentives
Title: Incentives
Author: JamesMilford
Date: Thu, Oct 4, 2018 8:27 AM
NodeLocation: 280,96,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,477,66,907,654,17,10
AcpStyles: FrameNode: FrameNode_1544920201

Constant Invest_Tax_Credit
Title: Investment Tax Credit
Units: percent
Description: Investment tax credit expressed as a percentage of the upfront capital costs.~
~
This input assumes the system owner is a taxable entity. For the current NYPA analysis, we assume third party ownership for government/non-profit entities. 
Definition: Table(All_PV_Sectors,ITC_Scenario,Static_PV_Time)(~
0,0,0,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.26,0.26,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.26,0.22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,~
0,0,0,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.26,0.26,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.26,0.22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,~
0,0,0,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.26,0.26,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,~
0,0,0,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.26,0.26,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.225,0.15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,~
0,0,0,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.26,0.26,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.225,0.15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,~
0,0,0,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.26,0.26,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,~
0,0,0,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.26,0.26,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.225,0.15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,~
0,0,0,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.26,0.26,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.225,0.15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,~
0,0,0,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.26,0.26,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3)
NodeLocation: 168,176,1
NodeSize: 64,40
WindState: 2,457,241,918,488
DefnState: 2,976,-7,782,843,0,DFNM
ValueState: 2,627,10,513,867,0,MIDM
Aliases: Alias Al1550189910, FormNode Fo1550189910, FormNode Fo1545167107, FormNode Fo1545084105, FormNode Fo1567092849, FormNode Fo1548967851
NodeColor: 65535,1,1
GraphSetup: Att_StackedBar Graph_Primary_Valdim:0~
Att_GraphIndexRange Static_PV_Time:1,1,,,,,10~
{!50000|Graph_SortBySpread:0}
ReformDef: [All_Sectors,Static_PV_Time]
ReformVal: [All_Sectors,Static_PV_Time]
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
DisplayOutputs: Object Object, Object Decision
Att_GraphValueRange: 1,,,,,,10
Att_ResultSliceState: [ITC_Scenario,2,Static_PV_Time,1,All_Sectors,1]
Att_EditSliceState: [ITC_Scenario,3,Static_PV_Time,1,All_Sectors,1]
{!40600|Att_StackingIndex: All_Sectors}
{!40600|Att_ClusterIndex: Null}
{!50000|Att_ColumnWidths: [,Static_PV_Time,\([,,,,,,,63,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,])]}

Variable ITC_Fraction
Title: ITC Fraction
Units: fraction
Description: Investment tax credit expressed as a percentage of the upfront capital costs.
Definition: VAR ITC:=Invest_Tax_Credit[Static_PV_Time=Annual_Econ_Time,ITC_Scenario=Selected_ITC_Scen, All_PV_Sectors=PV_Sectors];~
~
Val_by_Install_Event(ITC, 1, Annual_Econ_Time)
NodeLocation: 368,176,1
NodeSize: 64,40
ValueState: 2,611,47,1193,716,0,MIDM
ReformVal: [PV_Sectors,Annual_Econ_Time]
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [Equipment_Types,1,Installation_Event,1,ITC_Scenario,2,Annual_Econ_Time,1,PV_Sectors,9]

Variable Per_Unit_Federal_ITC
Title: Per-Unit Federal ITC
Units: $/kW-DC, $/kWh
Description: The per-unit ITC amount. Solar PV amounts are expressed in $/kW-DC, while battery storage amounts are in $/kWh. Replacement costs have not yet been discounted and proportioned to the remaining years in the economic horizon, so it is inappropriate to sum over Installation Events (ie, initial installation and future replacement).
Definition: Per_Unit_Equip_Price * Applied_ITC_by_Event
NodeLocation: 600,200,1
NodeSize: 64,40
WindState: 2,527,2,833,494
ValueState: 2,96,12,1183,799,0,MIDM
ReformVal: [Annual_Econ_Time,System_Types]
Att_ResultSliceState: [PV_Sectors,2,PV_Climate_Zone,1,System_Types,2,Equipment_Types,2,Installation_Event,1,Annual_Econ_Time,4]

Variable Total_ITC_for_System
Title: Total ITC for System
Units: $/system
Description: The total investment tax credit (eg, initial installation + discounted replacement) based on the equipment sizes used for each system type.
Definition: Sum_Initial_Repl_Val(ITC_for_System_Event,Replace_Value_Factor)
NodeLocation: 752,200,1
NodeSize: 64,40
WindState: 2,98,82,1157,590
ValueState: 2,2594,386,576,284,0,MIDM
ReformVal: [Equipment_Types,System_Types]
NumberFormat: 2,F,2,0,1,1,2,0,$,0,"ABBREV",0,,,0,0,15,
Att__TotalsIndex: [Equipment_Types]
Att_ResultSliceState: [PV_Sectors,1,PV_Climate_Zone,1,Area_Type,1,Annual_Econ_Time,20,System_Types,1,Equipment_Types,2]

Text FrameNode_1544920201
NodeLocation: 1184,320,-20
NodeSize: 360,304
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus: yes~
Show_description:20

Index ITC_Scenario
Att_PrevIndexValue: ['Low','Medium','High']
Title: ITC Scenario
Definition: ['Low','Medium','High']
IndexVals: ['item 1']
NodeLocation: 88,72,1
NodeSize: 64,40
DisplayOutputs: Object Object, Object Decision
{!40300|Att_SlicerPopupSize: 242,94}

Decision Selected_ITC_Scen
Title: ITC Scenario
Description: Select which ITC scenario you want to model. "Baseline" captures currently planned ITC phase-out for solar PV.
Definition: Choice(ITC_Scenario,2,0)
IndexVals: ['item 1']
NodeLocation: 240,72,1
NodeSize: 64,40
WindState: 2,577,280,842,409
DefnState: 2,786,323,340,225,0,DFNM
Aliases: FormNode Fo1545167109, FormNode Fo1545084106, FormNode Fo1548967850, FormNode Fo773137507

FormNode Fo1545167107
Title: Investment Tax Credit
Definition: 0
NodeLocation: 168,232,1
NodeSize: 56,16
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Invest_Tax_Credit

FormNode Fo1545167109
Title: ITC Scenario
Definition: 0
NodeLocation: 252,24,1
NodeSize: 76,16
NodeInfo: 1,0,0,0,0,0,0,118,0,,0,,,0
Original: Selected_ITC_Scen

Text Te1545927677
Title: SGIP
Description: SGIP Handbook: https://www.selfgenca.com/documents/handbook/2017~
--Section 3.1.3 states an additional incentive of 20% will be added to the tech incentive for projects using equipment manufactured in CA (at least 50% of equipment value must come from CA manufacturers)~
--Section 3.2.1 incentive can exceed $5 million per project~
--Section 5.2 discusses how incentives are based on hours of storage capacity and work like marginal tax rates~
--Section 5.2.3 systems larger than 30kW (eg, non-res power pack is 50kW) receive a PBI~
--Section 5.3.2 residential systems must have 52 full discharges per year (they are additive, so don't have to be a full discharge in a given event), and non-res must have 130 full discharges per year~

NodeLocation: 356,932,-1
NodeSize: 308,252
NodeInfo: 1,,,,,1
NodeColor: 49344,49344,49344
AcpStyles: Show_Object:no

Constant Stored_PV_Pct_ITC
Title: Stored PV Pct for ITC
Units: fraction
Description: The minimum amount of energy stored in batteries that must come from PV in order for the battery to qualify for the ITC.~
~
Source:~
https://www.energysage.com/solar/solar-energy-storage/energy-storage-tax-credits-incentives/
Definition: Table(All_Sectors)(0,0,0,0)
NodeLocation: 88,360,1
NodeSize: 64,40
DefnState: 2,1202,87,389,705,0,DFNM
ValueState: 2,212,218,416,303,0,MIDM
Aliases: Alias Al1550189914, FormNode Fo1550189914, FormNode Fo1546192388, Alias Al1584728928, FormNode Fo1584728929
NodeColor: 65535,65531,1
NumberFormat: 2,%,4,2,0,0,4,0,$,0,"ABBREV",0,,,0,0,15

FormNode Fo1546192388
Title: Stored PV Pct for ITC
Definition: 0
NodeLocation: 88,412,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Stored_PV_Pct_ITC

Variable Allowed_ITC_Pct_Rate
Title: Allowed ITC Percentage by Rate
Units: fraction
Description: The percentage of the full ITC that can be claimed by each equipment and system type.
Definition: IF Equipment_Types=Solar_PV_Label   {If PV equipment}~
THEN 100% * (Equipment_Sizes > 0)  {Then the equipment can claim the full ITC}~
ELSE Replace_X_with_Y(Pct_of_ITC_Strg_w_PV, Null, 0) * (Equipment_Sizes > 0) {Then use PV's percentage of total electricity used to charge the battery}
NodeLocation: 280,456,1
NodeSize: 64,40
WindState: 2,16,446,1180,350
ValueState: 2,9,41,752,675,0,MIDM
ReformVal: [Rate_Vintage,System_Types]
NumberFormat: 2,%,4,2,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [PV_Sectors,1,Equipment_Types,1,PV_Climate_Zone,2,System_Types,3,Rate_Vintage,1]

Variable Pct_of_ITC_Strg_w_PV
Title: Pct of ITC for Storage with PV
Units: fraction
Description: The portion of the full ITC that can be claimed by storage systems. A storage system must be charged by a minimum percentage (75%) of electricity coming from PV to qualify for the ITC. If it does not meet that minimum percentage, then none of the ITC can be claimed. If the minimum is met, then the percentage of battery charge from PV is used as the portion of the full ITC that can be claimed.
Definition: VAR pct:=IF Stored_PV_Pct_ITC[All_Sectors=PV_Sectors]=0 THEN 1 ELSE~
(IF PV_Pct_of_Charge2[Opt_Storage_Systems=Map_Opt_Syst_to_Syst, Opt_Sectors=PV_Sectors] < Stored_PV_Pct_ITC[All_Sectors=PV_Sectors]~
THEN 0~
ELSE PV_Pct_of_Charge2[Opt_Storage_Systems=Map_Opt_Syst_to_Syst, Opt_Sectors=PV_Sectors]);~
~
IF Estim_Storage_Add_On AND (System_Types = Storage_Added_Label)~
THEN pct[System_Types=PV_Strg_Retro_Label]~
ELSE pct
NodeLocation: 240,360,1
NodeSize: 64,40
WindState: 2,19,40,720,350
ValueState: 2,536,154,1088,513,0,MIDM
ReformVal: [PV_Climate_Zone,System_Types]
NumberFormat: 2,%,2,2,0,0,2,0,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [PV_Sectors,18,Rate_Vintage,1,Area_Type,2,System_Types,2,PV_Climate_Zone,1]

Variable Allowed_ITC_Pct_Time
Title: Allowed ITC Pct by Time
Units: fraction
Description: The percentage of the full ITC that can be claimed by each equipment and system type. For storage technologies, this is a function of the amount of energy stored that comes from PV.
Definition: Allowed_ITC_Pct_Rate[Rate_Vintage=Rate_Vintage_by_Time[Pre_and_Post_System=Post_System_Label]]
NodeLocation: 384,360,1
NodeSize: 64,40
ValueState: 2,0,62,1406,703,0,MIDM
GraphSetup: Att_GraphValueRange Allowed_ITC_Pct_Time:1,,,1
NumberFormat: 2,%,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [Equipment_Types,1,System_Types,1,PV_Climate_Zone,2,PV_Sectors,1,Time,1]
{!40700|Att_CellFormat: Undefined}

Variable Allowed_ITC_Pct_Year
Title: Allowed ITC Percent by Year
Units: fraction
Description: The percentage of the full ITC that can be claimed by each equipment and system type. For storage technologies, this is a function of the amount of energy stored that comes from PV.
Definition: Aggregate(Allowed_ITC_Pct_Time, Time_Year_Map, Time, Annual_Econ_Time, "Average", noMapError: True)~

NodeLocation: 432,456,1
NodeSize: 64,40
WindState: 2,112,336,977,513
ValueState: 2,230,187,1461,399,0,MIDM
ReformVal: [Annual_Econ_Time,System_Types]
NumberFormat: 2,%,4,2,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [PV_Sectors,3,Equipment_Types,2,PV_Climate_Zone,2,Area_Type,2,System_Types,2,Annual_Econ_Time,1]

Variable ITC_for_System_Event
Title: ITC for System by Event
Units: $/system
Description: The federal investment tax credit based on the equipment sizes used for each system type. Replacement costs have not yet been discounted and proportioned to the remaining years in the economic horizon, so it is inappropriate to sum over Installation Events (ie, initial installation and future replacement).
Definition: Per_Unit_Federal_ITC * Equipment_Sizes
NodeLocation: 688,360,1
NodeSize: 64,40
WindState: 2,129,187,1049,548
ValueState: 2,552,324,825,444,0,MIDM
ReformVal: [Equipment_Types,System_Types]
NumberFormat: 2,F,2,0,1,1,2,0,$,0,"ABBREV",0,,,0,0,15,
Att_ResultSliceState: [PV_Sectors,1,Annual_Econ_Time,13,PV_Climate_Zone,3,Installation_Event,1,Area_Type,1,System_Types,1,Equipment_Types,1]

Module Taxable_Incents
Title: Taxable Incentives
Author: JamesMilford
Date: Wed, Feb 6, 2019 6:05 PM
NodeLocation: 96,488,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,105,14,1698,688,17,10
AcpStyles: Framenode: Taxable_Incent_Frame

Constant kWh_Incen_Dur_Derate
Title: kWh Incent Derate for Duration
Description: The amount by which the incentive "base rate" is derated to account for different storage durations. This is a multiplier applied to the base rate incentive (eg, 100% = no derate). The duration lower bound refers to the minimum storage duration for which the derate is applicable. For example, let's say the derate multiplier is 100% for durations greater than or equal to zero and less than or equal to 2 hours; the multiplier is 50% for durations greater than 2 hours; and the multiplier is 0% for durations greater than 4 hours. The input table associated with this situation would look like the example below.~
~
Step	Lower Bound (hours)	Derate Multiplier (%)~
1		0						100%~
2		2						50%~
3		4						0%~
~
Source: ~
SGIP Handbook, Section 5.2.1~
https://www.selfgenca.com/documents/handbook/2017
Definition: Table(Incent_Duration_Step,Incent_Durat_Inputs)(~
0,1,~
5,0.25,~
7,0)
NodeLocation: 104,224,1
NodeSize: 64,40
WindState: 2,7,167,720,350
DefnState: 2,657,376,776,266,0,DFNM
ValueState: 2,324,330,871,305,0,MIDM
Aliases: Alias Al1550726183, FormNode Fo1550726184, FormNode Fo1548707006
ReformDef: [Incent_Durat_Inputs,Incent_Duration_Step]
DisplayOutputs: Object Object, Object Decision
{!40700|Att_CellFormat: CellSpan(Incent_Durat_Inputs,CellNumberFormat('Percentage',2,0,0,dateFormat:'ABBREV',fullPrecision:0,numbersAsDates:0,datesAsNumbers:0),2,header:0)}

FormNode Fo1548707006
Title: Incentive Derate for Duration
Definition: 0
NodeLocation: 104,172,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: kWh_Incen_Dur_Derate

Variable Incen_Durat_Derate
Title: Incentive Duration Derate
Units: fraction
Description: The incentive derate multiplier for the simulated storage durations.
Definition: AvgRate_Across_Brack(kWh_Incen_Dur_Derate[@Incent_Durat_Inputs=1], kWh_Incen_Dur_Derate[@Incent_Durat_Inputs=2], Hours_of_Storage[System_Types=Storage_Systems], Incent_Duration_Step)
NodeLocation: 248,224,1
NodeSize: 64,40
WindState: 2,318,265,720,350
ValueState: 2,456,56,804,702,0,MIDM
ReformVal: [PV_Climate_Zone,PV_Sectors]
NumberFormat: 2,%,4,2,0,0,4,0,$,0,"ABBREV",0,,,0,0,15

Constant kWh_Incent_DerateCap
Title: kWh Incent Derate for Capacity
Description: The amount by which the incentive "base rate" is derated to account for different storage capacities. This is a multiplier applied to the base rate incentive (eg, 100% = no derate). The capacity lower bound refers to the minimum capacity size for which the derate is applicable. For example, let's say the derate multiplier is 100% for capacity values greater than or equal to zero and less than or equal to 2 MWh; the multiplier is 50% for capacity values greater than 2 MWh; and the multiplier is 0% for capacity values greater than 4 MWh. The input table associated with this situation would look like the example below.~
~
Step	Lower Bound (MWh)		Derate Multiplier (%)~
1		0						100%~
2		2						50%~
3		4						0%~
~
Source: ~
SGIP Handbook, Section 5.2.2~
https://www.selfgenca.com/documents/handbook/2017
Definition: Table(Incent_Capacity_Step,Incent_MWhCap_Inputs)(~
0,1,~
100,1,~
100,1,~
100,1,~
100,1)
NodeLocation: 104,344,1
NodeSize: 64,40
WindState: 2,397,252,959,608
DefnState: 2,302,104,776,379,0,DFNM
ValueState: 2,27,546,877,303,0,MIDM
Aliases: Alias Al1550726186, FormNode Fo1550726187, FormNode Fo1548708354
ReformDef: [Incent_MWhCap_Inputs,Incent_Capacity_Step]
DisplayOutputs: Object Object, Object Decision
{!40700|Att_CellFormat: CellSpan(Incent_MWhCap_Inputs,CellNumberFormat('Percentage',2,0,0,dateFormat:'ABBREV',fullPrecision:0,numbersAsDates:0,datesAsNumbers:0),2,header:0)}

FormNode Fo1548708354
Title: Incentive Derate for Duration
Definition: 0
NodeLocation: 104,292,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: kWh_Incent_DerateCap

Variable Incent_Cap_Derate
Title: Incentive Capacity Derate
Units: fraction
Description: The incentive derate multiplier for the simulated storage capacities.
Definition: AvgRate_Across_Brack(kWh_Incent_DerateCap[@Incent_MWhCap_Inputs=1], kWh_Incent_DerateCap[@Incent_MWhCap_Inputs=2], Storage_Capacity[System_Types=Storage_Systems] * MW_per_kW, Incent_Capacity_Step)
NodeLocation: 248,344,1
NodeSize: 64,40
WindState: 2,304,156,720,350
ValueState: 2,643,60,739,655,0,MIDM
ReformVal: [PV_Climate_Zone,PV_Sectors]
NumberFormat: 2,%,2,2,0,0,2,0,$,0,"ABBREV",0,,,0,0,15

Constant Strg_kWh_Base_Rate
Title: Storage kWh Incent Base Rate
Units: $/kWh
Description: Storage incentive base rates prior to being derated for storage duration and capacity size. These are valid for years 2017 and onward.~
~
Source: ~
SGIP Handbook, Section 3.2.1~
https://www.selfgenca.com/documents/handbook/2017
Definition: Table(All_Sectors,Incentive_Steps,ITC_Applied,PV_Climate_Zone)(~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
0,~
Null,~
Null,~
Null,~
Null,~
Null,~
Null,~
Null,~
Null,~
Null,~
Null,~
Null,~
Null,~
Null,~
Null,~
Null,~
Null)
NodeLocation: 400,80,1
NodeSize: 64,40
WindState: 2,298,593,720,350
DefnState: 2,2808,47,797,760,0,DFNM
ValueState: 2,477,354,952,554,0,MIDM
Aliases: Alias Al1568695724, FormNode Fo1568695724, FormNode Fo1548723041
NodeColor: 65535,1,1
ReformDef: [PV_Climate_Zone,All_Sectors]
ReformVal: [Incentive_Steps,All_Sectors]
DisplayOutputs: Object Object, Object Decision
Att_ResultSliceState: [ITC_Applied,1,BESS_Incentive_Scen,3,All_Sectors,2,Incentive_Steps,1]
Att_EditSliceState: [ITC_Applied,1,Incentive_Steps,8,All_Sectors,1,PV_Climate_Zone,4]
{!50000|Att_ColumnWidths: [,Incentive_Steps,\([61,,,66])]}

FormNode Fo1548723041
Title: Storage Incentives
Definition: 0
NodeLocation: 408,132,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Strg_kWh_Base_Rate

Decision Incentive_Step_Start
Title: Incentive Step Start Month
Description: The month that a given incentive step first became active. The last step is meant to capture a zero-dollar incentive representing the termination of the incentive offering. Start dates must be sequential, ie, step 2's start date must come after step 1's start date.~
~
Source: Received dates in the SGIP database. Residential step 5 closed on 5/1/2018 until further funding becomes available (https://www.selfgenca.com/home/about/).
Definition: Table(All_Sectors,Incentive_Steps)(~
Choice(Incentive_Start_Time,1,0),Choice(Incentive_Start_Time,1,0),Choice(Incentive_Start_Time,1,0),Choice(Incentive_Start_Time,1,0),Choice(Incentive_Start_Time,1,0),Choice(Incentive_Start_Time,1,0),Choice(Incentive_Start_Time,1,0),Choice(Incentive_Start_Time,1,0),~
Choice(Incentive_Start_Time,1,0),Choice(Incentive_Start_Time,1,0),Choice(Incentive_Start_Time,1,0),Choice(Incentive_Start_Time,1,0),Choice(Incentive_Start_Time,1,0),Choice(Incentive_Start_Time,1,0),Choice(Incentive_Start_Time,1,0),Choice(Incentive_Start_Time,1,0),~
Choice(Incentive_Start_Time,1,0),Choice(Incentive_Start_Time,1,0),Choice(Incentive_Start_Time,1,0),Choice(Incentive_Start_Time,1,0),Choice(Incentive_Start_Time,1,0),Choice(Incentive_Start_Time,1,0),Choice(Incentive_Start_Time,1,0),Choice(Incentive_Start_Time,1,0),~
Choice(Incentive_Start_Time,186,0),Choice(Incentive_Start_Time,187,0),Choice(Incentive_Start_Time,199,0),Choice(Incentive_Start_Time,218,0),Choice(Incentive_Start_Time,230,0),Choice(Incentive_Start_Time,260,0),Choice(Incentive_Start_Time,290,0),Choice(Incentive_Start_Time,1,0))
NodeLocation: 552,80,1
NodeSize: 64,40
WindState: 2,475,416,829,498
DefnState: 2,190,249,1388,419,0,DFNM
ValueState: 2,591,315,941,389,0,MIDM
Aliases: Alias Al1568695821, FormNode Fo1568695821, FormNode Fo1548796240
NodeColor: 65535,1,1
ReformDef: [All_Sectors,Incentive_Steps]
DisplayOutputs: Object Object, Object Decision
TableCellDefault: Choice(Incentive_Start_Time,1,0)

FormNode Fo1548796240
Title: Start Time for Incentive Step
Definition: 0
NodeLocation: 560,132,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Incentive_Step_Start

Variable Storage_Incentive_Ba
Title: Storage Incentive Base Rate
Units: $/kWh
Description: The base rate for the taxable storage incentive.
Definition: VAR ITC_claimed:=StepInterp(BOY_Date_for_Econ_Yr, Storage_ITC_Claimed, Time, Annual_Econ_Time, True);~
Strg_kWh_Base_Rate[Incentive_Steps=Incent_Step_by_Time, All_Sectors=PV_Sectors, ITC_Applied=ITC_claimed, System_Types=Storage_Systems]
NodeLocation: 568,224,1
NodeSize: 64,40
WindState: 2,2199,101,720,350
ValueState: 2,2220,139,1171,662,1,MIDM
GraphSetup: Att_CatLineStyle Graph_Primary_Valdim:9
ReformVal: [Time,Null]
Att_ResultSliceState: [Storage_Systems,1,Area_Type,1,PV_Sectors,1,PV_Climate_Zone,1,Time,197]
Att_ColorRole: Null

Variable Storage_ITC_Claimed
Title: Storage ITC Claimed
Description: Identifies whether an ITC was claimed for the storage system.
Definition: IF Total_ITC_for_System[Equipment_Types=Battery_Strg_Label] > 0~
THEN "Yes"~
ELSE "No"
NodeLocation: 416,224,1
NodeSize: 64,40
WindState: 2,33,260,720,350
ValueState: 2,90,146,1608,576,0,MIDM
Att_ResultSliceState: [System_Types,1,PV_Climate_Zone,1,Area_Type,1,PV_Sectors,2,Annual_Econ_Time,1]

Variable Derated_Incent_Rate
Title: Derated Incentive Rate
Units: $/kWh
Description: The storage incentive rate after derating for duration and capacity size. 
Definition: Storage_Incentive_Ba * Incen_Durat_Derate * Incent_Cap_Derate
NodeLocation: 568,344,1
NodeSize: 64,40
WindState: 2,303,327,852,383
ValueState: 2,2059,190,1152,487,0,MIDM
ReformVal: [Time,Storage_Systems]
Att_ResultSliceState: [PV_Sectors,1,PV_Climate_Zone,1,Storage_Systems,1,Time,1]

Variable Taxes_on_Incentive
Title: Taxes on Incentive
Units: $/system
Description: The taxes paid on incentives provided for storage systems.~
~
Incentives or rebates are treated as income and do not change the cost basis for the ITC.~
(Source: https://www.seia.org/research-resources/cost-basis-itc-and-1603-applications)
Definition: Implement_Incentives * StepInterp(BOY_Date_for_Econ_Yr, Combined_Tax_Rate, Time, Annual_Econ_Time, LeftLookup: True)
NodeLocation: 1344,584,1
NodeSize: 64,40
WindState: 2,224,2,1144,551
ValueState: 2,562,8,952,659,1,MIDM
ReformVal: [Time,Installation_Event]
Att_ResultSliceState: [PV_Sectors,1,PV_Climate_Zone,1,Equipment_Types,2,System_Types,2,Area_Type,1,Installation_Event,2,Time,1]

Variable Strg_Incent_by_Event
Title: Storage Incentive by Event
Units: $/system
Description: The taxable incentive applied to each storage system.
Definition: VAR incentByEvent:=Val_by_Install_Event(BESS_Incentive + BESS_Flat_Incentive, Timesteps_Per_Year, Time)[Equipment_Types=Battery_Strg_Label];~
incentByEvent[Storage_Systems=System_Types] * (Equipment_Sizes[Equipment_Types=Battery_Strg_Label] > 0)
NodeLocation: 888,480,1
NodeSize: 64,40
WindState: 2,295,300,720,350
ValueState: 2,42,48,1455,732,1,MIDM
Aliases: Alias Al1913594979
ReformVal: [Time,Installation_Event]
NumberFormat: 2,F,2,0,1,1,2,0,$,0,"ABBREV",0,,,0,0,15,
Att_ResultSliceState: [PV_Sectors,1,PV_Climate_Zone,1,Area_Type,1,System_Types,2,Installation_Event,2,Time,1]

Variable Taxable_Incent_Event
Title: Taxable Incentives by Event
Units: $/system
Description: The value of taxable incentives after adjusting for their tax liability.
Definition: Implement_Incentives - Taxes_on_Incentive
NodeLocation: 1192,480,1
NodeSize: 64,40
WindState: 2,19,99,1140,548
ValueState: 2,224,38,1567,768,1,MIDM
GraphSetup: Att_GraphValueRange Taxable_Incent_Event:1,,1,,,,,2610.605001449585,3105.6768894195557,0~
Att_GraphIndexRange Time:1,,1,,,,,41517.07668605447,41835.74742895365,0
ReformVal: [Time,Installation_Event]
Att_ResultSliceState: [PV_Sectors,1,System_Types,2,PV_Climate_Zone,1,Equipment_Types,2,Area_Type,1,Installation_Event,1,Time,1]

Index Historic_Incent_Yrs
Title: Historic Incentive Years
Definition: 2009..Final_Hist_Incent_Yr
NodeLocation: 912,840,1
NodeSize: 64,40

Variable Incent_Step_by_Time
Title: Incentive Step by Time
Units: step
Description: The applicable incentive step for each time period.
Definition: FOR J:=PV_Sectors DO (~
   INDEX steps:=Subset(Incentive_Step_Start[All_Sectors=J] <> None_Label);~
   VAR dates:=Incentive_Step_Start[All_Sectors=J, Incentive_Steps=steps];~
   StepInterp(dates, steps, Time, steps, LeftLookup: True)~
)~

NodeLocation: 704,80,1
NodeSize: 64,40
WindState: 2,287,84,720,350
ValueState: 2,62,65,1372,551,1,MIDM

Constant Final_Hist_Incent_Yr
Title: Final Historic Incentive Year
Description: Specify the final year of historic incentive data for storage techs.
Definition: 2019
NodeLocation: 912,720,1
NodeSize: 64,40
Aliases: Alias Al1550726189, FormNode Fo1550726190, FormNode Fo1548888565

FormNode Fo1548888565
Title: Number of Incentive Duration Steps
Definition: 0
NodeLocation: 912,772,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Final_Hist_Incent_Yr

Variable Taxable_Incent_Year
Title: Taxable Incentives by Year
Units: $/system
Description: The value of taxable incentives after adjusting for their tax liability. These are averages across each year.
Definition: Sum_Initial_Repl_Val(Aggregate(Taxable_Incent_Event, Time_Year_Map, Time, Annual_Econ_Time, type: "Average", noMapError: True),Replace_Value_Factor)
NodeLocation: 1344,480,1
NodeSize: 64,40
WindState: 2,334,24,871,434
ValueState: 2,0,266,1775,382,0,MIDM
ReformVal: [Annual_Econ_Time,System_Types]
Att__TotalsIndex: []
Att_ResultSliceState: [PV_Climate_Zone,1,Equipment_Types,2,Area_Type,1,PV_Sectors,1,System_Types,1,Annual_Econ_Time,1]

Text Taxable_Incent_Frame
NodeLocation: 1776,328,-20
NodeSize: 360,304
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus: yes~
Show_description:20

Constant Strg_kW_Base_Rate
Title: Storage kW Incent Base Rate
Units: $/W
Description: Storage incentive base rates prior to being derated for capacity size. These are valid for years 2011-2016.~
~
Source: ~
SGIP Handbook 2011-2016~
<a href="https://www.selfgenca.com/home/resources/">https://www.selfgenca.com/home/resources/</a>
Definition: Table(Static_PV_Time)(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
NodeLocation: 256,480,1
NodeSize: 64,40
WindState: 2,496,343,720,537
DefnState: 2,193,73,1351,539,0,DFNM
ValueState: 2,274,299,952,554,0,MIDM
Aliases: FormNode Fo1572447780
NodeColor: 65535,1,1
ReformDef: [Incentive_Steps,ITC_Applied]
TableCellDefault: 0
Att_ResultSliceState: [ITC_Applied,2,All_Sectors,1,Incentive_Steps,1]
Att_EditSliceState: [All_Sectors,2,ITC_Applied,1,Incentive_Steps,1]
{!50000|Att_ColumnWidths: [,Incentive_Steps,\([61,,,,,,,])]}

FormNode Fo1572447780
Title: Storage Incentives
Definition: 0
NodeLocation: 264,524,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Strg_kW_Base_Rate

Constant Min_Cost_Share_Pct
Title: Min Cost Share Percentage
Units: fraction
Description: The minimum percentage of the storage system's eligible costs that a system owner must pay. kW-based incentives are bounded to ensure that owners do not pay less than this amount.~
~
Source:~
SGIP Handbook 2011-2016~
https://www.selfgenca.com/home/resources/
Definition: 0%
NodeLocation: 560,592,1
NodeSize: 64,40
Aliases: FormNode Fo1572464811
NodeColor: 65535,1,1
NumberFormat: 2,%,4,2,0,0,4,0,$,0,"ABBREV",0,,,0,0,15

Constant kW_Incent_Derate_Cap
Title: kW Incent Derate for Capacity
Description: The amount by which the incentive "base rate" is derated to account for different storage capacities. This is a multiplier applied to the base rate incentive (eg, 100% = no derate). The capacity lower bound refers to the minimum capacity size for which the derate is applicable. For example, let's say the derate multiplier is 100% for capacity values greater than or equal to zero and less than or equal to 1 MW; the multiplier is 50% for capacity values greater than 1 MWh; and the multiplier is 0% for capacity values greater than 2 MW. The input table associated with this situation would look like the example below.~
~
Step	Lower Bound (MW)		Derate Multiplier (%)~
1		0						100%~
2		1						50%~
3		2						0%~
~
Source: ~
SGIP Handbook 2011-2016~
https://www.selfgenca.com/home/resources/
Definition: Table(Incent_Capacity_Step,Incent_MW_Cap_Inputs)(~
0,1,~
100,1,~
100,1,~
100,1,~
100,1)
NodeLocation: 256,592,1
NodeSize: 64,40
WindState: 2,-13,159,959,608
DefnState: 2,702,276,776,379,0,DFNM
ValueState: 2,27,546,877,303,0,MIDM
Aliases: FormNode Fo1572457889
NodeColor: 65535,1,1
ReformDef: [Incent_MWhCap_Inputs,Incent_Capacity_Step]
TableCellDefault: 1
{!40700|Att_CellFormat: CellFormats(CellSpan(Incent_MWhCap_Inputs,CellNumberFormat('Percentage',2,0,0,dateFormat:'ABBREV',fullPrecision:0,numbersAsDates:0,datesAsNumbers:0),2,header:0),CellSpan(Incent_MW_Cap_Inputs,CellNumberFormat('General',1,0,0,dateFormat:'ABBREV',fullPrecision:0,numbersAsDates:0,datesAsNumbers:0,digits_:2,zeroes_:2),1,header:0),CellSpan(Incent_MW_Cap_Inputs,CellNumberFormat('Fixed Point',2,0,0,dateFormat:'ABBREV',fullPrecision:0,numbersAsDates:0,datesAsNumbers:0),1,header:0))}

FormNode Fo1572457889
Title: Incentive Derate for Duration
Definition: 0
NodeLocation: 256,644,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: kW_Incent_Derate_Cap

Variable Incent_kW_Cap_Derate
Title: Incentive kW Capacity Derate
Units: fraction
Description: The incentive derate multiplier for the simulated storage capacities.
Definition: AvgRate_Across_Brack(kW_Incent_Derate_Cap[@Incent_MW_Cap_Inputs=1], kW_Incent_Derate_Cap[@Incent_MW_Cap_Inputs=2], Storage_Max_Power[System_Types=Storage_Systems] * MW_per_kW, Incent_Capacity_Step)
NodeLocation: 408,592,1
NodeSize: 64,40
WindState: 2,282,364,720,350
ValueState: 2,276,151,1057,303,0,MIDM
NumberFormat: 2,%,2,2,0,0,2,0,$,0,"ABBREV",0,,,0,0,15

Variable Derate_kW_IncentRate
Title: Derated kW Incentive Rate
Units: $/kW
Description: The incentive rate derated for the size of the system.
Definition: Strg_kW_Base_Rate[Static_PV_Time=Annual_Econ_Time] * W_per_kW * Incent_kW_Cap_Derate;~

NodeLocation: 408,480,1
NodeSize: 64,40
ValueState: 2,151,161,1020,654,,MIDM
ReformVal: [Annual_Econ_Time,Installation_Event]
Att_ResultSliceState: [PV_Sectors,1,Storage_Systems,1,Annual_Econ_Time,1]

Variable kW_Incentive
Title: kW Incentive
Units: $/system
Description: The incentive based on system kW size before limiting the incentive to an upper limit (based on some fraction of overall system cost that a system owner must pay).
Definition: Storage_Max_Power[System_Types=Storage_Systems] * Derate_kW_IncentRate
NodeLocation: 560,480,1
NodeSize: 64,40
WindState: 2,73,29,984,472
ValueState: 2,58,49,1066,613,,MIDM
ReformVal: [Annual_Econ_Time,Installation_Event]
Att_ResultSliceState: [PV_Sectors,1,Storage_Systems,1,Installation_Event,1,Annual_PV_Time,1]

Variable Max_Allowed_Incent
Title: Max Allowed Incentive
Units: $/system
Description: The maximum allowed incentive, which considers the ITC and a minimum percentage of eligible system costs that an owner must pay.~
~
Source:~
SGIP Handbook 2011-2016~
https://www.selfgenca.com/home/resources/
Definition: (Install_Equip_Price * (1 - Applied_ITC_by_Event - Min_Cost_Share_Pct))[Equipment_Types=Battery_Strg_Label, Installation_Event=Init_Install_Label, System_Types=Storage_Systems] 
NodeLocation: 712,592,1
NodeSize: 64,40
ValueState: 2,444,72,1158,682,,MIDM
Att_ResultSliceState: [PV_Sectors,1,Storage_Systems,1,PV_Climate_Zone,1,Annual_PV_Time,1]

Variable Bounded_kW_Incentive
Title: Bounded kW Incentive
Units: $/system
Description: The incentive based on system kW size after limiting the incentive to an upper limit (based on some fraction of overall system cost that a system owner must pay).
Definition: MIN([kW_Incentive, Max_Allowed_Incent])
NodeLocation: 712,480,1
NodeSize: 64,40
ValueState: 2,303,181,1152,710,,MIDM
Att_ResultSliceState: [PV_Sectors,2,Storage_Systems,2,PV_Climate_Zone,1,Area_Type,1,Annual_Econ_Time,1]

Variable kWh_Incentive
Title: kWh Incentive
Units: $/system
Description: The incentive based on system kWh size.
Definition: Storage_Capacity[System_Types=Storage_Systems] * ~
(IF Use_simple_storage_i THEN Storage_incentive_ra {if using simplified storage incentive input}~
ELSE Derated_Incent_Rate)
NodeLocation: 720,344,1
NodeSize: 64,40
ValueState: 2,335,136,1020,590,1,MIDM
ReformVal: [Time,PV_Climate_Zone]
Att_ResultSliceState: [PV_Sectors,19,Storage_Systems,1,Area_Type,1,PV_Climate_Zone,1,Time,1]

Constant FinalYr_of_kW_Incent
Title: Final Year of kW Incentives
Description: The final year that kW-based incentives were available. After this year, kWh-based incentives will be applied.
Definition: 2000
NodeLocation: 888,240,1
NodeSize: 64,40
Aliases: FormNode Fo1572462032
NodeColor: 65535,1,1

FormNode Fo1572462032
Title: Number of Incentive Duration Steps
Definition: 0
NodeLocation: 888,188,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: FinalYr_of_kW_Incent

Variable BESS_Incentive
Title: BESS Incentive
Units: $/system
Description: This storage incentive, which was kW-based prior to 2017 and kWh-based afterward.
Definition: IF Time_Year_Map <= FinalYr_of_kW_Incent~
THEN  StepInterp(BOY_Date_for_Econ_Yr, Bounded_kW_Incentive, Time, Annual_Econ_Time, True)~
ELSE kWh_Incentive
NodeLocation: 888,344,1
NodeSize: 64,40
ValueState: 2,336,46,1378,770,,MIDM
ReformVal: [Time,PV_Climate_Zone]
Att_ResultSliceState: [Storage_Systems,2,PV_Sectors,1,Area_Type,1,PV_Climate_Zone,1,Time,1]

FormNode Fo1572464811
Title: Min Cost Share Percentage
Definition: 0
NodeLocation: 560,644,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Min_Cost_Share_Pct

Text Te1572464980
Title: BESS kWh-Based Incentives
NodeLocation: 416,204,-1
NodeSize: 392,196
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Text Te1572465129
Title: BESS kW-Based Incentives
NodeLocation: 416,540,-1
NodeSize: 392,132
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Text Te1580648199
Title: PV kW-Based Incentives
NodeLocation: 416,824,-1
NodeSize: 392,144
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Constant PV_kW_DC_Incentive
Title: PV kW-DC Incentive
Units: $/kW-DC
Description: Estimated PV incentive on a $/nameplate kW-DC basis.
Definition: Table(PV_Incentive_Scen,PV_Climate_Zone,Static_PV_Time)(~
0,0,0,0,0,0,0,0,0,0,0,1079.91034203936,916.696869241179,642.860640387095,539.280659329967,572.771780334585,593.244355409061,614.395362852156,648.766943073254,535.451897689116,1005,1005,1005,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,0,0,0,0,1079.91034203936,916.696869241179,642.860640387095,539.280659329967,572.771780334585,593.244355409061,614.395362852156,648.766943073254,535.451897689116,1005,1005,1005,1005,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,0,0,0,0,1079.91034203936,916.696869241179,642.860640387095,539.280659329967,572.771780334585,593.244355409061,614.395362852156,648.766943073254,535.451897689116,1005,1005,1005,1005,800,600,400,200,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
NodeLocation: 960,1104,1
NodeSize: 64,40
WindState: 2,-77,73,720,671
DefnState: 2,461,45,579,609,0,DFNM
ValueState: 2,233,37,1306,701,,MIDM
Aliases: FormNode Fo1580649311
NodeColor: 65535,1,1
GraphSetup: Att_GraphIndexRange Static_PV_Time:1,,0,,,,10,2014.9815272539854,2030.6107994914055,0~
Att_GraphValueRange PV_kW_DC_Incentive:1,,1,,,,,0,1027.4618715047836,0~
Flip:0
ReformDef: [PV_Climate_Zone,Static_PV_Time]
ReformVal: [Static_PV_Time,PV_Incentive_Scen]
NumberFormat: 2,F,4,0,1,1,4,0,$,0,"ABBREV",0,,,0,0,15,
DisplayOutputs: Object Object, Object Decision
TableCellDefault: 0
Att_ResultSliceState: [PV_Climate_Zone,3,PV_Incentive_Scen,2,Static_PV_Time,1]
Att_EditSliceState: [PV_Incentive_Scen,2,Static_PV_Time,1,PV_Climate_Zone,4]
{!40700|Att_CellFormat: CellAlignment('Center')}
{!50000|Att_ColumnWidths: [,Static_PV_Time,\([,,,,,,,,,,,,,,,,,,,,,,,,,,432,,,,,,,,,,,,,,,,,,,,,,,,])]}

Index PV_Incentive_Scen
Att_PrevIndexValue: ['Low','Medium','High']
Title: PV Incentive Scenario
Definition: ['Low','Medium','High']
NodeLocation: 128,880,1
NodeSize: 64,40
WindState: 2,683,293,875,511
Aliases: FormNode Fo1580649327
DisplayOutputs: Object Object, Object Decision

Decision PV_Incent_Scenario
Title:  PV Incentive Scenario
Description: Select which incentive scenario you wish to simulate.
Definition: Choice(PV_Incentive_Scen,2,0)
IndexVals: ['item 1']
NodeLocation: 272,880,1
NodeSize: 64,40
WindState: 2,455,283,777,494
DefnState: 2,952,307,692,202,0,DFNM
Aliases: FormNode Fo1580763407, FormNode Fo1580649196, FormNode Fo1008018531
TableCellDefault: Choice(PV_Incentive_Scen,2,0)

FormNode Fo1580649196
Title: PV Incentive Scenario
Definition: 0
NodeLocation: 276,924,1
NodeSize: 60,12
NodeInfo: 1,,,0,,,,104,,,0,,,0
Original: PV_Incent_Scenario

FormNode Fo1580649311
Title: PV kW-AC Incentive
Definition: 0
NodeLocation: 960,1052,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: PV_kW_DC_Incentive

FormNode Fo1580649327
Title: PV Incentive Scenario
Definition: 0
NodeLocation: 128,932,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: PV_Incentive_Scen

Variable PV_Incentive_Rate
Title: PV Incentive Rate
Units: $/kW-DC
Definition: PV_Incentive_over_Ti[Static_PV_Time=Annual_Econ_Time,All_PV_Sectors=PV_Sectors] ~
/*PV_kW_DC_Incentive[PV_Incentive_Scen=PV_Incent_Scenario, Static_PV_Time=Annual_Econ_Time] ~
+ Incentive_Adder
NodeLocation: 200,784,1
NodeSize: 64,40
ValueState: 2,1169,68,448,830,0,MIDM
ReformVal: [Area_Type,Annual_Econ_Time]

Variable PV_System_Incentive
Title: PV System Incentive
Units: $/system
Definition: VAR incentByYear:=PV_Incentive_Rate * PV_DC_System_Size_fo;~
StepInterp(BOY_Date_for_Econ_Yr, incentByYear, Time, Annual_Econ_Time, True)
NodeLocation: 424,784,1
NodeSize: 64,40
WindState: 2,98,82,912,481
ValueState: 2,180,186,1124,572,1,MIDM
GraphSetup: Att_GraphIndexRange Time:1,,0,,,,,39602.81915719807,46229.0305377841,0~
Flip:0
Att_ResultSliceState: [PV_Sectors,1,PV_Climate_Zone,1,Area_Type,1,Test_PV_Incentive_W_,1,Time,1]

Variable PV_Incent_by_Event
Title: PV Incentive by Event
Units: $/system
Definition: VAR incentByEvent:=Val_by_Install_Event(PV_System_Incentive, Timesteps_Per_Year, Time)[Equipment_Types=Solar_PV_Label];~
incentByEvent * (Equipment_Sizes[Equipment_Types=Solar_PV_Label] > 0) 
NodeLocation: 568,784,1
NodeSize: 64,40
ValueState: 2,404,131,886,755,1,MIDM
ReformVal: [Time,Installation_Event]
Att_ResultSliceState: [PV_Sectors,1,PV_Climate_Zone,1,System_Types,1,Area_Type,1,Installation_Event,1,Time,1]

Variable Implement_Incentives
Title: Implemented Incentives
Units: $/system
Description: Taxable incentives by system type.
Definition: IF Equipment_Types=Battery_Strg_Label~
THEN Replace_X_with_Y(Strg_Incent_by_Event, Null, 0)~
ELSE Replace_X_with_Y(PV_Incent_by_Event, Null, 0)
NodeLocation: 1040,480,1
NodeSize: 64,40
ValueState: 2,165,15,1099,844,1,MIDM
ReformVal: [Time,Installation_Event]
Att_ResultSliceState: [PV_Sectors,2,System_Types,2,PV_Climate_Zone,1,Equipment_Types,1,Area_Type,1,Installation_Event,2,Time,1]

Index BESS_Incentive_Scen
Att_PrevIndexValue: ['Low','Medium','High']
Title: BESS Incentive Scenario
Definition: ['Low','Medium','High']
NodeLocation: 1152,256,1
NodeSize: 64,40
WindState: 2,98,82,720,525
Aliases: FormNode Fo1580669552
DisplayOutputs: Object Object, Object Decision
{!40300|Att_SlicerPopupSize: 227,48}

Decision Storage_Incentive_Sc
Title: Storage Incentive Scenario
Description: Select which storage incentive scenario you wish to model
Definition: Choice(BESS_Incentive_Scen,2,1)
IndexVals: ['item 1']
NodeLocation: 1296,256,1
NodeSize: 64,40
WindState: 2,452,169,836,534
Aliases: FormNode Fo1580763408, FormNode Fo1580668309
NodeColor: 65535,1,1

FormNode Fo1580668309
Title: PV Incentive Scenario
Definition: 0
NodeLocation: 1308,308,1
NodeSize: 76,12
NodeInfo: 1,0,0,0,0,0,0,118,0,,0,,,0
Original: Storage_Incentive_Sc

FormNode Fo1580669552
Title: BESS Incentive Scenario
Definition: 0
NodeLocation: 1152,308,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: BESS_Incentive_Scen

Text Te1735257597
Title: Not Imported!
NodeLocation: 408,720,-1
NodeSize: 112,24
NodeInfo: 1,,,,,1
NodeColor: 65535,1,1

Constant Storage_KWh_Incentiv
Title: Storage KWh Incentive
Units: $/kWh
Description: $/kWh of storage capacity incentive for battery storage systems.
Definition: Table(BESS_Incentive_Scen,PV_Climate_Zone,Static_PV_Time)(~
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
NodeLocation: 1056,80,1
NodeSize: 64,40
WindState: 2,1104,119,720,350
DefnState: 2,479,19,499,873,0,DFNM
ValueState: 2,334,350,1116,490,,MIDM
Aliases: FormNode Fo1352896803
NodeColor: 65535,1,1
ReformDef: [BESS_Incentive_Scen,Static_PV_Time]
Att_EditSliceState: [BESS_Incentive_Scen,1,Static_PV_Time,11,PV_Climate_Zone,1]

Variable Storage_incentive_ra
Title: Storage incentive rate
Units: $/kWh
Definition: Storage_KWh_Incentiv[Static_PV_Time=Time_Year_Map,BESS_Incentive_Scen=Storage_Incentive_Sc]
NodeLocation: 896,80,1
NodeSize: 64,40
ValueState: 2,1604,86,1122,601,,MIDM

Decision Use_simple_storage_i
Title: Use simple storage incentive input
Definition: checkbox(1)
NodeLocation: 1240,80,1
NodeSize: 64,40
Aliases: FormNode Fo111382819
NodeColor: 65535,65531,1

FormNode Fo1352896803
Title: Storage KWh Incentive
Definition: 0
NodeLocation: 1304,184,1
NodeSize: 176,16
NodeColor: 65535,1,1
Original: Storage_KWh_Incentiv

FormNode Fo111382819
Title: Use simple storage incentive input
Definition: 0
NodeLocation: 1288,144,1
NodeSize: 152,16
NodeColor: 65535,65531,1
Original: Use_simple_storage_i

Index Incentive_Adder_Type
Att_PrevIndexValue: ['Community Adder','Prevailing Wage Adder']
Title: Incentive Adder Type
Definition: ['Community Adder','Prevailing Wage Adder']
NodeLocation: 568,880,1
NodeSize: 64,40

Constant Incentive_PV_kW_Adde
Title: Incentive PV $/kW Adder
Units: $/kW-DC
Description: Additional solar PV incentives dependent on installation type (e.g., parking canopy) or geography. 
Definition: Table(Incentive_Adder_Type,Area_Type,PV_Climate_Zone)(~
200,~
0)
NodeLocation: 1120,1192,1
NodeSize: 64,40
WindState: 2,2140,87,720,350
DefnState: 2,953,464,640,232,0,DFNM
NodeColor: 65535,1,1
ReformDef: [PV_Climate_Zone,Area_Type]
NumberFormat: 2,F,4,0,1,1,4,0,$,0,"ABBREV",0,,,0,0,15,
Att_EditSliceState: [Incentive_Adder_Type,2,Area_Type,1,PV_Climate_Zone,3]
{!40700|Att_CellFormat: CellAlignment('Center')}

Index Minimum_System_Size
Title: Minimum System Size
Definition: 1
NodeLocation: 1104,1304,1
NodeSize: 64,40
NodeColor: 65535,1,1
{!40300|DomainExpr: Continuous()}

Variable Incentive_Adder
Title: Incentive Adder
Definition: sum(Incentive_PV_kW_Adde,Incentive_Adder_Type)
NodeLocation: 968,1192,1
NodeSize: 64,40

Variable Base_Yr_PV_Incent1
Title: Base Yr PV Incent
Units: $/W-DC
Description: Base year PV incentives, accounting for average system sizes by sector, installation/area type, and geography. ~
~
Includes base incentives plus all "adders" (e.g., community credits, prevailing wage adders, and installation type (e.g., parking) adders). 
Definition: Base_Yr_PV_Incent[PV_Incentive_Scen=PV_Incent_Scenario] + ~
sum(PV_Incent_Adder,Incentive_Adder_Type) + ~
Installation_Type_Ad
NodeLocation: 488,1272,1
NodeSize: 64,40
ValueState: 2,1006,144,761,673,0,MIDM
ReformVal: [PV_Climate_Zone,PV_Sectors]
NumberFormat: 2,F,2,3,0,0,2,0,$,0,"ABBREV",0,,,0,0,15,
Att_ResultSliceState: [All_PV_Sectors,1,Test_PV_Incentive_W_,2,Area_Type,1,PV_Climate_Zone,1]
{!40700|Att_CellFormat: CellAlignment('Center')}

Constant PV_Incent_Adder
Title: PV Incent Adder
Units: $/W-DC
Definition: Table(PV_Climate_Zone,Incentive_Adder_Type)(~
0,0)
NodeLocation: 664,1392,1
NodeSize: 64,40
DefnState: 2,1015,371,539,247,0,DFNM
ValueState: 2,372,178,877,228,0,MIDM
NodeColor: 65535,1,1
ReformDef: [Incentive_Adder_Type,PV_Climate_Zone]
ReformVal: [Incentive_Adder_Type,PV_Climate_Zone]
NumberFormat: 2,F,3,3,0,0,3,0,$,0,"ABBREV",0,,,0,0,15,
Att_ResultSliceState: [Minimum_System_Size,3,PV_Climate_Zone,1,Incentive_Adder_Type,1]
Att_EditSliceState: [Incentive_Adder_Type,2,PV_Climate_Zone,1,Minimum_System_Size,1]
{!40700|Att_CellFormat: CellAlignment('Center')}

Constant Base_Yr_PV_Incent
Title: Base Yr PV Incent
Units: $/W-DC
Definition: Table(All_PV_Sectors,PV_Incentive_Scen,PV_Climate_Zone)(~
0,~
0,~
0.35,~
0,~
0,~
0,~
0,~
0,~
0)
NodeLocation: 480,1168,1
NodeSize: 64,40
WindState: 2,98,82,720,350
DefnState: 2,1022,494,575,195,0,DFNM
ValueState: 2,1379,177,416,303,0,MIDM
Aliases: FormNode Fo706663843, FormNode Fo135603299
NodeColor: 65535,1,1
ReformDef: [Minimum_System_Size,PV_Climate_Zone]
NumberFormat: 2,F,2,3,0,0,2,0,$,0,"ABBREV",0,,,0,0,15,
Att_EditSliceState: [All_PV_Sectors,2,PV_Climate_Zone,1,PV_Incentive_Scen,1]
{!40700|Att_CellFormat: CellAlignment('Center')}

Constant Installation_Type_Ad
Title: Installation Type Adder
Units: $/W-DC
Definition: Table(Area_Type,PV_Climate_Zone)(~
0)
NodeLocation: 488,1368,1
NodeSize: 64,40
DefnState: 2,500,506,788,258,0,DFNM
ValueState: 2,1312,359,416,303,0,MIDM
NodeColor: 65535,1,1
ReformVal: [Area_Type,PV_Climate_Zone]
NumberFormat: 2,F,2,2,0,0,2,0,$,0,"ABBREV",0,,,0,0,15,
{!40700|Att_CellFormat: CellAlignment('Center')}

Constant Incentive_Phase_out_
Title: Incentive Phase-out Mult
Units: $/W-DC
Definition: Table(Static_PV_Time,PV_Incentive_Scen)(~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,1,~
0,0,1,~
0,0,1,~
0,0,1,~
0,0,1,~
0,0,1,~
0,0,1,~
0,0,1,~
0,0,0.9,~
0,0,0.8,~
0,0,0.7,~
0,0,0.6,~
0,0,0.5,~
0,0,0.4,~
0,0,0.3,~
0,0,0.2,~
0,0,0.1,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0,~
0,0,0)
NodeLocation: 328,1168,1
NodeSize: 64,40
DefnState: 2,1166,48,527,827,0,DFNM
ValueState: 2,307,319,1441,345,0,MIDM
NodeColor: 65535,1,1
ReformDef: [PV_Incentive_Scen,Static_PV_Time]
{!40700|Att_CellFormat: CellAlignment('Center')}

Variable Incent_Size_Mult
Title: Incent Size Mult
Definition: 1/*local x:=sum((Avg_PVkW_facil_by_CZ>=Minimum_System_Size),Minimum_System_Size); ~
local position:=IF x=0 THEN 1 ELSE x;~
@Minimum_System_Size=x
NodeLocation: 960,1304,1
NodeSize: 64,40
ValueState: 2,2011,66,813,726,0,MIDM
NodeColor: 65535,1,1
ReformVal: [Spatial_ID,PV_Sectors]
Att__TotalsIndex: [Minimum_System_Size]
Att_ResultSliceState: [Area_Type,2,PV_Climate_Zone,1,PV_Sectors,1,Minimum_System_Size,2]

Alias Al1967504163
Title: Avg PVkW/facil, by CZ
Definition: 1
NodeLocation: 960,1400,1
NodeSize: 64,40
Original: Avg_PVkW_facil_by_CZ

Variable PV_Incentive_over_Ti
Title: PV Incentive over Time
Units: $/kW-DC
Definition: Base_Yr_PV_Incent1[PV_Incentive_Scen=PV_Incent_Scenario] * Incentive_Phase_out_[PV_Incentive_Scen=PV_Incent_Scenario] * 1000
NodeLocation: 320,1272,1
NodeSize: 64,40
ValueState: 2,400,345,1104,316,0,MIDM
GraphSetup: Att_GraphIndexRange Static_PV_Time:1,,0,,,,10,14,23,1~
Att_ForceCategorical Graph_Primary_Valdim:1~
Att_StackedBar Graph_Primary_Valdim:0~
{!50007|Graph_BarOutline:0}~
{!50000|Graph_SortBySpread:0}~
Graph_AxisLabelFont:,20,0
ReformVal: [Static_PV_Time,PV_Climate_Zone]
NumberFormat: 2,F,2,3,1,0,2,0,$,0,"ABBREV",0,,,0,0,15,
Att_ResultSliceState: [Area_Type,3,PV_Climate_Zone,1,Static_PV_Time,1]
{!40600|Att_ClusterIndex: PV_Climate_Zone}

Variable Base
Title: Base
Definition: sum(Base_Yr_PV_Incent * Incent_Size_Mult,Minimum_System_Size)
NodeLocation: 1168,1400,1
NodeSize: 64,40
ValueState: 2,1047,179,768,682,0,MIDM
ReformVal: [PV_Climate_Zone,PV_Sectors]
Att_ResultSliceState: [Area_Type,2,PV_Sectors,1,PV_Climate_Zone,1]

Variable Adders
Title: Adders
Definition: sum(PV_Incent_Adder,Incentive_Adder_Type)
NodeLocation: 1144,1072,1
NodeSize: 64,40
ValueState: 2,2922,65,774,723,0,MIDM
ReformVal: [PV_Climate_Zone,PV_Sectors]
Att_ResultSliceState: [Area_Type,2,PV_Sectors,1,PV_Climate_Zone,1]

Text Te288209699
Title: This method is customized for NYPA and only used for calculating the incentive rate in $/kW. This does not affect system sizing or dispatch calcs for economics.
NodeLocation: 536,1068,-1
NodeSize: 256,44

Text Te139442979
Title: Not used
NodeLocation: 1060,1236,-1
NodeSize: 180,236

Constant Storage_Flat_Incenti
Title: Storage Flat Incentive
Units: $/system
Definition: Table(All_PV_Sectors,BESS_Incentive_Scen,PV_Climate_Zone,Static_PV_Time,All_System_Types1)(~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,4000,4000,4000,0,0,~
0,0,4000,4000,4000,0,0,~
0,0,4000,4000,4000,0,0,~
0,0,4000,4000,4000,0,0,~
0,0,4000,4000,4000,0,0,~
0,0,4000,4000,4000,0,0,~
0,0,2000,2000,2000,0,0,~
0,0,500,2000,500,0,0,~
0,0,500,2000,500,0,0,~
0,0,500,2000,500,0,0,~
0,0,500,2000,500,0,0,~
0,0,500,2000,500,0,0,~
0,0,500,2000,500,0,0,~
0,0,500,2000,500,0,0,~
0,0,500,2000,500,0,0,~
0,0,500,1000,500,0,0,~
0,0,500,1000,500,0,0,~
0,0,500,1000,500,0,0,~
0,0,500,1000,500,0,0,~
0,0,500,1000,500,0,0,~
0,0,500,1000,500,0,0,~
0,0,500,1000,500,0,0,~
0,0,500,1000,500,0,0,~
0,0,500,1000,500,0,0,~
0,0,500,1000,500,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,4000,4000,4000,0,0,~
0,0,4000,4000,4000,0,0,~
0,0,4000,4000,4000,0,0,~
0,0,4000,4000,4000,0,0,~
0,0,4000,4000,4000,0,0,~
0,0,4000,4000,4000,0,0,~
0,0,2000,2000,2000,0,0,~
0,0,500,2000,500,0,0,~
0,0,500,2000,500,0,0,~
0,0,500,2000,500,0,0,~
0,0,500,2000,500,0,0,~
0,0,500,2000,500,0,0,~
0,0,500,2000,500,0,0,~
0,0,500,2000,500,0,0,~
0,0,500,2000,500,0,0,~
0,0,500,1000,500,0,0,~
0,0,500,1000,500,0,0,~
0,0,500,1000,500,0,0,~
0,0,500,1000,500,0,0,~
0,0,500,1000,500,0,0,~
0,0,500,1000,500,0,0,~
0,0,500,1000,500,0,0,~
0,0,500,1000,500,0,0,~
0,0,500,1000,500,0,0,~
0,0,500,1000,500,0,0,~
0,0,0,1000,0,0,0,~
0,0,0,1000,0,0,0,~
0,0,0,1000,0,0,0,~
0,0,0,1000,0,0,0,~
0,0,0,1000,0,0,0,~
0,0,0,1000,0,0,0,~
0,0,0,1000,0,0,0,~
0,0,0,1000,0,0,0,~
0,0,0,1000,0,0,0,~
0,0,0,1000,0,0,0,~
0,0,0,1000,0,0,0,~
0,0,0,1000,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,4000,4000,4000,0,0,~
0,0,4000,4000,4000,0,0,~
0,0,4000,4000,4000,0,0,~
0,0,4000,4000,4000,0,0,~
0,0,4000,4000,4000,0,0,~
0,0,4000,4000,4000,0,0,~
0,0,2000,2000,2000,0,0,~
0,0,500,2000,2000,0,0,~
0,0,500,2000,2000,0,0,~
0,0,500,2000,2000,0,0,~
0,0,500,2000,2000,0,0,~
0,0,500,2000,2000,0,0,~
0,0,500,2000,2000,0,0,~
0,0,500,2000,2000,0,0,~
0,0,500,2000,2000,0,0,~
0,0,500,2000,1000,0,0,~
0,0,500,2000,1000,0,0,~
0,0,500,2000,1000,0,0,~
0,0,500,2000,1000,0,0,~
0,0,500,2000,1000,0,0,~
0,0,500,2000,1000,0,0,~
0,0,500,2000,1000,0,0,~
0,0,500,2000,1000,0,0,~
0,0,500,2000,1000,0,0,~
0,0,500,2000,1000,0,0,~
0,0,0,2000,1000,0,0,~
0,0,0,2000,1000,0,0,~
0,0,0,2000,1000,0,0,~
0,0,0,2000,1000,0,0,~
0,0,0,2000,1000,0,0,~
0,0,0,2000,1000,0,0,~
0,0,0,2000,1000,0,0,~
0,0,0,2000,1000,0,0,~
0,0,0,2000,1000,0,0,~
0,0,0,2000,1000,0,0,~
0,0,0,2000,1000,0,0,~
0,0,0,2000,1000,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0)
NodeLocation: 1192,376,1
NodeSize: 64,40
DefnState: 2,427,-17,1054,905,0,DFNM
ValueState: 2,233,100,1183,706,1,MIDM
NodeColor: 65535,1,1
GraphSetup: Graph_SymbolKey:1
ReformDef: [BESS_Incentive_Scen,Static_PV_Time]
ReformVal: [Static_PV_Time,Static_PV_Time]
Att_ResultSliceState: [PV_Climate_Zone,1,All_System_Types1,3,All_PV_Sectors,1,Static_PV_Time,1,BESS_Incentive_Scen,1]
Att_EditSliceState: [All_PV_Sectors,2,PV_Climate_Zone,1,All_System_Types1,3,Static_PV_Time,1,BESS_Incentive_Scen,2]
Att_ColorRole: BESS_Incentive_Scen
Att_SymbolRole: All_System_Types1

Variable BESS_Flat_Incentive
Title: BESS Flat Incentive 
Definition: Storage_Flat_Incenti[Static_PV_Time=Time_Year_Map,BESS_Incentive_Scen=Storage_Incentive_Sc,All_PV_Sectors=PV_Sectors,All_System_Types1=Storage_Systems]
NodeLocation: 1024,376,1
NodeSize: 64,40
ValueState: 2,2126,100,1204,654,1,MIDM
ReformVal: [Time,Storage_Systems]
Att_ResultSliceState: [PV_Sectors,2,PV_Climate_Zone,1,Storage_Systems,2,Time,1]

FormNode Fo706663843
Title: Base Yr PV Incent
Definition: 0
NodeLocation: 404,1456,1
NodeSize: 156,16
NodeColor: 65535,1,1
Original: Base_Yr_PV_Incent

Variable Test_PV_Incentive_W_
Title: Test PV Incentive $/W-DC
Definition: [0,0.35,0.4,0.45,0.5,0.55,0.6000000000000001,0.6500000000000001,0.7000000000000002]
NodeLocation: 688,1160,1
NodeSize: 64,40
{!40300|Att_SlicerPopupSize: 237,112}

Variable PV_Incentives_by_PV_
Title: PV Incentives by PV Time
Units: $
Definition: Increm_DC_Capacity {MW-DC}~
* PV_Incentive_Rate1[PV_Climate_Zone=Climate_Zone_Map,Time=Time_Solar_PV] {$/kW-DC}~
* 1000 {kW-DC / MW-DC}
NodeLocation: 88,1160,1
NodeSize: 64,40
ValueState: 2,1881,263,1699,351,0,MIDM
NumberFormat: 2,F,2,0,1,0,2,0,$,0,"ABBREV",0,,,0,0,15,
Att__TotalsIndex: [Time_Solar_PV]
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,1,Area_Type,1,Test_PV_Incentive_W_,1,Time_Solar_PV,1]

Alias Al1145062499
Title: New Constr + Retrofit Installs
Definition: 1
NodeLocation: 96,1496,1
NodeSize: 64,40
Original: NC_and_Retro_Install

Alias Al437134435
Title: Increm DC Capacity
Definition: 1
NodeLocation: 88,1384,1
NodeSize: 64,40
Original: Increm_DC_Capacity

Variable PV_Incentive_Rate1
Title: PV Incentive Rate
Units: $/kW-DC
Definition: StepInterp(BOY_Date_for_Econ_Yr, PV_Incentive_Rate, Time, Annual_Econ_Time, True)
NodeLocation: 128,1040,1
NodeSize: 64,40
ValueState: 2,474,153,977,643,,MIDM

Variable PV_Incentives_by_Yea
Title: PV Incentives by Year
Definition: local x:=Cumulate(PV_Incentives_by_PV_,Time_Solar_PV);~
local y:=x[Time_Solar_PV=PV_Time_at_End_of_Fo];~
Uncumulate(y,Forecast_Year1)
NodeLocation: 176,1256,1
NodeSize: 64,40
WindState: 2,597,77,1249,619
ValueState: 2,430,242,1209,379,0,MIDM
NumberFormat: 2,F,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15,
Att__TotalsIndex: [Forecast_Year1]
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,1,Area_Type,1,Test_PV_Incentive_W_,7,Forecast_Year,1,Forecast_Year1,1]

Variable Total_PV_Incentives_
Title: Total PV Incentives by Year
Units: $
Definition: sum(PV_Incentives_by_Yea,PV_Sectors,PV_Spatial_ID,Area_Type)
NodeLocation: 248,1360,1
NodeSize: 64,40
ValueState: 2,521,134,449,691,0,MIDM
Aliases: FormNode Fo1608852579
ReformVal: [0,Forecast_Year1]
NumberFormat: 2,F,2,0,1,0,2,0,$,0,"ABBREV",0,,,0,0,15,
Att__TotalsIndex: [Forecast_Year1]

Variable Va49
Definition: Base_Yr_PV_Incent[PV_Incentive_Scen=PV_Incent_Scenario]
NodeLocation: 760,1280,1
NodeSize: 64,40
ValueState: 2,944,293,828,587,0,MIDM

Close Taxable_Incents

Variable Applied_ITC_by_Event
Title: Applied ITC by Event
Units: fraction
Description: The ITC amount as a fraction of upfront capital costs that can be claimed by each equipment and system type. For storage technologies, this is a function of the amount of energy stored that comes from PV.
Definition: ITC_Fraction * Val_By_Install_Event(Allowed_ITC_Pct_Year, 1, Annual_Econ_Time)
NodeLocation: 536,360,1
NodeSize: 64,40
WindState: 2,51,375,951,433
ValueState: 2,176,287,1337,309,0,MIDM
ReformVal: [Annual_Econ_Time,Installation_Event]
Att_ResultSliceState: [PV_Sectors,1,PV_Climate_Zone,1,Equipment_Types,1,System_Types,1,Area_Type,1,Installation_Event,1,Annual_Econ_Time,1]

Variable Va16
Definition: Rate_Vintage=Rate_Vintage_by_Time[Pre_and_Post_System=Post_System_Label]
NodeLocation: 96,584,1
NodeSize: 64,40
ValueState: 2,430,131,1111,630,0,MIDM
Att__TotalsIndex: [Rate_Vintage]
Att_ResultSliceState: [Rate_Vintage,0,PV_Climate_Zone,1,PV_Sectors,1,Time,1]

Variable Va23
Definition: PV_Pct_of_Charge2[Opt_Storage_Systems=Map_Opt_Syst_to_Syst, Opt_Sectors=PV_Sectors] < Stored_PV_Pct_ITC[All_Sectors=PV_Sectors]
NodeLocation: 512,88,1
NodeSize: 64,40
ValueState: 2,765,64,770,598,0,MIDM

Close Incentives

Module Taxes
Title: Taxes
Author: JamesMilford
Date: Thu, Oct 4, 2018 8:27 AM
NodeLocation: 432,96,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,42,111,1621,624,17,10
AcpStyles: FrameNode: FrameNode_1544920240

Decision Taxed_as_Commercial
Title: Taxed as Commercial
Units: boolean
Description: Flags sectors that will be exposed to commercial tax treatment.
Definition: Table(All_Sectors)(Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(1))
NodeLocation: 400,408,1
NodeSize: 64,40
DefnState: 2,1143,109,364,668,0,DFNM
Aliases: FormNode Fo1554732067
NodeColor: 65535,1,1
TableCellDefault: Checkbox(0)

Constant MACRS_Schedule
Title: MACRS Schedule
Units: fraction
Description: MACRS depreciation schedules for each sector.
Definition: Table(All_PV_Sectors,PV_Operating_Year)(~
0.2,0.32,0.192,0.1152,0.1152,0.0576,0,0,0,0,0,0,0,0,0,0,0,0,0,0,~
0.2,0.32,0.192,0.1152,0.1152,0.0576,0,0,0,0,0,0,0,0,0,0,0,0,0,0,~
0.2,0.32,0.192,0.1152,0.1152,0.0576,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
NodeLocation: 96,80,1
NodeSize: 64,40
WindState: 2,477,329,720,350
DefnState: 2,248,57,940,522,0,DFNM
Aliases: Alias Al1568695862, FormNode Fo1568695862, FormNode Fo1545167165
ReformDef: [All_Sectors,PV_Operating_Year]
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
DisplayOutputs: Object Object, Object Decision
{!40700|Att_CellFormat: Undefined}

Constant Tax_Rates
Title: Tax Rates
Units: fraction/year
Description: The corporate tax rates for each tax entity.~
~
Source:~
(State tax) https://www.cdtfa.ca.gov/taxes-and-fees/sales-use-tax-rates-history.htm~
https://files.taxfoundation.org/legacy/docs/State%20Corporate%20Income%20Tax%20Rates%2C%202000-2014.xlsx~
https://taxfoundation.org/state-corporate-income-tax-rates-brackets-2017/~
https://en.wikipedia.org/wiki/Corporate_tax_in_the_United_States~
~
(Federal tax)~
https://tradingeconomics.com/united-states/corporate-tax-rate
Definition: Table(All_Utilities,Static_PV_Time,Tax_Entity)(~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.06,0.21,~
0.069,0.21,~
0.069,0.21,~
0.069,0.21,~
0.069,0.21,~
0.069,0.21,~
0.069,0.21,~
0.069,0.21,~
0.069,0.21,~
0.069,0.21,~
0.069,0.21,~
0.069,0.21,~
0.069,0.21,~
0.06,0.21,~
0.05,0.21,~
0.04,0.21,~
0.03,0.21,~
0.03,0.21,~
0.025,0.21,~
0.025,0.21,~
0.025,0.21,~
0.025,0.21,~
0.025,0.21,~
0.025,0.21,~
0.0225,0.21,~
0.02,0.21,~
0.02,0.21,~
0.01,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0.069,0.21,~
0.069,0.21,~
0.069,0.21,~
0.069,0.21,~
0.069,0.21,~
0.069,0.21,~
0.069,0.21,~
0.069,0.21,~
0.069,0.21,~
0.069,0.21,~
0.069,0.21,~
0.069,0.21,~
0.06,0.21,~
0.05,0.21,~
0.04,0.21,~
0.03,0.21,~
0.03,0.21,~
0.025,0.21,~
0.025,0.21,~
0.025,0.21,~
0.025,0.21,~
0.025,0.21,~
0.025,0.21,~
0.0225,0.21,~
0.02,0.21,~
0.02,0.21,~
0.01,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21,~
0.05,0.21)
NodeLocation: 552,224,1
NodeSize: 64,40
WindState: 2,258,541,1722,350
DefnState: 2,1025,78,594,719,0,DFNM
ValueState: 2,196,202,416,303,0,MIDM
Aliases: Alias Al1568695868, FormNode Fo1568695868, FormNode Fo1545167166
ReformDef: [All_Utilities,Static_PV_Time]
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
DisplayOutputs: Object Object, Object Decision

Constant Bonus_Deprec_Sched
Title: Bonus Depreciation Schedule
Units: fraction
Description: The schedules for bonus depreciation.
Definition: Table(Static_PV_Time)(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
NodeLocation: 96,176,1
NodeSize: 64,40
WindState: 2,884,527,720,350
DefnState: 2,1048,27,282,856,0,DFNM
ValueState: 2,168,170,421,498,,MIDM
Aliases: Alias Al1568695863, FormNode Fo1568695863, FormNode Fo1545167167
ReformVal: [Static_PV_Time,Undefined]
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
DisplayOutputs: Object Object, Object Decision

Variable MACRS_Schedules
Title: MACRS Schedules
Definition: MACRS_Schedule[All_PV_Sectors=PV_Sectors]
NodeLocation: 248,80,1
NodeSize: 64,40
ValueState: 2,552,554,732,303,,MIDM

Variable Depreciab_Cost_Basis
Title: Depreciable Cost Basis
Units: $/kW-DC, $/kWh
Description: The cost basis that can be depreciated by commercial entities. Solar PV costs are in $/kW-DC, while battery storage costs are in $/kWh.
Definition: (Per_Unit_Equip_Price - 0.5 * Per_Unit_Federal_ITC) * Com_Tax_Entity
NodeLocation: 400,80,1
NodeSize: 64,40
WindState: 2,205,316,1474,624
ValueState: 2,337,168,944,513,,MIDM
ReformVal: [Annual_Econ_Time,Installation_Event]
Att_ResultSliceState: [PV_Sectors,2,Equipment_Types,2,System_Types,1,PV_Climate_Zone,1,Installation_Event,1,Annual_PV_Time,1]

Variable Com_Tax_Entity
Title: Commercial Tax Entity
Units: boolean
Description: Flags sectors that will be exposed to commercial tax treatment.
Definition: IF Assume_Third_Party_O THEN 1 ELSE Taxed_as_Commercial[All_Sectors=PV_Sectors]
NodeLocation: 400,272,1
NodeSize: 64,40
WindState: 2,49,39,720,350

Variable Total_Depreciation
Title: Total Depreciation
Units: $/kW-DC, $/kWh
Description: The depreciable amount based on MACRS and bonus depreciation. Solar PV amounts are in $/kW-DC, while battery storage amounts are in $/kWh.
Definition: MACRS_Deprec_Basis * MACRS_Schedules + Bonus_Deprec_Basis * (PV_Operating_Year=1)
NodeLocation: 704,80,1
NodeSize: 64,40
WindState: 2,102,82,906,463
ValueState: 2,499,105,944,661,,MIDM
ReformVal: [PV_Operating_Year,PV_Sectors]
Att__TotalsIndex: []
Att_ResultSliceState: [Equipment_Types,1,Annual_Econ_Time,12,Assume_Third_Party_O,2,PV_Climate_Zone,1,System_Types,1,Installation_Event,1,Area_Type,1,PV_Sectors,2,PV_Operating_Year,1]

Decision Allow_Bonus_Deprec
Title: Allow Bonus Depreciation
Units: boolean
Description: Select whether to allow bonus depreciation to be considered.
Definition: Checkbox(0)
NodeLocation: 248,272,1
NodeSize: 64,40
Aliases: FormNode Fo1538000901

FormNode Fo1538000901
Title: Allow Bonus Depreciation
Definition: 0
NodeLocation: 300,300,1
NodeSize: 28,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Allow_Bonus_Deprec

Variable Bonus_Deprec_Scheds
Title: Bonus Depreciation Schedules
Units: fraction
Description: The schedules for bonus depreciation.
Definition: Val_by_Install_Event(Bonus_Deprec_Sched[Static_PV_Time=Annual_Econ_Time], 1, Annual_Econ_Time)
NodeLocation: 248,176,1
NodeSize: 64,40
ValueState: 2,263,62,792,588,,MIDM
ReformVal: [Annual_Econ_Time,Installation_Event]
Att_ResultSliceState: [Equipment_Types,2,Installation_Event,1,Annual_PV_Time,1]

Variable Bonus_Deprec_Basis
Title: Bonus Depreciation Cost Basis
Units: $/kW-DC, $/kWh
Description: The cost basis for bonus depreciation. Solar PV costs are in $/kW-DC, while battery storage costs are in $/kWh. When batteries are paired with solar, they're allowed to use bonus depreciation.
Definition: Depreciab_Cost_Basis * Bonus_Deprec_Scheds * Allow_Bonus_Deprec * (Equip_Install_Map[All_Equipment_Types=Solar_PV_Label, All_System_Types=System_Types] OR (System_Types = Storage_Added_Label))
NodeLocation: 400,176,1
NodeSize: 64,40
ValueState: 2,188,230,951,606,,MIDM
Att_ResultSliceState: [Equipment_Types,2,PV_Sectors,2,System_Types,3,Installation_Event,1,PV_Climate_Zone,1,Annual_PV_Time,1]

Variable MACRS_Deprec_Basis
Title: MACRS Depreciation Cost Basis
Units: $/kW-DC, $/kWh
Description: The cost basis for MACRS depreciation after considering bonus depreciation. Solar PV costs are in $/kW-DC, while battery storage costs are in $/kWh.
Definition: Depreciab_Cost_Basis - Bonus_Deprec_Basis
NodeLocation: 552,80,1
NodeSize: 64,40
WindState: 2,751,260,720,350
ValueState: 2,132,138,999,692,,MIDM
Att_ResultSliceState: [PV_Sectors,2,Equipment_Types,2,System_Types,2,Installation_Event,1,PV_Climate_Zone,1,Annual_Econ_Time,1]

Variable Deprec_Deduct_Benef
Title: Depreciation Deduction Benefit
Units: $/kW-DC, $/kWh
Description: The tax benefit from deducting depreciation. Solar PV amounts are in $/kW-DC, while battery storage amounts are in $/kWh. Replacement costs have not yet been discounted and proportioned to the remaining years in the economic horizon, so it is inappropriate to sum over Installation Events (ie, initial installation and future replacement).
Definition: Total_Depreciation * Comb_TaxRate_byEvent
NodeLocation: 856,80,1
NodeSize: 64,40
ValueState: 2,88,90,981,696,,MIDM
ReformVal: [PV_Operating_Year,Installation_Event]
Att_ResultSliceState: [Assume_Third_Party_O,1,PV_Sectors,1,Annual_Econ_Time,1,PV_Climate_Zone,1,Equipment_Types,1,System_Types,1,Area_Type,1,Installation_Event,1,PV_Operating_Year,1]

Variable Federal_Tax_Rate
Title: Federal Tax Rate
Units: fraction/year
Description: The federal tax rate.
Definition: Tax_Rates[Tax_Entity=Federal_Label, Static_PV_Time=Annual_Econ_Time,All_Utilities=Selected_Utility]
NodeLocation: 704,176,1
NodeSize: 64,40
ValueState: 2,72,74,1009,700,,MIDM
ReformVal: [Annual_Econ_Time,Installation_Event]
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [Equipment_Types,2,Installation_Event,1,Annual_PV_Time,1]

Variable State_Tax_Rate
Title: State Tax Rate
Units: fraction/year
Description: The state tax rate.
Definition: Tax_Rates[Tax_Entity=State_Label, Static_PV_Time=Annual_Econ_Time,All_Utilities=Selected_Utility]
NodeLocation: 704,272,1
NodeSize: 64,40
ValueState: 2,56,58,885,745,,MIDM
ReformVal: [Annual_Econ_Time,Installation_Event]
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [Equipment_Types,2,Installation_Event,1,Annual_PV_Time,1]

Variable Combined_Tax_Rate
Title: Combined Tax Rate
Units: fraction/year
Description: The combined state and federal tax rate.
Definition: (State_Tax_Rate + (1-State_Tax_Rate) * Federal_Tax_Rate) * Com_Tax_Entity
NodeLocation: 856,272,1
NodeSize: 64,40
ValueState: 2,248,250,929,487,1,MIDM
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15

Variable NPV_of_Depreciation
Title: NPV of Depreciation
Units: $/kW-DC, $/kWh
Description: The net present value of tax benefits from depreciation. Solar PV amounts are in $/kW-DC, while battery storage amounts are in $/kWh. Replacement costs have not yet been discounted and proportioned to the remaining years in the economic horizon, so it is inappropriate to sum over Installation Events (ie, initial installation and future replacement).
Definition: NPV(Nominal_Equity_Rate, Deprec_Deduct_Benef, PV_Operating_Year)
NodeLocation: 1008,80,1
NodeSize: 64,40
ValueState: 2,68,204,1246,377,0,MIDM
Att_ResultSliceState: [PV_Sectors,2,Equipment_Types,1,All_Sectors,1,Annual_PV_Time,1]

Variable NPV_Interest_Deduct
Title: NPV of Interest Deduction Benefit
Units: $/$
Description: The net present value of the tax benefit from interest deductions per dollar of debt-financed capital. Replacement costs have not yet been discounted and proportioned to the remaining years in the economic horizon, so it is inappropriate to sum over Installation Events (ie, initial installation and future replacement).
Definition: NPV_Interest_Factor * Comb_TaxRate_byEvent
NodeLocation: 1008,272,1
NodeSize: 64,40
ValueState: 2,216,218,828,565,,MIDM
ReformVal: [Annual_Econ_Time,Installation_Event]
Att_ResultSliceState: [PV_Sectors,2,Equipment_Types,2,Installation_Event,1,Annual_PV_Time,1]

Variable Lev_Interest_Deduct
Title: Total Lev Interest Deduction
Units: ($/year)/$
Description: The net present value of interest deductions levelized over the system lifetime in order to produce an annual equivalent value. The units are levelized annual interest deductions per dollar of debt-financed capital. Replacement costs have not yet been discounted and proportioned to the remaining years in the economic horizon, so it is inappropriate to sum over Installation Events (ie, initial installation and future replacement).
Definition: PMT(Nominal_Equity_Rate, Economic_Lifetime, -NPV_Interest_Deduct)
NodeLocation: 1160,272,1
NodeSize: 64,40
WindState: 2,60,21,921,350
ValueState: 2,539,139,876,648,,MIDM
ReformVal: [Annual_Econ_Time,Installation_Event]
Att_ResultSliceState: [PV_Sectors,1,Equipment_Types,1,Equity_Test,1,Installation_Event,1,Annual_Econ_Time,1]

Variable Tot_Lev_Depreciation
Title: Total Levelized Depreciation
Units: $/year-kW-DC, $/year-kWh
Description: The total (eg, initial installation + discounted replacement) net present value of tax benefits from depreciation levelized to an effective annual value. Solar PV amounts are in $/year-kW-DC, while battery storage amounts are in $/year-kWh.
Definition: Sum_Initial_Repl_Val(Lev_Depreciation,Replace_Value_Factor)
NodeLocation: 1160,80,1
NodeSize: 64,40
ValueState: 2,701,154,1048,455,0,MIDM
Att_ResultSliceState: [PV_Sectors,2,System_Types,1,Annual_Econ_Time,1]

Alias Al1538108395
Title: Levelized Annual Bill
Definition: 1
NodeLocation: 704,392,1
NodeSize: 64,40
Original: Lev_Ann_Bill_byYr

Variable Ann_IncomeTax_Benef
Title: Annual Income Tax Benefit
Units: $/year-system
Description: The benefit from deducting utility bill and O&M expenses from the taxable revenues.
Definition: (Lev_Ann_Bill_byYr * (NOT Assume_Third_Party_O) {a third party owned system won't get to deduct energy costs as an expense ... it's all revenue}~
+ Annual_O_M_Cost + Lev_Interconnect_Fee) * Combined_Tax_Rate[Installation_Event=Init_Install_Label] * Com_Tax_Entity
NodeLocation: 856,368,1
NodeSize: 64,40
WindState: 2,583,215,1098,532
ValueState: 2,128,124,1184,539,1,MIDM
Aliases: Alias Al1538108980
ReformVal: [Annual_Econ_Time,Pre_and_Post_System]
Att_ResultSliceState: [PV_Sectors,2,Pre_and_Post_System,1,Equipment_Types,1,PV_Climate_Zone,1,Annual_Econ_Time,1]

Alias Al1538159919
Title: Levelized O&M
Definition: 1
NodeLocation: 1160,368,1
NodeSize: 64,40
Original: Levelized_O_M

Text FrameNode_1544920240
NodeLocation: 1592,336,-20
NodeSize: 360,304
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus: yes~
Show_description:20

FormNode Fo1545167165
Title: MACRS Schedule
Definition: 0
NodeLocation: 104,24,1
NodeSize: 56,16
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: MACRS_Schedule

FormNode Fo1545167166
Title: Tax Rates
Definition: 0
NodeLocation: 552,272,1
NodeSize: 56,16
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Tax_Rates

FormNode Fo1545167167
Title: Bonus Depreciation Schedule
Definition: 0
NodeLocation: 104,232,1
NodeSize: 56,16
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Bonus_Deprec_Sched

Variable Comb_TaxRate_byEvent
Title: Combined Tax Rate by Event
Units: fraction/year
Description: The combined state and federal tax rate by installation event.
Definition: Val_by_Install_Event(Combined_Tax_Rate, 1, Annual_Econ_Time)
NodeLocation: 856,176,1
NodeSize: 64,40
WindState: 2,134,9,720,350
ValueState: 2,248,148,929,589,1,MIDM
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [Installation_Event,1,Equipment_Types,1,Annual_Econ_Time,1]

Variable Lev_Depreciation
Title: Levelized Depreciation
Units: $/year-kW-DC, $/year-kWh
Description: The net present value of tax benefits from depreciation levelized to an effective annual value. Solar PV amounts are in $/year-kW-DC, while battery storage amounts are in $/year-kWh. Replacement costs have not yet been discounted and proportioned to the remaining years in the economic horizon, so it is inappropriate to sum over Installation Events (ie, initial installation and future replacement).
Definition: PMT(Nominal_Equity_Rate, Economic_Lifetime, -NPV_of_Depreciation )
NodeLocation: 1008,176,1
NodeSize: 64,40
ValueState: 2,42,149,1076,350,0,MIDM
Att_ResultSliceState: [PV_Sectors,2,System_Types,1,Annual_PV_Time,1]

FormNode Fo1554732067
Title: Taxed as Commercial
Definition: 0
NodeLocation: 408,456,1
NodeSize: 56,16
NodeInfo: 1,,,0
NodeColor: 65535,65531,1
Original: Taxed_as_Commercial

Text Te721742371
Title: Think about tax rates in light of possible TPO model for comparison
NodeLocation: 212,428,-1
NodeSize: 100,52

Decision Assume_Third_Party_O
Title: Assume Third Party Owned?
Definition: Checkbox(0)
NodeLocation: 704,488,1
NodeSize: 64,40
Aliases: FormNode Fo1141958179
NodeColor: 65535,1,1

FormNode Fo1141958179
Title: Assume Third Party Owned?
Definition: 0
NodeLocation: 596,552,1
NodeSize: 164,16
NodeInfo: 1,,,,,,,70,,,,,,0
NodeColor: 65535,65531,1
Original: Assume_Third_Party_O

Text Te394931747
Title: These economics don't seem to work for a TPO system
NodeLocation: 924,504,-1
NodeSize: 100,56

Close Taxes

Module Equipment_Costs
Title: Equipment Costs
Author: JamesMilford
Date: Thu, Oct 4, 2018 8:27 AM
NodeLocation: 584,96,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,286,0,1373,710,17,10
AcpStyles: FrameNode: FrameNode_1544920267

Constant Base_Installed_Cost_
Title: Base Installed Cost Input
Units: $/kW-DC, $/kWh
Description: The upfront installed equipment price before any tax credits or rebates. PV is priced in $/kW-DC, while storage is priced in $/kWh. ~
~
NOTE: Any values after the user input "Base of Cost Decline" are overriden by a calculation of a forecast rate of cost decline.
Definition: Table(All_PV_Sectors,Static_PV_Time,All_Equipment_Types)(~
7530,3019.5277,~
7530,2847.9272,~
7530,2686.0788,~
7530,2533.4283,~
7530,2389.4529,~
7530,2253.6598,~
7530,2125.5837,~
7530,2004.7863,~
7530,1890.8538,~
6620,1783.3961,~
4670,1682.0453,~
4090,1586.4542,~
3600,1496.2957,~
3360,1411.2608,~
3160,1331.0585,~
2940,1255.4141,~
2780,1184.0687,~
2770,1116.7777,~
2710,1053.311,~
2539.533,995.754,~
2368.927,938.0997,~
2198.321,885.7625,~
2027.715,837.6242,~
1857.109,792.794,~
1686.503,767.5955,~
1515.897,745.0723,~
1345.29,725.4158,~
1174.684,706.2698,~
1004.078,688.8763,~
992.948,680.2653,~
981.817,671.6543,~
970.687,663.0432,~
959.556,654.4325,~
948.426,645.8215,~
937.295,637.2105,~
926.165,628.5995,~
915.034,619.9885,~
903.903,611.3777,~
892.773,602.7668,~
881.642,594.1558,~
870.512,585.5448,~
859.381,576.9338,~
848.251,568.323,~
837.12,559.712,~
825.99,551.101,~
814.859,542.49,~
803.728,533.879,~
792.598,525.268,~
781.467,516.6572,~
770.4923,508.1877,~
759.6718,499.8569,~
5570,1476.3521,~
5570,1384.2113,~
5570,1297.821,~
5570,1216.8225,~
5570,1140.8792,~
5570,1069.6757,~
5570,1002.916,~
5570,940.3228,~
5570,881.6362,~
5180,826.6123,~
3570,775.0225,~
2900,726.6524,~
2890,681.3012,~
2400,638.7804,~
2290,598.9134,~
1940,561.5345,~
1880,526.4885,~
1760,493.6298,~
1720,462.8218,~
1677.411,433.9712,~
1592.393,405.0557,~
1507.374,377.9183,~
1422.356,352.1915,~
1337.338,327.5802,~
1252.319,315.298,~
1167.301,304.3908,~
1082.282,295.046,~
997.264,286.1275,~
912.245,278.041,~
901.65,274.5655,~
891.054,271.09,~
880.458,267.6145,~
869.862,264.139,~
859.266,260.6635,~
848.67,257.188,~
838.074,253.7125,~
827.478,250.237,~
816.882,246.7615,~
806.286,243.286,~
795.69,239.8102,~
785.094,236.3348,~
774.498,232.8593,~
763.902,229.3837,~
753.307,225.9083,~
742.711,222.4327,~
732.115,218.9572,~
721.519,215.4818,~
710.923,212.0062,~
700.327,208.5308,~
689.8889,205.1122,~
679.6064,201.7497,~
5570,1476.3521,~
5570,1384.2113,~
5570,1297.821,~
5570,1216.8225,~
5570,1140.8792,~
5570,1069.6757,~
5570,1002.916,~
5570,940.3228,~
5570,881.6362,~
5180,826.6123,~
3570,775.0225,~
2900,726.6524,~
2890,681.3012,~
2400,638.7804,~
2290,598.9134,~
1940,561.5345,~
1880,526.4885,~
1760,493.6298,~
1720,462.8218,~
1677.411,433.9712,~
1592.393,405.0557,~
1507.374,377.9183,~
1422.356,352.1915,~
1337.338,327.5802,~
1252.319,315.298,~
1167.301,304.3908,~
1082.282,295.046,~
997.264,286.1275,~
912.245,278.041,~
901.65,274.5655,~
891.054,271.09,~
880.458,267.6145,~
869.862,264.139,~
859.266,260.6635,~
848.67,257.188,~
838.074,253.7125,~
827.478,250.237,~
816.882,246.7615,~
806.286,243.286,~
795.69,239.8102,~
785.094,236.3348,~
774.498,232.8593,~
763.902,229.3837,~
753.307,225.9083,~
742.711,222.4327,~
732.115,218.9572,~
721.519,215.4818,~
710.923,212.0062,~
700.327,208.5308,~
689.8889,205.1122,~
679.6064,201.7497)
NodeLocation: 120,120,1
NodeSize: 64,40
WindState: 2,399,105,1016,618
DefnState: 2,645,10,733,853,0,DFNM
ValueState: 2,218,39,1293,648,1,MIDM
Aliases: Alias Al1568696041, FormNode Fo1568696041, FormNode Fo1539276353, FormNode Fo1544633533, FormNode Fo930517283, FormNode Fo1572476397, FormNode Fo1567092923
NodeColor: 65535,1,1
GraphSetup: Att_GraphIndexRange Static_PV_Time:1,,0,,,,10,2020.9325099736452,2035,0
ReformDef: [PV_Climate_Zone,Static_PV_Time]
ReformVal: [Static_PV_Time,Area_Type]
NumberFormat: 2,F,4,0,1,1,4,0,$,0,"ABBREV",0,,,0,0,15,
DisplayOutputs: Object Object, Object Decision
Att__TotalsIndex: []
Att_ResultSliceState: [All_Equipment_Types,1,New_or_Retrofit,2,All_Sectors,1,Area_Type,1,Static_PV_Time,1]
Att_EditSliceState: [All_Equipment_Types,2,Static_PV_Time,13,All_PV_Sectors,1]
{!40700|Att_CellFormat: CellAlignment('Center')}

Constant Equipment_Lifetime
Title: Equipment Lifetime
Units: years
Description: The economic lifetime for each equipment type. If this input is changed, Economic Lifetime (Economic_Lifetime) must also be changed to ensure that all economic calculations are correct.
Definition: Table(All_Equipment_Types)(20,10)
NodeLocation: 120,472,1
NodeSize: 64,40
WindState: 2,261,529,720,350
DefnState: 2,967,280,523,281,0,DFNM
ValueState: 2,185,8,575,641,,MIDM
Aliases: Alias Al1568696042, FormNode Fo1568696044, FormNode Fo1568696024, FormNode Fo1567092850
GraphSetup: Att_CatLineStyle Graph_Primary_Valdim:9
ReformDef: [0,Static_PV_Time]
ReformVal: [0,Static_PV_Time]
DisplayOutputs: Object Object, Object Decision
Att_ResultSliceState: [All_Equipment_Types,2,Sectors,1,Static_PV_Time,1]
Att_EditSliceState: [All_Equipment_Types,1,Static_PV_Time,1,Sectors,1]
{!40300|Att_SlicerPopupSize: 227,64}

Constant Economic_Lifetime
Title: Economic Lifetime
Units: years
Description: The economic lifetime over which cash flows will be considered.
Definition: SubTable(StructSingCell_Input[StructSingCell_Names=Economic_Life_Label])
NodeLocation: 592,472,1
NodeSize: 64,40
WindState: 2,102,82,1026,486
ValueState: 2,72,74,430,288,,MIDM
Aliases: Alias Al1568696089, FormNode Fo1568696089, FormNode Fo1544633535, FormNode Fo1567092924

Constant O_M_Cost
Title: O&M Cost
Units: $/yr-kW-DC, $/yr-kWh
Description: The operations and maintenance costs by equipment type. Solar PV costs are expressed in $/yr-kW-DC, and battery storage costs are in $/yr-kWh.~
~
PV source (includes inverter replacement): https://www.nrel.gov/docs/fy16osti/66944.pdf
Definition: Table(All_PV_Sectors,Static_PV_Time,All_Equipment_Types)(~
74.4763,75.8967,~
74.4763,75.8967,~
74.4763,75.8967,~
74.4763,75.8967,~
74.4763,75.8967,~
74.4763,75.8967,~
74.4763,75.8967,~
74.4763,75.8967,~
74.4763,75.8967,~
65.4759,66.7246,~
46.1892,47.0701,~
40.4526,41.2241,~
35.6062,36.2853,~
33.2325,33.8663,~
31.2543,31.8504,~
29.0784,29.633,~
27.4959,28.0203,~
27.397,27.9195,~
28.94,26.3328,~
27.389,24.8938,~
25.838,23.4525,~
24.287,22.144,~
22.736,20.9405,~
21.184,19.8197,~
19.633,19.19,~
18.082,18.6268,~
16.531,18.1355,~
14.98,17.6567,~
13.429,17.222,~
13.328,17.0068,~
13.226,16.7913,~
13.125,16.576,~
13.024,16.3607,~
12.923,16.1455,~
12.822,15.9302,~
12.72,15.715,~
12.619,15.4998,~
12.518,15.2845,~
12.417,15.0693,~
12.316,14.854,~
12.215,14.6385,~
12.113,14.4232,~
12.012,14.208,~
11.911,13.9927,~
11.81,13.7775,~
11.709,13.5623,~
11.607,13.347,~
11.506,13.1318,~
11.405,12.9165,~
11.3049,12.7048,~
11.2057,12.4965,~
60.9788,39.0557,~
60.9788,39.0557,~
60.9788,39.0557,~
60.9788,39.0557,~
60.9788,39.0557,~
60.9788,39.0557,~
60.9788,39.0557,~
60.9788,39.0557,~
60.9788,39.0557,~
56.7092,36.3211,~
39.0834,25.0321,~
31.7484,20.3342,~
31.6389,20.2641,~
26.2745,16.8283,~
25.0703,16.057,~
21.2386,13.6029,~
20.5817,13.1822,~
19.268,12.3407,~
18.55,11.5705,~
17.854,10.8492,~
17.159,10.1265,~
16.463,9.448,~
15.768,8.8048,~
15.072,8.1895,~
14.376,7.8825,~
13.681,7.6098,~
12.985,7.3762,~
12.29,7.1532,~
11.594,6.951,~
11.507,6.8643,~
11.421,6.7773,~
11.334,6.6902,~
11.247,6.6035,~
11.16,6.5165,~
11.074,6.4298,~
10.987,6.3427,~
10.9,6.256,~
10.814,6.169,~
10.727,6.0823,~
10.64,5.9953,~
10.554,5.9082,~
10.467,5.8215,~
10.38,5.7345,~
10.293,5.6478,~
10.207,5.5607,~
10.12,5.474,~
10.033,5.387,~
9.947,5.3003,~
9.86,5.2133,~
9.7738,5.1277,~
9.6883,5.0435,~
60.9788,39.0557,~
60.9788,39.0557,~
60.9788,39.0557,~
60.9788,39.0557,~
60.9788,39.0557,~
60.9788,39.0557,~
60.9788,39.0557,~
60.9788,39.0557,~
60.9788,39.0557,~
56.7092,36.3211,~
39.0834,25.0321,~
31.7484,20.3342,~
31.6389,20.2641,~
26.2745,16.8283,~
25.0703,16.057,~
21.2386,13.6029,~
20.5817,13.1822,~
19.268,12.3407,~
18.55,11.5705,~
17.854,10.8492,~
17.159,10.1265,~
16.463,9.448,~
15.768,8.8048,~
15.072,8.1895,~
14.376,7.8825,~
13.681,7.6098,~
12.985,7.3762,~
12.29,7.1532,~
11.594,6.951,~
11.507,6.8643,~
11.421,6.7773,~
11.334,6.6902,~
11.247,6.6035,~
11.16,6.5165,~
11.074,6.4298,~
10.987,6.3427,~
10.9,6.256,~
10.814,6.169,~
10.727,6.0823,~
10.64,5.9953,~
10.554,5.9082,~
10.467,5.8215,~
10.38,5.7345,~
10.293,5.6478,~
10.207,5.5607,~
10.12,5.474,~
10.033,5.387,~
9.947,5.3003,~
9.86,5.2133,~
9.7738,5.1277,~
9.6883,5.0435)
NodeLocation: 120,664,1
NodeSize: 64,40
WindState: 2,444,494,720,350
DefnState: 2,655,169,519,601,0,DFNM
ValueState: 2,445,68,1054,636,,MIDM
Aliases: Alias Al1568696050, FormNode Fo1568696050, FormNode Fo1544633536, FormNode Fo1567092851
GraphSetup: Att_StackedBar Graph_Primary_Valdim:0~
Att_CatLineStyle Graph_Primary_Valdim:9
ReformDef: [All_Sectors,Static_PV_Time]
ReformVal: [All_Equipment_Types,All_Sectors]
NumberFormat: 2,F,2,2,1,1,2,1,$,0,"ABBREV",0,,,0,0,15
DisplayOutputs: Object Object, Object Decision

Variable O_M_Rate
Title: O&M Rate
Units: $/yr-kW-DC, $/yr-kWh
Description: The operations and maintenance costs by equipment type. Solar PV costs are expressed in $/yr-kW-DC, and battery storage costs are in $/yr-kWh.
Definition: VAR reindex:=O_M_Cost[All_PV_Sectors=PV_Sectors, All_Equipment_Types=Equipment_Types,Static_PV_Time=Annual_Econ_Time];~
~
IF Inflate_O_M_Costs~
THEN reindex * (1+Inflation_Rate)^(Annual_Econ_Time-Base_Year_for_O_M_In)~
ELSE reindex
NodeLocation: 272,664,1
NodeSize: 64,40
ValueState: 2,405,76,1314,581,0,MIDM
ReformVal: [PV_Sectors,Annual_Econ_Time]
NumberFormat: 2,F,2,2,1,1,2,1,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [Equipment_Types,1,Annual_Econ_Time,1,PV_Sectors,1]

Decision Base_Year_for_O_M_In
Title: Base Year for O&M Inflation
Units: year
Description: The base year for incentive inflation, meaning this year will have an inflation factor of 1.0.
Definition: 2021
NodeLocation: 272,768,1
NodeSize: 64,40
Aliases: FormNode Fo1537996363
NodeColor: 65535,65531,1

Decision Inflate_O_M_Costs
Title: Inflate O&M Costs
Units: boolean
Description: Check this box to inflate incentives over time.
Definition: Checkbox(0)
NodeLocation: 432,664,1
NodeSize: 64,40

Variable Equipment_Lifetimes
Title: Equipment Lifetimes
Units: years
Description: The economic lifetime for each equipment type.
Definition: Equipment_Lifetime[All_Equipment_Types=Equipment_Types]
NodeLocation: 272,472,1
NodeSize: 64,40

FormNode Fo1537996363
Title: Base Year for O&M Inflation
Definition: 0
NodeLocation: 272,812,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Base_Year_for_O_M_In

Variable Per_Unit_Equip_Price
Title: Per-Unit Equipment Price
Units: $/kW-DC, $/kWh
Description: The per-unit price seen by customers. Solar PV prices are expressed in $/kW-DC, while battery storage prices are in $/kWh. Replacement costs have not yet been discounted and proportioned to the remaining years in the economic horizon, so it is inappropriate to sum over Installation Events (ie, initial installation and future replacement).~
~
DOESN'T SEEM TO REDUCE PRICE DUE TO FORECAST PRICE DECLINES OF THE REPLACEMENT EQUIPMENT
Definition: VAR price:=Equipment_Cost_Resul[All_Equipment_Types=Equipment_Types, All_pv_Sectors=PV_Sectors, Static_PV_Time=Annual_Econ_Time] * Equip_Installed_Flag;~
~
Val_by_Install_Event(price, 1, Annual_Econ_Time)
NodeLocation: 568,120,1
NodeSize: 64,40
WindState: 2,-48,325,1556,638
ValueState: 2,2072,123,1166,711,1,MIDM
GraphSetup: Att_GraphValueRange Per_Unit_Equip_Price:1,,1,,,,,0,3026.1409282684326,0~
Att_GraphIndexRange Annual_Econ_Time:1,,0,,,,10,2011.0217268019915,2052.1974620223045,0
ReformVal: [Annual_Econ_Time,Base_Yr_of_Cost_Decl]
NumberFormat: 2,F,4,2,1,1,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: []
Att_ResultSliceState: [Equipment_Types,1,System_Types,1,Area_Type,1,Installation_Event,1,PV_Sectors,2,Base_Yr_of_Cost_Decl,1,Annual_Econ_Time,1]

Variable Levelized_O_M
Title: Levelized O&M
Units: $/yr-kW-DC, $/yr-kWh
Description: The levelized annual cost of operations and maintenance.
Definition: VAR realEquityRate:=(1+Nominal_Equity_Rate[All_PV_Sectors=PV_Sectors])/(1+Inflation_Rate*Inflate_O_M_Costs)-1;   {The real equity rate after adjusting for inflation, which prevents having to create an orthogonal index to track inflation}~
PMT(Nominal_Equity_Rate[All_PV_Sectors=PV_Sectors], Economic_Lifetime, -PV(realEquityRate, Economic_Lifetime, -O_M_Rate));~

NodeLocation: 432,568,1
NodeSize: 64,40
WindState: 2,11,70,1177,361
ValueState: 2,339,214,1160,587,,MIDM
Aliases: Alias Al1538159919
ReformVal: [Annual_Econ_Time,PV_Sectors]
NumberFormat: 2,F,4,2,1,1,4,0,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [Equipment_Types,1,All_PV_Sectors,1,PV_Sectors,1,Annual_Econ_Time,1]

Variable FirstYr_O_M
Title: First-Year O&M
Units: $/year-system
Description: The first-year O&M costs.
Definition: Sum(O_M_Rate * Equipment_Sizes, Equipment_Types)
NodeLocation: 432,760,1
NodeSize: 64,40
ValueState: 2,147,299,1159,498,,MIDM
NumberFormat: 2,F,4,2,1,1,4,0,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [PV_Sectors,1,System_Types,1,System_Sizing_Method,1,PV_Climate_Zone,1,Annual_Econ_Time,1]

Variable Tot_Equipment_Price
Title: Total Equipment Price
Units: $/system
Description: The total price of installed equipment (initial installation + discounted replacement), based on the sizing of each equipment type.
Definition: Sum_Initial_Repl_Val(Install_Equip_Price,Replace_Value_Factor)
NodeLocation: 864,120,1
NodeSize: 64,40
WindState: 2,13,222,720,350
ValueState: 2,443,213,741,618,0,MIDM
GraphSetup: Att_GraphValueRange Tot_Equipment_Price:1,,1,,,,,0,81218.05191040039,0~
Att_GraphIndexRange Annual_Econ_Time:1,,1,,,,10,2020.11490675807,2032,0
ReformVal: [Equipment_Types,PV_Sectors]
NumberFormat: 2,F,4,2,1,1,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: []
Att_ResultSliceState: [PV_Climate_Zone,3,System_Types,2,Area_Type,1,Annual_Econ_Time,11,PV_Sectors,2,Equipment_Types,1]

Variable Interconnect_Fees
Title: Interconnect Fees
Units: $/system
Description: A one-time cost to connect a PV system within SDGE's service territory.
Definition: Interconnect_Fee[Static_PV_Time=Annual_Econ_Time]
NodeLocation: 272,880,1
NodeSize: 64,40
DefnState: 2,488,161,416,632,,DFNM
ValueState: 2,392,283,416,414,,MIDM
NumberFormat: 2,F,4,2,1,1,4,0,$,0,"ABBREV",0,,,0,0,15
TableCellDefault: 0

Variable Lev_Interconnect_Fee
Title: Levelized Interconnect Fee
Units: $/year-system
Description: The annualized interconnection fee.
Definition: PMT(Nominal_Equity_Rate, Economic_Lifetime, -Interconnect_Fees)
NodeLocation: 432,880,1
NodeSize: 64,40
WindState: 2,666,287,720,350
ValueState: 2,2322,276,1031,551,,MIDM
Aliases: Alias Al1539193638
NumberFormat: 2,F,4,2,1,1,4,1,$,0,"ABBREV",0,,,0,0,15

Constant Interconnect_Fee
Title: Interconnect Fee
Units: $/system
Description: A one-time cost to connect a PV system within SDGE's service territory.~
~
Source: https://www.energysage.com/net-metering/sdge/~
Net metering 2.0, along with interconnect fees, went into effect in June 2016.
Definition: Table(Static_PV_Time)(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
NodeLocation: 120,880,1
NodeSize: 64,40
WindState: 2,285,574,720,350
DefnState: 2,488,161,416,632,,DFNM
ValueState: 2,196,202,416,303,0,MIDM
Aliases: Alias Al1568696122, FormNode Fo1568696122, FormNode Fo1544633537
DisplayOutputs: Object Object, Object Decision
TableCellDefault: 0

Index DER_Cost_Scenario
Att_PrevIndexValue: ['Low','Medium','High']
Title: DER Cost Scenario
Definition: ['Low','Medium','High']
IndexVals: ['item 1']
NodeLocation: 784,232,1
NodeSize: 64,40
DisplayOutputs: Object Object, Object Decision
{!40300|Att_SlicerPopupSize: 237,70}

Decision Base_Yr_of_Cost_Decl
Title: Base Yr of Cost Decline
Description: Select the base year to which cost decline scenarios will be applied.
Definition: 2052
NodeLocation: 416,232,1
NodeSize: 64,40
Aliases: Alias Al1568923259, FormNode Fo1568923259, FormNode Fo1543274532, FormNode Fo1544916731
NodeColor: 65535,65531,1
{!40300|Att_SlicerPopupSize: 247,64}

FormNode Fo1543274532
Title: Base Year for PV Cost Decline
Definition: 0
NodeLocation: 420,280,1
NodeSize: 60,16
NodeInfo: 1,0,0,0,0,0,0,78,0,,0,,,
Original: Base_Yr_of_Cost_Decl

Constant DER_Cost_Change_Rate
Title: DER Cost Change Rate
Units: %/year
Description: Forecast rate of change in installed PV system prices. ~
~
Sign convention is such that a negative value is a cost decline.
Definition: Table(All_PV_Sectors,DER_Cost_Scenario,All_Equipment_Types)(~
-0.058,-0.058,~
-0.042,-0.042,~
-0.029,-0.029,~
-0.058,-0.058,~
-0.042,-0.042,~
-0.029,-0.029,~
-0.058,-0.058,~
-0.042,-0.042,~
-0.029,-0.029)
NodeLocation: 120,232,1
NodeSize: 64,40
WindState: 2,1067,27,720,495
DefnState: 2,832,97,558,320,0,DFNM
ValueState: 2,260,266,759,632,0,MIDM
Aliases: Alias Al1568696043, FormNode Fo1568696042, FormNode Fo1544633538, FormNode Fo1544635478
NodeColor: 65535,1,1
ReformDef: [All_Equipment_Types,DER_Cost_Scenario]
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
DisplayOutputs: Object Object, Object Decision
Att_EditSliceState: [All_PV_Sectors,2,DER_Cost_Scenario,1,All_Equipment_Types,2]

Variable Equipment_Cost_Resul
Title: Equipment Cost Result
Units: $/kW-DC, $/kWh
Description: Historical & forecast installed equipment price (all-in retail price) to the customer prior to incentives.~
~
All values past the base year for cost decline will use the cost change rates applied to the base year as opposed to the data input in the equipment prices table.
Definition: IF Static_PV_Time>Base_Yr_of_Cost_Decl THEN Base_Installed_Cost_[Static_PV_Time=Base_Yr_of_Cost_Decl] * Price_Multiplier * Base_Cost_Multiplier ~
ELSE Base_Installed_Cost_ * Base_Cost_Multiplier
NodeLocation: 416,120,1
NodeSize: 64,40
WindState: 2,334,175,1264,521
ValueState: 2,557,73,681,721,1,MIDM
Aliases: FormNode Fo1544635738, FormNode Fo1548968037
GraphSetup: Graph_AxisLabelFont:,20,0~
Att_ContLineStyle Graph_Primary_Valdim:5~
Att_GraphValueRange Equipment_Cost_Resul:1,,1,,,,10,0,647.1657007932663,0~
Att_GraphIndexRange Static_PV_Time:1,,0,,,,,2022.0341443270445,2050,0~
{!50400|Att_AxisOrKeyTitle All_PV_Sectors:""}
ReformVal: [Static_PV_Time,All_PV_Sectors]
NumberFormat: 2,F,4,2,1,1,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [BaseYr_Strg_Costs,Base_Yr_of_Cost_Decl]
Att_GraphValueRange: 1,,,,,,10
Att_ResultSliceState: [All_Equipment_Types,1,Area_Type,1,All_PV_Sectors,1,Static_PV_Time,1]

Decision Select_DER_Cost_Scen
Title: DER Cost Scenario
Description: Select the DER cost scenario to apply.
Definition: Choice(DER_Cost_Scenario,2,1)
IndexVals: ['item 1']
NodeLocation: 264,232,1
NodeSize: 64,40
ValueState: 2,2515,291,416,303,,MIDM
Aliases: Alias Al1568923260, FormNode Fo1568923260, FormNode Fo1543281664, FormNode Fo1544881571

FormNode Fo1543281664
Title: Selected PV Cost Scenario
Definition: 0
NodeLocation: 264,284,1
NodeSize: 72,12
NodeInfo: 1,0,0,0,0,0,0,102,0,,0,,,
Original: Select_DER_Cost_Scen

FormNode Fo1544633533
Title: Installed Equipment Price
Definition: 0
NodeLocation: 128,172,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,72,0,,0,,,0
Original: Base_Installed_Cost_

FormNode Fo1544633535
Title: Economic Lifetime
Definition: 0
NodeLocation: 648,620,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Economic_Lifetime

FormNode Fo1544633536
Title: O&M Cost
Definition: 0
NodeLocation: 128,716,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: O_M_Cost

FormNode Fo1544633537
Title: Interconnect Fee
Definition: 0
NodeLocation: 128,932,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Interconnect_Fee

FormNode Fo1544633538
Title: PV Cost Change Rate
Definition: 0
NodeLocation: 128,284,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: DER_Cost_Change_Rate

Text FrameNode_1544920267
NodeLocation: 1332,424,-20
NodeSize: 276,352
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus: yes~
Show_description:20

Variable Replace_Value_Factor
Title: Replacement Value Factor
Units: $/$
Description: A factor that can be applied to a replacement cost/benefit to find it's effective net present value over the number of years remaining in the economic lifetime relative to the first replacement event.~
This discounts the future replacement cost/benefit back to the current decision year. For example, if the replacement will not occur until the beginning of year 11 (eg, the equipment lifetime is 10 years), then that cost/benefit must be discounted by 10 years to represent a current year present value. Next, it annualizes the present value for the current decision year. Finally, it determines how many years are left in the economic horizon and only charges/credits the equipment with costs/benefits over the remaining years. For example, if an equipment type has a lifetime of 12 years and the economic horizon is 20 years, then the remaining lifetime is 8 years, which indicates 8/12 of the full replacement cost should be charged. The annualized costs over the remaining years are then present valued to represent the portion of full costs/benefits that are incurred in the remaining years.~

Definition: VAR discntFactor:= 1 / (1 + Nominal_Equity_Rate)^Equipment_Lifetimes;    {Discount factor to bring future replacement cost to present value in current decision year}~
VAR annualFactor:=PMT(Nominal_Equity_Rate, Equipment_Lifetimes, -discntFactor);   {Annualizes the present value in the current decision year}~
PV(Nominal_Equity_Rate, Economic_Lifetime - Equipment_Lifetimes, -annualFactor)   {Finds the present value of the annualized value over the number of years remaining in the economic lifetime}~

NodeLocation: 432,472,1
NodeSize: 64,40
WindState: 2,202,148,1117,456
ValueState: 2,388,123,859,312,0,MIDM

Variable Install_Equip_Price
Title: Installed Equipment Price
Units: $/system
Description: The price of installed equipment, based on the sizing of each equipment type. Replacement costs have not yet been discounted and proportioned to the remaining years in the economic horizon, so it is inappropriate to sum over Installation Events (ie, initial installation and future replacement).
Definition: Per_Unit_Equip_Price * Equipment_Sizes
NodeLocation: 712,120,1
NodeSize: 64,40
WindState: 2,385,170,720,350
ValueState: 2,260,145,1291,669,1,MIDM
GraphSetup: Att_StackedBar Graph_Primary_Valdim:0~
{!50007|Graph_BarOutline:0}~
Att_CatLineStyle Graph_Primary_Valdim:9~
Att_GraphValueRange Install_Equip_Price:1,,0,,,,,0,237723.91974925995,0~
Att_GraphIndexRange Annual_Econ_Time:1,,0,,,,10,2019.9440391361713,2055,0
ReformVal: [Annual_Econ_Time,PV_Sectors]
NumberFormat: 2,F,4,2,1,1,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: []
Att_ResultSliceState: [Installation_Event,1,Annual_Econ_Time,11,Area_Type,1,PV_Climate_Zone,2,System_Types,2,Equipment_Types,1,PV_Sectors,3]
{!40600|Att_StackingIndex: PV_Climate_Zone}
{!40600|Att_ClusterIndex: Null}

Index Storage_Cost_Scen
Att_PrevIndexValue: ['Low','Medium','High']
Title: Storage Cost Scenario
Description: DELETE. MADE SAME AS PV
Definition: ['Low','Medium','High']
IndexVals: ['item 1']
NodeLocation: 1112,200,1
NodeSize: 64,40
NodeColor: 65535,1,1
{!40300|Att_SlicerPopupSize: 232,70}

Decision BaseYr_Strg_Costs
Title: Base Yr: Storage Cost Decline
Description: Select the base year to which cost decline scenarios will be applied.
Definition: Choice(Static_PV_Time,51,0)
NodeLocation: 1112,96,1
NodeSize: 64,40
Aliases: Alias Al1568923261, FormNode Fo1568923261, FormNode Fo1548961182
NodeColor: 65535,1,1
{!40300|Att_SlicerPopupSize: 227,64}

FormNode Fo1548961182
Title: Base Year for PV Cost Decline
Definition: 0
NodeLocation: 1124,392,1
NodeSize: 60,16
NodeInfo: 1,0,0,0,0,0,0,78,0,,0,,,
Original: BaseYr_Strg_Costs

Constant Strg_Cost_Chg_Rate
Title: Storage Cost Change Rate
Units: fraction/year
Description: Forecast rate of change in installed storage system prices. ~
~
Sign convention is such that a negative value is a cost decline.
Definition: Table(All_PV_Sectors,DER_Cost_Scenario)(~
-0.06,-0.05,-0.04,~
0,0,0,~
0,0,0)
NodeLocation: 1120,464,1
NodeSize: 64,40
WindState: 2,326,534,720,350
DefnState: 2,405,127,643,517,0,DFNM
Aliases: Alias Al1568696044, FormNode Fo1568696043, FormNode Fo1548961184, FormNode Fo1548967772
NodeColor: 65535,1,1
ReformDef: [DER_Cost_Scenario,All_PV_Sectors]
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
{!50000|Att_ColumnWidths: [,All_Sectors,\([,,,])]}

Decision Select_StrgCost_Scen
Title: Storage Cost Scenario
Description: Select the storage cost scenario to apply.
Definition: Choice(Storage_Cost_Scen,2,1)
IndexVals: ['item 1']
NodeLocation: 1120,304,1
NodeSize: 64,40
WindState: 2,294,485,720,350
Aliases: Alias Al1568923262, FormNode Fo1568923262, FormNode Fo1548961183, FormNode Fo1548967773
NodeColor: 65535,1,1

FormNode Fo1548961183
Title: Selected PV Cost Scenario
Definition: 0
NodeLocation: 1128,348,1
NodeSize: 72,12
NodeInfo: 1,0,0,0,0,0,0,102,0,,0,,,
Original: Select_StrgCost_Scen

FormNode Fo1548961184
Title: PV Cost Change Rate
Definition: 0
NodeLocation: 1128,516,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Strg_Cost_Chg_Rate

Variable Price_Multiplier
Title: Price Multiplier
Units: fraction
Description: The price escalation according to the selected PV and storage cost scenarios.
Definition: IF Static_PV_Time> Base_Yr_of_Cost_Decl ~
   THEN (1 + DER_Cost_Change_Rate[DER_Cost_Scenario=Select_DER_Cost_Scen])^(Static_PV_Time-Base_Yr_of_Cost_Decl)~
   ELSE 1
NodeLocation: 264,48,1
NodeSize: 64,40
ValueState: 2,38,198,1696,612,0,MIDM
NumberFormat: 2,%,4,2,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [All_Equipment_Types,1,All_PV_Sectors,1,Static_PV_Time,1]

Text Te1549390762
Description: Not sure if interconnect fees will apply to a storage only system, or if additional interconnect fees apply to solar+storage system. Might need to reindex by equipment type or system type to capture nuances
NodeLocation: 624,880,2
NodeSize: 104,48
NodeInfo: 1,0,0,1,1,1,1,,0,,0,,,
NodeColor: 57311,57311,57311
NodeFont: Arial Narrow,13
AcpStyles: Show_Object:no

FormNode Fo1568696024
Title: Equipment Lifetime
Definition: 0
NodeLocation: 128,516,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Equipment_Lifetime

Constant Base_Cost_Multiplier
Title: Base Cost Multiplier
Units: fraction
Description: Multiplier of the input base equipment prices as a function of geography.
Definition: Table(All_Equipment_Types,Area_Type)(~
1,~
1)
NodeLocation: 568,232,1
NodeSize: 64,40
WindState: 2,596,63,720,350
DefnState: 2,1251,542,350,169,0,DFNM
ValueState: 2,708,386,633,303,0,MIDM
Aliases: FormNode Fo1993568547
NodeColor: 65535,1,1
ReformDef: [All_Equipment_Types,Area_Type]
TableCellDefault: 1
Att_EditSliceState: [All_Equipment_Types,1,PV_Climate_Zone,1,Area_Type,1]

Variable Va25
Definition: Base_Installed_Cost_ * Price_Multiplier * Base_Cost_Multiplier
NodeLocation: 904,344,1
NodeSize: 64,40
ValueState: 2,729,183,922,606,,MIDM
ReformVal: [Static_PV_Time,PV_Climate_Zone]
Att_ResultSliceState: [All_Equipment_Types,1,All_PV_Sectors,1,New_or_Retrofit,1,Area_Type,3,PV_Climate_Zone,1,Static_PV_Time,1]

Variable Va26
NodeLocation: 904,448,1
NodeSize: 64,40

Text Te607228195
Title: Delete
NodeLocation: 1128,276,-1
NodeSize: 88,268
NodeInfo: 1,,,,1

FormNode Fo930517283
Title: Installed Equipment Price
Definition: 0
NodeLocation: 268,340,1
NodeSize: 204,20
NodeColor: 49151,49151,49151
Original: Base_Installed_Cost_

FormNode Fo1993568547
Title: Base Cost Multiplier
Definition: 0
NodeLocation: 572,272,1
NodeSize: 60,16
NodeInfo: 1,,,0
NodeColor: 65535,1,1
Original: Base_Cost_Multiplier

Module NYPA_Input_Tables
Title: NYPA Input Tables
Author: CWelch
Date: Sat, Apr 2, 2022 10:12 AM
NodeLocation: 544,360,1
NodeSize: 64,40
DiagState: 2,442,95,944,480,17,10

Variable Equipment_Cost_Forec
Title: Equipment Cost Forecast
Units: $/kW-DC,$/kWh
Description: Forecast equipment installation costs after factoring in equipment cost multipliers (for each installation type) and cost change rates. ~
~
Units: $/kW-DC (solar PV), $/kWh (battery storage -- assumed 3.5 hr at peak capacity)
Definition: Equipment_Cost_Resul[Static_PV_Time=Cost_Forecast_Year]
NodeLocation: 248,64,1
NodeSize: 64,40
ValueState: 2,261,35,902,758,1,MIDM
GraphSetup: Att_ContLineStyle Graph_Primary_Valdim:5~
Att_GraphIndexRange Cost_Forecast_Year:1,0~
SymbolSize:13~
Graph_AxisLabelFont:,20,0~
{!50007|Graph_BarOutline:0}~
Att_StackedBar Graph_Primary_Valdim:0~
{!50000|Graph_SortBySpread:0}~
Graph_SymbolKey:1~
Att_GraphValueRange Equipment_Cost_Forec:|1:1,,1,,,,,1134.5600336790085,1483.9999824762344,0
ReformVal: [Cost_Forecast_Year,PV_Climate_Zone]
NumberFormat: 2,F,4,0,1,1,4,0,$,0,"ABBREV",0,,,0,0,15,
Att_ResultSliceState: [Test_Cost_Multiplier,1,PV_Climate_Zone,3,Cost_Forecast_Year,1]
Att_XRole: Cost_Forecast_Year
Att_YRole: -1
Att_ColorRole: Area_Type
Att_SymbolRole: PV_Climate_Zone
Att_CoordinateIndex: All_Equipment_Types
{!40200|Att_GraphSetupSlices: [3,1,All_Equipment_Types,1]}

Index Cost_Forecast_Year
Title: Cost Forecast Year
Definition: Copyindex(subset(Annual_Econ_Time>Base_Yr_of_Cost_Decl))
NodeLocation: 400,64,1
NodeSize: 64,40
WindState: 2,508,158,1003,529
ValueState: 2,2854,98,224,351,,MIDM
{!50400|Att_AxisOrKeyTitle: ""}

Variable Base_Year_Cost
Title: Base Year Cost
Units: $/kWDC, $/kWh
Description: Estimated installed cost in the base year (2021), after which costs will decline at the input cost change rate. Units are $/kWh for storage (assuming a 3.5-hour system) and $/kW-DC for solar PV. These values are also scaled by multipliers for each installation type (e.g., ground mount, rooftop, carport).
Definition: subtable(Base_Installed_Cost_[Static_PV_Time=Base_Yr_of_Cost_Decl])
NodeLocation: 112,64,1
NodeSize: 64,40
WindState: 2,2138,82,720,350
DefnState: 2,622,348,768,190,0,DFNM
ReformDef: [PV_Climate_Zone,All_Equipment_Types]
NumberFormat: 2,F,2,0,1,1,2,0,$,0,"ABBREV",0,,,0,0,15,

Close NYPA_Input_Tables

Close Equipment_Costs

Module Annual_Cost_of_Syste
Title: Annual Cost of System
Author: JamesMilford
Date: Thu, Oct 4, 2018 8:27 AM
NodeLocation: 736,96,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,307,50,1204,640,17,10
BalloonHelp: FrameNode: FrameNode_1544920329
AcpStyles: FrameNode: FrameNode_1544920329

Variable Cost_of_Elect_Ratio
Title: Cost of Electricity Ratio
Units: post/pre ratio
Description: Ratio of the cost of electricity (when "simple LCOE" method is chosen, this is simply the ratio of the calculated LCOE and the first-year value of solar).
Definition: DetermTable(Cost_Ratio_Method)(PPA_to_Value_Ratio,Simple_LCOE_to_Value)
NodeLocation: 480,304,1
NodeSize: 64,40
WindState: 2,766,136,720,350
ValueState: 2,327,107,1067,657,1,MIDM
Aliases: FormNode Fo1539221820, FormNode Fo1572476395
GraphSetup: Att_GraphIndexRange Annual_Econ_Time:1,,0,,,,10,2022.0709496736526,2032,0~
Grid:0~
Att_GraphValueRange Cost_of_Elect_Ratio:1,,1,,,,,1.320643737912178,2.707960143685341,0~
Graph_AxisTitleColor:17408,29184,50176~
Graph_AxisLabelColor:17408,29184,50176~
Graph_KeyTextColor:17408,29184,50176~
Graph_KeyLabelColor:17408,29184,50176~
Graph_AxisTitleFont:Arial,20,1~
Graph_KeyFont:,18,1~
Graph_KeyTitleFont:,20,1~
Graph_GridColor:20224,20224,20224~
Graph_FrameColor:20224,20224,20224~
Att_ContLineStyle Graph_Primary_Valdim:5~
Graph_KeyAreaBrush:65024,65024,65024~
Graph_TickDir:2~
Graph_PlotAreaBrush:65280,65280,65280,2,1,65280,65280,65280~
Att_GraphIndexRange PV_Sectors:1,,0,,,,,1,7,1
ReformVal: [Annual_Econ_Time,System_Types]
NumberFormat: 2,F,1,2,0,0,1,1,$,0,"ABBREV",0,,,0,0,15,
Att__TotalsIndex: []
Att_ResultSliceState: [Area_Type,1,PV_Climate_Zone,4,PV_Sectors,23,System_Types,2,Annual_Econ_Time,19]

Text FrameNode_1544920329
NodeLocation: 1304,392,-20
NodeSize: 360,304
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus: yes~
Show_description:20

Variable PPA_to_Value_Ratio
Title: PPA to Value Ratio
Units: fraction
Definition: ZIDZ(Manual_PPA_Rates_by_,Value_of_generation)
NodeLocation: 312,304,1
NodeSize: 64,40
ValueState: 2,623,216,944,639,1,MIDM
GraphSetup: Att_GraphIndexRange Annual_Econ_Time:1,,0,,,,10,2021.938028216362,2031.3760011196136,0
ReformVal: [Annual_Econ_Time,PV_Climate_Zone]
Att_ResultSliceState: [PV_Sectors,1,System_Types,1,Area_Type,1,PV_Climate_Zone,1,Annual_Econ_Time,1]

Module Old_Cost_Ratio_Calcs
Title: Old Cost Ratio Calcs
Author: CWelch
Date: Fri, Mar 25, 2022 11:08 AM
NodeLocation: 152,176,1
NodeSize: 64,40
DiagState: 2,330,63,1301,721,17,10

Variable Annual_Loan_Payments
Title: Annual Loan Payments
Units: $/year-system
Description: Annual loan payments after reducing upfront costs by the Federal ITC.
Definition: Annual_Loan_Factor * Syst_Price_after_ITC
NodeLocation: 288,104,1
NodeSize: 64,40
WindState: 2,102,82,981,463
ValueState: 2,1921,28,1158,482,,MIDM
GraphSetup: Att_GraphIndexRange Annual_Econ_Time:1,,0,,,,10,2020.0337401032448,2032,0
ReformVal: [Annual_Econ_Time,System_Types]
Att_ResultSliceState: [PV_Sectors,2,PV_Climate_Zone,1,System_Types,1,Annual_PV_Time,1]

Variable Annual_Deprec_Benef
Title: Annual Depreciation Benefit
Units: $/year-system
Description: The annualized depreciation tax benefit.
Definition: Sum(Tot_Lev_Depreciation * Equipment_Sizes, Equipment_Types)
NodeLocation: 288,296,1
NodeSize: 64,40
WindState: 2,102,82,1235,490
ValueState: 2,2361,148,953,513,,MIDM
Att_ResultSliceState: [PV_Sectors,2,System_Types,1,Annual_PV_Time,1]

Variable Annual_O_M_Cost
Title: Annual O&M Cost
Units: $/year-system
Description: The annualized O&M costs.
Definition: Sum(Levelized_O_M * Equipment_Sizes, Equipment_Types)
NodeLocation: 288,488,1
NodeSize: 64,40
WindState: 2,57,302,1220,546
ValueState: 2,466,105,1051,744,,MIDM
Att_ResultSliceState: [Equipment_Types,1,PV_Sectors,1,Annual_PV_Time,1]

Variable Ann_Interest_Benefit
Title: Annual Interest Benefit
Units: $/year-system
Description: Total (eg, initial installation + discounted replacement) annual loan interest payments tax deductions.
Definition: Sum(Sum_Initial_Repl_Val(Lev_Interest_Deduct * (Install_Equip_Price - ITC_for_System_Event),Replace_Value_Factor), Equipment_Types)
NodeLocation: 288,200,1
NodeSize: 64,40
WindState: 2,47,227,1118,525
ValueState: 2,2453,37,1158,580,,MIDM
ReformVal: [Annual_Econ_Time,Equipment_Types]
Att_ResultSliceState: [PV_Sectors,2,System_Types,2,PV_Climate_Zone,1,Equipment_Types,1,Annual_PV_Time,1]

Variable Syst_Price_after_ITC
Title: System Price after ITC
Units: $/system
Description: The system price after subtracting the federal ITC and taxable incentives/rebates.
Definition: Sum(Tot_Equipment_Price - Total_ITC_for_System - Taxable_Incent_Year, Equipment_Types)
NodeLocation: 136,64,1
NodeSize: 64,40
WindState: 2,286,158,896,454
ValueState: 2,385,65,1322,840,1,MIDM
GraphSetup: Att_GraphValueRange Syst_Price_after_ITC:1,,0,,,,,0,29108816.385269165,0~
Att_GraphIndexRange Annual_Econ_Time:1,,0,,,,10,2022.0347301959991,2031.768249630928,0
ReformVal: [Annual_Econ_Time,PV_Sectors]
NumberFormat: 2,F,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [PV_Climate_Zone,1,System_Types,2,PV_Incentive_Scen,1,BESS_Incentive_Scen,1,PV_Sectors,1,Annual_Econ_Time,1]

Alias Al1538108980
Title: Annual Bill Expense Benefit
Definition: 1
NodeLocation: 328,600,1
NodeSize: 64,40
NodeColor: 65535,1,1
Original: Ann_IncomeTax_Benef

Alias Al1538109016
Title: Levelized Annual Bill
Definition: 1
NodeLocation: 448,688,1
NodeSize: 64,40
Original: Lev_Ann_Bill_byYr

Variable Annual_System_Cost
Title: Annual System Cost
Units: $/year-system
Description: The annual system cost that excludes bill savings.
Definition: Annual_Loan_Payments + Lev_Interconnect_Fee - Ann_Interest_Benefit - Annual_Deprec_Benef + Annual_O_M_Cost + Ann_Income_Tax_Incr
NodeLocation: 528,240,1
NodeSize: 64,40
WindState: 2,102,82,1260,523
ValueState: 2,257,71,1236,758,1,MIDM
ReformVal: [Annual_Econ_Time,Equity_Test]
Att_ResultSliceState: [PV_Sectors,1,Equipment_Types,1,PV_Climate_Zone,1,Annual_PV_Time,1]

Variable Ann_Income_Tax_Incr
Title: Annual Income Tax Increase
Units: $/year-system
Description: The increase (if positive) or savings (if negative) in tax benefits from deducting utility bill expenses from the taxable basis.
Definition: Ann_IncomeTax_Benef[Pre_and_Post_System=Pre_System_Label] - Ann_IncomeTax_Benef[Pre_and_Post_System=Post_System_Label]
NodeLocation: 952,712,1
NodeSize: 64,40
ValueState: 2,152,154,959,349,,MIDM
Att_ResultSliceState: [PV_Sectors,2,PV_Climate_Zone,1,Annual_PV_Time,1]

Variable Ann_Lev_Bill_Savings
Title: Annual Levelized Bill Savings
Units: $/year-system
Description: The savings based on levelized annual utility bills.
Definition: Lev_Ann_Bill_byYr[Pre_and_Post_System=Pre_System_Label] - Lev_Ann_Bill_byYr[Pre_and_Post_System=Post_System_Label]
NodeLocation: 576,792,1
NodeSize: 64,40
ValueState: 2,506,195,927,588,1,MIDM

Variable Annual_Cost_of_Elect
Title: Annual Cost of Electricity
Units: $/year-system
Definition: (Annual_Loan_Payments + Lev_Interconnect_Fee - Ann_Interest_Benefit - Annual_Deprec_Benef + Annual_O_M_Cost) * (Pre_and_Post_System=Post_System_Label) - Ann_IncomeTax_Benef + Lev_Ann_Bill_byYr
NodeLocation: 528,368,1
NodeSize: 64,40
WindState: 2,1075,127,720,350
ValueState: 2,320,114,1196,687,1,MIDM
ReformVal: [Annual_Econ_Time,PV_Sectors]
NumberFormat: 2,F,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [PV_Sectors,2,Equipment_Types,1,PV_Climate_Zone,1,Pre_and_Post_System,1,Annual_PV_Time,1]
{!40700|Att_CellFormat: Undefined}

Variable Ann_ElectCost_Sav
Title: Annual Electricity Cost Savings
Units: $/year-system
Description: The savings in total cost of electricity, which includes utility bill savings less any system costs.
Definition: Annual_Cost_of_Elect[Pre_and_Post_System=Pre_System_Label] - Annual_Cost_of_Elect[Pre_and_Post_System=Post_System_Label]
NodeLocation: 680,320,1
NodeSize: 64,40
WindState: 2,102,82,812,350
ValueState: 2,902,22,969,750,1,MIDM
Att_ResultSliceState: [PV_Sectors,1,Equipment_Types,1,PV_Climate_Zone,1,Annual_PV_Time,1]

Variable Simple_Payback_Time
Title: Simple Payback Time
Units: years
Description: The simple payback time using basic first-year cashflows (eg, bill savings and O&M).
Definition: Divide(Syst_Price_after_ITC + Interconnect_Fees, FirstYr_BillSav_byYr - FirstYr_O_M, True)
NodeLocation: 440,64,1
NodeSize: 64,40
WindState: 2,620,26,1014,700
ValueState: 2,344,24,1048,852,1,MIDM
Aliases: FormNode Fo1539221811, FormNode Fo1572476394
GraphSetup: Att_GraphValueRange Simple_Payback_Time:1,,1,,,,,44.14858102798462,46.575873494148254,0~
Att_GraphIndexRange Annual_Econ_Time:1,,0,,,,10,2020.978289425373,2031.882246375084,0
ReformVal: [Annual_Econ_Time,PV_Sectors]
NumberFormat: 2,F,4,1,0,0,4,1,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [PV_Climate_Zone,3,System_Types,1,Area_Type,1,Equity_Test,1,PV_Sectors,2,Annual_Econ_Time,11]

Objective Cost_of_Elect_Compon
Title: Cost of Electricity Components
Units: $/year
Definition: Table(Cost_Component)(Lev_Ann_Bill_byYr,Annual_Loan_Payments * (Pre_and_Post_System=Post_System_Label),Annual_O_M_Cost * (Pre_and_Post_System=Post_System_Label),Lev_Interconnect_Fee * (Pre_and_Post_System=Post_System_Label),-Annual_Deprec_Benef * (Pre_and_Post_System=Post_System_Label),-Ann_Interest_Benefit * (Pre_and_Post_System=Post_System_Label),-Ann_IncomeTax_Benef,0)
NodeLocation: 608,488,1
NodeSize: 64,40
DefnState: 2,154,432,861,448,,DFNM
ValueState: 2,2251,42,1205,774,1,MIDM
NodeColor: 19661,48336,65535
GraphSetup: Att_StackedBar Graph_Primary_Valdim:0~
{!50007|Graph_BarOutline:0}~
{!40600|Att_WaterfallBar Graph_Primary_Valdim:1}~
Att_CatLineStyle Graph_Primary_Valdim:9~
Att_GraphIndexRange Annual_Econ_Time:1,,0,,,,10,2021.0589036941528,2031.6031724214554,0~
Att_ForceCategorical Graph_Primary_Valdim:1
ReformVal: [Pre_and_Post_System,PV_Climate_Zone]
Att__TotalsIndex: []
Att_ResultSliceState: [PV_Sectors,1,System_Types,1,Area_Type,1,Annual_Econ_Time,11,Cost_Component,2,PV_Climate_Zone,3,Pre_and_Post_System,2]
{!40600|Att_StackingIndex: PV_Climate_Zone}
{!40600|Att_ClusterIndex: PV_Climate_Zone}

Variable CostOf_Elect_Compare
Title: Cost of Electricity Comparison
Units: $/year
Description: Comparison of the overall cost of electricity before and after system installation (including utility electric energy & demand payments, system finance payments, etc.) 
Definition: IF System_Type = No_System_Label~
THEN IF PositionInIndex(Pre_and_Post_System, System_Comparison, Pre_and_Post_System)~
   THEN CostOf_ElectCompare[System_Types=SystType_for_System, System_Comparison=Pre_System_Label]~
   ELSE Null~
ELSE CostOf_ElectCompare[System_Types=SystType_for_System]
NodeLocation: 1048,576,1
NodeSize: 64,40
ValueState: 2,391,75,1165,681,1,MIDM
Aliases: FormNode Fo1539221825, FormNode Fo1572476396, FormNode Fo1567051466
GraphSetup: Att_ForceCategorical Graph_Primary_Valdim:1~
Grid:0~
Att_GraphIndexRange Annual_Econ_Time:1,0,0,,,,,2018.734813734889,2030,0~
Att_CatLineStyle Graph_Primary_Valdim:9~
{!40600|Att_WaterfallBar Graph_Primary_Valdim:1}~
Graph_HLabelRotation:0~
Att_StackedBar Graph_Primary_Valdim:1~
Att_GraphValueRange CostOf_Elect_Compare:1,,1,,,,,-12.375155463814735,15896.69418334961,0~
{!50000|Graph_SortBySpread:0}
ReformVal: [System_Comparison,Cost_Component]
NumberFormat: 2,I,4,0,1,1,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [Bill_Components,Month,Cost_Component]
Att_ResultSliceState: [System_Type,4,PV_Sectors,2,Annual_Econ_Time,9,PV_Climate_Zone,1,Area_Type,1,All_PV_Sectors,2,Cost_Component,1,System_Comparison,2]
{!40600|Att_StackingIndex: Cost_Component}
{!40600|Att_ClusterIndex: Cost_Component}

Variable Cost_Savings_by_Comp
Title: Cost Savings by Component
Units: $/year
Definition: Cost_of_Elect_Compon[Pre_and_Post_System=Pre_System_Label] - Cost_of_Elect_Compon[Pre_and_Post_System=Post_System_Label]
NodeLocation: 600,632,1
NodeSize: 64,40
ValueState: 2,40,42,1189,737,1,MIDM
ReformVal: [Month,Bill_Components]
Att_ResultSliceState: [PV_Sector,1,Bill_Components,1,Month,1]
{!40600|Att_ClusterIndex: Bill_Components}

Alias Al1539193638
Title: Levelized Interconnect Fee
Definition: 1
NodeLocation: 288,392,1
NodeSize: 64,40
Original: Lev_Interconnect_Fee

Variable Middle_of_Year_Month
Title: Middle of Year Monthly Payback
Units: years
Description: The mid-year value from the monthly payback times.
Definition: Mthly_Simple_Payback[Time=MOY_Date_for_Econ_Yr]
NodeLocation: 744,104,1
NodeSize: 64,40
ValueState: 2,98,160,1164,433,,MIDM

Variable Mthly_vs_Ann_Payback
Title: Monthly vs Annual Payback
Units: years
Description: A comparison of the mid-year value of the interpolated monthly payback times and the annual payback times.
Definition: [Simple_Payback_Time,Middle_of_Year_Month]
NodeLocation: 896,104,1
NodeSize: 64,40
NodeInfo: 1,1,1,1,1,1,0,0,0,0,,0,1,0
ValueState: 2,348,62,1422,738,1,MIDM
ReformVal: [Annual_Econ_Time,Self]
Att_ResultSliceState: [PV_Sectors,1,PV_Climate_Zone,1,System_Types,1,Self,1,Annual_Econ_Time,1]

Variable CostOf_ElectCompare
Title: Cost of Electricity Comparison
Units: $/year
Description: Comparison of the overall cost of electricity before and after system installation (including utility electric energy & demand payments, system finance payments, etc.) 
Definition: IF NOT Map_Costs_to_Sector[All_Sectors=PV_Sectors]~
THEN Null~
ELSE IF System_Comparison = Cost_Savings_Label~
THEN Cost_Savings_by_Comp~
ELSE Cost_of_Elect_Compon[Pre_and_Post_System=System_Comparison]~

NodeLocation: 856,472,1
NodeSize: 64,40
ValueState: 2,311,14,1288,796,1,MIDM
GraphSetup: Att_GraphIndexRange Annual_Econ_Time:1,0~
Att_CatLineStyle Graph_Primary_Valdim:9~
{!40600|Att_WaterfallBar Graph_Primary_Valdim:1}~
Graph_HLabelRotation:0~
Graph_KeyFont:,18,0~
Graph_KeyTitleFont:,18,1~
Graph_AxisLabelFont:,18,0~
Graph_AxisTitleFont:Arial,18,1~
Att_StackedBar Graph_Primary_Valdim:1~
Att_ForceCategorical Graph_Primary_Valdim:
ReformVal: [System_Types,Cost_Component]
NumberFormat: 2,I,4,0,1,1,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [Bill_Components,Month,Cost_Component]
Att_ResultSliceState: [System_Comparison,2,PV_Climate_Zone,1,PV_Sectors,2,Annual_Econ_Time,9,Cost_Component,0,System_Types,1]
{!40600|Att_StackingIndex: Cost_Component}
{!40600|Att_ClusterIndex: Cost_Component}

Alias Al1548956516
Title: Monthly Simple Payback Time
Definition: 1
NodeLocation: 592,104,1
NodeSize: 64,40
Original: Mthly_Simple_Payback

Text Te949545507
Title: Change cost of electricity ratio calc
NodeLocation: 848,320,-1
NodeSize: 64,40

Alias Al1047325219
Title: Levelized Solar Production
Definition: 1
NodeLocation: 144,384,1
NodeSize: 64,40
Original: NPV_of_Solar_Product

Variable Levelized_cost_of_so
Title: Levelized cost of solar production
Units: $/kWh
Definition: NPV_of_System_Cost / NPV_of_Solar_Product
NodeLocation: 128,648,1
NodeSize: 64,40
ValueState: 2,1934,-2,767,851,,MIDM
GraphSetup: Att_GraphIndexRange Annual_Econ_Time:1,,0,,,,10,2020.9949763417244,2031.1365003585815,0
ReformVal: [Annual_Econ_Time,PV_Climate_Zone]
NumberFormat: 2,F,4,2,0,1,4,1,$,0,"ABBREV",0,,,0,0,15,
Att_ResultSliceState: [Area_Type,1,System_Types,1,PV_Sectors,1,PV_Climate_Zone,3,Annual_Econ_Time,1]

Variable Annual_System_Cost_b
Title: Annual System Cost by Component
Definition: [Annual_Loan_Payments,Lev_Interconnect_Fee,- Ann_Interest_Benefit,- Annual_Deprec_Benef,Annual_O_M_Cost,0*Ann_Income_Tax_Incr]
NodeLocation: 72,280,1
NodeSize: 64,40
ValueState: 2,563,126,920,744,1,MIDM
NodeColor: 65535,1,1
GraphSetup: {!40600|Att_WaterfallBar Graph_Primary_Valdim:1}~
Att_CatLineStyle Graph_Primary_Valdim:9~
Att_Stacked_Lines Graph_Primary_Valdim:1~
Att_GraphIndexRange Annual_Econ_Time:1,,0,,,,10,2022.0020577907562,2031.275512099266,0~
Att_GraphValueRange Annual_System_Cost_b:1,,1,,,,,0,110K,0
ReformVal: [Self,Debt_Equity_Rates]
Att_ResultSliceState: [PV_Sectors,1,Annual_Econ_Time,11,PV_Climate_Zone,2,System_Types,1,Area_Type,1,Annual_Econ_Time,11,Self,1]
Att_ColorRole: Null
{!40600|Att_StackingIndex: Annual_System_Cost_b}
{!40600|Att_ClusterIndex: Null}

Variable NPV_of_System_Cost
Title: NPV of System Cost
Definition: PV(Nominal_Equity_Rate, Economic_Lifetime,-Annual_System_Cost)
NodeLocation: 72,496,1
NodeSize: 64,40

Variable Va22
NodeLocation: 456,152,1
NodeSize: 64,40

Variable NPV_of_Bill_Savings
Title: NPV of Bill Savings
Definition: PV(Nominal_Equity_Rate, Economic_Lifetime,-Ann_Lev_Bill_Savings)
NodeLocation: 392,832,1
NodeSize: 64,40

Variable Levelized_Value_of_S
Title: Levelized Value of Solar Production
Units: $/kWh
Definition: ZIDZ(NPV_of_Bill_Savings, NPV_of_Solar_Product)
NodeLocation: 208,840,1
NodeSize: 64,40
ValueState: 2,566,168,659,631,,MIDM
GraphSetup: Att_GraphValueRange Levelized_Value_of_S:1,,0,,,,,0,0.12,0~
Att_GraphIndexRange Annual_Econ_Time:1,,0,,,,10,2021.8430269956589,2032,0
ReformVal: [Annual_Econ_Time,System_Types]
NumberFormat: 2,F,4,3,0,0,4,1,$,0,"ABBREV",0,,,0,0,15,
Att_ResultSliceState: [PV_Sectors,2,Area_Type,1,PV_Climate_Zone,3,System_Types,2,Annual_Econ_Time,1]

Variable Value_vs_Cost
Title: Value vs Cost
Units: $/kWh
Definition: [Levelized_cost_of_so,Levelized_Value_of_S]
NodeLocation: 120,168,1
NodeSize: 64,40
ValueState: 2,516,43,892,743,1,MIDM
GraphSetup: Att_GraphValueRange Value_vs_Cost:1,,1,,,,8,0,0.35000000000000003,0~
Att_CatLineStyle Graph_Primary_Valdim:9~
Att_StackedBar Graph_Primary_Valdim:0~
{!50007|Graph_BarOutline:0}~
Att_GraphIndexRange Annual_Econ_Time:1,,0,,,,10,2020.0126904249191,2031.717280626297,0
ReformVal: [Annual_Econ_Time,Equity_Test]
NumberFormat: 2,F,4,2,0,1,4,1,$,0,"ABBREV",0,,,0,0,15,
Att__TotalsIndex: [Equity_Test,Self]
Att_ResultSliceState: [System_Types,1,PV_Sectors,1,PV_Climate_Zone,1,Area_Type,1,Self,-1,Equity_Test,-1,Annual_Econ_Time,11]
{!40300|Att_SlicerPopupSize: 227,64}

Variable Cost_to_Value_Ratio
Title: Cost to Value Ratio
Definition: ZIDZ(Levelized_cost_of_so,Levelized_Value_of_S)
NodeLocation: 304,720,1
NodeSize: 64,40
ValueState: 2,2786,188,902,645,,MIDM
GraphSetup: Att_GraphValueRange Cost_to_Value_Ratio:1,,1,,,,,0,2.4693472385406494,0~
Att_GraphIndexRange Annual_Econ_Time:1,,0,,,,10,2020.9468935728073,2032,0
ReformVal: [Annual_Econ_Time,PV_Climate_Zone]
Att_ResultSliceState: [PV_Sectors,1,System_Types,1,Area_Type,1,PV_Climate_Zone,1,Annual_Econ_Time,1]

Close Old_Cost_Ratio_Calcs

Module Monthly_Payback_Logi
Title: Monthly Payback Logic
Author: JamesMilford
Date: Wed, Feb 6, 2019 6:05 PM
NodeLocation: 152,72,1
NodeSize: 64,40
DiagState: 2,49,80,1791,484,17,10

Variable Mthly_Simple_Payback
Title: Monthly Simple Payback Time
Units: years
Description: The simple payback time interpolated to the monthly level.
Definition: VAR numerator:=Tot_Price_Aft_Incent - Monthly_Fees;~
IF (numerator < 0) AND (FirstYr_BillSav_Time > 0)~
THEN 0~
ELSE IF (numerator > 0) AND (FirstYr_BillSav_Time < 0)~
THEN INF~
ELSE Divide(numerator, FirstYr_BillSav_Time, False)
NodeLocation: 928,168,1
NodeSize: 64,40
WindState: 2,332,171,1361,658
ValueState: 2,2099,4,1275,767,1,MIDM
Aliases: Alias Al1548956516
GraphSetup: Att_GraphIndexRange Time_Solar_PV:1,,1,,,,,40.543K,42.369K,0~
Att_GraphIndexRange Time:1,,0,,,,,38717,49670.41991043091,0~
Att_GraphValueRange Mthly_Simple_Payback:1,,0,,,,10,0,40.22722691297531,0
ReformVal: [Time,System_Types]
DisplayOutputs: Object Object, Object Variable, Variable Payback_Time_by_ID1
Att__TotalsIndex: [Self]
Att_GraphValueRange: 1,,,,,,10
Att_ResultSliceState: [Area_Type,1,PV_Climate_Zone,1,PV_Sectors,1,System_Types,2,Time,1]
{!40300|Att_SlicerPopupSize: 227,70}

Variable Monthly_ITC_Fraction
Title: Monthly ITC Fraction
Units: fraction
Description: Investment tax credit expressed as a percentage of the upfront capital costs.
Definition: StepInterp(BOY_Date_for_Econ_Yr, ITC_Fraction, Time, Annual_Econ_Time, True) * Val_by_Install_Event(Allowed_ITC_Pct_Time, Timesteps_Per_Year, Time);
NodeLocation: 408,272,1
NodeSize: 64,40
WindState: 2,553,20,720,356
ValueState: 2,429,24,1064,627,0,MIDM
ReformVal: [Time_Solar_PV,Installation_Event]
Att_ResultSliceState: [PV_Sectors,2,Equipment_Types,1,System_Types,1,PV_Climate_Zone,1,Area_Type,1,Installation_Event,2,Time,1]

Variable Monthly_Equip_Price
Title: Monthly Equip Price
Units: $/system
Description: The total price of installed equipment (initial installation + discounted replacement), based on the sizing of each equipment type. The last six months are not valid since mid-year interpolation is performed, which results in a six-month look-ahead beyond the end of the data availability.
Definition: LinearInterp(MOY_Date_for_Econ_Yr, Tot_Equipment_Price, Time, Annual_Econ_Time);
NodeLocation: 88,168,1
NodeSize: 64,40
WindState: 2,172,150,986,474
ValueState: 2,312,0,1370,744,1,MIDM
ReformVal: [Time,PV_Sectors]
Att_ResultSliceState: [Equipment_Types,1,System_Types,1,PV_Climate_Zone,1,PV_Sectors,2,Time,1]

Variable Annual_Cost_Escalat
Title: Annual Cost Escalation
Units: fraction/year
Description: The cost escalation at the end of the simulation horizon. This will be used to estimate costs 6-months beyond the end of simulation horizon. 
Definition: Divide(Tot_Equipment_Price[Annual_Econ_Time=Max(Annual_Econ_Time)], Tot_Equipment_Price[Annual_Econ_Time=Max(Annual_Econ_Time)-1], True) - 1;   {Annual end-of-simulation escalation rate}
NodeLocation: 88,64,1
NodeSize: 64,40
WindState: 2,484,102,720,350
ValueState: 2,294,101,1225,533,1,MIDM
NumberFormat: 2,%,2,2,0,0,2,0,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [PV_Climate_Zone,1,Equipment_Types,1,System_Types,1,PV_Sectors,1]

Variable Monthly_Cost_Escalat
Title: Monthly Cost Escalation
Units: fraction/month
Description: The compounding monthly equivalent of the annual cost escalation at the end of the simulation horizon. This will be used to estimate costs six months beyond the simulation horizon.
Definition: (1+Annual_Cost_Escalat)^(1/Months_per_Year)-1;   {The compounding monthly equivalent of the annual escalation rate}
NodeLocation: 240,64,1
NodeSize: 64,40
WindState: 2,562,119,720,350
ValueState: 2,426,154,1109,594,0,MIDM
NumberFormat: 2,%,2,2,0,0,2,0,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [Equipment_Types,2,System_Types,2,PV_Sectors,1,PV_Climate_Zone,1]

Variable Mthly_Escal_Factors
Title: Monthly Escalation Factors
Units: fraction
Description: Escalation factors to estimate the equipment costs for the final months of the simulation.
Definition: CumProduct(IF Time <= MOY_Date_for_Econ_Yr[Annual_Econ_Time=Max(Annual_Econ_Time)] THEN 1 ELSE 1 + Monthly_Cost_Escalat, Time);   {Escalation factor to account for final months for which mid-year interpolation is flat}
NodeLocation: 392,64,1
NodeSize: 64,40
WindState: 2,272,184,720,350
ValueState: 2,528,5,1056,593,1,MIDM
NumberFormat: 2,%,4,6,0,0,4,0,$,0,"ABBREV",0,,,0,0,15

Variable Extended_Equip_Price
Title: Extended Equip Price
Units: $/system
Description: The total price of installed equipment (initial installation + discounted replacement), based on the sizing of each equipment type. The last six months are estimated from the escalation rates in the previous months. Replacement costs have not yet been discounted and proportioned to the remaining years in the economic horizon, so it is inappropriate to sum over Installation Events (ie, initial installation and future replacement).
Definition: VAR price:=IF Time <= MOY_Date_for_Econ_Yr[Annual_Econ_Time=Max(Annual_Econ_Time)]   {For all but the final 6 months of simulation}~
   THEN Monthly_Equip_Price    {Then use the mid-year interpolated values}~
   ELSE Monthly_Equip_Price * Mthly_Escal_Factors;   {Otherwise extend the price escalation to the final 6 months}~
~
Val_by_Install_Event(price, Timesteps_Per_Year, Time)
NodeLocation: 480,168,1
NodeSize: 64,40
ValueState: 2,80,10,1025,684,1,MIDM
ReformVal: [Time_Solar_PV,Installation_Event]
Att__TotalsIndex: []
Att_ResultSliceState: [PV_Sectors,1,Equipment_Types,1,System_Types,1,PV_Climate_Zone,1,Installation_Event,1,Time,1]

Variable Monthly_ITC_Amount
Title: Monthly ITC Amount
Units: $/system
Description: The federal investment tax credit based on the equipment sizes used for each system type. Replacement costs have not yet been discounted and proportioned to the remaining years in the economic horizon, so it is inappropriate to sum over Installation Events (ie, initial installation and future replacement).
Definition: Monthly_ITC_Fraction * Extended_Equip_Price
NodeLocation: 560,272,1
NodeSize: 64,40
WindState: 2,335,290,720,350
ValueState: 2,343,8,1052,689,1,MIDM
ReformVal: [Time_Solar_PV,Installation_Event]
Att_ResultSliceState: [PV_Sectors,1,Equipment_Types,1,System_Types,1,PV_Climate_Zone,1,Installation_Event,1,Time,1]

Variable Price_After_Incent
Title: Price After Incentives
Units: $/system
Description: The price of installed equipment, based on the sizing of each equipment type. Replacement costs have not yet been discounted and proportioned to the remaining years in the economic horizon, so it is inappropriate to sum over Installation Events (ie, initial installation and future replacement).
Definition: Extended_Equip_Price - Monthly_ITC_Amount - Taxable_Incent_Event
NodeLocation: 632,168,1
NodeSize: 64,40
WindState: 2,43,47,1456,350
ValueState: 2,290,5,1152,690,,MIDM
ReformVal: [Time_Solar_PV,Installation_Event]
Att__TotalsIndex: []
Att_ResultSliceState: [PV_Sectors,1,Equipment_Types,1,System_Types,1,PV_Climate_Zone,1,Installation_Event,2,Time,1]

Variable Tot_Price_Aft_Incent
Title: Total Price After Incentives
Units: $/system
Description: The total price of installed equipment (initial installation + discounted replacement), based on the sizing of each equipment type.
Definition: Sum(Sum_Initial_Repl_Val(Price_After_Incent,Replace_Value_Factor), Equipment_Types)
NodeLocation: 784,168,1
NodeSize: 64,40
ValueState: 2,204,137,1167,698,,MIDM
Aliases: FormNode Fo619863549
GraphSetup: Att_GraphIndexRange Time:1,,0,,,,,39537.3416184783,49668.12498682737,0~
Att_GraphValueRange Tot_Price_Aft_Incent:1,,1,,,,,0,50K,0
Att_ResultSliceState: [PV_Sectors,1,System_Types,1,PV_Climate_Zone,1,Area_Type,1,Time,1]

Variable Monthly_Fees
Title: Monthly Fees
Units: $/system
Description: Interconnection fees interpolated to monthly values.
Definition: StepInterp(EOY_Date_for_Econ_Yr, Interconnect_Fees, Time, Annual_Econ_Time)
NodeLocation: 784,272,1
NodeSize: 64,40
WindState: 2,345,91,1017,327
ValueState: 2,457,159,798,693,1,MIDM

Variable Original_Monthly_Pa1
Title: Original Monthly Payback Calc
Units: years
Description: The simple payback time interpolated to the monthly level.
Definition: VAR ITC_Fract:=StepInterp(BOY_Date_for_Econ_Yr, ITC_Fraction, Time_Solar_PV, Annual_Econ_Time, True) * Val_by_Install_Event(Allowed_ITC_Pct_Time, PV_Timesteps_PerYear, Time_Solar_PV);~
VAR equipPrice:=LinearInterp(MOY_Date_for_Econ_Yr, Tot_Equipment_Price, Time_Solar_PV, Annual_Econ_Time);~
VAR priceEscalation:=Divide(Tot_Equipment_Price[Annual_Econ_Time=Max(Annual_Econ_Time)], Tot_Equipment_Price[Annual_Econ_Time=Max(Annual_Econ_Time)-1], True) - 1;   {Annual end-of-simulation escalation rate}~
VAR equivEscalation:=(1+priceEscalation)^(1/Months_per_Year)-1;   {The compounding monthly equivalent of the annual escalation rate}~
VAR escalatFactor:=CumProduct(IF Time_Solar_PV <= MOY_Date_for_Econ_Yr[Annual_Econ_Time=Max(Annual_Econ_Time)] THEN 1 ELSE 1 + equivEscalation, Time_Solar_PV);   {Escalation factor to account for final months for which mid-year interpolation is flat}~
VAR extendedPrice:=IF Time_Solar_PV <= MOY_Date_for_Econ_Yr[Annual_Econ_Time=Max(Annual_Econ_Time)]   {For all but the final 6 months of simulation}~
   THEN equipPrice    {Then use the mid-year interpolated values}~
   ELSE equipPrice * escalatFactor;   {Otherwise extend the price escalation to the final 6 months}~
VAR ITC_Amt:=ITC_Fract * extendedPrice;~
VAR priceAfterITC:=Sum(Sum_Initial_Repl_Val(extendedPrice - ITC_Amt {- Taxable_Incent_Event},Replace_Value_Factor), Equipment_Types);~
VAR fees:=LinearInterp(EOY_Date_for_Econ_Yr, Interconnect_Fees, Time_Solar_PV, Annual_Econ_Time);~
~
Divide(priceAfterITC + fees, FirstYr_BillSav_Time, True)~

NodeLocation: 928,392,1
NodeSize: 64,40
WindState: 2,10,68,1361,658
ValueState: 2,79,14,1469,681,1,MIDM
NodeColor: 65535,1,1
GraphSetup: Att_GraphValueRange Original_Monthly_Pa1:1,,0,,,,,-0.26074469089508057,20.8305162191391,0~
Att_GraphIndexRange Time_Solar_PV:1,,1,,,,,40.543K,42.369K,0
ReformVal: [Time_Solar_PV,System_Types]
Att__TotalsIndex: [Self]
Att_ResultSliceState: [PV_Sectors,1,PV_Climate_Zone,1,System_Types,1,Time_Solar_PV,1]
{!40300|Att_SlicerPopupSize: 227,70}

Text FrameNode_1549389509
NodeLocation: 1384,320,-20
NodeSize: 360,304
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus: yes~
Show_description:20

Close Monthly_Payback_Logi

Variable Simple_Payback_Time1
Title: Simple Payback Time
Units: years
Description: The simple payback time interpolated to the monthly level.
Definition: VAR numerator:=Tot_Price_Aft_Incent - Monthly_Fees;~
IF (numerator < 0) AND (FirstYr_BillSav_Time > 0)~
THEN 0~
ELSE IF (numerator > 0) AND (FirstYr_BillSav_Time < 0)~
THEN INF~
ELSE Divide(Tot_Price_Aft_Incent - Monthly_Fees, FirstYr_BillSav_Time, False)
NodeLocation: 312,72,1
NodeSize: 64,40
ValueState: 2,434,104,1104,666,1,MIDM
GraphSetup: {!50400|Att_AxisOrKeyTitle Time:""}~
Att_GraphValueRange Simple_Payback_Time1:1,,1,,,,,0,11.629531234502792,0~
Att_GraphIndexRange Time:1,,0,,,,,42649.27217160165,47983.60028320551,0~
Graph_AxisLabelFont:,20,0
ReformVal: [Time,System_Types]
Att__TotalsIndex: []
Att_ResultSliceState: [Area_Type,1,PV_Climate_Zone,1,PV_Sectors,1,System_Types,1,Time,1]

Module Simple_LCOE_Calculat
Title: Simple LCOE Calculator
Author: CWelch
Date: Fri, Mar 25, 2022 11:08 AM
NodeLocation: 152,432,1
NodeSize: 64,40
DiagState: 2,96,44,1195,595,17,10

Variable Replace_Val_Fact_Sim
Title: Replacement Value Factor, Simple
Units: $/$
Description: A factor that can be applied to a replacement cost/benefit to find it's effective net present value over the number of years remaining in the economic lifetime relative to the first replacement event.~
This discounts the future replacement cost/benefit back to the current decision year. For example, if the replacement will not occur until the beginning of year 11 (eg, the equipment lifetime is 10 years), then that cost/benefit must be discounted by 10 years to represent a current year present value. Next, it annualizes the present value for the current decision year. Finally, it determines how many years are left in the economic horizon and only charges/credits the equipment with costs/benefits over the remaining years. For example, if an equipment type has a lifetime of 12 years and the economic horizon is 20 years, then the remaining lifetime is 8 years, which indicates 8/12 of the full replacement cost should be charged. The annualized costs over the remaining years are then present valued to represent the portion of full costs/benefits that are incurred in the remaining years.~

Definition: VAR discntFactor:= 1 / (1 + Nominal_Equity_Rate)^Equipment_Lifetimes;    {Discount factor to bring future replacement cost to present value in current decision year}~
VAR annualFactor:=PMT(Nominal_Equity_Rate, Equipment_Lifetimes, -discntFactor);   {Annualizes the present value in the current decision year}~
PV(Nominal_Equity_Rate, Economic_Lifetime - Equipment_Lifetimes, -annualFactor)   {Finds the present value of the annualized value over the number of years remaining in the economic lifetime}~

NodeLocation: 120,168,1
NodeSize: 64,40
WindState: 2,202,148,1117,456
ValueState: 2,387,354,1201,180,0,MIDM

Constant Simple_LCOE_Discount
Title: Simple LCOE Discount Rate
Units: %/yr
Description: Discount rate to be used in the SIMPLE LCOE calculation.~
~
current input assumption is essentially a WACC (before tax) assuming 40% debt financed at 7% and 60% equity financed at 12%. This is highly uncertain.
Definition: 8.9%
NodeLocation: 120,480,1
NodeSize: 64,40
ValueState: 2,548,554,416,303,,MIDM
Aliases: FormNode Fo1703427619
NodeColor: 65535,1,1
NumberFormat: 2,%,2,2,0,0,2,1,$,0,"ABBREV",0,,,0,0,15,

Variable Total_EquipPric_Simp
Title: Total Equipment Price, Simple
Units: $/system
Description: The total price of installed equipment (initial installation + discounted replacement), based on the sizing of each equipment type.
Definition: Sum_Initial_Repl_Val(Install_Equip_Price,Replace_Value_Factor)
NodeLocation: 280,72,1
NodeSize: 64,40
WindState: 2,13,222,720,350
ValueState: 2,626,150,939,740,0,MIDM
GraphSetup: Att_GraphValueRange Total_EquipPric_Simp:1,,1,,,,,0,81218.05191040039,0~
Att_GraphIndexRange Annual_Econ_Time:1,,1,,,,10,2020.11490675807,2032,0
ReformVal: [Equipment_Types,System_Types]
NumberFormat: 2,F,4,2,1,1,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: []
Att_ResultSliceState: [PV_Sectors,1,PV_Climate_Zone,1,Area_Type,1,Annual_Econ_Time,21,System_Types,1,Equipment_Types,1]

Variable Total_ITC_Simple
Title: Total ITC for System, Simple
Units: $/system
Description: The total investment tax credit (eg, initial installation + discounted replacement) based on the equipment sizes used for each system type.
Definition: Sum_Initial_Repl_Val(ITC_for_System_Event,Replace_Val_Fact_Sim)
NodeLocation: 280,168,1
NodeSize: 64,40
WindState: 2,98,82,1157,590
ValueState: 2,190,238,1235,377,0,MIDM
ReformVal: [Annual_Econ_Time,Equipment_Types]
NumberFormat: 2,F,2,0,1,1,2,0,$,0,"ABBREV",0,,,0,0,15,
Att__TotalsIndex: []
Att_ResultSliceState: [PV_Sectors,1,PV_Climate_Zone,1,Area_Type,1,System_Types,1,Equipment_Types,2,Annual_Econ_Time,14]

Variable PV_of_O_M_Simple
Title: PV of O&M, Simple
Units: $/system
Description: The levelized annual cost of operations and maintenance. For use only in the SIMPLE LCOE calculation
Definition: local realEquityRate:=(1+Simple_LCOE_Discount)/(1+Inflation_Rate*Inflate_O_M_Costs)-1;   {The real equity rate after adjusting for inflation, which prevents having to create an orthogonal index to track inflation}~
local pres_val:=PV(Simple_LCOE_Discount, Economic_Lifetime, -O_M_Rate);~
pres_val * Equipment_Sizes~

NodeLocation: 280,368,1
NodeSize: 64,40
WindState: 2,11,70,1177,361
ValueState: 2,339,214,1160,587,,MIDM
NumberFormat: 2,F,4,2,1,1,4,0,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [Equipment_Types,1,PV_Climate_Zone,1,System_Types,1,PV_Sectors,1,Area_Type,1,Annual_Econ_Time,1]

Variable PV_Taxable_Inc_Smp
Title: PV Taxable Incentives, Simple
Units: $/system
Description: The value of taxable incentives after adjusting for their tax liability. These are averages across each year. For use only in the SIMPLE LCOE calculation
Definition: Sum_Initial_Repl_Val(Aggregate(Taxable_Incent_Event, Time_Year_Map, Time, Annual_Econ_Time, type: "Average", noMapError: True),Replace_Val_Fact_Sim)
NodeLocation: 280,272,1
NodeSize: 64,40
WindState: 2,334,24,871,434
ValueState: 2,212,1,1249,755,1,MIDM
ReformVal: [Annual_Econ_Time,Equipment_Types]
Att_ResultSliceState: [PV_Climate_Zone,3,System_Types,1,PV_Sectors,1,Area_Type,1,Equipment_Types,2,Annual_Econ_Time,1]

Variable PV_of_System_Cost
Title: PV of System Cost
Units: $/system
Definition: local total:=Total_EquipPric_Simp - Total_ITC_Simple - PV_Taxable_Inc_Smp + PV_of_O_M_Simple;~
sum(total,Equipment_Types)
NodeLocation: 472,224,1
NodeSize: 64,40
ValueState: 2,690,256,902,603,,MIDM
ReformVal: [Annual_Econ_Time,System_Types]
Att_ResultSliceState: [PV_Sectors,1,PV_Climate_Zone,3,Area_Type,1,System_Types,1,Annual_Econ_Time,1]

Variable PV_of_Solar_Producti
Title: PV of Solar Production, Simple
Units: pV of kWh
Description: For use only in the SIMPLE LCOE calculation
Definition: local pv_solar:=NPV(Simple_LCOE_Discount, Levelized_Applied_So, PV_Operating_Year);~
sum(pv_solar * Weeks_Per_Month, Month, Profile_Hours)
NodeLocation: 472,480,1
NodeSize: 64,40
ValueState: 2,111,118,970,707,0,MIDM
ReformVal: [PV_Climate_Zone,PV_Sectors]
NumberFormat: 2,F,2,0,1,0,2,0,$,0,"ABBREV",0,,,0,0,15,
Att__TotalsIndex: [PV_Climate_Zone,PV_Sectors,Area_Type]
Att_ResultSliceState: [Area_Type,0,PV_Sectors,1,PV_Climate_Zone,1]

Text Te1560821283
Title: Look at PV function and NPV function and timing of first period that is discounted
NodeLocation: 528,88,-1
NodeSize: 120,56

Variable Simple_LCOE_of_PV
Title: Simple LCOE of PV
Units: $/kWh
Definition: ZIDZ(PV_of_System_Cost,PV_of_Solar_Producti)
NodeLocation: 672,352,1
NodeSize: 64,40
WindState: 2,2189,228,720,350
ValueState: 2,501,105,1031,775,1,MIDM
GraphSetup: Flip:0~
Att_GraphIndexRange Annual_Econ_Time:1,,0,,,,10,2021.0268869400024,2031.4014666080475,0
ReformVal: [Annual_Econ_Time,PV_Sectors]
NumberFormat: 2,F,4,3,0,0,4,0,$,0,"ABBREV",0,,,0,0,15,
Att_ResultSliceState: [Area_Type,1,PV_Sectors,1,System_Types,1,PV_Climate_Zone,3,Annual_Econ_Time,1]

FormNode Fo1703427619
Title: Simple LCOE Discount Rate
Definition: 0
NodeLocation: 120,528,1
NodeSize: 64,16
NodeInfo: 1,,,0
NodeColor: 65535,1,1
Original: Simple_LCOE_Discount

Variable Compare10
Definition: [Total_EquipPric_Simp,Total_ITC_Simple,PV_of_O_M_Simple,PV_Taxable_Inc_Smp]
NodeLocation: 472,368,1
NodeSize: 64,40
ValueState: 2,2218,145,1005,758,1,MIDM
GraphSetup: Att_GraphIndexRange Annual_Econ_Time:1,,0,,,,10,2021.0785456895828,2032,0
ReformVal: [Annual_Econ_Time,Self]
Att__TotalsIndex: []
Att_ResultSliceState: [PV_Sectors,1,PV_Climate_Zone,3,Equipment_Types,1,Area_Type,1,Annual_Econ_Time,13,Self,1,System_Types,1]
{!40700|Att_CellFormat: CellNumberFormat('Fixed Point',0,0,1,'$-#','ABBREV',0,0,0,2,0)}

Variable Simple_LCOE_of_PV1
Title: Simple LCOE of PV
Units: $/kWh
Description: Levelized cost of electricity of solar (or solar + storage) using a "simple LCOE" calculation, accounting for installed cost, tax credits, and incentives.
Definition: Simple_LCOE_of_PV[Annual_Econ_Time=Cost_Forecast_Year]
NodeLocation: 840,352,1
NodeSize: 64,40
WindState: 2,2189,228,720,350
ValueState: 2,733,237,972,614,1,MIDM
Aliases: FormNode Fo75198755
GraphSetup: Att_GraphIndexRange Annual_Econ_Time:1,,0,,,,10,2021.0268869400024,2031.4014666080475,0~
Flip:0
ReformVal: [Annual_Econ_Time,PV_Climate_Zone]
NumberFormat: 2,F,4,3,0,0,4,0,$,0,"ABBREV",0,,,0,0,15,
Att__TotalsIndex: [Cost_Forecast_Year]
Att_ResultSliceState: [Area_Type,3,System_Types,1,PV_Climate_Zone,3,Cost_Forecast_Year,1]

FormNode Fo75198755
Title: Simple LCOE of PV
Definition: 1
NodeLocation: 772,536,1
NodeSize: 164,16
Original: Simple_LCOE_of_PV1

Close Simple_LCOE_Calculat

Variable Cost_of_Electricity_
Title: Cost of Electricity Ratio
Description: The ratio of post-system to pre-system total cost of electricity.~
~
DOESN'T WORK ANYMORE WITH CHANGES TO SYSTEM SIZING CALCS. PLUS ECONOMICS AREN'T RIGHT.
Definition: Divide(Annual_Cost_of_Elect[Pre_and_Post_System=Post_System_Label], Annual_Cost_of_Elect[Pre_and_Post_System=Pre_System_Label])
NodeLocation: 312,176,1
NodeSize: 64,40
ValueState: 2,264,190,1067,610,,MIDM
NodeColor: 65535,1,1
GraphSetup: Att_GraphIndexRange Annual_Econ_Time:1,,0,,,,10,2021.0472226142883,2031.386462688446,0
ReformVal: [Annual_Econ_Time,PV_Climate_Zone]
Att_ResultSliceState: [PV_Climate_Zone,2,System_Types,1,Area_Type,1,PV_Sectors,1,Annual_Econ_Time,1]

Index Cost_Ratio_Method
Title: Cost Ratio Method
Definition: MultiChoice(Self,2,returnList:0)
NodeLocation: 720,96,1
NodeSize: 64,40
Aliases: FormNode Fo2025340451
NodeColor: 65535,65531,1
{!40300|DomainExpr: Discrete('Manual PPA Inputs','Simple LCOE Calculator')}

FormNode Fo2025340451
Title: Cost to Value Ratio Method
Definition: 0
NodeLocation: 652,152,1
NodeSize: 236,16
NodeInfo: 1,,,,,,,226,,,,,,0
Original: Cost_Ratio_Method

Variable Simple_LCOE_to_Value
Title: Simple LCOE to Value Ratio
Definition: ZIDZ(Simple_LCOE_of_PV,Value_of_generation)
NodeLocation: 312,432,1
NodeSize: 64,40
ValueState: 2,266,34,999,759,,MIDM
GraphSetup: Att_GraphIndexRange Annual_Econ_Time:1,,0,,,,10,2021.1102975606918,2032,0~
Att_GraphValueRange Simple_LCOE_to_Value:1,,1,,,,,0,2.0010854601860046,0
ReformVal: [Annual_Econ_Time,PV_Climate_Zone]
Att_ResultSliceState: [System_Types,1,PV_Sectors,1,Area_Type,1,PV_Climate_Zone,1,Annual_Econ_Time,1]

Module Manually_Input_PPA
Title: Manually Input PPA
Author: CWelch
Date: Fri, Mar 25, 2022 1:32 PM
NodeLocation: 152,304,1
NodeSize: 64,40
DiagState: 2,588,24,944,604,17,10

Constant Estimated_PPA_Rates
Title: Estimated PPA Rates
Definition: Table(Annual_Econ_Time,All_System_Types)(~
0.07,0,0.09,0,0,0,0,~
0.07,0,0.09,0,0,0,0,~
0.07,0,0.09,0,0,0,0,~
0.07,0,0.09,0,0,0,0,~
0.07,0,0.09,0,0,0,0,~
0.07,0,0.09,0,0,0,0,~
0.07,0,0.09,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,~
0,0,0,0,0,0,0)
NodeLocation: 112,664,1
NodeSize: 64,40
DefnState: 2,334,471,1057,273,0,DFNM
NodeColor: 65535,1,1

Variable Base_assumed_PPA_rat
Title: Base assumed PPA rates
Units: $/kWh
Definition: SubTable(Estimated_PPA_Rates[All_System_Types=System_Types])
NodeLocation: 272,664,1
NodeSize: 64,40
DefnState: 2,1001,332,480,533,0,DFNM
ValueState: 2,301,251,752,522,,MIDM
ReformDef: [System_Types,Annual_Econ_Time]
NumberFormat: 2,F,2,3,0,1,2,1,$,0,"ABBREV",0,,,0,0,15,

Constant PPA_Multiplier
Title: PPA Multiplier
Units: fraction
Definition: Table(Area_Type,PV_Climate_Zone)(~
1.6)
NodeLocation: 440,664,1
NodeSize: 64,40
DefnState: 2,702,270,648,174,0,DFNM
NodeColor: 65535,1,1
ReformDef: [Area_Type,PV_Climate_Zone]
TableCellDefault: 1

Variable Manual_PPA_Rates_by_
Title: Manual PPA Rates by Type
Units: $/kWh
Definition: Base_assumed_PPA_rat * PPA_Multiplier
NodeLocation: 272,768,1
NodeSize: 64,40
ValueState: 2,361,129,1114,647,,MIDM
Aliases: Alias Al1165860387
Att_ResultSliceState: [System_Types,1,Area_Type,1,PV_Climate_Zone,1,Annual_Econ_Time,1]

Alias Al1203148323
Title: First year $/kWh value of solar generation
Definition: 1
NodeLocation: 128,64,1
NodeSize: 72,40
Original: First_year_kWh_value

Alias Al1165860387
Title: PPA Rates by Type
Definition: 1
NodeLocation: 128,320,1
NodeSize: 64,40
Original: Manual_PPA_Rates_by_

Alias Al497262115
Title: $/kWh value of solar by Econ Time
Definition: 1
NodeLocation: 128,208,1
NodeSize: 64,40
Original: Value_of_generation

Close Manually_Input_PPA

Variable Simple_LCOE_vs_Value
Title: Simple LCOE vs Value of Solar
Units: $/kWh
Description: Comparison of the value of solar per the NY VDER calculator (inclusive of manually input community adders, environmental value, or LSRV) and a "simple" LCOE for solar (accounting for installed costs, tax credits (assume third party owned), and incentives.
Definition: [Simple_LCOE_of_PV1,Value_of_generation1]
NodeLocation: 312,528,1
NodeSize: 64,40
WindState: 2,953,224,720,557
ValueState: 2,28,43,876,713,0,MIDM
GraphSetup: Graph_AxisLabelFont:,20,0~
SymbolSize:11~
Att_Stacked_Lines Graph_Primary_Valdim:0~
Att_GraphIndexRange Annual_Econ_Time:1,,0,,,,10,2021,2030,0~
Att_GraphValueRange Simple_LCOE_vs_Value:1,,1,,,,,0,0.21799230456352234,0~
Att_CatLineStyle Graph_Primary_Valdim:5~
Att_GraphIndexRange Cost_Forecast_Year:1,,1,,,,,2022.0101600289345,2031,0~
Graph_SymbolKey:0
ReformVal: [Cost_Forecast_Year,0]
NumberFormat: 2,F,4,3,0,1,4,1,$,0,"ABBREV",0,,,0,0,15,
Att__TotalsIndex: []
Att_ResultSliceState: [PV_Climate_Zone,1,System_Types,1,PV_Sectors,1,Area_Type,1,Self,1,Test_Cost_Multiplier,2,Cost_Forecast_Year,1]
{!40300|Att_SlicerPopupSize: 292,64}

Text Te1891843619
Title: Current modified approach for NYPA will not work for stand-alone storage, due to LCOE calculation methodology
NodeLocation: 892,504,-1
NodeSize: 124,80

Variable Cost_of_Elect_Ratio2
Title: Cost of Electricity Ratio
Units: post/pre ratio
Description: Ratio of the cost of electricity (for a solar PV system or paired solar + storage system) to the value of delivered electricity. A ratio less than 1 means that the levelized cost of an installed system is expected to be lower than the first-year value of solar.
Definition: Cost_of_Elect_Ratio[Annual_Econ_Time=Cost_Forecast_Year,@PV_Sectors=1] 
NodeLocation: 656,304,1
NodeSize: 64,40
WindState: 2,413,262,1025,450
ValueState: 2,475,28,741,629,1,MIDM
GraphSetup: SymbolSize:11~
Att_GraphIndexRange PV_Sectors:1,,0,,,,,1,7,1~
Graph_PlotAreaBrush:65280,65280,65280,2,1,65280,65280,65280~
Graph_TickDir:2~
Graph_KeyAreaBrush:65024,65024,65024~
Att_ContLineStyle Graph_Primary_Valdim:5~
Graph_FrameColor:20224,20224,20224~
Graph_GridColor:20224,20224,20224~
Graph_KeyTitleFont:,20,1~
Graph_KeyFont:,18,1~
Graph_AxisTitleFont:Arial,20,1~
Graph_KeyLabelColor:17408,29184,50176~
Graph_KeyTextColor:17408,29184,50176~
Graph_AxisLabelColor:17408,29184,50176~
Graph_AxisTitleColor:17408,29184,50176~
Att_GraphValueRange Cost_of_Elect_Ratio2:1,,1,,,,,1.320643737912178,2.707960143685341,0~
Grid:0~
Att_GraphIndexRange Annual_Econ_Time:1,,1,,,,10,2022.0709496736526,2032,0
ReformVal: [Cost_Forecast_Year,0]
NumberFormat: 2,F,1,2,0,0,1,1,$,0,"ABBREV",0,,,0,0,15,
Att__TotalsIndex: []
Att_ResultSliceState: [Area_Type,1,System_Types,1,PV_Climate_Zone,1,Test_Cost_Multiplier,2,Cost_Forecast_Year,1]

Close Annual_Cost_of_Syste

Close System_Economics

Module Equipment_Sizing
Title: Equipment Sizing
Author: JamesMilford
Date: Wed, Oct 10, 2018 9:00 AM
NodeLocation: 544,64,1
NodeSize: 64,40
NodeInfo: 1,0,0
DiagState: 2,104,31,1554,648,17,10
Aliases: Alias Al1548967120
NodeColor: 65535,65535,65535
AcpStyles: FrameNode: FrameNode_1544919879

Constant Battery_Storage_Spec
Title: Battery Storage Specs
Description: The technology specifications for a single unit of the battery storage device. Note that the energy storage capacity (in kWh) is prior to losses, so the usable energy will be equal to the capacity multiplied by the roundtrip efficiency. Most battery controllers limit the battery's charge level level to not fall outside a minimum and maximum percentage of the rated energy capacity.~
~
Residential are based on a Tesla Powerwall (Gen 2), while non-commercial are based on a Tesla Power Pack (Gen 2).~
~
Note: Tesla Powerpack specs 210kWh, 50kW, 88% (2hr system) or 89% (4hr system)~
~
Page 16 of SDGE's "Behind the Meter Battery Energy Storage System M&V" report (Aug 2019) states that controllers are configured to only allow the battery charge level to range between 5%-95% of the rated energy capacity.
Definition: Table(All_Sectors,Battery_Specs)(~
0.9,0.05,0.95,~
0.9,0.05,0.95,~
0.9,0.05,0.95,~
Null,Null,Null)
NodeLocation: 136,176,1
NodeSize: 64,40
WindState: 2,297,1,801,442
DefnState: 2,292,147,1157,717,0,DFNM
ValueState: 2,274,25,821,620,0,MIDM
Aliases: Alias Al1550183618, FormNode Fo1550183618, FormNode Fo1542305979, FormNode Fo1567093176
GraphSetup: Att_StackedBar Graph_Primary_Valdim:0~
Att_CatLineStyle Graph_Primary_Valdim:9
ReformDef: [Battery_Specs,All_Sectors]
ReformVal: [All_Sectors,Battery_Specs]
DisplayOutputs: Object Object, Object Decision
Att_GraphValueRange: 1,,,,,,10
Att_ResultSliceState: [Battery_Specs,1,Battery_Specs,3,All_Sectors,1]
Att_ColorRole: Null
{!40600|Att_ClusterIndex: Null}
{!40700|Att_CellFormat: CellFormats(CellSpan(Battery_Specs,CellNumberFormat('Percentage',2,0,0,dateFormat:'ABBREV',fullPrecision:0,numbersAsDates:0,datesAsNumbers:0),1,3,header:0))}

Variable Storage_Capacity
Title: Storage Capacity
Units: kWh/system
Description: The energy storage capacity of the battery system.
Definition: /*Battery_Storage_Spec[All_Sectors=PV_Sectors, Battery_Specs=Energy_kWh_Label]*/~
Storage_Max_Power * Hours_of_Storage_at_[All_System_Types=System_Types,All_PV_Sectors=PV_Sectors]
NodeLocation: 288,176,1
NodeSize: 64,40
WindState: 2,336,-7,720,350
ValueState: 2,670,169,804,696,0,MIDM
ReformVal: [System_Types,PV_Sectors]
NumberFormat: 2,F,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15,
Att_ResultSliceState: [PV_Climate_Zone,3,PV_Sectors,1,System_Types,1]

Variable Equipment_Sizes
Title: Equipment Sizes
Units: kW-DC/syst, kWh/syst
Description: The solar PV array size (in kW-DC) and storage size (in kWh) per system assumed for economics.
Definition: IF Equipment_Types = Solar_PV_Label~
THEN PV_DC_Size_by_System~
ELSE Storage_Capacity
NodeLocation: 560,176,1
NodeSize: 64,40
WindState: 2,5,42,875,350
DefnState: 2,883,249,416,303,,DFNM
ValueState: 2,1224,374,617,284,0,MIDM
NodeColor: 19661,48336,65535
GraphSetup: Att_StackedBar Graph_Primary_Valdim:0~
Att_CatLineStyle Graph_Primary_Valdim:9~
Att_GraphValueRange Equipment_Sizes:1,,1,,,,,0,5068.057179450989,0
ReformVal: [Equipment_Types,PV_Sectors]
Att__TotalsIndex: []
Att_ResultSliceState: [System_Types,1,Area_Type,1,PV_Climate_Zone,1,PV_Sectors,2,Equipment_Types,1]
Att_ColorRole: Null
{!40600|Att_ClusterIndex: Null}
{!50000|Att_ColumnWidths: [,All_Equipment_Types,\([179])]}

Variable PV_DC_Size_by_System
Title: PV DC Size by System Type
Units: kW-DC/system
Description: The solar PV system size in kW-DC.
Definition: PV_DC_System_Size_fo * Equip_Install_Map[All_Equipment_Types=Solar_PV_Label, All_System_Types=System_Types]
NodeLocation: 288,504,1
NodeSize: 64,40
WindState: 2,102,82,1085,492
ValueState: 2,385,149,1019,616,0,MIDM
ReformVal: [PV_Sectors,System_Types]
Att_ResultSliceState: [System_Types,2,Area_Type,1,PV_Climate_Zone,1,PV_Sectors,1]

Text Te1542300414
Title: Sizing for impact analysis
NodeLocation: 944,152,-1
NodeSize: 280,136
NodeInfo: 1,0,0,1,1,1,1,,0,,0,,,
NodeColor: 65535,65535,65535
NodeFont: Arial Narrow,15

FormNode Fo1542305979
Title: Battery Storage Specs
Definition: 0
NodeLocation: 136,228,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Battery_Storage_Spec

Variable PV_ACSystSize_byTime
Title: PV AC System Size by Time
Units: kW-AC/PVbldg unit
Description: The solar PV system size in kW-AC per PV building stock unit (eg, per building or per m2 or roofspace).
Definition: DC_Watts_per_m2_usab * kW_per_W * AC_to_DC_Ratio_by_PV
NodeLocation: 744,176,1
NodeSize: 64,40
WindState: 2,98,82,1467,427
ValueState: 2,919,426,603,278,0,MIDM
Aliases: Alias Al844149923, Alias Al565149219
ReformVal: [Time_Solar_PV,0]
Att_ResultSliceState: [PV_Spatial_ID,1,Area_Type,1,New_or_Retrofit,2,PV_Sectors,1]

Text Te1542841015
Title: Sizing for dispatch and hourly value analysis (not incentives/LCOE)
NodeLocation: 332,476,-4
NodeSize: 316,460
NodeInfo: 1,0,0,1,1,1,1,,0,,0,,,
NodeColor: 65535,65535,65535
NodeFont: Arial Narrow,15

Variable Storage_Max_Power
Title: Storage Max Power
Units: kW-AC/system
Description: The max charge/discharge rate of the battery system.
Definition: Fraction_of_Peak_for[All_System_Types=System_Types,All_PV_Sectors=PV_Sectors] * ~
Peak_basis_for_stora
NodeLocation: 288,272,1
NodeSize: 64,40
WindState: 2,12,-11,720,350
ValueState: 2,1131,423,469,248,0,MIDM
Aliases: Alias Al1969009827, Alias Al1807426659
NodeColor: 65535,1,1
ReformVal: [PV_Climate_Zone,PV_Sectors]
NumberFormat: 2,F,4,2,1,0,4,0,$,0,"ABBREV",0,,,0,0,15,
DisplayOutputs: Object Object, Object Variable
Att_ResultSliceState: [System_Types,3,Area_Type,1,PV_Sectors,1,PV_Climate_Zone,1]

Variable Hours_of_Storage
Title: Hours of Storage
Units: hours
Description: The number of hour of storage available.
Definition: Divide(Storage_Capacity, Storage_Max_Power, True)
NodeLocation: 440,272,1
NodeSize: 64,40
ValueState: 2,56,58,932,653,0,MIDM

Variable Charge_disch_eff
Title: Charge/discharge efficiency
Units: fraction
Description: Charge efficiency is assumed to be equal to discharge efficiency and is calculated as the square root of the round-trip efficiency of the battery system.
Definition: sqrt(Battery_Storage_Spec[All_Sectors=PV_Sectors, Battery_Specs=Roundtrip_Label])
NodeLocation: 296,80,1
NodeSize: 80,40
WindState: 2,-15,-11,720,350
ValueState: 2,695,213,384,587,0,MIDM
NumberFormat: 2,%,4,2,0,0,4,0,$,0,"ABBREV",0,,,0,0,15

Variable Min_Charge_Level
Title: Min Storage Charge Level
Units: fraction
Description: The minimum battery charge level as a percentage of the rated energy capacity.
Definition: Battery_Storage_Spec[All_Sectors=PV_Sectors, Battery_Specs=Min_SOC_Label]
NodeLocation: 136,80,1
NodeSize: 64,40
WindState: 2,-15,-11,720,350
NumberFormat: 2,%,4,2,0,0,4,0,$,0,"ABBREV",0,,,0,0,15

Variable Max_Charge_Level
Title: Max Storage Charge Level
Units: fraction
Description: The maximum battery charge level as a percentage of the rated energy capacity.
Definition: Battery_Storage_Spec[All_Sectors=PV_Sectors, Battery_Specs=Max_SOC_Label]
NodeLocation: 136,288,1
NodeSize: 64,40
WindState: 2,-15,-11,720,350
ValueState: 2,132,138,416,303,0,MIDM
NumberFormat: 2,%,4,2,0,0,4,0,$,0,"ABBREV",0,,,0,0,15

Constant Hours_of_Storage_at_
Title: Hours of Storage at Peak Output
Units: hrs
Description: The number of hours of energy storage at the rated max power of the storage system
Definition: Table(All_PV_Sectors,All_System_Types)(~
0,0,3,3,3,3,3,~
2,2,2,2,2,2,2,~
2,2,2,2,2,2,2)
NodeLocation: 448,80,1
NodeSize: 64,40
WindState: 2,195,92,720,522
DefnState: 2,786,138,574,474,0,DFNM
ValueState: 2,359,362,1508,203,0,MIDM
NodeColor: 65535,1,1
ReformDef: [All_PV_Sectors,All_System_Types]
TableCellDefault: 2
Att_EditSliceState: [All_System_Types,5,All_PV_Sectors,1]

Alias Al1968755747
Title: Peak Load
Definition: 1
NodeLocation: 144,504,1
NodeSize: 64,40
Original: Peak_Load

Constant Fraction_of_Peak_for
Title: Fraction of Peak for Storage Max
Units: kWstorage/kWpeak
Description: The fraction of the peak basis (either customer load, in AC, kW DC solar system size) assumed for battery sizing (where battery size is kW AC). ~
~
So units for this fraction are kW-AC storage / kW DC solar (for paired systems) or kW-AC storage / kW-AC peak load for stand-alone systems. ~
~
0.66 {median value from NY DER installations https://der.nyserda.ny.gov/search/ through about 2021} and is used for NonResidential. Residential uses JEA average for historical installations.~
~
<a href="https://resourceinnovation.sharepoint.com/:x:/r/sites/611140_NYPAProduct/Shared%20Documents/General/Modeling%20Files/DER/Raw%20Data%20Sets/DER%20Facilities%20in%20NY.xlsx?d=w43c8a0b32638488db1c66ff424c780e8&csf=1&web=1&e=QZg12t">https://resourceinnovation.sharepoint.com/:x:/r/sites/611140_NYPAProduct/Shared%20Documents/General/Modeling%20Files/DER/Raw%20Data%20Sets/DER%20Facilities%20in%20NY.xlsx?d=w43c8a0b32638488db1c66ff424c780e8&csf=1&web=1&e=QZg12t</a>
Definition: Table(All_PV_Sectors,All_System_Types)(~
0,0,0.74,0.74,0.74,0.74,0.74,~
1,1,1,1,1,1,1,~
1,1,1,1,1,1,1)
NodeLocation: 584,80,1
NodeSize: 64,40
WindState: 2,547,109,720,350
DefnState: 2,1133,196,599,336,0,DFNM
ValueState: 2,375,378,1524,214,0,MIDM
Aliases: Alias Al568492323
NodeColor: 65535,1,1
ReformDef: [All_PV_Sectors,All_System_Types]
TableCellDefault: 1

Variable Peak_basis_for_stora
Title: Peak basis for storage sizing
Units: kW
Description: The kw basis for sizing a storage system, since storage system sizing is assumed to be proportional to either the PV system size (for paired systems) or peak customer load (for storage only systems).~
~
Peak basis will be AC for a storage only system and DC for a solar paired system
Definition: IF System_with_PV THEN PV_DC_Size_by_System ELSE Peak_Load
NodeLocation: 288,392,1
NodeSize: 64,40
WindState: 2,882,140,720,350
ValueState: 2,578,521,1033,230,0,MIDM
ReformVal: [PV_Sectors,System_Types]

Alias Al1442611491
Title: System with PV
Definition: 1
NodeLocation: 136,392,1
NodeSize: 64,40
NodeColor: 65535,1,1
Original: System_with_PV

Module Old3
Title: Old
Author: CWelch
Date: Thu, May 4, 2023 10:19 AM
NodeLocation: 736,368,1
NodeSize: 64,40

Alias Al1542828348
Title: Forecast AC System Size by Zip
Definition: 1
NodeLocation: 176,64,1
NodeSize: 64,40
NodeColor: 65535,1,1
Original: Forecast_AC_System_S

Variable NewConstr_AC_SysSize
Title: NewConstr AC System Size
Units: CEC-kW-AC/system
Description: The AC system size for new construction once new construction requirements becomes active.
Definition: IF Time_Solar_PV < NewConstr_Code_Sys_S[NewConstr_Code_Param=CodeCompDate_Label, All_Sectors=PV_Sectors,PV_Climate_Zone=Climate_Zone_Map]~
THEN Forecast_AC_System_S~
ELSE NewConstr_Code_Sys_S[PV_Climate_Zone=Climate_Zone_Map,All_Sectors=PV_Sectors,NewConstr_Code_Param=ForceSysSize_Label] / DC_to_AC_Ratio[PV_Climate_Zone=Climate_Zone_Map, All_Sectors=PV_Sectors]
NodeLocation: 176,160,1
NodeSize: 64,40
WindState: 2,2,38,720,350
ValueState: 2,195,52,1309,743,0,MIDM
GraphSetup: Att_GraphIndexRange PV_Spatial_ID:1,1~
Att_CatLineStyle Graph_Primary_Valdim:5
Att_ResultSliceState: [PV_Spatial_ID,3,Area_Type,1,PV_Sectors,1,Time_Solar_PV,1]

Alias Al1542831105
Title: CEC-kW-AC per Bldg Unit
Definition: 1
NodeLocation: 336,64,1
NodeSize: 64,40
Original: kW_AC_per_PV_stock_U

Variable Historical_based_PV_
Title: Historical based PV AC Sys Size
Description: The solar PV system size in kW-AC per building stock unit (eg, per building or per m2 or roofspace).
Definition: {IF (New_or_Retrofit=NewConstr_Label) AND (PV_Stock_Basis_by_Se[All_Sectors=PV_Sectors]=Buildings_Label)~
THEN NewConstr_AC_SysSize~
ELSE} kW_AC_per_PV_stock_U
NodeLocation: 336,160,1
NodeSize: 64,40
ValueState: 2,309,321,907,550,,MIDM
Att_ResultSliceState: [PV_Sectors,2,New_or_Retrofit,1,PV_Spatial_ID,1,Time_Solar_PV,1]

Index NewConstr_Code_Param
Att_PrevIndexValue: ['Code Compliance Date','Forced System Size (kW DC), if applicable']
Title: NewConstr Code Parameter
Definition: ['Code Compliance Date','Forced System Size (kW DC), if applicable']
NodeLocation: 464,336,1
NodeSize: 64,40
DisplayOutputs: Object Object, Object Decision
{!40300|Att_SlicerPopupSize: 267,48}

Decision CodeCompDate_Label
Title: CodeCompDate Label
Definition: Choice(NewConstr_Code_Param,1,0)
NodeLocation: 112,392,1
NodeSize: 64,40
NodeInfo: 1,,,,,,,0,,,,,,0

Decision ForceSysSize_Label
Title: ForceSysSize Label
Definition: Choice(NewConstr_Code_Param,2,0)
NodeLocation: 280,424,1
NodeSize: 64,40
NodeInfo: 1,,,,,,,0,,,,,,0

Variable NewConstrCode_Defaul
Title: NewConstrCode Default
Definition: Table(NewConstr_Code_Param)(1-Jan-2055,0)
NodeLocation: 256,288,1
NodeSize: 72,40
DefnState: 2,580,586,818,303,0,DFNM
ReformDef: [NewConstr_Code_Param,Undefined]

Decision Peak_kW_basis_for_St
Title: Peak kW basis for Storage Sizing
Units: kW/system
Definition: Table(All_System_Types)(0,0,0,0,0,0,0)
NodeLocation: 464,432,1
NodeSize: 64,40
DefnState: 2,1370,483,416,303,0,DFNM
ValueState: 2,1263,451,416,303,0,MIDM

Close Old3

Close Equipment_Sizing

Alias Al1538428922
Title: Import Interconnection Data
Definition: 1
NodeLocation: 400,384,1
NodeSize: 64,40
NodeInfo: 1,0,0
NodeColor: 58982,58982,58982
Original: Import_Interconnecti

Module PV_Auxiliary_Variabl
Title: PV Auxiliary Variables
Author: JamesMilford
Date: Wed, Oct 24, 2018 4:58 PM
NodeLocation: 256,288,1
NodeSize: 64,40
NodeInfo: 1,0,0
DiagState: 2,0,34,1818,684,17,10
NodeColor: 57311,57311,57311
AcpStyles: Show_Object:no

Variable RateVint_by_RateName
Title: Rate Vintage for Rate Name
Description: The rate vintage corresponding to the post-system rate name and date. If this returns a Null value, it indicates that the rate name corresponds to a pre-system.
Definition: SubIndex(Selected_Cust_Rates[Pre_and_Post_System=Post_System_Label], Rate_Names_and_Start, Rate_Vintage)
NodeLocation: 384,1464,1
NodeSize: 64,40
ValueState: 2,635,484,1151,292,0,MIDM
ReformVal: [Pre_and_Post_System,Rate_Names_and_Start]
Att_ResultSliceState: [PV_Sectors,1,Rate_Names_and_Start,1,PV_Climate_Zone,1]

Index Rate_Names_and_Start
Att_PrevIndexValue: ['VA -1 (Residential Service) | 2022-01','VA -1 (Residential Service) + Net Metering T&C | 2022-01','VA -GS2(Commercial Service Demand) | 2022-01','VA -GS2(Commercial Service Demand) | 2022-01 TEST','VA -GS3(Industrial Service) | 2022-01','VA -GS3(Industrial Service) + Net Metering T&C | 2022-01']
Title: Rate Names and Start Dates
Definition: VAR names:=MdArrayToTable(Selected_Cust_Rates, omitNull: True);~
VAR lastCol:=Size(names.Col);~
INDEX all_names:=CopyIndex(names[@.Col=lastCol]);~
INDEX uniqNames:=Unique(all_Names);~
INDEX sorted:=SortIndex(uniqNames);~
Subset(sorted <> None_Label)
NodeLocation: 384,1192,1
NodeSize: 64,40
WindState: 2,2146,81,1165,697
ValueState: 2,908,442,659,261,0,MIDM
{!40300|Att_SlicerPopupSize: 1727,522}

Text Te1545165196
Description: Currently chooses the rate name for the post-system, which doesn't tell you the pre-system if they are different.
NodeLocation: 384,1740,-1
NodeSize: 112,52
NodeInfo: 1,0,0,1,0,1,0,,0,,0,,,
NodeColor: 57311,57311,57311
AcpStyles: Show_Object:no

Variable ClimateZone_for_Rate
Title: Climate Zone for Rate Name
Description: The climate zone for each rate name. If multiple climate zones are applicable to the same rate name (eg, non-residential rates), then the last possible climate zone is returned. For this reason, this mapping cannot be applied to results that differ by climate zone for the same rate name. If this returns a Null value, it indicates that the rate name corresponds to a pre-system.
Definition: Replace_X_with_Y(JoinText(SubIndex(RateVint_by_RateName, Rate_Vintage, PV_Climate_Zone), Rate_Vintage), "", Null)
NodeLocation: 384,1552,1
NodeSize: 64,40
WindState: 2,311,484,720,350
ValueState: 2,240,13,945,771,0,MIDM
ReformVal: [PV_Sectors,Rate_Names_and_Start]
Att_ResultSliceState: [PV_Sectors,1,Rate_Names_and_Start,1,Rate_Vintage,1]

Variable Sector_for_Rate_Name
Title: Sector for Rate Name
Description: The sector that applies to each rate name.  If this returns a Null value, it indicates that the rate name corresponds to a pre-system.
Definition: SubIndex(ClimateZone_for_Rate <> Null, 1, PV_Sectors)
NodeLocation: 384,1640,1
NodeSize: 64,40
ValueState: 2,573,306,551,613,0,MIDM

Index All_Rates_and_Dates
Title: All Rate Names and Start Dates
Definition: VAR selectNames:=Select_Customer_Rate[Rate_Setting=Name_Setting_Label];~
VAR names:=MdArrayToTable(selectNames, omitNull: True);~
VAR lastCol:=Size(names.Col);~
INDEX all_names:=CopyIndex(names[@.Col=lastCol]);~
INDEX uniqNames:=Unique(all_Names);~
INDEX sorted:=SortIndex(uniqNames);~
Subset(sorted <> None_Label)
NodeLocation: 384,1280,1
NodeSize: 64,40
WindState: 2,14,58,1165,697
ValueState: 2,776,322,649,416,0,MIDM
{!40300|Att_SlicerPopupSize: 807,308}

Constant Num_Incent_Dur_Steps
Title: Number of Incentive Duration Steps
Description: Specify the number of steps (ie, marginal brackets) in the incentive as a function of storage duration.
Definition: 3
NodeLocation: 1840,264,1
NodeSize: 64,40
Aliases: Alias Al1550726181, FormNode Fo1550726182, FormNode Fo1548706815

Index Incent_Duration_Step
Att_PrevIndexValue: [1,2,3]
Title: Incentive Duration Step
Definition: 1..Num_Incent_Dur_Steps
NodeLocation: 1840,376,1
NodeSize: 64,40
DisplayOutputs: Object Object, Object Decision

FormNode Fo1548706815
Title: Number of Incentive Duration Steps
Definition: 0
NodeLocation: 1840,316,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Num_Incent_Dur_Steps

Index Incent_Durat_Inputs
Att_PrevIndexValue: ['Storage Duration Lower Bound (hours)','Incentive Rate (Pct. of Base)']
Title: Incentive Duration Inputs
Definition: ['Storage Duration Lower Bound (hours)','Incentive Rate (Pct. of Base)']
NodeLocation: 1840,928,1
NodeSize: 64,40
DisplayOutputs: Object Object, Object Decision

Function AvgRate_Across_Brack(binLowLimit, binValue, lookupVal; binIndex: Index)
Title: Avg Rate Across Brackets
Description: Finds the average rate when different marginal rates are applied to different bins of values. For example, in the following table we have two different marginal rates (15% and 20%). The 15% rate is applicable to values ranging from 0 to 100, while the 20% rate is applicable to all values above 100. Thus, if the lookupVal is 150, this will return a weighted average rate of 16.67% = (15% * 100 + 20% * 50) / 150.~
~
binIndex	binLowLimit		binValue~
1			0				15%~
2			100				20%~
~
[binLowLimit]: the lower limit on the bin range~
[binValue]: the marginal rate associated with each bin~
[lookupVal]: the value whose average rate you're trying to determine~
[binIndex]: the index used to define each bin
Definition: VAR binHighLimit:=IF @binIndex = Size(binIndex)~
   THEN INF~
   ELSE binLowLimit[@binIndex=@binIndex+1];~
VAR binSize:=binHighLimit - binLowLimit;~
VAR cumulQty:=0;~
VAR cumulVal:=0;~
~
FOR J:=@binIndex DO (~
   VAR binQty:=Replace_X_with_Y(MIN([binSize[@binIndex=J], lookupVal - cumulQty]), INF, 0);~
   cumulQty:=cumulQty + binQty;~
   VAR wtdQty:=binQty * binValue[@binIndex=J];~
   cumulVal:=cumulVal + wtdQty;~
);~
~
Divide(cumulVal, lookupVal, True)~

NodeLocation: 1840,1104,1
NodeSize: 64,40
WindState: 2,283,126,1043,576

Constant Num_Incent_Cap_Steps
Title: Number of Incentive Capacity Steps
Description: Specify the number of steps (ie, marginal brackets) in the incentive as a function of storage capacity size.
Definition: 5
NodeLocation: 1840,464,1
NodeSize: 64,40
WindState: 2,340,265,720,350
Aliases: Alias Al1550726184, FormNode Fo1550726185, FormNode Fo1548708353

Index Incent_Capacity_Step
Att_PrevIndexValue: [1,2,3,4,5]
Title: Incentive Capacity Step
Definition: 1..Num_Incent_Cap_Steps
NodeLocation: 1840,576,1
NodeSize: 64,40
DisplayOutputs: Object Object, Object Decision

FormNode Fo1548708353
Title: Number of Incentive Duration Steps
Definition: 0
NodeLocation: 1840,516,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Num_Incent_Cap_Steps

Index Incent_MWhCap_Inputs
Att_PrevIndexValue: ['Storage Capacity Lower Bound (MWh)','Incentive Rate (Pct. of Base)']
Title: Incentive MWh Capacity Inputs
Definition: ['Storage Capacity Lower Bound (MWh)','Incentive Rate (Pct. of Base)']
IndexVals: ['item 1']
NodeLocation: 1840,840,1
NodeSize: 64,40
DisplayOutputs: Object Object, Object Decision

Index Incentive_Steps
Att_PrevIndexValue: [1,2,3,4,5,6,7,8]
Title: Incentive Steps
Definition: 1..Num_Incentive_Steps
NodeLocation: 1832,176,1
NodeSize: 64,40
WindState: 2,11,94,875,306
DisplayOutputs: Object Object, Object Decision

Index ITC_Applied
Att_PrevIndexValue: ['Yes','No']
Title: ITC Applied
Definition: ['Yes','No']
NodeLocation: 1840,664,1
NodeSize: 64,40
DisplayOutputs: Object Object, Object Decision
{!40300|Att_SlicerPopupSize: 227,48}

Index Incentive_Start_Time
Att_PrevIndexValue: ['None',1-Jan-2002,1-Feb-2002,1-Mar-2002,1-Apr-2002,1-May-2002,1-Jun-2002,1-Jul-2002,1-Aug-2002,1-Sep-2002,1-Oct-2002,1-Nov-2002,1-Dec-2002,1-Jan-2003,1-Feb-2003,1-Mar-2003,1-Apr-2003,1-May-2003,1-Jun-2003,1-Jul-2003,1-Aug-2003,1-Sep-2003,1-Oct-2003,1-Nov-2003,1-Dec-2003,1-Jan-2004,1-Feb-2004,1-Mar-2004,1-Apr-2004,1-May-2004,1-Jun-2004,1-Jul-2004,1-Aug-2004,1-Sep-2004,1-Oct-2004,1-Nov-2004,1-Dec-2004,1-Jan-2005,1-Feb-2005,1-Mar-2005,1-Apr-2005,1-May-2005,1-Jun-2005,1-Jul-2005,1-Aug-2005,1-Sep-2005,1-Oct-2005,1-Nov-2005,1-Dec-2005,1-Jan-2006,1-Feb-2006,1-Mar-2006,1-Apr-2006,1-May-2006,1-Jun-2006,1-Jul-2006,1-Aug-2006,1-Sep-2006,1-Oct-2006,1-Nov-2006,1-Dec-2006,1-Jan-2007,1-Feb-2007,1-Mar-2007,1-Apr-2007,1-May-2007,1-Jun-2007,1-Jul-2007,1-Aug-2007,1-Sep-2007,1-Oct-2007,1-Nov-2007,1-Dec-2007,1-Jan-2008,1-Feb-2008,1-Mar-2008,1-Apr-2008,1-May-2008,1-Jun-2008,1-Jul-2008,1-Aug-2008,1-Sep-2008,1-Oct-2008,1-Nov-2008,1-Dec-2008,1-Jan-2009,1-Feb-2009,1-Mar-2009,1-Apr-2009,1-May-2009,1-Jun-2009,1-Jul-2009,1-Aug-2009,1-Sep-2009,1-Oct-2009,1-Nov-2009,1-Dec-2009,1-Jan-2010,1-Feb-2010,1-Mar-2010,1-Apr-2010,1-May-2010,1-Jun-2010,1-Jul-2010,1-Aug-2010,1-Sep-2010,1-Oct-2010,1-Nov-2010,1-Dec-2010,1-Jan-2011,1-Feb-2011,1-Mar-2011,1-Apr-2011,1-May-2011,1-Jun-2011,1-Jul-2011,1-Aug-2011,1-Sep-2011,1-Oct-2011,1-Nov-2011,1-Dec-2011,1-Jan-2012,1-Feb-2012,1-Mar-2012,1-Apr-2012,1-May-2012,1-Jun-2012,1-Jul-2012,1-Aug-2012,1-Sep-2012,1-Oct-2012,1-Nov-2012,1-Dec-2012,1-Jan-2013,1-Feb-2013,1-Mar-2013,1-Apr-2013,1-May-2013,1-Jun-2013,1-Jul-2013,1-Aug-2013,1-Sep-2013,1-Oct-2013,1-Nov-2013,1-Dec-2013,1-Jan-2014,1-Feb-2014,1-Mar-2014,1-Apr-2014,1-May-2014,1-Jun-2014,1-Jul-2014,1-Aug-2014,1-Sep-2014,1-Oct-2014,1-Nov-2014,1-Dec-2014,1-Jan-2015,1-Feb-2015,1-Mar-2015,1-Apr-2015,1-May-2015,1-Jun-2015,1-Jul-2015,1-Aug-2015,1-Sep-2015,1-Oct-2015,1-Nov-2015,1-Dec-2015,1-Jan-2016,1-Feb-2016,1-Mar-2016,1-Apr-2016,1-May-2016,1-Jun-2016,1-Jul-2016,1-Aug-2016,1-Sep-2016,1-Oct-2016,1-Nov-2016,1-Dec-2016,1-Jan-2017,1-Feb-2017,1-Mar-2017,1-Apr-2017,1-May-2017,1-Jun-2017,1-Jul-2017,1-Aug-2017,1-Sep-2017,1-Oct-2017,1-Nov-2017,1-Dec-2017,1-Jan-2018,1-Feb-2018,1-Mar-2018,1-Apr-2018,1-May-2018,1-Jun-2018,1-Jul-2018,1-Aug-2018,1-Sep-2018,1-Oct-2018,1-Nov-2018,1-Dec-2018,1-Jan-2019,1-Feb-2019,1-Mar-2019,1-Apr-2019,1-May-2019,1-Jun-2019,1-Jul-2019,1-Aug-2019,1-Sep-2019,1-Oct-2019,1-Nov-2019,1-Dec-2019,1-Jan-2020,1-Feb-2020,1-Mar-2020,1-Apr-2020,1-May-2020,1-Jun-2020,1-Jul-2020,1-Aug-2020,1-Sep-2020,1-Oct-2020,1-Nov-2020,1-Dec-2020,1-Jan-2021,1-Feb-2021,1-Mar-2021,1-Apr-2021,1-May-2021,1-Jun-2021,1-Jul-2021,1-Aug-2021,1-Sep-2021,1-Oct-2021,1-Nov-2021,1-Dec-2021,1-Jan-2022,1-Feb-2022,1-Mar-2022,1-Apr-2022,1-May-2022,1-Jun-2022,1-Jul-2022,1-Aug-2022,1-Sep-2022,1-Oct-2022,1-Nov-2022,1-Dec-2022,1-Jan-2023,1-Feb-2023,1-Mar-2023,1-Apr-2023,1-May-2023,1-Jun-2023,1-Jul-2023,1-Aug-2023,1-Sep-2023,1-Oct-2023,1-Nov-2023,1-Dec-2023,1-Jan-2024,1-Feb-2024,1-Mar-2024,1-Apr-2024,1-May-2024,1-Jun-2024,1-Jul-2024,1-Aug-2024,1-Sep-2024,1-Oct-2024,1-Nov-2024,1-Dec-2024,1-Jan-2025,1-Feb-2025,1-Mar-2025,1-Apr-2025,1-May-2025,1-Jun-2025,1-Jul-2025,1-Aug-2025,1-Sep-2025,1-Oct-2025,1-Nov-2025,1-Dec-2025,1-Jan-2026,1-Feb-2026,1-Mar-2026,1-Apr-2026,1-May-2026,1-Jun-2026,1-Jul-2026,1-Aug-2026,1-Sep-2026,1-Oct-2026,1-Nov-2026,1-Dec-2026,1-Jan-2027,1-Feb-2027,1-Mar-2027,1-Apr-2027,1-May-2027,1-Jun-2027,1-Jul-2027,1-Aug-2027,1-Sep-2027,1-Oct-2027,1-Nov-2027,1-Dec-2027,1-Jan-2028,1-Feb-2028,1-Mar-2028,1-Apr-2028,1-May-2028,1-Jun-2028,1-Jul-2028,1-Aug-2028,1-Sep-2028,1-Oct-2028,1-Nov-2028,1-Dec-2028,1-Jan-2029,1-Feb-2029,1-Mar-2029,1-Apr-2029,1-May-2029,1-Jun-2029,1-Jul-2029,1-Aug-2029,1-Sep-2029,1-Oct-2029,1-Nov-2029,1-Dec-2029,1-Jan-2030,1-Feb-2030,1-Mar-2030,1-Apr-2030,1-May-2030,1-Jun-2030,1-Jul-2030,1-Aug-2030,1-Sep-2030,1-Oct-2030,1-Nov-2030,1-Dec-2030,1-Jan-2031,1-Feb-2031,1-Mar-2031,1-Apr-2031,1-May-2031,1-Jun-2031,1-Jul-2031,1-Aug-2031,1-Sep-2031,1-Oct-2031,1-Nov-2031,1-Dec-2031]
Title: Incentive Start Times
Definition: Concat(None_Label, PV_Sim_Strt_Yr_Opt)
NodeLocation: 1840,1016,1
NodeSize: 64,40

Constant Num_Incentive_Steps
Title: Number of Incentive Steps
Description: Specify the number of steps for incentive for incentive base rates.
Definition: 8
NodeLocation: 1832,64,1
NodeSize: 64,40
WindState: 2,27,216,720,350
Aliases: Alias Al1550726187, FormNode Fo1550726188, FormNode Fo1548887199

FormNode Fo1548887199
Title: Number of Incentive Duration Steps
Definition: 0
NodeLocation: 1832,116,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Num_Incentive_Steps

Index PV_Sectors
Att_PrevIndexValue: ['Residential','Commercial','Industrial']
Title: PV Sectors
Description: The sectors selected for the PV analysis.
Definition: MultiChoice(All_PV_Sectors,returnList:1)
NodeLocation: 1536,344,1
NodeSize: 64,40
WindState: 2,319,12,1255,632
Aliases: FormNode Fo1535066238, FormNode Fo1539140368, FormNode Fo1247325693
NumberFormat: 2,F,4,6,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
DisplayOutputs: Object Object, Object Function, Object Variable, Function Sequential_Opt_PV0, Function Aggregate_Optimizati, Function Set_Start_Coeff_PV0, Function Sequential_Opt_PV2, Function OG_Sequential_Optimi
Att_GraphIndexRange: 1,,0,,,,,1,11,1
{!50400|Att_AxisOrKeyTitle: ""}
{!40300|Att_SlicerPopupSize: 1663,353}
OnChange: Set_Optimization_Sec()

FormNode Fo1539140368
Title: PV Sectors
Definition: 0
NodeLocation: 1536,400,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,0
Original: PV_Sectors

Index PV_Spatial_ID
Title: PV Spatial ID
Description: MultiChoice(All_Spatial_ID, allowNone:0, returnList:1)
Definition: MultiChoice(Spatial_ID,1,returnList:1)
NodeLocation: 1536,64,1
NodeSize: 64,40
WindState: 2,46,71,816,730
DefnState: 2,857,228,346,508,,DFNM
ValueState: 2,2185,301,416,303,,MIDM
Aliases: FormNode Fo1535655040, FormNode Fo1542091914
DisplayOutputs: Object Object, Object Function, Object Variable, Function Sequential_Opt_PV0, Function Aggregate_Optimizati, Function MultiStage_CalibrPV0, Function Set_Start_Coeff_PV0, Function Sequential_Opt_PV2, Function OG_Multi_Stage_Calib, Function OG_Sequential_Optimi
{!50400|Att_AxisOrKeyTitle: ""}
{!40300|Att_SlicerPopupSize: 1360,784}

Index Market_Share_Metric
Att_PrevIndexValue: ['Cost of Electricity Ratio','Simple Payback Time','Static Long-Run Market Share']
Title: Market Share Metric
Definition: ['Cost of Electricity Ratio','Simple Payback Time','Static Long-Run Market Share']
NodeLocation: 960,384,1
NodeSize: 64,40

Decision Payback_Label
Title: Payback Label
Definition: Choice(Market_Share_Metric,2,1)
NodeLocation: 960,472,1
NodeSize: 64,40
Aliases: FormNode Fo1542088327

Index Competing_Systems
Title: Competing Systems
Definition: Concat(System_Types, Grid_Label)
NodeLocation: 960,784,1
NodeSize: 64,40
WindState: 2,102,82,1090,454
ValueState: 2,1180,397,336,216,0,MIDM
{!40300|Att_SlicerPopupSize: 255,157}

Decision Grid_Label
Title: Grid Label
Definition: 'Grid Electricity'
NodeLocation: 960,872,1
NodeSize: 64,40

Index Payback_Intervals
Title: Payback Time Intervals
Units: years
Definition: 0..30
NodeLocation: 960,696,1
NodeSize: 64,40
Att_GraphIndexRange: 1,,,,,,10

Index Installation_Types
Title: Installation Types
Definition: Subset(Sum(Construct_Type_Map[All_System_Types=Competing_Systems], Competing_Systems))
NodeLocation: 960,960,1
NodeSize: 64,40
WindState: 2,169,154,985,544
DisplayOutputs: Object Object, Object Variable
{!40300|Att_SlicerPopupSize: 267,42}

Index Annual_Econ_Time
Att_PrevIndexValue: [2015,2016,2017,2018,2019,2020,2021,2022,2023,2024,2025,2026,2027,2028,2029,2030,2031,2032,2033,2034,2035,2036,2037,2038,2039,2040,2041,2042,2043,2044,2045,2046,2047,2048,2049,2050,2051,2052]
Title: Annual Economic Time
Description: Starts one year prior to the minimum of PV or BESS simulation start years, so that annual economic calculations can be treated as middle-of-year values.
Definition: (MIN([DatePart(BESS_Calibrat_Start, 'Y'), DatePart(PV_Calibration_Start, 'Y')])-1)..MAX([DatePart(BESS_Sim_End_Year, 'Y'), DatePart(PV_Sim_End_Year, 'Y')])
NodeLocation: 384,544,1
NodeSize: 64,40
WindState: 2,228,3,1362,905
ValueState: 2,472,240,832,491,0,MIDM
Att_GraphIndexRange: 1,,,,,,10
{!40300|Att_SlicerPopupSize: 367,336}

Variable BOY_Date_for_Econ_Yr
Title: BOY Date for Econ Year
Description: The date associated with the beginning of the economic year (BOY).
Definition: BOY_Date_StaticPV_Yr[Static_PV_Time=Annual_Econ_Time]
NodeLocation: 384,632,1
NodeSize: 64,40
WindState: 2,101,420,720,350
ValueState: 2,12,148,416,504,0,MIDM

Index Rate_Vintage
Att_PrevIndexValue: [1]
Title: Rate Vintage
Definition: [1]
NodeLocation: 384,1016,1
NodeSize: 64,40
WindState: 2,98,82,1059,632
{!40300|Att_SlicerPopupSize: 377,140}

Index Rate_Names_with_None
Att_PrevIndexValue: ['None','1 Residential Service | 2012-01','1 Residential Service | 2016-01','NC -1 (Residential Service) | 2019-11','NC -5 (Commercial Service) | 2019-11','NC -6L (Industrial Service) | 2019-11','SC -16 (Commercial Service Time-Of-Use) + Solar Choice Rider | 2023-05','SC -20 (Industrial Service) | 2023-05','SC -20 (Industrial Service) + Rate PR-Standard Offer | 2023-05','SC -5 (Residential Service Time-Of-Use) + Solar Choice Rider | 2023-05','SC -8 (Residential Service) | 2023-05','SC -9 (Commercial Service) | 2023-05','VA -1 (Residential Service) | 2022-01','VA -1 (Residential Service) + Net Metering T&C | 2022-01','VA -GS2(Commercial Service Demand) | 2022-01','VA -GS2(Commercial Service Non-Demand) + Net Metering T&C | 2022-01','VA -GS3(Industrial Service) | 2022-01','VA -GS3(Industrial Service) + Net Metering T&C | 2022-01']
Title: Rate Names with None
Definition: Concat(None_Label, Rate_Names)
NodeLocation: 384,1104,1
NodeSize: 64,40
WindState: 2,2053,82,720,350
ValueState: 2,747,118,600,464,,MIDM

Decision Map_Charges_to_Sect
Title: Map Charges to Sector
Units: boolean
Description: Flag the bill components that are relevant to each sector.
Definition: Table(All_Sectors,Bill_Components)(~
Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),~
Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),~
Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),~
Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1))
NodeLocation: 96,704,1
NodeSize: 64,40
DefnState: 2,865,261,776,436,0,DFNM
ValueState: 2,148,154,715,524,0,MIDM
Aliases: FormNode Fo1534997100, FormNode Fo1657194771
NodeColor: 65535,65531,1
ReformDef: [All_Sectors,Bill_Components]
ReformVal: [All_Sectors,Bill_Components]
TableCellDefault: Checkbox(1)

FormNode Fo1534997100
Title: Map Charges to Sector
Definition: 0
NodeLocation: 96,748,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Map_Charges_to_Sect

Index PV_Climate_Zone
Att_PrevIndexValue: ['Whole State']
Title: PV Climate Zone
Definition: ['Whole State']
NodeLocation: 960,64,1
NodeSize: 64,40
WindState: 2,707,203,665,594
ValueState: 2,491,274,416,303,,MIDM
DisplayOutputs: Object Object, Object Variable, Object Decision
{!50400|Att_AxisOrKeyTitle: ""}
{!40300|Att_SlicerPopupSize: 907,84}

Constant All_Spatial_ID_to_CZ
Title: All Spatial ID to CZ Map
Definition: Table(All_Spatial_ID)('Whole State','Whole State','Whole State')
NodeLocation: 960,152,1
NodeSize: 64,40
WindState: 2,2679,167,720,350
DefnState: 2,2409,378,590,258,0,DFNM
ValueState: 2,1103,362,565,291,0,MIDM
Aliases: Alias Al1551412556, FormNode Fo1551412556, Alias Al1159025699, FormNode Fo1540240591
DisplayOutputs: Object Object, Object Decision

Variable Climate_Zone_Map
Title: Climate Zone Map
Definition: All_Spatial_ID_to_CZ[All_Spatial_ID=PV_Spatial_ID]
NodeLocation: 960,264,1
NodeSize: 64,40
ValueState: 2,2835,428,590,205,0,MIDM
DisplayOutputs: Object Object, Object Variable

Index All_Technologies
Att_PrevIndexValue: ['Solar PV','Solar PV + Storage']
Title: All Technologies
Definition: ['Solar PV','Solar PV + Storage']
NodeLocation: 672,64,1
NodeSize: 64,40

Index Static_PV_Time
Att_PrevIndexValue: [2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024,2025,2026,2027,2028,2029,2030,2031,2032,2033,2034,2035,2036,2037,2038,2039,2040,2041,2042,2043,2044,2045,2046,2047,2048,2049,2050,2051,2052]
Title: Static PV Time
Definition: PV_Static_Start_Year..PV_Static_End_Year
NodeLocation: 384,272,1
NodeSize: 64,40
WindState: 2,98,82,1097,834
ValueState: 2,372,378,425,504,,MIDM
DisplayOutputs: Object Object, Object Decision
Att_GraphIndexRange: 1,,,,,,10
{!50400|Att_AxisOrKeyTitle: ""}
{!40300|Att_SlicerPopupSize: 227,378}

Index Incentive_Source
Title: Incentive Source
Definition: ['Local','State','Federal','Utility']
NodeLocation: 96,64,1
NodeSize: 64,40

Index Incentive_Type
Title: Incentive Type
Definition: ['Upfront ','Performance-Based']
NodeLocation: 96,152,1
NodeSize: 64,40

Index Tax_Entity
Att_PrevIndexValue: ['State','Federal']
Title: Tax Entity
Definition: ['State','Federal']
NodeLocation: 1248,64,1
NodeSize: 64,40
DisplayOutputs: Object Object, Object Decision

Index PV_Operating_Year
Att_PrevIndexValue: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]
Title: PV Operating Year
Definition: 1..Economic_Lifetime
NodeLocation: 384,896,1
NodeSize: 64,40
WindState: 2,219,71,1086,715
ValueState: 2,632,289,416,303,,MIDM
DisplayOutputs: Object Object, Object Decision
{!40300|Att_SlicerPopupSize: 282,294}

Index All_Equipment_Types
Att_PrevIndexValue: ['Solar PV','Battery Storage']
Title: All Equipment Types
Definition: ['Solar PV','Battery Storage']
NodeLocation: 1104,64,1
NodeSize: 64,40
DisplayOutputs: Object Object, Object Decision
{!40300|Att_SlicerPopupSize: 272,28}

Index Equipment_Types
Title: Equipment Types
Definition: Subset(Sum(Equip_Install_Map[All_System_Types=System_Types], System_Types))
NodeLocation: 1104,360,1
NodeSize: 64,40
{!40300|Att_SlicerPopupSize: 347,56}

Decision Federal_Label
Title: Federal Label
Definition: Choice(Tax_Entity,2,0)
NodeLocation: 1248,152,1
NodeSize: 64,40
Aliases: FormNode Fo1540240592

Decision State_Label
Title: State Label
Definition: Choice(Tax_Entity,1,0)
NodeLocation: 1248,256,1
NodeSize: 64,40
Aliases: FormNode Fo1540240593

Index Loan_Term_Months
Title: Loan Term Months
Definition: 1..Loan_Term
NodeLocation: 96,240,1
NodeSize: 64,40

Index Cost_Component
Att_PrevIndexValue: ['Utility Bill','Loan Payments','O&M','Interconnect Fee','Depreciation Deduction','Interest Deduction','OpEx Deductions','Net Costs']
Title: Cost Component
Definition: ['Utility Bill','Loan Payments','O&M','Interconnect Fee','Depreciation Deduction','Interest Deduction','OpEx Deductions','Net Costs']
IndexVals: ['item 1']
NodeLocation: 96,376,1
NodeSize: 64,40
{!40300|Att_SlicerPopupSize: 302,140}

Decision Map_Costs_to_Sector
Title: Map Costs to Sector
Units: boolean
Description: Flags the costs that are relevant to each sector.
Definition: Table(All_Sectors,Cost_Component)(~
Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),~
Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),~
Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),~
Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1))
NodeLocation: 96,464,1
NodeSize: 64,40
WindState: 2,98,82,720,419
DefnState: 2,257,350,1289,349,0,DFNM
Aliases: FormNode Fo1538686227, FormNode Fo315017491
NodeColor: 65535,65531,1
ReformDef: [Cost_Component,All_Sectors]
TableCellDefault: Checkbox(1)

FormNode Fo1538686227
Title: Map Costs to Sector
Definition: 0
NodeLocation: 100,512,1
NodeSize: 60,16
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Map_Costs_to_Sector

Index All_System_Types
Att_PrevIndexValue: ['Solar PV Retrofit','Solar PV NewConstruct','Solar + Storage Retrofit','Solar + Storage NewConstruct','Storage Added to Exist Solar','Storage Only Retrofit','Storage Only NewConstruct']
Title: All System Types
Definition: ['Solar PV Retrofit','Solar PV NewConstruct','Solar + Storage Retrofit','Solar + Storage NewConstruct','Storage Added to Exist Solar','Storage Only Retrofit','Storage Only NewConstruct']
NodeLocation: 240,64,1
NodeSize: 64,40
WindState: 2,98,82,720,799
ValueState: 2,2479,131,416,303,0,MIDM
{!40300|Att_SlicerPopupSize: 227,112}

Decision Select_System_Types
Title: Select System Types
Description: Select the system types considered in the analysis.
Definition: Table(All_System_Types)(Checkbox(1),Checkbox(0),Checkbox(1),Checkbox(0),Checkbox(0),Checkbox(1),Checkbox(0))
NodeLocation: 240,152,1
NodeSize: 64,40
WindState: 2,98,82,720,724
DefnState: 2,538,333,416,303,0,DFNM
Aliases: FormNode Fo1539019857
NodeColor: 65535,65531,1
TableCellDefault: Checkbox(0)

Index System_Types
Att_PrevIndexValue: ['Solar PV Retrofit','Solar + Storage Retrofit','Storage Only Retrofit']
Title: System Types
Definition: Subset(Select_System_Types)
NodeLocation: 240,256,1
NodeSize: 64,40
WindState: 2,102,21,1089,879
ValueState: 2,992,329,416,303,0,MIDM
DisplayOutputs: Object Object, Object Variable
{!40300|Att_SlicerPopupSize: 1172,112}

Index New_or_Retrofit
Att_PrevIndexValue: ['NewConstr','Retrofit']
Title: NewConstr or Retrofit
Definition: ['NewConstr','Retrofit']
NodeLocation: 528,64,1
NodeSize: 64,40
WindState: 2,340,206,720,350
{!40300|Att_SlicerPopupSize: 267,56}

Index System_Configuration
Title: System Configuration
Definition: ['Solar PV','Solar + Storage','Storage Added to Exist PV','Storage Only']
NodeLocation: 672,152,1
NodeSize: 64,40

Index Battery_Specs
Att_PrevIndexValue: ['Roundtrip Efficiency (%)','Minimum Charge Level (%)','Maximum Charge Level (%)']
Title: Battery Specs
Definition: ['Roundtrip Efficiency (%)','Minimum Charge Level (%)','Maximum Charge Level (%)']
NodeLocation: 816,64,1
NodeSize: 64,40
DisplayOutputs: Object Object, Object Decision
{!40300|Att_SlicerPopupSize: 227,70}

Decision Energy_kWh_Label
Title: Energy kWh Label
Definition: Choice(Battery_Specs,1,0)
NodeLocation: 816,152,1
NodeSize: 64,40
Aliases: FormNode Fo1540240594

Decision Construct_Type_Map
Title: Construction Type Map
Units: boolean
Description: Flags the systems that are specific to new or retrofit construction.
Definition: Table(All_System_Types,New_or_Retrofit)(~
Checkbox(0),Checkbox(1),~
Checkbox(1),Checkbox(0),~
Checkbox(0),Checkbox(1),~
Checkbox(1),Checkbox(0),~
Checkbox(0),Checkbox(1),~
Checkbox(0),Checkbox(1),~
Checkbox(1),Checkbox(0))
NodeLocation: 240,1312,1
NodeSize: 64,40
WindState: 2,102,82,916,508
DefnState: 2,1294,361,416,517,0,DFNM
Aliases: FormNode Fo1539020467
ReformDef: [New_or_Retrofit,All_System_Types]
TableCellDefault: Checkbox(0)

Decision Equip_Install_Map
Title: Equipment Installation Map
Units: boolean
Description: Flags which system types include a solar installation in the system cost.
Definition: Table(All_System_Types,All_Equipment_Types)(~
Checkbox(1),Checkbox(0),~
Checkbox(1),Checkbox(0),~
Checkbox(1),Checkbox(1),~
Checkbox(1),Checkbox(1),~
Checkbox(0),Checkbox(1),~
Checkbox(0),Checkbox(1),~
Checkbox(0),Checkbox(1))
NodeLocation: 1104,152,1
NodeSize: 64,40
DefnState: 2,1144,209,607,649,0,DFNM
ValueState: 2,352,292,601,657,0,MIDM
Aliases: FormNode Fo1539020468
ReformDef: [All_Equipment_Types,All_System_Types]
ReformVal: [All_Equipment_Types,All_System_Types]
TableCellDefault: Checkbox(0)

Decision Solar_PV_Label
Title: Solar PV Label
Definition: Choice(All_Equipment_Types,1,0)
NodeLocation: 1104,560,1
NodeSize: 64,40
Aliases: FormNode Fo1540240595

FormNode Fo1539019857
Title: Select System Types
Definition: 0
NodeLocation: 248,196,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,72,0,,0,,,0
Original: Select_System_Types

FormNode Fo1539020467
Title: Construction Type Map
Definition: 0
NodeLocation: 240,1364,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Construct_Type_Map

FormNode Fo1539020468
Title: Equipment Installation Map
Definition: 0
NodeLocation: 1104,204,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Equip_Install_Map

Variable System_ConstructType
Title: System Construction Type
Description: The construction type for each system.~
~
NOTE: GOT RID OF COST BY NEW VS RETRO .STILL NEED THIS?
Definition: VAR nullText:=IF Construct_Type_Map[All_System_Types=System_Types]~
   THEN New_or_Retrofit~
   ELSE Null;~
JoinText(nullText, New_or_Retrofit)
NodeLocation: 240,1432,1
NodeSize: 64,40
ValueState: 2,296,298,481,419,0,MIDM
NodeColor: 65535,1,1

Variable Equip_Installed_Flag
Title: Equipment Installed Flag
Units: boolean
Description: A flag indicating the types of equipment installed for each system configuration.
Definition: Equip_Install_Map[All_System_Types=System_Types, All_Equipment_Types=Equipment_Types]
NodeLocation: 1104,264,1
NodeSize: 64,40
ValueState: 2,824,264,417,243,0,MIDM

Index NewConstr_System_Typ
Title: NewConstr System Type
Definition: Subset(Construct_Type_Map[All_System_Types=System_Types, New_or_Retrofit=NewConstr_Label])
NodeLocation: 240,1520,1
NodeSize: 64,40
ValueState: 2,520,434,416,391,0,MIDM

Index Retrofit_System_Type
Title: Retrofit System Type
Definition: Subset(Construct_Type_Map[All_System_Types=System_Types, New_or_Retrofit=Retrofit_Label])
NodeLocation: 240,1608,1
NodeSize: 64,40
WindState: 2,12,328,720,350
ValueState: 2,377,480,416,303,0,MIDM

Decision Retrofit_Label
Title: Retrofit Label
Definition: Choice(New_or_Retrofit,2,0)
NodeLocation: 528,152,1
NodeSize: 64,40
Aliases: FormNode Fo1540240596

Decision NewConstr_Label
Title: NewConstr Label
Definition: Choice(New_or_Retrofit,1,0)
NodeLocation: 528,256,1
NodeSize: 64,40
Aliases: FormNode Fo1540240597

Index Pre_and_Post_System
Att_PrevIndexValue: ['Pre-System','Post-System']
Title: Pre and Post System
Definition: ['Pre-System','Post-System']
NodeLocation: 528,616,1
NodeSize: 64,40
{!40300|Att_SlicerPopupSize: 270,80}

Index Bill_Components
Att_PrevIndexValue: ['Basic Service Fees','Minimum Charges','Summer Energy','Summer On-Peak Energy','Summer Off-Peak Energy','Summer Super-Off Peak Energy','Summer Semi-Peak Energy','Winter Energy','Winter On-Peak Energy','Winter Off-Peak Energy','Winter Super-Off Peak Energy','Winter Semi-Peak Energy','Non-Coincident Demand','Summer On-Peak Demand','Winter On-Peak Demand','Net Total']
Title: Bill Components
Definition: ['Basic Service Fees','Minimum Charges','Summer Energy','Summer On-Peak Energy','Summer Off-Peak Energy','Summer Super-Off Peak Energy','Summer Semi-Peak Energy','Winter Energy','Winter On-Peak Energy','Winter Off-Peak Energy','Winter Super-Off Peak Energy','Winter Semi-Peak Energy','Non-Coincident Demand','Summer On-Peak Demand','Winter On-Peak Demand','Net Total']
NodeLocation: 96,616,1
NodeSize: 64,40
WindState: 2,102,82,752,502
ValueState: 2,853,0,498,511,0,MIDM
{!40300|Att_SlicerPopupSize: 232,210}

Decision Pre_System_Label
Title: Pre-System Label
Definition: Choice(Pre_and_Post_System,1,0)
NodeLocation: 528,704,1
NodeSize: 64,40
DefnState: 2,248,250,964,440,,DFNM
Aliases: FormNode Fo1534916543
TableCellDefault: Choice(Static_Profile_Names,1,0)

FormNode Fo1534916543
Title: Period Label
Definition: 0
NodeLocation: 528,752,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,
Original: Pre_System_Label

Decision Post_System_Label
Title: Post-System Label
Definition: Choice(Pre_and_Post_System,2,0)
NodeLocation: 528,816,1
NodeSize: 64,40
DefnState: 2,248,250,964,440,,DFNM
Aliases: FormNode Fo1534916544
TableCellDefault: Choice(Static_Profile_Names,1,0)

FormNode Fo1534916544
Title: Period Label
Definition: 0
NodeLocation: 528,864,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,
Original: Post_System_Label

Index System_Comparison
Att_PrevIndexValue: ['Pre-System','Post-System','Cost Savings']
Title: System Comparison
Definition: Concat(Pre_and_Post_System, Cost_Savings_Label)
NodeLocation: 672,296,1
NodeSize: 64,40
WindState: 2,657,349,1080,557
{!40300|Att_SlicerPopupSize: 242,70}

Decision Cost_Savings_Label
Title: Cost Savings Label
Definition: 'Cost Savings'
NodeLocation: 672,384,1
NodeSize: 64,40
Aliases: FormNode Fo1540240598

Index Rate_Setting
Att_PrevIndexValue: ['Rate Name','Rate Start Date','Allow Rate Escalation']
Title: Rate Setting
Definition: ['Rate Name','Rate Start Date','Allow Rate Escalation']
NodeLocation: 816,704,1
NodeSize: 64,40
{!40300|Att_SlicerPopupSize: 352,48}

Decision Name_Setting_Label
Title: Name Setting Label
Definition: Choice(Rate_Setting,1,0)
NodeLocation: 816,792,1
NodeSize: 64,40
WindState: 2,44,158,720,350
Aliases: FormNode Fo1540242170

Decision Rate_Date_Label
Title: Rate Date Label
Definition: Choice(Rate_Setting,2,0)
NodeLocation: 816,904,1
NodeSize: 64,40
Aliases: FormNode Fo1540242171

Decision Rate_Escalate_Label
Title: Rate Escalate Label
Definition: Choice(Rate_Setting,3,0)
NodeLocation: 816,1016,1
NodeSize: 64,40
Aliases: FormNode Fo1540242172

Index Date_Start_and_End
Att_PrevIndexValue: ['Start','End']
Title: Date Start & End
Definition: ['Start','End']
NodeLocation: 384,1368,1
NodeSize: 64,40

FormNode Fo1540240591
Title: Spatial ID to CZ Map
Definition: 0
NodeLocation: 960,200,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,
Original: All_Spatial_ID_to_CZ

FormNode Fo1540240592
Title: Federal Label
Definition: 0
NodeLocation: 1248,192,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,
Original: Federal_Label

FormNode Fo1540240593
Title: State Label
Definition: 0
NodeLocation: 1248,296,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,
Original: State_Label

FormNode Fo1540240594
Title: Energy kWh Label
Definition: 0
NodeLocation: 812,192,1
NodeSize: 68,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,0
Original: Energy_kWh_Label

FormNode Fo1540240595
Title: Solar PV Label
Definition: 0
NodeLocation: 1104,608,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,
Original: Solar_PV_Label

FormNode Fo1540240596
Title: Retrofit Label
Definition: 0
NodeLocation: 528,192,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,0
Original: Retrofit_Label

FormNode Fo1540240597
Title: NewConstr Label
Definition: 0
NodeLocation: 528,304,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,
Original: NewConstr_Label

FormNode Fo1540240598
Title: Cost Savings Label
Definition: 0
NodeLocation: 672,432,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,
Original: Cost_Savings_Label

FormNode Fo1540242170
Title: Name Setting Label
Definition: 0
NodeLocation: 816,840,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,0
Original: Name_Setting_Label

FormNode Fo1540242171
Title: Rate Date Label
Definition: 0
NodeLocation: 816,952,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,
Original: Rate_Date_Label

FormNode Fo1540242172
Title: Rate Escalate Label
Definition: 0
NodeLocation: 816,1064,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,
Original: Rate_Escalate_Label

Index Minimum_Roofspace
Att_PrevIndexValue: [4.3,6,7.5,10,20,30]
Title: Minimum Roofspace
Definition: [4.3,6,7.5,10,20,30]
NodeLocation: 1392,256,1
NodeSize: 64,40

Index Building_Size
Att_PrevIndexValue: ['Small','Medium','Large']
Title: Building Size
Definition: ['Small','Medium','Large']
NodeLocation: 1392,64,1
NodeSize: 64,40

Index Stock_Basis_Types
Att_PrevIndexValue: ['Buildings','m2 of Roofspace']
Title: Stock Basis Types
Definition: ['Buildings','m2 of Roofspace']
NodeLocation: 1248,464,1
NodeSize: 64,40

Decision Buildings_Label
Title: Buildings Label
Definition: Choice(Stock_Basis_Types,1,0)
NodeLocation: 1248,552,1
NodeSize: 64,40
DisplayOutputs: Object Object, Object Variable
TableCellDefault: Choice(Stock_Basis_Types,1,0)

Index Roof_Type
Att_PrevIndexValue: ['Flat','Tilted']
Title: Roof Type
Definition: ['Flat','Tilted']
NodeLocation: 1392,432,1
NodeSize: 64,40

Variable EOY_Date_for_Econ_Yr
Title: EOY Date for Econ Year
Description: The date associated with the end of the economic year (EOY).
Definition: EOY_Date_StaticPV_Yr[Static_PV_Time=Annual_Econ_Time]
NodeLocation: 384,720,1
NodeSize: 64,40
WindState: 2,101,420,720,350
ValueState: 2,1353,100,416,504,0,MIDM

Decision PV_Retrofit_Label
Title: PV Retrofit Label
Definition: Choice(All_System_Types,1,0)
NodeLocation: 240,344,1
NodeSize: 64,40
DefnState: 2,248,250,964,440,,DFNM
Aliases: FormNode Fo1541553060
TableCellDefault: Choice(Static_Profile_Names,1,0)

FormNode Fo1541553060
Title: Period Label
Definition: 0
NodeLocation: 240,392,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,0
Original: PV_Retrofit_Label

Index Eligibility_Factors
Att_PrevIndexValue: ['Lidar Suitability','Premise Type','Homeownership']
Title: Eligibility Factors
Definition: ['Lidar Suitability','Premise Type','Homeownership']
IndexVals: ['item 1']
NodeLocation: 1392,520,1
NodeSize: 64,40
WindState: 2,444,119,720,350
{!40300|Att_SlicerPopupSize: 227,70}

Index Impact_Type_MWdc_GWh
Att_PrevIndexValue: ['Demand (MW-DC)','Energy (GWh)']
Title: Impact Type
Definition: ['Demand (MW-DC)','Energy (GWh)']
NodeLocation: 1536,464,1
NodeSize: 64,40

Variable Aggreg_Spatial_IDs
Title: Aggreg Spatial IDs
Units: boolean
Description: The spatial ID's that represent aggregate values.
Definition: All_Agg_Spatial_IDs[All_Spatial_ID=PV_Spatial_ID]
NodeLocation: 1536,176,1
NodeSize: 64,40

Variable Non_Agg_Spatial_IDs
Title: Non-Aggreg Spatial IDs
Units: boolean
Description: The spatial ID's that represent non-aggregate values.
Definition: NOT Aggreg_Spatial_IDs
NodeLocation: 1536,264,1
NodeSize: 64,40
ValueState: 2,826,27,432,595,,MIDM

Decision Energy_GWh_Label
Title: Energy GWh Label
Definition: Choice(Impact_Type_MWdc_GWh,2,0)
NodeLocation: 1536,552,1
NodeSize: 64,40
Aliases: FormNode Fo1541710821

FormNode Fo1541710821
Title: Energy GWh Label
Definition: 0
NodeLocation: 1536,600,1
NodeSize: 72,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,0
Original: Energy_GWh_Label

Decision Demand_MW_DC_Label
Title: Demand MW-DC Label
Definition: Choice(Impact_Type_MWdc_GWh,1,0)
NodeLocation: 1536,664,1
NodeSize: 64,40
Aliases: FormNode Fo1541734992

FormNode Fo1541734992
Title: Energy GWh Label
Definition: 0
NodeLocation: 1536,712,1
NodeSize: 72,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,0
Original: Demand_MW_DC_Label

FormNode Fo1542088327
Title: Payback Label
Definition: 0
NodeLocation: 960,520,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,
Original: Payback_Label

Decision Cost_of_Elect_Label
Title: Cost of Elect Label
Definition: Choice(Market_Share_Metric,1,1)
NodeLocation: 960,584,1
NodeSize: 64,40
Aliases: FormNode Fo1542088353

FormNode Fo1542088353
Title: Payback Label
Definition: 0
NodeLocation: 960,632,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,
Original: Cost_of_Elect_Label

FormNode Fo1542091914
Title: PV Spatial ID
Definition: 0
NodeLocation: 1536,112,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,
Original: PV_Spatial_ID

Index Demograph_Data_Types
Title: Demographic Data Types
Definition: ['Homeownership %','Single Family %']
NodeLocation: 672,704,1
NodeSize: 64,40
WindState: 2,35,108,720,350

Index PV_Adopt_Data_Types
Att_PrevIndexValue: ['Incremental System Count','Incremental Nameplate CEC-MW-AC','Incremental Coincident Peak Avg MW-AC','Cumulative System Count','Cumulative Nameplate CEC-MW-AC','Cumulative Coincident Peak Avg MW-AC','Incremental Non-Coincident Peak MW-AC','Cumulative Nameplate MW-DC','Cumulative Non-Coincident Peak MW-AC','Incremental Nameplate MW-DC']
Title: PV Adoption Data Types
Definition: ['Incremental System Count','Incremental Nameplate CEC-MW-AC','Incremental Coincident Peak Avg MW-AC','Cumulative System Count','Cumulative Nameplate CEC-MW-AC','Cumulative Coincident Peak Avg MW-AC','Incremental Non-Coincident Peak MW-AC','Cumulative Nameplate MW-DC','Cumulative Non-Coincident Peak MW-AC','Incremental Nameplate MW-DC']
IndexVals: ['item 1']
NodeLocation: 672,520,1
NodeSize: 64,40
WindState: 2,8,34,720,350
Aliases: Alias Al872771107
{!40300|Att_SlicerPopupSize: 347,238}

Decision PV_Map_Increm_Cumul
Title: PV Map Incremental to Cumulative
Description: Map the cumulative data types to the incremental data types. Leave cumulative data types Null.
Definition: Table(PV_Adopt_Data_Types)(Choice(PV_Adopt_Data_Types,4,0),Choice(PV_Adopt_Data_Types,5,0),Choice(PV_Adopt_Data_Types,6,0),Null,Null,Null,Choice(PV_Adopt_Data_Types,9,0),Null,Null,Choice(PV_Adopt_Data_Types,8,0))
NodeLocation: 672,792,1
NodeSize: 64,40
DefnState: 2,2084,362,808,437,0,DFNM
Aliases: Alias Al1542351006, FormNode Fo1542351091, Alias Al1542352236, FormNode Fo1542352234, FormNode Fo1542351043
TableCellDefault: Choice(PV_Adopt_Data_Types,1,0)

Index PV_Cumul_Data_Type
Att_PrevIndexValue: ['Cumulative System Count','Cumulative Nameplate CEC-MW-AC','Cumulative Coincident Peak Avg MW-AC','Cumulative Nameplate MW-DC','Cumulative Non-Coincident Peak MW-AC']
Title: PV Cumulative Data Types
Definition: Subset(PV_Map_Increm_Cumul = Null)
NodeLocation: 672,904,1
NodeSize: 64,40
{!40300|Att_SlicerPopupSize: 257,98}

FormNode Fo1542351043
Title: Map Incremental to Cumulative
Definition: 0
NodeLocation: 680,844,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: PV_Map_Increm_Cumul

Index PV_Adopt_Types_None
Att_PrevIndexValue: ['None','Incremental System Count','Incremental Nameplate CEC-MW-AC','Incremental Coincident Peak Avg MW-AC','Cumulative System Count','Cumulative Nameplate CEC-MW-AC','Cumulative Coincident Peak Avg MW-AC','Incremental Non-Coincident Peak MW-AC','Cumulative Nameplate MW-DC','Cumulative Non-Coincident Peak MW-AC','Incremental Nameplate MW-DC']
Title: PV Adopt Data Types with None
Definition: Concat(None_Label, PV_Adopt_Data_Types)
NodeLocation: 672,616,1
NodeSize: 64,40

Variable MOY_Date_for_Econ_Yr
Title: MOY Date for Econ Year
Description: The date associated with the middle of the economic year (MOY).
Definition: MakeDate(Annual_Econ_Time, 7, 1)
NodeLocation: 384,808,1
NodeSize: 64,40
WindState: 2,101,420,720,350
ValueState: 2,269,284,1181,504,,MIDM

Index Installation_Type
Title: Installation Type
Definition: Concat(Concat(New_or_Retrofit, BESS_Types), NA_Label)
NodeLocation: 528,376,1
NodeSize: 64,40
WindState: 2,144,-1,720,350
{!40300|Att_SlicerPopupSize: 292,70}

Decision NA_Label
Title: NA Label
Definition: 'N/A'
NodeLocation: 528,464,1
NodeSize: 64,40
Aliases: FormNode Fo1543517730

FormNode Fo1543517730
Title: NA Label
Definition: 0
NodeLocation: 536,512,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,
Original: NA_Label

Decision Small_Bldg_Label
Title: Small Bldg Label
Definition: Choice(Building_Size,1,0)
NodeLocation: 1392,152,1
NodeSize: 64,40
Aliases: FormNode Fo1544546536

FormNode Fo1544546536
Title: Federal Label
Definition: 0
NodeLocation: 1392,192,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,
Original: Small_Bldg_Label

Variable BOY_Date_StaticPV_Yr
Title: BOY Date for Static PV Year
Description: The date associated with the beginning of year (BOY).
Definition: MakeDate(Static_PV_Time, 1, 1)
NodeLocation: 384,368,1
NodeSize: 64,40
WindState: 2,101,420,720,350
ValueState: 2,12,148,416,504,,MIDM

Variable EOY_Date_StaticPV_Yr
Title: EOY Date for Static PV Year
Description: The date associated with the end of year (EOY).
Definition: MakeDate(Static_PV_Time, 12, 31)
NodeLocation: 384,456,1
NodeSize: 64,40
WindState: 2,101,420,720,350
ValueState: 2,1353,100,416,504,,MIDM

Decision Power_kW_Label
Title: Power kW Label
Definition: Choice(Battery_Specs,2,0)
NodeLocation: 816,256,1
NodeSize: 64,40
Aliases: FormNode Fo1545885106

FormNode Fo1545885106
Title: Energy kWh Label
Definition: 0
NodeLocation: 812,296,1
NodeSize: 68,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,0
Original: Power_kW_Label

Index Storage_Systems
Att_PrevIndexValue: ['Solar + Storage Retrofit','Storage Only Retrofit']
Title: Storage Systems
Definition: Subset(Equip_Install_Map[All_System_Types=System_Types, All_Equipment_Types=Battery_Strg_Label])
NodeLocation: 1104,1024,1
NodeSize: 64,40
WindState: 2,141,183,1474,798
ValueState: 2,2433,285,416,303,,MIDM
{!40300|Att_SlicerPopupSize: 320,110}

Variable System_with_Storage
Title: System with Storage
Units: boolean
Description: A flag indicating whether a system type includes storage.
Definition: Equip_Installed_Flag[Equipment_Types=Battery_Strg_Label]
NodeLocation: 1104,672,1
NodeSize: 64,40
WindState: 2,73,563,720,350
ValueState: 2,1247,481,416,303,0,MIDM

Index Opt_Storage_Systems
Att_PrevIndexValue: ['Solar + Storage Retrofit','Storage Only Retrofit']
Title: Opt Storage Systems
Description: If a storage retrofit added to an existing solar installation would have different equipment cost implications or retail rate implications relative to the solar+storage and solar only systems, then the storage retrofit on an existing solar installation must be modeled separately, which would require optimizing the storage dispatch for that unique system configuration.
Definition: Subset(Storage_Systems <> Storage_Added_Label)
NodeLocation: 1104,936,1
NodeSize: 64,40
WindState: 2,40,-1,910,825
{!40300|Att_SlicerPopupSize: 593,110}

Variable System_with_PV
Title: System with PV
Units: boolean
Description: A flag indicating whether a system type includes solar PV.
Definition: Equip_Installed_Flag[Equipment_Types=Solar_PV_Label]
NodeLocation: 1104,760,1
NodeSize: 64,40
ValueState: 2,1175,517,416,303,0,MIDM
Aliases: Alias Al1442611491

Decision Battery_Strg_Label
Title: Battery Storage Label
Definition: Choice(All_Equipment_Types,2,0)
NodeLocation: 1104,448,1
NodeSize: 64,40
Aliases: FormNode Fo1546279501

FormNode Fo1546279501
Title: Solar PV Label
Definition: 0
NodeLocation: 1104,496,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,
Original: Battery_Strg_Label

Index PV_Systems
Title: PV Systems
Definition: Subset(Equip_Install_Map[All_System_Types=System_Types, All_Equipment_Types=Solar_PV_Label])
NodeLocation: 1104,1200,1
NodeSize: 64,40

Index All_PV_Systems
Title: All PV Systems
Definition: Subset(Equip_Install_Map[All_Equipment_Types=Solar_PV_Label])
NodeLocation: 1104,1112,1
NodeSize: 64,40

Index Installation_Event
Att_PrevIndexValue: ['Initial Install','Future Replacement']
Title: Installation Event
Definition: ['Initial Install','Future Replacement']
NodeLocation: 1680,64,1
NodeSize: 64,40
{!40300|Att_SlicerPopupSize: 247,56}

Decision Init_Install_Label
Title: Initial Install Label
Definition: Choice(Installation_Event,1,0)
NodeLocation: 1680,176,1
NodeSize: 64,40
Aliases: FormNode Fo1546451225

FormNode Fo1546451225
Title: Initial Install Label
Definition: 0
NodeLocation: 1688,228,1
NodeSize: 72,12
NodeInfo: 1,0,0,0,0,0,0,102,0,,0,,,
Original: Init_Install_Label

Decision Replacement_Label
Title: Replacement Label
Definition: Choice(Installation_Event,2,0)
NodeLocation: 1680,288,1
NodeSize: 64,40
Aliases: FormNode Fo1546451247

FormNode Fo1546451247
Title: Initial Install Label
Definition: 0
NodeLocation: 1688,340,1
NodeSize: 72,12
NodeInfo: 1,0,0,0,0,0,0,102,0,,0,,,
Original: Replacement_Label

Function Val_by_Install_Event(data, stepsPerYear; timeInd: INDEX)
Title: Value by Install Event
Description: This performs a future time lookup on values that might differ between an initial equipment installation and a future replacement. The initial installation will use values from the current time period, while the future replacement will use values from X number of years into the future (where X is the equipment lifetime, indicating when the equipment must be replaced). If the equipment lifetime is greater than or equal to the economic horizon, then no replacement costs need to be considered and this function returns a Null value. ~
~
[data] data indexed by timeInd for which a future lookup will be performed.~
[stepsPerYear] the number of timesteps per year for the timeInd index.~
[timeInd] a time index used in data.
Definition: VAR replaceValue:=IF Equipment_Lifetimes >= Economic_Lifetime~
   THEN 0 {temporarily replaced null with zero here, for testing only}~
   ELSE LinearInterp(@timeInd, data, @timeInd + Equipment_Lifetimes*stepsPerYear, timeInd);~
~
IF Installation_Event = Init_Install_Label~
THEN data~
ELSE replaceValue
NodeLocation: 1680,488,1
NodeSize: 64,40
WindState: 2,247,225,1176,551
NodeColor: 65535,39321,39321

Function Sum_Initial_Repl_Val(values, replace_factor)
Title: Sum Initial and Replace Value
Description: Applies a discounting factor to convert replacement costs into the current decision year's present value. Then it sums the values for initial installations and future replacement costs.~
~
[values]: data indexed by Installation_Event~
~
~
Replace_Value_Factor
Definition: VAR replFactor:=IF Installation_Event = Init_Install_Label~
   THEN 1~
   ELSE replace_factor;~
~
Sum(values * replFactor, Installation_Event)
NodeLocation: 1680,400,1
NodeSize: 64,40
WindState: 2,285,56,800,599

Index System_Type
Att_PrevIndexValue: ['No System','Solar PV','Solar PV + Storage','Storage Only','Storage Added to Existing PV']
Title: System Type
Definition: ['No System','Solar PV','Solar PV + Storage','Storage Only','Storage Added to Existing PV']
NodeLocation: 240,800,1
NodeSize: 64,40
WindState: 2,2,228,720,350
Att_GraphIndexRange: 1,,,,,,10
{!40300|Att_SlicerPopupSize: 452,116}

Index Bill_Components1
Title: Bill Components
Definition: ['Minimum Charges','Summer On-Peak Energy','Summer Off-Peak Energy','Summer Super-Off Peak Energy','Summer Semi-Peak Energy','Winter On-Peak Energy','Winter Off-Peak Energy','Winter Super-Off Peak Energy','Winter Semi-Peak Energy','Net Total']
NodeLocation: 240,888,1
NodeSize: 64,40

Decision Pre_or_Post_by_Syst
Title: Pre or Post by System
Description: Assigns the pre- or post-system results to each system type.
Definition: Table(System_Type)(Choice(Pre_and_Post_System,1,0),Choice(Pre_and_Post_System,2,0),Choice(Pre_and_Post_System,2,0),Choice(Pre_and_Post_System,2,0),Choice(Pre_and_Post_System,1,0))
NodeLocation: 240,976,1
NodeSize: 64,40
DefnState: 2,1088,275,416,303,0,DFNM
Aliases: FormNode Fo1546900065
TableCellDefault: Choice(Pre_and_Post_System,1,0)

FormNode Fo1546900065
Title: Pre or Post by System
Definition: 0
NodeLocation: 240,1028,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Pre_or_Post_by_Syst

Decision SystType_for_System
Title: System Type for System
Description: Assigns an element of the system types index each system type.
Definition: Table(System_Type)(Choice(All_System_Types,1,0),Choice(All_System_Types,1,0),Choice(All_System_Types,3,0),Choice(All_System_Types,6,0),Choice(All_System_Types,5,0))
NodeLocation: 240,1088,1
NodeSize: 64,40
DefnState: 2,1144,278,540,303,0,DFNM
ValueState: 2,409,206,769,587,0,MIDM
Aliases: FormNode Fo1546900097
TableCellDefault: Choice(All_System_Types,1,0)

FormNode Fo1546900097
Title: Pre or Post by System
Definition: 0
NodeLocation: 240,1140,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: SystType_for_System

Decision No_System_Label
Title: No System Label
Description: Assigns the pre- or post-system results to each system type.
Definition: Choice(System_Type,1,0)
NodeLocation: 240,1200,1
NodeSize: 64,40
Aliases: FormNode Fo1546900379
TableCellDefault: Choice(Pre_and_Post_System,1,0)

FormNode Fo1546900379
Title: Pre or Post by System
Definition: 0
NodeLocation: 248,1248,1
NodeSize: 72,16
NodeInfo: 1,0,0,0,0,0,0,110,0,,0,,,0
Original: No_System_Label

Index Rate_Attribute_Setti
Att_PrevIndexValue: ['Structure Type','Include ''rate'' Attribute','Include ''adj'' Attribute','Include ''sell'' Attribute']
Title: Rate Attribute Settings
Definition: ['Structure Type',"Include 'rate' Attribute","Include 'adj' Attribute","Include 'sell' Attribute"]
NodeLocation: 1680,608,1
NodeSize: 64,40
WindState: 2,98,82,720,681
ValueState: 2,56,58,478,378,0,MIDM

Decision Rate_Structure_Label
Title: Rate Structure Label
Definition: Choice(Rate_Attribute_Setti,1,0)
NodeLocation: 1680,720,1
NodeSize: 64,40
WindState: 2,1105,286,720,350
DefnState: 2,194,175,1081,431,0,DFNM
Aliases: FormNode Fo1547764450
ReformDef: [Rate_Attribute_Setti,PV_Climate_Zone]
TableCellDefault: NonCoinc_Dmd_Default
Att_EditSliceState: [All_Sectors,1,Rate_Vintage,1,Pre_and_Post_System,2,PV_Climate_Zone,1,Rate_Attribute_Setti,1]

FormNode Fo1547764450
Title: Non-Coinc Demand Rate Attributes
Definition: 0
NodeLocation: 1684,672,1
NodeSize: 76,16
NodeInfo: 1,0,0,0,0,0,0,110,0,,0,,,0
Original: Rate_Structure_Label

Index Included_Attributes
Att_PrevIndexValue: ['Include ''rate'' Attribute','Include ''adj'' Attribute','Include ''sell'' Attribute']
Title: Included Attributes
Definition: Subset(Rate_Attribute_Setti<>Rate_Structure_Label)
NodeLocation: 1680,808,1
NodeSize: 64,40

Decision Storage_Added_Label
Title: Storage Added Label
Definition: Choice(All_System_Types,5,0)
NodeLocation: 240,456,1
NodeSize: 64,40
DefnState: 2,248,250,964,440,,DFNM
Aliases: FormNode Fo1549394953
TableCellDefault: Choice(Static_Profile_Names,1,0)

FormNode Fo1549394953
Title: Period Label
Definition: 0
NodeLocation: 240,504,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,0
Original: Storage_Added_Label

Decision PV_Strg_Retro_Label
Title: PV+Strg Retro Label
Definition: Choice(All_System_Types,3,0)
NodeLocation: 240,568,1
NodeSize: 64,40
DefnState: 2,248,250,964,440,,DFNM
Aliases: FormNode Fo1549395305
TableCellDefault: Choice(Static_Profile_Names,1,0)

FormNode Fo1549395305
Title: Period Label
Definition: 0
NodeLocation: 240,616,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,0
Original: PV_Strg_Retro_Label

Decision Roundtrip_Label
Title: Roundtrip Label
Definition: Choice(Battery_Specs,1,0)
NodeLocation: 816,360,1
NodeSize: 64,40
Aliases: FormNode Fo1550004482

FormNode Fo1550004482
Title: Energy kWh Label
Definition: 0
NodeLocation: 812,400,1
NodeSize: 68,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,0
Original: Roundtrip_Label

Index Debt_or_Equity
Att_PrevIndexValue: ['Debt','Equity']
Title: Debt or Equity
Definition: ['Debt','Equity']
NodeLocation: 96,936,1
NodeSize: 64,40
DisplayOutputs: Object Object, Object Decision

Decision Debt_Label
Title: Debt Label
Definition: Choice(Debt_or_Equity,1,0)
NodeLocation: 96,1024,1
NodeSize: 64,40
Aliases: FormNode Fo1550187276

FormNode Fo1550187276
Title: Debt Label
Definition: 0
NodeLocation: 104,1076,1
NodeSize: 64,12
NodeInfo: 1,0,0,0,0,0,0,91,0,,0,,,
Original: Debt_Label

Decision Equity_Label
Title: Equity Label
Definition: Choice(Debt_or_Equity,2,0)
NodeLocation: 96,1136,1
NodeSize: 64,40
Aliases: FormNode Fo1550187290

FormNode Fo1550187290
Title: Debt Label
Definition: 0
NodeLocation: 104,1188,1
NodeSize: 64,12
NodeInfo: 1,0,0,0,0,0,0,91,0,,0,,,
Original: Equity_Label

Constant PV_Static_Start_Year
Title: PV Static Start Year
Description: The start year for the Static PV Time.
Definition: 2002
NodeLocation: 384,64,1
NodeSize: 64,40
WindState: 2,485,224,720,350
Aliases: Alias Al1550726687, FormNode Fo1550726688, FormNode Fo1550190554

Constant PV_Static_End_Year
Title: PV Static End Year
Description: The end year for the Static PV Time.
Definition: 2052
NodeLocation: 384,168,1
NodeSize: 64,40
Aliases: Alias Al1550726688, FormNode Fo1550726689, FormNode Fo1550190555

FormNode Fo1550190554
Title: PV Static Start Year
Definition: 0
NodeLocation: 384,108,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: PV_Static_Start_Year

FormNode Fo1550190555
Title: PV Static End Year
Definition: 0
NodeLocation: 384,212,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: PV_Static_End_Year

Decision Min_SOC_Label
Title: Min SOC Label
Definition: Choice(Battery_Specs,2,0)
NodeLocation: 816,464,1
NodeSize: 64,40
Aliases: FormNode Fo1572020378

FormNode Fo1572020378
Title: Energy kWh Label
Definition: 0
NodeLocation: 812,504,1
NodeSize: 68,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,0
Original: Min_SOC_Label

Decision Max_SOC_Label
Title: Max SOC Label
Definition: Choice(Battery_Specs,3,0)
NodeLocation: 816,568,1
NodeSize: 64,40
Aliases: FormNode Fo1572020379

FormNode Fo1572020379
Title: Energy kWh Label
Definition: 0
NodeLocation: 812,608,1
NodeSize: 68,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,0
Original: Max_SOC_Label

Index Incent_MW_Cap_Inputs
Att_PrevIndexValue: ['Storage Capacity Lower Bound (MW)','Incentive Rate (Pct. of Base)']
Title: Incentive MW Capacity Inputs
Definition: ['Storage Capacity Lower Bound (MW)','Incentive Rate (Pct. of Base)']
IndexVals: ['item 1']
NodeLocation: 1840,752,1
NodeSize: 64,40

Index Bill_Components_None
Att_PrevIndexValue: ['None','Basic Service Fees','Minimum Charges','Summer Energy','Summer On-Peak Energy','Summer Off-Peak Energy','Summer Super-Off Peak Energy','Summer Semi-Peak Energy','Winter Energy','Winter On-Peak Energy','Winter Off-Peak Energy','Winter Super-Off Peak Energy','Winter Semi-Peak Energy','Non-Coincident Demand','Summer On-Peak Demand','Winter On-Peak Demand','Net Total']
Title: Bill Components & None
Definition: Concat(None_Label, Bill_Components)
NodeLocation: 96,808,1
NodeSize: 64,40
ValueState: 2,164,170,387,431,0,MIDM

Index All_Storage_Systems
Att_PrevIndexValue: ['Solar + Storage Retrofit','Solar + Storage NewConstruct','Storage Added to Exist Solar','Storage Only Retrofit','Storage Only NewConstruct']
Title: All Storage Systems
Definition: Subset(Equip_Install_Map[All_Equipment_Types=Battery_Strg_Label])
NodeLocation: 1104,848,1
NodeSize: 64,40
WindState: 2,98,82,910,825
{!40300|Att_SlicerPopupSize: 243,110}

Decision OptSyst_for_StrgSyst
Title: Opt System for Storage System
Description: The optimization storage system to use for a given storage system.
Definition: Table(All_Storage_Systems)(Choice(All_Storage_Systems,1,0),Choice(All_Storage_Systems,1,0),Choice(All_Storage_Systems,1,0),Choice(All_Storage_Systems,4,0),Choice(All_Storage_Systems,4,0))
NodeLocation: 1104,1288,1
NodeSize: 64,40
DefnState: 2,260,266,635,313,0,DFNM
Aliases: FormNode Fo1574795335
TableCellDefault: Choice(All_Storage_Systems,1,0)

FormNode Fo1574795335
Title: Opt System for Storage System
Definition: 0
NodeLocation: 1104,1340,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: OptSyst_for_StrgSyst

Variable Map_Opt_Syst_to_Syst
Title: Map Opt System to Systems
Description: Maps the optimized storage systems to the Systems index.
Definition: IgnoreWarnings(OptSyst_for_StrgSyst[All_Storage_Systems=System_Types])
NodeLocation: 1104,1400,1
NodeSize: 64,40

Index Annual_PV_Time2
Title: Annual PV Time
Description: Starts one year prior to the PV simulation start year, so that annual economic calculations can be treated as middle-of-year values.
Definition: (MIN(PV_Year_Map, Time_Solar_PV)-1)..MAX(PV_Year_Map, Time_Solar_PV)
NodeLocation: 528,936,1
NodeSize: 64,40
WindState: 2,281,12,1252,905
ValueState: 2,472,240,416,411,0,MIDM
Att_GraphIndexRange: 1,,,,,,10
{!40300|Att_SlicerPopupSize: 277,336}

Decision Storage_Retro_Label
Title: Storage Retro Label
Definition: Choice(All_System_Types,6,0)
NodeLocation: 240,688,1
NodeSize: 64,40
DefnState: 2,248,250,964,440,,DFNM
Aliases: FormNode Fo1578024666
TableCellDefault: Choice(Static_Profile_Names,1,0)

FormNode Fo1578024666
Title: Period Label
Definition: 0
NodeLocation: 240,736,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,0
Original: Storage_Retro_Label

Close PV_Auxiliary_Variabl

Module Technical_Potential
Title: Technical Potential
Author: JamesMilford
Date: Wed, Oct 31, 2018 10:11 AM
NodeLocation: 544,152,1
NodeSize: 64,40
NodeInfo: 1,0,0
DiagState: 2,1964,5,1635,623,17,10
NodeColor: 65535,65535,65535
AcpStyles: FrameNode: FrameNode_1544920370

Constant NewConstr_Code_Sys_S
Title:  NewConstr Code Sys Size Assumption
Units: various
Description: Assumed size for a new construction system after possible new construction code compliance takes effect. If not forced, should just be zero. ~
Units: ~
kW-DC/system for Historical Interconnection Based system sizing~
% of load for Load Based System Sizing method.~
~
~
Source - "Medium" scenario:~
CEC assumed capacities sized to offset annual energy consumption of prototype homes.~
Uses a weighted average across homes 2100 and 2700 sqft in size.~
https://efiling.energy.ca.gov/GetDocument.aspx?tn=221797~
~

Definition: Table(All_Sectors,NewConstr_Code_Param,PV_Climate_Zone)(~
1-Jan-2055,~
0,~
1-Jan-2055,~
0,~
1-Jan-2055,~
0,~
1-Jan-2055,~
0)
NodeLocation: 368,88,1
NodeSize: 64,40
WindState: 2,52,125,894,541
DefnState: 2,554,406,814,310,0,DFNM
ValueState: 2,416,209,685,592,,MIDM
Aliases: Alias Al1550183210, FormNode Fo1550183210, FormNode Fo1542305980, FormNode Fo1544638294
NodeColor: 65535,1,1
ReformDef: [NewConstr_Code_Param,All_Sectors]
NumberFormat: 2,F,2,2,0,0,2,1,$,0,"ABBREV",0,,,0,0,15,
DisplayOutputs: Object Object, Object Decision
TableCellDefault: NewConstrCode_Defaul
Att_EditSliceState: [PV_Climate_Zone,1,All_Sectors,1,NewConstr_Code_Param,3]

FormNode Fo1542305980
Title: Residential NewConstr System Size
Definition: 0
NodeLocation: 368,140,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 65535,1,1
Original: NewConstr_Code_Sys_S

Constant PV_Stock_Basis_by_Se
Title: PV Stock Basis by Sector
Description: Select the units basis used for each PV sector. Selecting "buildings" will use Lidar suitability specific to buildings, while selecting "m2 of roofspace" will use Lidar suitability specific to roofspace.
Definition: Table(All_Sectors)(Choice(Stock_Basis_Types,2,0),Choice(Stock_Basis_Types,2,0),Choice(Stock_Basis_Types,2,0),'N/A')
NodeLocation: 176,88,1
NodeSize: 64,40
WindState: 2,2773,308,720,350
DefnState: 2,584,166,516,667,0,DFNM
ValueState: 2,2246,141,443,692,0,MIDM
Aliases: Alias Al1568696874, FormNode Fo1568696942, FormNode Fo168015043
NodeColor: 65535,1,1
DisplayOutputs: Object Object, Object Variable, Object Decision
TableCellDefault: Choice(Stock_Basis_Types,1,0)

Module Lidar_Regression
Title: Lidar Regression (OLD)
Author: JamesMilford
Date: Wed, Oct 31, 2018 10:11 AM
NodeLocation: 264,560,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,419,275,944,466,17,10
NodeColor: 65535,65535,65535
AcpStyles: Show_object: no

Variable Suitability_for_Sect
Title: Suitability for Sector
Units: fraction
Definition: PV_technical_suitabi~
~
/* OLD for SDGE~
IF Stock_Basis_by_Sect[All_Sectors=PV_Sectors] = Buildings_Label~
THEN Wtd_Bldg_Suitability~
ELSE Implied_Area_Suitab
NodeLocation: 552,256,1
NodeSize: 64,40
ValueState: 2,154,26,1473,830,1,MIDM
Aliases: Alias Al1226024131
GraphSetup: Att_GraphValueRange Suitability_for_Sect:1,,1,,,,,0.8909926414489746,1.117754578590393,0
ReformVal: [PV_Spatial_ID,Null]
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,1]
Att_ColorRole: Null

Objective Suitability_Basis
Title: Suitability Basis
Definition: Table(Suitability_Params)(Lidar_Min_Syst_Sizes,1)
NodeLocation: 248,160,1
NodeSize: 64,40
ValueState: 2,136,138,582,303,,MIDM
NodeColor: 19661,48336,65535

Index Suitability_Params
Att_PrevIndexValue: ['slope','intercept']
Title: Suitability Params
Definition: ['slope','intercept']
NodeLocation: 248,56,1
NodeSize: 64,40

Variable Regressed_Suitabilit
Title: Regressed Suitability Coeffs
Definition: Regression(Suitability_for_Sect, Suitability_Basis, Lidar_Min_Syst_Sizes, Suitability_Params)
NodeLocation: 400,160,1
NodeSize: 64,40
ValueState: 2,504,406,832,403,,MIDM

Index System_Size_Range
Title: System Size Range
Units: kW-DC
Definition: Sequence(1,81,4)
NodeLocation: 248,256,1
NodeSize: 64,40

Variable Predicted_Suitabilit
Title: Predicted Suitability by Lidar Size
Definition: Sum(Suitability_Basis * Regressed_Suitabilit, Suitability_Params)
NodeLocation: 400,56,1
NodeSize: 64,40
ValueState: 2,390,85,1453,706,1,MIDM
ReformVal: [Lidar_Min_Syst_Sizes,Lidar_Zip]
Att_ResultSliceState: [PV_Sectors,1,Lidar_Zip,1,System_Size_Range,1]

Variable Predict_Suitability
Title: Predicted Suitability
Definition: VAR basis:=Array(Suitability_Params, [PV_DC_System_Size_fo[PV_Climate_Zone=Climate_Zone_Map], 1]);~
Sum(basis * Regressed_Suitabilit, Suitability_Params)
NodeLocation: 552,160,1
NodeSize: 64,40
WindState: 2,102,82,1047,598
ValueState: 2,171,25,1270,821,0,MIDM
GraphSetup: Att_ContLineStyle Graph_Primary_Valdim:4
ReformVal: [PV_Sectors,PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,1,PV_Climate_Zone,1,Lidar_Zip,1]

Variable Compare_Actual_and_P
Title: Compare Actual and Prediction
Definition: [Predicted_Suitabilit,Suitability_for_Sect]
NodeLocation: 552,56,1
NodeSize: 64,40
ValueState: 2,72,74,1464,805,1,MIDM
ReformVal: [Lidar_Min_Syst_Sizes,Self]
Att_ResultSliceState: [PV_Sectors,2,PV_Spatial_ID,107,Self,1,Lidar_Min_System_Siz,1]

Variable Plot_Regressed_Suita
Title: Plot Regressed Suitability
Definition: VAR basis:=Array(Suitability_Params, [System_Size_Range, 1]);~
Sum(basis * Regressed_Suitabilit, Suitability_Params)
NodeLocation: 400,256,1
NodeSize: 64,40
ValueState: 2,247,4,1446,870,1,MIDM
Att_ResultSliceState: [PV_Sectors,2,PV_Spatial_ID,1,System_Size_Range,1]

Close Lidar_Regression

Module Lidar_Mappings
Title: Lidar Mappings (OLD)
Author: JamesMilford
Date: Wed, Oct 31, 2018 10:11 AM
NodeLocation: 112,560,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,127,124,1630,616,17
NodeColor: 65535,65535,65535
AcpStyles: FrameNode: FrameNode_1545066682

Decision Minimum_PV_Size_for_
Title: Minimum PV Size for Lidar Suitability
Units: kW-DC
Definition: Choice(Lidar_Min_Syst_Sizes,6,0)
NodeLocation: 312,560,1
NodeSize: 64,40
Aliases: FormNode Fo1540850586
NodeColor: 57311,57311,57311
AcpStyles: Show_object: no

FormNode Fo1540850586
Title: Minimum System Size for LIDAR Suitability
Definition: 0
NodeLocation: 316,508,1
NodeSize: 60,12
NodeInfo: 1,0,0,0,0,0,0,82,0,,0,,,
Original: Minimum_PV_Size_for_

Variable Minimum_Roofspace_fo
Title: Minimum Roofspace for Lidar Suitability
Definition: SubIndex(Approx_kW_Equiv, Minimum_PV_Size_for_, Minimum_Roofspace)
NodeLocation: 464,560,1
NodeSize: 64,40
NodeColor: 57311,57311,57311
AcpStyles: Show_object: no

Index Lidar_Zip
Att_PrevIndexValue: [90.001K,90.002K,90.003K,90.004K,90.005K,90.006K,90.007K,90.008K,90.01K,90.011K,90.012K,90.013K,90.014K,90.015K,90.016K,90.017K,90.018K,90.019K,90.02K,90.021K,90.022K,90.023K,90.024K,90.025K,90.026K,90.027K,90.028K,90.029K,90.031K,90.032K,90.033K,90.034K,90.035K,90.036K,90.037K,90.038K,90.039K,90.04K,90.041K,90.042K,90.043K,90.044K,90.045K,90.046K,90.047K,90.048K,90.049K,90.056K,90.057K,90.058K,90.059K,90.061K,90.062K,90.063K,90.064K,90.065K,90.066K,90.067K,90.068K,90.069K,90.071K,90.077K,90.089K,90.094K,90.095K,90.201K,90.21K,90.211K,90.212K,90.22K,90.221K,90.222K,90.23K,90.232K,90.24K,90.241K,90.242K,90.245K,90.247K,90.248K,90.249K,90.25K,90.254K,90.255K,90.26K,90.261K,90.262K,90.266K,90.27K,90.272K,90.274K,90.277K,90.278K,90.28K,90.291K,90.292K,90.293K,90.301K,90.302K,90.303K,90.601K,90.602K,90.603K,90.604K,90.605K,90.606K,90.62K,90.621K,90.623K,90.63K,90.631K,90.638K,90.64K,90.65K,90.66K,90.67K,90.68K,90.701K,90.703K,90.706K,90.713K,90.715K,90.716K,90.72K,90.74K,90.803K,90.804K,90.808K,90.814K,90.815K,91.006K,91.007K,91.008K,91.01K,91.016K,91.024K,91.104K,91.106K,91.107K,91.108K,91.706K,91.709K,91.722K,91.723K,91.724K,91.731K,91.732K,91.733K,91.74K,91.744K,91.745K,91.746K,91.748K,91.752K,91.755K,91.765K,91.766K,91.768K,91.77K,91.773K,91.775K,91.776K,91.78K,91.789K,91.79K,91.791K,91.792K,91.801K,92.101K,92.102K,92.103K,92.104K,92.106K,92.107K,92.108K,92.109K,92.11K,92.113K,92.116K,92.118K,92.136K,92.14K,92.155K,92.401K,92.405K,92.408K,92.41K,92.411K,92.501K,92.503K,92.504K,92.505K,92.506K,92.509K,92.602K,92.603K,92.604K,92.606K,92.61K,92.612K,92.614K,92.617K,92.618K,92.62K,92.625K,92.626K,92.627K,92.63K,92.637K,92.646K,92.647K,92.648K,92.649K,92.651K,92.653K,92.655K,92.657K,92.66K,92.661K,92.662K,92.663K,92.683K,92.688K,92.691K,92.692K,92.694K,92.697K,92.701K,92.703K,92.704K,92.705K,92.706K,92.707K,92.708K,92.78K,92.782K,92.801K,92.802K,92.804K,92.805K,92.806K,92.807K,92.808K,92.821K,92.823K,92.831K,92.832K,92.833K,92.834K,92.835K,92.84K,92.841K,92.843K,92.844K,92.845K,92.86K,92.861K,92.865K,92.866K,92.867K,92.868K,92.869K,92.87K,92.879K,92.886K,92.887K,93.009K,93.01K,93.03K,93.035K,93.036K,93.041K,93.042K,93.043K,93.301K,93.304K,93.305K,93.309K,93.312K,93.611K,93.612K,93.65K,93.701K,93.702K,93.703K,93.704K,93.705K,93.71K,93.711K,93.72K,93.721K,93.722K,93.726K,93.727K,93.728K,93.74K,95.202K,95.203K,95.204K,95.205K,95.207K,95.208K,95.209K,95.21K,95.211K,95.231K,95.35K,95.351K,95.354K,95.355K,95.397K,95.605K,95.652K,95.655K,95.66K,95.673K,95.811K,95.814K,95.815K,95.816K,95.817K,95.818K,95.819K,95.82K,95.821K,95.822K,95.823K,95.824K,95.825K,95.828K,95.831K,95.833K,95.834K,95.835K,95.838K,95.864K]
Title: Lidar Zip
Definition: [90001,90002,90003,90004,90005,90006,90007,90008,90010,90011,90012,90013,90014,90015,90016,90017,90018,90019,90020,90021,90022,90023,90024,90025,90026,90027,90028,90029,90031,90032,90033,90034,90035,90036,90037,90038,90039,90040,90041,90042,90043,90044,90045,90046,90047,90048,90049,90056,90057,90058,90059,90061,90062,90063,90064,90065,90066,90067,90068,90069,90071,90077,90089,90094,90095,90201,90210,90211,90212,90220,90221,90222,90230,90232,90240,90241,90242,90245,90247,90248,90249,90250,90254,90255,90260,90261,90262,90266,90270,90272,90274,90277,90278,90280,90291,90292,90293,90301,90302,90303,90601,90602,90603,90604,90605,90606,90620,90621,90623,90630,90631,90638,90640,90650,90660,90670,90680,90701,90703,90706,90713,90715,90716,90720,90740,90803,90804,90808,90814,90815,91006,91007,91008,91010,91016,91024,91104,91106,91107,91108,91706,91709,91722,91723,91724,91731,91732,91733,91740,91744,91745,91746,91748,91752,91755,91765,91766,91768,91770,91773,91775,91776,91780,91789,91790,91791,91792,91801,92101,92102,92103,92104,92106,92107,92108,92109,92110,92113,92116,92118,92136,92140,92155,92401,92405,92408,92410,92411,92501,92503,92504,92505,92506,92509,92602,92603,92604,92606,92610,92612,92614,92617,92618,92620,92625,92626,92627,92630,92637,92646,92647,92648,92649,92651,92653,92655,92657,92660,92661,92662,92663,92683,92688,92691,92692,92694,92697,92701,92703,92704,92705,92706,92707,92708,92780,92782,92801,92802,92804,92805,92806,92807,92808,92821,92823,92831,92832,92833,92834,92835,92840,92841,92843,92844,92845,92860,92861,92865,92866,92867,92868,92869,92870,92879,92886,92887,93009,93010,93030,93035,93036,93041,93042,93043,93301,93304,93305,93309,93312,93611,93612,93650,93701,93702,93703,93704,93705,93710,93711,93720,93721,93722,93726,93727,93728,93740,95202,95203,95204,95205,95207,95208,95209,95210,95211,95231,95350,95351,95354,95355,95397,95605,95652,95655,95660,95673,95811,95814,95815,95816,95817,95818,95819,95820,95821,95822,95823,95824,95825,95828,95831,95833,95834,95835,95838,95864]
NodeLocation: 720,128,1
NodeSize: 64,40
ValueState: 2,630,77,431,561,,MIDM
{!40300|Att_SlicerPopupSize: 232,1001}

Index Lidar_Fields
Att_PrevIndexValue: ['ZIP Area (m2)','Lon','Lat','City','State','Year','LiDar Land Area Extent of ZIP (%)','Total number of buildings','Total rooftop area','Total No. Small Buildings','Total Area Small Buildings (m2)','Total No. Medium Buildings','Total Area Medium Buildings (m2)','Total No. Large Buildings','Total Area Large Buildings (m2)','Total No. of Small Bldg. Any Available Area','Total Area of Small Bldg. Any Available Area (m2)','Total No. of Small Bldg. >= 30 m2 Available Area','Total Area of Small Bldg. >= 30 m2 Available Area (m2)','Total No. of Small Bldg. >= 20 m2 Available Area','Total Area of Small Bldg. >= 20 m2 Available Area (m2)','Total No. of Small Bldg. >= 10 m2 Available Area','Total Area of Small Bldg. >= 10 m2 Available Area (m2)','Total No. of Small Bldg. >= 7.5 m2 Available Area','Total Area of Small Bldg. >= 7.5 m2 Available Area (m2)','Total No. of Small Bldg. >= 6 m2 Available Area','Total Area of Small Bldg. >= 6 m2 Available Area (m2)','Total No. of Small Bldg. >= 4.3 m2 Available Area','Total Area of Small Bldg. >= 4.3 m2 Available Area (m2)','Total No. of Medium Bldg. Any Available Area','Total Area of Medium Bldg. Any Available Area (m2)','Total No. of Medium Bldg. >= 30 m2 Available Area','Total Area of Medium Bldg. >= 30 m2 Available Area (m2)','Total No. of Medium Bldg. >= 20 m2 Available Area','Total Area of Medium Bldg. >= 20 m2 Available Area (m2)','Total No. of Medium Bldg. >= 10 m2 Available Area','Total Area of Medium Bldg. >= 10 m2 Available Area (m2)','Total No. of Medium Bldg. >= 7.5 m2 Available Area','Total Area of Medium Bldg. >= 7.5 m2 Available Area (m2)','Total No. of Medium Bldg. >= 6 m2 Available Area','Total Area of Medium Bldg. >= 6 m2 Available Area (m2)','Total No. of Medium Bldg. >= 4.3 m2 Available Area','Total Area of Medium Bldg. >= 4.3 m2 Available Area (m2)','Total No. of Large Bldg. Any Available Area','Total Area of Large Bldg. Any Available Area (m2)','Total No. of Large Bldg. >= 30 m2 Available Area','Total Area of Large Bldg. >= 30 m2 Available Area (m2)','Total No. of Large Bldg. >= 20 m2 Available Area','Total Area of Large Bldg. >= 20 m2 Available Area (m2)','Total No. of Large Bldg. >= 10 m2 Available Area','Total Area of Large Bldg. >= 10 m2 Available Area (m2)','Total No. of Large Bldg. >= 7.5 m2 Available Area','Total Area of Large Bldg. >= 7.5 m2 Available Area (m2)','Total No. of Large Bldg. >= 6 m2 Available Area','Total Area of Large Bldg. >= 6 m2 Available Area (m2)','Total No. of Large Bldg. >= 4.3 m2 Available Area','Total Area of Large Bldg. >= 4.3 m2 Available Area (m2)','Small Buildings (%)','Rooftop Area on Small Buildings (%)','Medium Buildings (%)','Rooftop Area on Medium Buildings (%)','Large Buildings (%)','Rooftop Area on Large Buildings (%)','Small Bldgs. >= 10 m2 (%)','Area of Small Bldgs. >= 10 m2 (m2)','Medium Bldgs. >= 10 m2 (%)','Area of Medium Bldgs. >= 10 m2 (m2)','Large Bldgs. >= 10 m2 (%)','Area of Large Bldgs. >= 10 m2 (m2)','Locale Description','2010 Population Density (people / sq. mile)','Census Region']
Title: Lidar Fields
Definition: ['ZIP Area (m2)','Lon','Lat','City','State','Year','LiDar Land Area Extent of ZIP (%)','Total number of buildings','Total rooftop area','Total No. Small Buildings','Total Area Small Buildings (m2)','Total No. Medium Buildings','Total Area Medium Buildings (m2)','Total No. Large Buildings','Total Area Large Buildings (m2)','Total No. of Small Bldg. Any Available Area','Total Area of Small Bldg. Any Available Area (m2)','Total No. of Small Bldg. >= 30 m2 Available Area','Total Area of Small Bldg. >= 30 m2 Available Area (m2)','Total No. of Small Bldg. >= 20 m2 Available Area','Total Area of Small Bldg. >= 20 m2 Available Area (m2)','Total No. of Small Bldg. >= 10 m2 Available Area','Total Area of Small Bldg. >= 10 m2 Available Area (m2)','Total No. of Small Bldg. >= 7.5 m2 Available Area','Total Area of Small Bldg. >= 7.5 m2 Available Area (m2)','Total No. of Small Bldg. >= 6 m2 Available Area','Total Area of Small Bldg. >= 6 m2 Available Area (m2)','Total No. of Small Bldg. >= 4.3 m2 Available Area','Total Area of Small Bldg. >= 4.3 m2 Available Area (m2)','Total No. of Medium Bldg. Any Available Area','Total Area of Medium Bldg. Any Available Area (m2)','Total No. of Medium Bldg. >= 30 m2 Available Area','Total Area of Medium Bldg. >= 30 m2 Available Area (m2)','Total No. of Medium Bldg. >= 20 m2 Available Area','Total Area of Medium Bldg. >= 20 m2 Available Area (m2)','Total No. of Medium Bldg. >= 10 m2 Available Area','Total Area of Medium Bldg. >= 10 m2 Available Area (m2)','Total No. of Medium Bldg. >= 7.5 m2 Available Area','Total Area of Medium Bldg. >= 7.5 m2 Available Area (m2)','Total No. of Medium Bldg. >= 6 m2 Available Area','Total Area of Medium Bldg. >= 6 m2 Available Area (m2)','Total No. of Medium Bldg. >= 4.3 m2 Available Area','Total Area of Medium Bldg. >= 4.3 m2 Available Area (m2)','Total No. of Large Bldg. Any Available Area','Total Area of Large Bldg. Any Available Area (m2)','Total No. of Large Bldg. >= 30 m2 Available Area','Total Area of Large Bldg. >= 30 m2 Available Area (m2)','Total No. of Large Bldg. >= 20 m2 Available Area','Total Area of Large Bldg. >= 20 m2 Available Area (m2)','Total No. of Large Bldg. >= 10 m2 Available Area','Total Area of Large Bldg. >= 10 m2 Available Area (m2)','Total No. of Large Bldg. >= 7.5 m2 Available Area','Total Area of Large Bldg. >= 7.5 m2 Available Area (m2)','Total No. of Large Bldg. >= 6 m2 Available Area','Total Area of Large Bldg. >= 6 m2 Available Area (m2)','Total No. of Large Bldg. >= 4.3 m2 Available Area','Total Area of Large Bldg. >= 4.3 m2 Available Area (m2)','Small Buildings (%)','Rooftop Area on Small Buildings (%)','Medium Buildings (%)','Rooftop Area on Medium Buildings (%)','Large Buildings (%)','Rooftop Area on Large Buildings (%)','Small Bldgs. >= 10 m2 (%)','Area of Small Bldgs. >= 10 m2 (m2)','Medium Bldgs. >= 10 m2 (%)','Area of Medium Bldgs. >= 10 m2 (m2)','Large Bldgs. >= 10 m2 (%)','Area of Large Bldgs. >= 10 m2 (m2)','Locale Description','2010 Population Density (people / sq. mile)','Census Region']
NodeLocation: 720,216,1
NodeSize: 64,40
DisplayOutputs: Object Object, Object Variable, Object Index, Index Lidar_Locale_Type, Variable Zip_to_Locale_Map
{!40300|Att_SlicerPopupSize: 237,1001}

Index Lidar_Min_Syst_Sizes
Att_PrevIndexValue: [0.645,0.9,1.125,1.5,3,4.5]
Title: Lidar Min System Sizes
Units: kW-DC
Definition: CopyIndex(Approx_kW_Equiv)
NodeLocation: 488,448,1
NodeSize: 64,40
WindState: 2,98,82,720,350
ValueState: 2,789,129,416,303,0,MIDM
NumberFormat: 2,F,2,3,0,0,2,0,$,0,"ABBREV",0,,,0,0,15

Index Lidar_Estimated_Fiel
Att_PrevIndexValue: ['ZIP Name','County','State','State-Zip','ZIP Integer','Locale','Total Small Buildings','Percent Suitability - Small Buildings']
Title: Lidar Estimated Fields
Definition: ['ZIP Name','County','State','State-Zip','ZIP Integer','Locale','Total Small Buildings','Percent Suitability - Small Buildings']
NodeLocation: 576,248,1
NodeSize: 64,40
{!40300|Att_SlicerPopupSize: 227,126}

Index Lidar_Estimated_Zips
Att_PrevIndexValue: [91.901K,91.902K,91.905K,91.906K,91.91K,91.911K,91.913K,91.914K,91.915K,91.916K,91.917K,91.932K,91.934K,91.935K,91.941K,91.942K,91.945K,91.948K,91.95K,91.962K,91.963K,91.977K,91.978K,91.98K,92.003K,92.004K,92.007K,92.008K,92.009K,92.01K,92.011K,92.014K,92.019K,92.02K,92.021K,92.024K,92.025K,92.026K,92.027K,92.028K,92.029K,92.036K,92.037K,92.04K,92.054K,92.055K,92.056K,92.057K,92.058K,92.059K,92.06K,92.061K,92.064K,92.065K,92.066K,92.067K,92.069K,92.07K,92.071K,92.075K,92.078K,92.081K,92.082K,92.083K,92.084K,92.086K,92.091K,92.093K,92.101K,92.102K,92.103K,92.104K,92.105K,92.106K,92.107K,92.108K,92.109K,92.11K,92.111K,92.113K,92.114K,92.115K,92.116K,92.117K,92.118K,92.119K,92.12K,92.121K,92.122K,92.123K,92.124K,92.126K,92.127K,92.128K,92.129K,92.13K,92.131K,92.134K,92.136K,92.139K,92.14K,92.145K,92.147K,92.154K,92.155K,92.161K,92.173K,92.179K,92.201K,92.203K,92.21K,92.227K,92.231K,92.233K,92.236K,92.241K,92.243K,92.249K,92.25K,92.251K,92.253K,92.254K,92.257K,92.259K,92.26K,92.264K,92.27K,92.273K,92.274K,92.275K,92.281K,92.53K,92.532K,92.536K,92.539K,92.543K,92.544K,92.545K,92.561K,92.562K,92.563K,92.57K,92.584K,92.586K,92.587K,92.59K,92.591K,92.592K,92.595K,92.596K,92.602K,92.603K,92.604K,92.606K,92.61K,92.612K,92.614K,92.617K,92.618K,92.62K,92.624K,92.625K,92.626K,92.627K,92.629K,92.63K,92.637K,92.646K,92.648K,92.649K,92.651K,92.653K,92.656K,92.657K,92.66K,92.661K,92.662K,92.663K,92.672K,92.673K,92.675K,92.676K,92.677K,92.678K,92.679K,92.688K,92.691K,92.692K,92.694K,92.697K,92.704K,92.707K,92.708K,92.782K,92.802K]
Title: Lidar Estimated Zips
Definition: [91901,91902,91905,91906,91910,91911,91913,91914,91915,91916,91917,91932,91934,91935,91941,91942,91945,91948,91950,91962,91963,91977,91978,91980,92003,92004,92007,92008,92009,92010,92011,92014,92019,92020,92021,92024,92025,92026,92027,92028,92029,92036,92037,92040,92054,92055,92056,92057,92058,92059,92060,92061,92064,92065,92066,92067,92069,92070,92071,92075,92078,92081,92082,92083,92084,92086,92091,92093,92101,92102,92103,92104,92105,92106,92107,92108,92109,92110,92111,92113,92114,92115,92116,92117,92118,92119,92120,92121,92122,92123,92124,92126,92127,92128,92129,92130,92131,92134,92136,92139,92140,92145,92147,92154,92155,92161,92173,92179,92201,92203,92210,92227,92231,92233,92236,92241,92243,92249,92250,92251,92253,92254,92257,92259,92260,92264,92270,92273,92274,92275,92281,92530,92532,92536,92539,92543,92544,92545,92561,92562,92563,92570,92584,92586,92587,92590,92591,92592,92595,92596,92602,92603,92604,92606,92610,92612,92614,92617,92618,92620,92624,92625,92626,92627,92629,92630,92637,92646,92648,92649,92651,92653,92656,92657,92660,92661,92662,92663,92672,92673,92675,92676,92677,92678,92679,92688,92691,92692,92694,92697,92704,92707,92708,92782,92802]
NodeLocation: 576,160,1
NodeSize: 64,40
WindState: 2,102,82,820,793
ValueState: 2,552,337,416,520,,MIDM

Index Lidar_Locale_Type
Title: Lidar Locale Type
Definition: INDEX locales:=CopyIndex(Lidar_Detailed_Data[Lidar_Fields=Locale_Label]);~
INDEX uniq_locale:=Unique(locales);~
SortIndex(uniq_locale)
NodeLocation: 720,392,1
NodeSize: 64,40
DisplayInputs: Object Object, Object Decision, Object Index, Index Lidar_Fields, Decision Locale_Label

Decision Locale_Label
Title: Locale Label
Definition: Choice(Lidar_Fields,70,0)
NodeLocation: 720,304,1
NodeSize: 64,40
DisplayOutputs: Object Object, Object Variable, Object Index, Index Lidar_Locale_Type, Variable Zip_to_Locale_Map

Decision Estim_Locale_Label
Title: Estimated Locale Label
Definition: Choice(Lidar_Estimated_Fiel,6,0)
NodeLocation: 576,336,1
NodeSize: 64,40

Constant SystSize_per_Roofspc
Title: System Size per Roofspace
Units: kW/m2
Description: The LIDAR study suggests that 10m2 of roofspace is roughly capable of hosting a 1.5kW-DC system, given the shading, tilt, and azimuth are within reasonable bounds.~
~
Source:~
https://www.nrel.gov/docs/fy16osti/65298.pdf (p. 10)
Definition: SubTable(StructSingCell_Input[StructSingCell_Names=Size_per_Roof_Label])
NodeLocation: 128,304,1
NodeSize: 64,40
WindState: 2,43,-4,720,350
Aliases: Alias Al1568696807, FormNode Fo1568696807, FormNode Fo1540936783

Variable Approx_kW_Equiv
Title: Approx kW Equivalency
Units: kW-DC
Description: The rough kW equivalency for each size of contiguous roofspace.
Definition: Minimum_Roofspace * SystSize_per_Roofspc
NodeLocation: 280,304,1
NodeSize: 64,40
ValueState: 2,351,264,416,310,0,MIDM
NumberFormat: 2,F,2,3,0,0,2,0,$,0,"ABBREV",0,,,0,0,15

Constant Lidar_Estimated_Bldg
Title: Lidar Estimated Bldg Suitability
Description: ~
Source:~
NSRDB Viewer, Estimated National Small Building Suitability layer
Definition: Table(Lidar_Estimated_Fiel,Lidar_Estimated_Zips)(~
'ALPINE','BONITA','BOULEVARD','CAMPO','CHULA VISTA','CHULA VISTA','CHULA VISTA','CHULA VISTA','CHULA VISTA','DESCANSO','DULZURA','IMPERIAL BEACH','JACUMBA','JAMUL','LA MESA','LA MESA','LEMON GROVE','MOUNT LAGUNA','NATIONAL CITY','PINE VALLEY','POTRERO','SPRING VALLEY','SPRING VALLEY','TECATE','BONSALL','BORREGO SPRINGS','CARDIFF BY THE SEA','CARLSBAD','CARLSBAD','CARLSBAD','CARLSBAD','DEL MAR','EL CAJON','EL CAJON','EL CAJON','ENCINITAS','ESCONDIDO','ESCONDIDO','ESCONDIDO','FALLBROOK','ESCONDIDO','JULIAN','LA JOLLA','LAKESIDE','OCEANSIDE','CAMP PENDLETON','OCEANSIDE','OCEANSIDE','OCEANSIDE','PALA','PALOMAR MOUNTAIN','PAUMA VALLEY','POWAY','RAMONA','RANCHITA','RANCHO SANTA FE','SAN MARCOS','SANTA YSABEL','SANTEE','SOLANA BEACH','SAN MARCOS','VISTA','VALLEY CENTER','VISTA','VISTA','WARNER SPRINGS','RANCHO SANTA FE','LA JOLLA','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','CORONADO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN YSIDRO','SAN DIEGO','INDIO','INDIO','INDIAN WELLS','BRAWLEY','CALEXICO','CALIPATRIA','COACHELLA','DESERT HOT SPRINGS','EL CENTRO','HEBER','HOLTVILLE','IMPERIAL','LA QUINTA','MECCA','NILAND','OCOTILLO','PALM DESERT','PALM SPRINGS','RANCHO MIRAGE','SEELEY','THERMAL','SALTON CITY','WESTMORLAND','LAKE ELSINORE','LAKE ELSINORE','AGUANGA','ANZA','HEMET','HEMET','HEMET','MOUNTAIN CENTER','MURRIETA','MURRIETA','PERRIS','MENIFEE','SUN CITY','QUAIL VALLEY','TEMECULA','TEMECULA','TEMECULA','WILDOMAR','WINCHESTER','IRVINE','IRVINE','IRVINE','IRVINE','FOOTHILL RANCH','IRVINE','IRVINE','IRVINE','IRVINE','IRVINE','CAPISTRANO BEACH','CORONA DEL MAR','COSTA MESA','COSTA MESA','DANA POINT','LAKE FOREST','LAGUNA WOODS','HUNTINGTON BEACH','HUNTINGTON BEACH','HUNTINGTON BEACH','LAGUNA BEACH','LAGUNA HILLS','ALISO VIEJO','NEWPORT COAST','NEWPORT BEACH','NEWPORT BEACH','NEWPORT BEACH','NEWPORT BEACH','SAN CLEMENTE','SAN CLEMENTE','SAN JUAN CAPISTRANO','SILVERADO','LAGUNA NIGUEL','TRABUCO CANYON','TRABUCO CANYON','RANCHO SANTA MARGARITA','MISSION VIEJO','MISSION VIEJO','LADERA RANCH','IRVINE','SANTA ANA','SANTA ANA','FOUNTAIN VALLEY','TUSTIN','ANAHEIM',~
'SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','SAN DIEGO','RIVERSIDE','RIVERSIDE','RIVERSIDE','IMPERIAL','IMPERIAL','IMPERIAL','RIVERSIDE','RIVERSIDE','IMPERIAL','IMPERIAL','IMPERIAL','IMPERIAL','RIVERSIDE','RIVERSIDE','IMPERIAL','IMPERIAL','RIVERSIDE','RIVERSIDE','RIVERSIDE','IMPERIAL','RIVERSIDE','IMPERIAL','IMPERIAL','RIVERSIDE','RIVERSIDE','RIVERSIDE','RIVERSIDE','RIVERSIDE','RIVERSIDE','RIVERSIDE','RIVERSIDE','RIVERSIDE','RIVERSIDE','RIVERSIDE','RIVERSIDE','RIVERSIDE','RIVERSIDE','RIVERSIDE','RIVERSIDE','RIVERSIDE','RIVERSIDE','RIVERSIDE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE','ORANGE',~
'CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA','CA',~
'CA_91901','CA_91902','CA_91905','CA_91906','CA_91910','CA_91911','CA_91913','CA_91914','CA_91915','CA_91916','CA_91917','CA_91932','CA_91934','CA_91935','CA_91941','CA_91942','CA_91945','CA_91948','CA_91950','CA_91962','CA_91963','CA_91977','CA_91978','CA_91980','CA_92003','CA_92004','CA_92007','CA_92008','CA_92009','CA_92010','CA_92011','CA_92014','CA_92019','CA_92020','CA_92021','CA_92024','CA_92025','CA_92026','CA_92027','CA_92028','CA_92029','CA_92036','CA_92037','CA_92040','CA_92054','CA_92055','CA_92056','CA_92057','CA_92058','CA_92059','CA_92060','CA_92061','CA_92064','CA_92065','CA_92066','CA_92067','CA_92069','CA_92070','CA_92071','CA_92075','CA_92078','CA_92081','CA_92082','CA_92083','CA_92084','CA_92086','CA_92091','CA_92093','CA_92101','CA_92102','CA_92103','CA_92104','CA_92105','CA_92106','CA_92107','CA_92108','CA_92109','CA_92110','CA_92111','CA_92113','CA_92114','CA_92115','CA_92116','CA_92117','CA_92118','CA_92119','CA_92120','CA_92121','CA_92122','CA_92123','CA_92124','CA_92126','CA_92127','CA_92128','CA_92129','CA_92130','CA_92131','CA_92134','CA_92136','CA_92139','CA_92140','CA_92145','CA_92147','CA_92154','CA_92155','CA_92161','CA_92173','CA_92179','CA_92201','CA_92203','CA_92210','CA_92227','CA_92231','CA_92233','CA_92236','CA_92241','CA_92243','CA_92249','CA_92250','CA_92251','CA_92253','CA_92254','CA_92257','CA_92259','CA_92260','CA_92264','CA_92270','CA_92273','CA_92274','CA_92275','CA_92281','CA_92530','CA_92532','CA_92536','CA_92539','CA_92543','CA_92544','CA_92545','CA_92561','CA_92562','CA_92563','CA_92570','CA_92584','CA_92586','CA_92587','CA_92590','CA_92591','CA_92592','CA_92595','CA_92596','CA_92602','CA_92603','CA_92604','CA_92606','CA_92610','CA_92612','CA_92614','CA_92617','CA_92618','CA_92620','CA_92624','CA_92625','CA_92626','CA_92627','CA_92629','CA_92630','CA_92637','CA_92646','CA_92648','CA_92649','CA_92651','CA_92653','CA_92656','CA_92657','CA_92660','CA_92661','CA_92662','CA_92663','CA_92672','CA_92673','CA_92675','CA_92676','CA_92677','CA_92678','CA_92679','CA_92688','CA_92691','CA_92692','CA_92694','CA_92697','CA_92704','CA_92707','CA_92708','CA_92782','CA_92802',~
91.901K,91.902K,91.905K,91.906K,91.91K,91.911K,91.913K,91.914K,91.915K,91.916K,91.917K,91.932K,91.934K,91.935K,91.941K,91.942K,91.945K,91.948K,91.95K,91.962K,91.963K,91.977K,91.978K,91.98K,92.003K,92.004K,92.007K,92.008K,92.009K,92.01K,92.011K,92.014K,92.019K,92.02K,92.021K,92.024K,92.025K,92.026K,92.027K,92.028K,92.029K,92.036K,92.037K,92.04K,92.054K,92.055K,92.056K,92.057K,92.058K,92.059K,92.06K,92.061K,92.064K,92.065K,92.066K,92.067K,92.069K,92.07K,92.071K,92.075K,92.078K,92.081K,92.082K,92.083K,92.084K,92.086K,92.091K,92.093K,92.101K,92.102K,92.103K,92.104K,92.105K,92.106K,92.107K,92.108K,92.109K,92.11K,92.111K,92.113K,92.114K,92.115K,92.116K,92.117K,92.118K,92.119K,92.12K,92.121K,92.122K,92.123K,92.124K,92.126K,92.127K,92.128K,92.129K,92.13K,92.131K,92.134K,92.136K,92.139K,92.14K,92.145K,92.147K,92.154K,92.155K,92.161K,92.173K,92.179K,92.201K,92.203K,92.21K,92.227K,92.231K,92.233K,92.236K,92.241K,92.243K,92.249K,92.25K,92.251K,92.253K,92.254K,92.257K,92.259K,92.26K,92.264K,92.27K,92.273K,92.274K,92.275K,92.281K,92.53K,92.532K,92.536K,92.539K,92.543K,92.544K,92.545K,92.561K,92.562K,92.563K,92.57K,92.584K,92.586K,92.587K,92.59K,92.591K,92.592K,92.595K,92.596K,92.602K,92.603K,92.604K,92.606K,92.61K,92.612K,92.614K,92.617K,92.618K,92.62K,92.624K,92.625K,92.626K,92.627K,92.629K,92.63K,92.637K,92.646K,92.648K,92.649K,92.651K,92.653K,92.656K,92.657K,92.66K,92.661K,92.662K,92.663K,92.672K,92.673K,92.675K,92.676K,92.677K,92.678K,92.679K,92.688K,92.691K,92.692K,92.694K,92.697K,92.704K,92.707K,92.708K,92.782K,92.802K,~
'Rural Fringe','City Large','Rural Fringe','Rural Fringe','City Large','City Large','City Large','City Large','City Large','Rural Fringe','Rural Fringe','Suburb Large','Rural Fringe','Rural Fringe','City Large','City Large','City Large','Rural Fringe','City Large','Rural Fringe','Rural Fringe','City Large','City Large','Rural Fringe','Suburb Large','Rural Fringe','City Small','City Small','City Small','City Small','City Small','City Large','City Large','City Large','City Large','City Small','City Large','City Small','Town Fringe','City Small','City Small','Rural Fringe','City Large','City Large','Suburb Large','Suburb Large','Suburb Large','Suburb Large','Suburb Large','City Small','Rural Fringe','Rural Fringe','City Large','Town Fringe','Rural Fringe','City Large','City Small','Rural Fringe','City Large','City Large','City Small','Suburb Large','City Small','Suburb Large','Suburb Large','Rural Fringe','City Large','City Large','City Large','City Large','City Large','City Large','City Large','City Large','City Large','City Large','City Large','City Large','City Large','City Large','City Large','City Large','City Large','City Large','Suburb Large','City Large','City Large','City Large','City Large','City Large','City Large','City Large','City Large','City Large','City Large','City Large','City Large','City Large','City Large','City Large','City Large','City Large','City Large','City Large','Suburb Large','City Large','Suburb Large','City Large','Rural Fringe','Suburb Large','Suburb Large','Town Fringe','Suburb Small','Town Fringe','Rural Fringe','Suburb Large','Suburb Small','Town Fringe','Town Fringe','Suburb Small','Suburb Large','Rural Fringe','Town Fringe','Suburb Small','Suburb Large','Suburb Large','Suburb Large','Suburb Small','Rural Fringe','Rural Fringe','Town Fringe','Suburb Midsize','Suburb Midsize','City Small','City Small','City Small','City Small','City Small','City Small','Rural Fringe','Rural Fringe','Rural Fringe','Suburb Midsize','Suburb Midsize','Suburb Midsize','Rural Fringe','City Small','City Small','Suburb Midsize','City Small','City Midsize','City Midsize','City Midsize','City Midsize','Suburb Large','City Midsize','City Midsize','City Midsize','City Midsize','City Midsize','Suburb Large','City Midsize','City Midsize','City Midsize','Suburb Large','Suburb Large','Suburb Large','City Midsize','Suburb Large','Suburb Large','Suburb Large','Suburb Large','Suburb Large','City Midsize','City Midsize','City Midsize','City Midsize','City Midsize','Suburb Large','Suburb Large','Suburb Large','City Midsize','Suburb Large','Suburb Large','Suburb Large','Suburb Large','Suburb Large','Suburb Large','Suburb Large','City Midsize','City Large','City Large','Suburb Large','City Small','Suburb Large',~
4639,5861,345,375,15.291K,16.027K,7374,2441,6054,481,63,5835,0,2299,8678,9070,6943,0,9305,350,0,13.642K,2357,0,1388,862,2826,7795,11.169K,3740,5634,5856,10.109K,10.352K,10.345K,13.526K,8458,9897,10.897K,14.877K,6769,1985,10.569K,9619,8390,0,14.075K,11.254K,5514,290,-999,1148,13.042K,11.112K,0,153,10.482K,285,12.642K,2930,8625,6379,6706,7097,9600,299,962,307,1352,8660,7514,10.953K,10.903K,6694,8910,1331,9156,5778,8981,8924,16.563K,11.248K,9276,13.63K,5479,7308,8915,2572,6278,5524,4185,13.801K,8873,11.044K,13.1K,10.43K,8062,982,24,7093,5,0,0,13.559K,3,210,3430,135,14.534K,10.685K,4055,8515,6859,1377,7447,2551,12.909K,1357,3078,3562,18.7K,1142,296,0,10.667K,4869,8180,0,3630,-999,515,12.459K,3727,1279,518,8144,14.041K,8068,2454,15.857K,12.668K,8726,11.7K,7624,6358,2135,11.717K,19.231K,8031,8161,3772,4402,6128,3811,1759,2356,4492,977,2709,9066,2247,5088,10.381K,14.071K,6670,14.102K,2009,16.502K,10.453K,9707,9329,6269,9321,3007,8189,1807,1437,6592,8379,6883,11.675K,4019,15.881K,0,10.037K,7821,13.372K,13.616K,4984,11,13.911K,10.136K,14.455K,4403,6512,~
0.866903436,0.870298724,0.877352982,0.876123774,0.89250345,0.898889243,0.898159367,0.886382185,0.891808462,0.872128919,0.878213973,0.954776664,0.878697001,0.872664847,0.852104805,0.901540887,0.909255301,0.859933537,0.901225943,0.863371205,0.873441828,0.888212132,0.90048338,0.873816819,0.90284773,0.879980221,0.92740717,0.924554319,0.914407226,0.895269247,0.920056369,0.83757849,0.877171819,0.87732935,0.875158371,0.902791756,0.869030111,0.913568091,0.904504806,0.929642368,0.902112207,0.874838246,0.863674905,0.888755006,0.931649998,0.938198874,0.921458913,0.918427037,0.940708713,0.942658163,0.770252386,0.846593004,0.879921172,0.911403656,0.876272214,0.778878255,0.906760799,0.858030293,0.899124539,0.873692422,0.908191781,0.910599944,0.933484627,0.934351359,0.897547337,0.865308364,0.834845777,0.87100357,0.832100592,0.897921478,0.899520894,0.923491281,0.899718047,0.935315208,0.856228956,0.767092412,0.892047761,0.919868467,0.891023371,0.904190946,0.894353151,0.898736386,0.910413972,0.894866662,0.830078481,0.896708357,0.88605655,0.876046253,0.873965554,0.882241211,0.886238442,0.893106562,0.865813875,0.866734114,0.877861427,0.863566539,0.891519083,0.91732119,0.875,0.903115175,1,0.890518786,0.901557523,0.903559353,1,0.887087323,0.94704517,0.901721604,0.878621969,0.945907454,0.919516171,0.923447741,0.901061613,0.920598,0.874913624,0.951002441,0.895855219,0.927523404,0.928548401,0.900096035,0.935070287,0.863974921,0.892616751,0.89801228,0.940038695,0.943094861,0.925156898,0.884965792,0.863852237,0.877963239,0.925454134,0.895905357,0.884289968,0.942376579,0.943265896,0.917140428,0.935132722,0.905404394,0.932178232,0.850401254,0.831266187,0.834145549,0.865119229,0.881354348,0.883444386,0.856741816,0.905093619,0.92356962,0.873819916,0.91697164,0.971102863,0.902544298,0.978785901,0.957491472,0.906054413,0.908319185,0.922751558,0.937563971,0.891842008,0.958636664,0.951506194,0.924331761,0.981408342,0.935256911,0.921146192,0.923415118,0.975111996,0.979517634,0.93559199,0.966003915,0.927806501,0.898389061,0.920182501,0.934153642,0.947978996,0.861095739,0.8434238,0.899878641,0.916821163,0.904844275,0.935089195,0.897999271,0.889411008,0.940105009,0.924469623,0.906303683,0.96343105,0.968639835,0.940208668,0.909090909,0.96779527,0.940607735,0.989277067,0.938451056,0.965601966)
NodeLocation: 128,184,1
NodeSize: 64,40
WindState: 2,347,593,720,350
DefnState: 2,270,10,1281,863,0,DFNM
ValueState: 2,148,44,1253,848,0,MIDM
Aliases: Alias Al1568696808, FormNode Fo1568696808, FormNode Fo1540936787
GraphSetup: Att_ContLineStyle Graph_Primary_Valdim:4
ReformDef: [Lidar_Estimated_Fiel,Lidar_Estimated_Zips]
ReformVal: [Lidar_Estimated_Fiel,Lidar_Estimated_Zips]
Att_ResultSliceState: [Lidar_Estimated_Fiel,8,Lidar_Estimated_Zips,1]

Variable Zip_Mismatches
Title: Zip Mismatches
Description: PV spatial IDs that don't match a zip code from the estimated Lidar data.
Definition: Subset(PositionInIndex(Lidar_Estimated_Zips, PV_Spatial_ID, Lidar_Estimated_Zips) = 0)
NodeLocation: 280,432,1
NodeSize: 64,40
ValueState: 2,573,21,860,832,,MIDM

Variable Zip_to_Locale_Map
Title: Zip to Locale Map
Description: Maps detailed lidar data by zip code to a lidar locale type.
Definition: Lidar_Detailed_Data[Lidar_Fields=Locale_Label]
NodeLocation: 704,496,1
NodeSize: 64,40
ValueState: 2,440,73,416,672,,MIDM
DisplayInputs: Object Object, Object Decision, Object Index, Index Lidar_Fields, Decision Locale_Label

Variable LidarZip_for_ID
Title: Lidar Zip for Spatial ID
Description: For spatial IDs that aren't represented in the Lidar zip code list, this assigns the nearest (in terms of zip code value) to an unmatched spatial ID. This is generally a reasonable approach, given that similar zip codes are generally adjacent to one another.
Definition: VAR numeric_ID:=IF IsNumber(PV_Spatial_ID) THEN PV_Spatial_ID ELSE Null;~
StepInterp(Lidar_Estimated_Zips, Lidar_Estimated_Zips, numeric_ID, Lidar_Estimated_Zips)
NodeLocation: 128,88,1
NodeSize: 64,40
ValueState: 2,472,51,416,726,,MIDM

Variable Locale_for_Estimated
Title: Locale for Estimated Zips
Description: The Lidar locale type for PV spatial IDs.
Definition: Lidar_Estimated_Bldg[Lidar_Estimated_Fiel=Estim_Locale_Label, Lidar_Estimated_Zips=LidarZip_for_ID]
NodeLocation: 280,136,1
NodeSize: 64,40
WindState: 2,343,385,720,350
ValueState: 2,536,98,416,743,,MIDM

FormNode Fo1540936783
Title: System Size per Roofspace
Definition: 0
NodeLocation: 128,356,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: SystSize_per_Roofspc

FormNode Fo1540936787
Title: Lidar Estimated Bldg Suitability
Definition: 0
NodeLocation: 128,236,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Lidar_Estimated_Bldg

Variable SDGE_Matches
Title: SDGE Matches
Definition: PositionInIndex(Lidar_Zip, PV_Spatial_ID, Lidar_Zip) > 0
NodeLocation: 128,528,1
NodeSize: 64,40
ValueState: 2,280,41,498,815,,MIDM
Att__TotalsIndex: [PV_Spatial_ID]

Text FrameNode_1545066682
NodeLocation: 752,336,-20
NodeSize: 360,304
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus: yes~
Show_description:20

Close Lidar_Mappings

Module Roofspace_Per_Buildi
Title: Roofspace Per Building
Author: JamesMilford
Date: Wed, Nov 7, 2018 1:59 PM
NodeLocation: 112,240,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,152,58,1430,596,17,10
NodeColor: 65535,65535,65535
AcpStyles: FrameNode: FrameNode_1545066262

Decision Year_of_Consump_Data
Title: Year of Consumption Data
Description: The year from which consumption data is available.
Definition: SubTable(StructSingCell_Input[StructSingCell_Names=Consump_Year_Label])
NodeLocation: 280,280,1
NodeSize: 64,40
NodeColor: 65535,65531,1
DisplayOutputs: Object Object, Object Variable

Variable Usable_PV_stock_to_b
Title: Usable PV stock to building stock
Units: (bldgs or m2)/bldg
Description: Ratio of usable PV stock (either m2 area or # of buildings, depending on the PV stock basis) to building counts. This accounts for technical suitability of the input area or building stocks.
Definition: {IF PV_Stock_Basis_by_Se[All_Sectors=PV_Sectors] = Buildings_Label~
THEN PV_suitability[All_PV_Sectors=PV_Sectors,All_Utilities=Selected_Utility]~
ELSE }Usable_PV_Area_to_Bu
NodeLocation: 600,160,1
NodeSize: 64,40
ValueState: 2,385,270,1271,401,0,MIDM
Aliases: Alias Al263822787
ReformVal: [PV_Sectors,PV_Spatial_ID]
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,0,Area_Type,1]
Att_ColorRole: Null

Text FrameNode_1545066262
NodeLocation: 1080,328,-20
NodeSize: 360,304
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus: yes~
Show_description:20

Constant Total_PV_Area
Title: Total PV Area
Units: m2
Description: m2 of PV area by area type. not relevant for any sectors where building count will be used as the basis for solar PV potential rather than roof area.~
~
Prior to model changes, this came from the m2_of_Eligible node for the SDGE forecast (to facilitate reproducibility).
Definition: Table(Spatial_ID,All_Utilities,Building_Stock_Year,All_PV_Sectors,Area_Type)(~
212190054.8952052,~
106070694.506306,~
5923752.1144352965,~
214410076.08017442,~
106778905.08682972,~
5894647.3517414825,~
216653324.0561643,~
107491844.23285122,~
5865685.587470813,~
218920041.8315861,~
108209543.51595706,~
5836866.119038998,~
221210474.95730677,~
108932034.71853034,~
5808188.247313708,~
223524871.5532493,~
109659349.83515811,~
5779651.27659761,~
225863482.33527115,~
110391521.07404819,~
5751254.514611494,~
228226560.64232406,~
111128580.8584555,~
5722997.272477477,~
230614362.46389788,~
111870561.82811782,~
5694878.864702293,~
233027146.46775174,~
112617496.84070131,~
5666898.609160662,~
235465174.02793512,~
113369418.97325549,~
5639055.827078743,~
237928709.2531022,~
114126361.52367797,~
5611349.843017669,~
240418019.01512256,~
114888358.01218913,~
5583779.98485716,~
242933372.9779909,~
115655442.18281643,~
5556345.583779216,~
245475043.62703955,~
116427648.00488873,~
5529045.974251897,~
248043306.29845652,~
117205009.6745406,~
5501880.4940131735,~
250638439.2091122,~
117987561.61622663,~
5474848.484054863,~
253260723.4866984,~
118775338.48424591,~
5447949.288606643,~
255910443.2001825,~
119568375.16427661,~
5421182.2551201405,~
258587885.3905804,~
120366706.77492085,~
5394546.734253105,~
261293340.1020512,~
121170368.6692599,~
5368042.079853654,~
264027100.41331747,~
121979396.43641976,~
5341667.648944598,~
266789462.46941403,~
122793825.90314712,~
5315422.801707843,~
269580725.51376903,~
123613693.13539597,~
5289306.901468871,~
272401191.9206207,~
124439034.43992469,~
5263319.31468129,~
275251167.2277731,~
125269886.36590385,~
5237459.41091147,~
278130960.16969466,~
126106285.70653479,~
5211726.562823245,~
281040882.71096313,~
126948269.50067887,~
5186120.1461627,~
283981250.08006024,~
127795875.03449777,~
5160639.53974302,~
286952380.8035201,~
128649139.84310463,~
5135284.125429426,~
289954596.7404347,~
129508101.71222624,~
5110053.288124179,~
292988223.11732066,~
130372798.67987634,~
5084946.415751655,~
296053588.5633505,~
131243269.03804007,~
5059962.8992435,~
299151025.1459528,~
132119551.33436969,~
5035102.132523854,~
302280868.40678453,~
133001684.37389162,~
5010363.512494648,~
305443457.39808,~
133889707.22072487,~
4985746.439020971,~
308639134.71937984,~
134783659.1998109,~
4961250.314916516,~
311868246.55464464,~
135683579.89865515,~
4936874.545929089,~
315131142.7097564,~
136589509.1690801,~
4912618.540726195,~
318428176.6504127,~
137501487.12899,~
4888481.710880691,~
321759705.54041725,~
138419554.16414747,~
4864463.470856515,~
325126090.28037107,~
139343750.92996198,~
4840563.237994474,~
328527695.54676825,~
140274118.35329017,~
4816780.432498121,~
331964889.83150107,~
141210697.63424823,~
4793114.477419676,~
335438045.48177826,~
142153530.24803644,~
4769564.798646043,~
338947538.7404609,~
143102657.94677585,~
4746130.824884871,~
342493749.78682035,~
144058122.76135713,~
4722811.987650704,~
346077062.7777228,~
145019967.00330198,~
4699607.721251184,~
349697865.88924426,~
145988233.26663673,~
4676517.462773332,~
353356551.35872144,~
146962964.4297786,~
4653540.65206989,~
357053515.5272422,~
147944203.6574346,~
4630676.731745732,~
186766997.16076967,~
27455889.070269186,~
4885133.744353354,~
187138431.6240012,~
27374024.89112159,~
4894849.0958754765,~
187510604.7806988,~
27292404.803280246,~
4904583.768886046,~
187883518.0999454,~
27211028.0789474,~
4914337.8018108355,~
188257173.0537456,~
27129893.992495343,~
4924111.233152042,~
188631571.11703146,~
27049001.820459947,~
4933904.101488432,~
189006713.7676683,~
26968350.841534205,~
4943716.4454754945,~
189382602.48646063,~
26887940.336561803,~
4953548.303845597,~
189759238.75715786,~
26807769.588530708,~
4963399.715408137,~
190136624.06646022,~
26727837.88256678,~
4973270.719049692,~
190514759.90402466,~
26648144.505927384,~
4983161.353734177,~
190893647.7624707,~
26568688.74799505,~
4993071.658502996,~
191273289.13738626,~
26489469.900271125,~
5003001.672475198,~
191653685.52733368,~
26410487.25636946,~
5012951.434847631,~
192034838.43385556,~
26331740.11201011,~
5022920.984895092,~
192416749.3614807,~
26253227.765013058,~
5032910.361970492,~
192799419.8177301,~
26174949.515291944,~
5042919.605505,~
193182851.31312278,~
26096904.664847836,~
5052948.755008208,~
193567045.36118183,~
26019092.517762993,~
5062997.8500682805,~
193952003.4784404,~
25941512.38019467,~
5073066.930352115,~
194337727.18444765,~
25864163.560368925,~
5016538.482013484,~
194724218.00177476,~
25787045.36857445,~
4960639.921968354,~
195111477.4560209,~
25710157.117156427,~
4905364.231462912,~
195499507.07581934,~
25633498.12051039,~
4850704.469952299,~
195888308.39284343,~
25557067.695076108,~
4796653.774229144,~
196277882.94181257,~
25480865.159331508,~
4743205.357561794,~
196668232.26049846,~
25404889.833786573,~
4690352.508842166,~
197059357.889731,~
25329141.040977303,~
4638088.591743076,~
197451261.37340438,~
25253618.105459664,~
4586407.043884975,~
197843944.25848332,~
25178320.35380357,~
4535301.376011953,~
198237408.09500903,~
25103247.114586875,~
4484765.171176938,~
198631654.43610537,~
25028397.718389384,~
4434792.083935969,~
199026684.83798498,~
24953771.497786887,~
4385375.839551441,~
199422500.8599555,~
24879367.787345212,~
4336510.233204246,~
199819104.06442553,~
24805185.923614282,~
4288189.129214668,~
200216496.01691106,~
24731225.24512221,~
4240406.460271984,~
200614678.28604144,~
24657485.092369385,~
4193156.226672633,~
201013652.44356564,~
24583964.807822607,~
4146432.4955668775,~
201413420.0643585,~
24510663.73590922,~
4100229.400213865,~
201813982.72642687,~
24437581.223011255,~
4054541.1392449844,~
202215342.0109159,~
24364716.61745962,~
4009361.9759354326,~
202617499.50211525,~
24292069.26952828,~
3964686.2374838986,~
203020456.7874653,~
24219638.531428456,~
3920508.3143002726,~
203424215.45756355,~
24147423.757302858,~
3876822.6593012926,~
203828777.10617074,~
24075424.30321993,~
3833623.787214041,~
204234143.3302173,~
24003639.527168095,~
3790906.2738872,~
204640315.72980946,~
23932068.789050046,~
3748664.755609981,~
205047295.90823576,~
23860711.450677022,~
3706893.928438647,~
205455085.47197327,~
23789566.875763126,~
3665588.5475305375,~
205863686.03069395,~
23718634.429919653,~
3624743.42648551,~
206273099.197271,~
23647913.48064943,~
3584353.4366947277,~
11563629.299145794,~
2267686.4648552504,~
1925724.5651504253,~
11600778.57780963,~
2271623.4168295776,~
1912524.0878500277,~
11638047.202127805,~
2275567.2037835587,~
1899414.0973223036,~
11675435.555509789,~
2279517.8375834664,~
1886393.9732975578,~
11712944.022596791,~
2283475.330116175,~
1873463.0997579268,~
11750572.989265718,~
2287439.6932891957,~
1860620.8649082326,~
11788322.84263314,~
2291410.9390307115,~
1847866.6611470375,~
11826193.971059281,~
2295389.0792896156,~
1835199.8850378967,~
11864186.76415201,~
2299374.1260355446,~
1822619.9372808079,~
11902301.612770848,~
2303366.091258916,~
1810126.2226838567,~
11940538.909030987,~
2307364.986970965,~
1797718.1501350568,~
11978899.04630733,~
2311370.8252037778,~
1785395.1325743825,~
12017382.419238534,~
2315383.618010331,~
1773156.5869659935,~
12055989.423731074,~
2319403.3774645254,~
1761001.93427065,~
12094720.456963308,~
2323430.115661225,~
1748930.599418316,~
12133575.917389572,~
2327463.84471629,~
1736942.0112809523,~
12172556.20474427,~
2331504.576766616,~
1725035.602645494,~
12211661.720045999,~
2335552.32397017,~
1713210.8101870145,~
12250892.865601659,~
2339607.098506026,~
1701467.0744420728,~
12290250.045010606,~
2343668.9125744016,~
1689803.8397822438,~
12329733.663168795,~
2347737.7783966963,~
1678220.5543878302,~
12369344.12627295,~
2351813.708215527,~
1666716.6702217543,~
12409081.84182474,~
2355896.7142947647,~
1655291.6430036288,~
12448947.218634974,~
2359986.8089195727,~
1643944.9321840052,~
12488940.666827803,~
2364084.004396442,~
1632676.0009187993,~
12529062.597844943,~
2368188.313053229,~
1621484.3160438915,~
12569313.424449908,~
2372299.747239193,~
1610369.348049901,~
12609693.56073225,~
2376418.3193250326,~
1599330.5710571338,~
12650203.422111828,~
2380544.041702924,~
1588367.462790702,~
12690843.425343078,~
2384676.9267865564,~
1577479.5045558123,~
12731613.988519296,~
2388816.9870111714,~
1566666.1812132269,~
12772515.531076945,~
2392964.2348335995,~
1555926.981154889,~
12813548.473799972,~
2397118.682732297,~
1545261.3962797192,~
12854713.238824127,~
2401280.343207385,~
1534668.9219695742,~
12896010.249641316,~
2405449.2287806855,~
1524149.0570653724,~
12937439.931103952,~
2409625.35199576,~
1513701.3038433832,~
12979002.70942933,~
2413808.7254179474,~
1503325.167991678,~
13020699.012204004,~
2417999.3616344007,~
1493020.1585867424,~
13062529.268388197,~
2422197.273254126,~
1482785.78807025,~
13104493.908320205,~
2426402.4729080196,~
1472621.572225995,~
13146593.363720829,~
2430614.973248907,~
1462527.0301569807,~
13188828.067697814,~
2434834.7869515796,~
1452501.6842626694,~
13231198.454750305,~
2439061.9267128347,~
1442545.0602163842,~
13273704.960773319,~
2443296.4052515123,~
1432656.686942868,~
13316348.023062227,~
2447538.235308533,~
1422836.0965959951,~
13359128.080317255,~
2451787.4296469376,~
1413082.8245366367,~
13402045.572647993,~
2456044.001051925,~
1403396.409310677,~
13445100.941577928,~
2460307.9623308904,~
1393776.392627181,~
13488294.630048985,~
2464579.326313464,~
1384222.3193367112,~
13531627.08242608,~
2468858.1058515497,~
1374733.7374097933,~
13575098.744501697,~
2473144.3138193637,~
1365310.1979155296,~
169456815.59221542,~
21785279.230652094,~
5517531.287608651,~
171042479.69943243,~
21973027.34536535,~
5491332.888149867,~
172642981.39610922,~
22162393.495551325,~
5465258.884203935,~
174258459.52253357,~
22353391.625631228,~
5439308.685114787,~
175889054.21816826,~
22546035.800200924,~
5413481.703030915,~
177534906.93380794,~
22740340.20506664,~
5387777.352892051,~
179196160.44384962,~
22936319.148289554,~
5362195.05241592,~
180872958.85867813,~
23133987.06123941,~
5336734.222085043,~
182565447.6371674,~
23333358.49965721,~
5311394.285133612,~
184273773.59929863,~
23534448.144727048,~
5286174.667534426,~
185998084.93889675,~
23737270.8041572,~
5261074.797985884,~
187738531.23648587,~
23941841.413270533,~
5236094.107899047,~
189495263.47226506,~
24148175.03610428,~
5211232.031384755,~
191268434.0392057,~
24356286.866519343,~
5186488.005240808,~
193058196.75627112,~
24566192.229319107,~
5161861.468939211,~
194864706.88176015,~
24777906.58137793,~
5137351.864613472,~
196688121.12677544,~
24991445.512779344,~
5112958.637045965,~
198528597.66881788,~
25206824.74796406,~
5088681.233655357,~
200386296.16550812,~
25424060.146887887,~
5064519.104484087,~
202261377.7684366,~
25643167.706189606,~
5040471.7021859065,~
204154005.13714308,~
25864163.560368925,~
5016538.482013484,~
204154005.13714308,~
26087063.982974578,~
4992718.901806062,~
204154005.13714308,~
26311885.38780267,~
4969012.421977176,~
204154005.13714308,~
26538644.33010535,~
4945418.5055024335,~
204154005.13714308,~
26767357.507809877,~
4921936.617907343,~
204154005.13714308,~
26998041.76274823,~
4898566.227255215,~
204154005.13714308,~
27230714.081897292,~
4875306.804135104,~
204154005.13714308,~
27465391.598629717,~
4852157.821649819,~
204154005.13714308,~
27702091.593975592,~
4829118.75540399,~
204154005.13714308,~
27940831.497894976,~
4806189.083492185,~
204154005.13714308,~
28181628.890561376,~
4783368.2864870895,~
204154005.13714308,~
28424501.50365632,~
4760655.847427739,~
204154005.13714308,~
28669467.221675064,~
4738051.251807808,~
204154005.13714308,~
28916544.083243564,~
4715553.987563956,~
204154005.13714308,~
29165750.282446787,~
4693163.545064225,~
204154005.13714308,~
29417104.170168474,~
4670879.417096499,~
204154005.13714308,~
29670624.255442463,~
4648701.098857013,~
204154005.13714308,~
29926329.206815626,~
4626628.087938912,~
204154005.13714308,~
30184237.85372259,~
4604659.884320878,~
204154005.13714308,~
30444369.187872272,~
4582795.9903558,~
204154005.13714308,~
30706742.364646386,~
4561035.9107594965,~
204154005.13714308,~
30971376.704509996,~
4539379.152599503,~
204154005.13714308,~
31238291.694434214,~
4517825.2252839,~
204154005.13714308,~
31507506.98933118,~
4496373.640550204,~
204154005.13714308,~
31779042.41350139,~
4475023.912454301,~
204154005.13714308,~
32052917.962093513,~
4453775.557359444,~
204154005.13714308,~
32329153.802576773,~
4432628.093925295,~
204154005.13714308,~
32607770.27622603,~
4411581.043097022,~
204154005.13714308,~
32888787.899619654,~
4390633.928094445,~
204154005.13714308,~
33172227.366150323,~
4369786.274401235,~
204154005.13714308,~
33458109.54754882,~
4349037.609754171,~
60173146.29742893,~
19105403.64580398,~
7160069.313503008,~
60939166.29683477,~
19294015.570483048,~
7170290.811571222,~
61714937.932570025,~
19484489.505449396,~
7180526.901540461,~
62500585.34553335,~
19676843.832797986,~
7190777.604241681,~
63296234.256969705,~
19871097.11609507,~
7201042.940535577,~
64102011.98858862,~
20067268.102169707,~
7211322.931312621,~
64918047.48293853,~
20265375.722922977,~
7221617.597493109,~
65744471.32404044,~
20465439.09715503,~
7231926.960027205,~
66581415.75828437,~
20667477.5324102,~
7242251.039894976,~
67429014.71559167,~
20871510.526840307,~
7252589.858106442,~
68287403.8308469,~
21077557.77108638,~
7262943.435701616,~
69156720.46560241,~
21285639.150178935,~
7273311.793750548,~
70037103.73005927,~
21495774.745457035,~
7283694.953353365,~
70928694.50532804,~
21707984.836506266,~
7294092.935640317,~
71831635.46597297,~
21922289.903115876,~
7304505.7617718205,~
72746071.10284303,~
22138710.627255213,~
7314933.452938497,~
73672147.74619378,~
22357267.895069685,~
7325376.03036122,~
74610013.58910346,~
22577982.79889642,~
7335833.515291159,~
75559818.71118724,~
22800876.63929984,~
7346305.9290098185,~
76521715.1026133,~
23025970.927127298,~
7356793.292829086,~
77495856.68842468,~
23253287.385585036,~
7367295.628091272,~
77495856.68842468,~
23482847.95233464,~
7377812.9561691545,~
77495856.68842468,~
23714674.78161016,~
7388345.298466024,~
77495856.68842468,~
23948790.246356178,~
7398892.676415724,~
77495856.68842468,~
24185216.940386932,~
7409455.111482697,~
77495856.68842468,~
24423977.680566795,~
7420032.625162028,~
77495856.68842468,~
24665095.50901226,~
7430625.238979487,~
77495856.68842468,~
24908593.69531567,~
7441232.974491573,~
77495856.68842468,~
25154495.738790903,~
7451855.85328556,~
77495856.68842468,~
25402825.370741222,~
7462493.89697954,~
77495856.68842468,~
25653606.556749508,~
7473147.127222462,~
77495856.68842468,~
25906863.49899112,~
7483815.565694185,~
77495856.68842468,~
26162620.638569575,~
7494499.234105515,~
77495856.68842468,~
26420902.657875285,~
7505198.1541982535,~
77495856.68842468,~
26681734.482967585,~
7515912.347745238,~
77495856.68842468,~
26945141.285980284,~
7526641.836550389,~
77495856.68842468,~
27211148.48755094,~
7537386.642448755,~
77495856.68842468,~
27479781.75927415,~
7548146.787306553,~
77495856.68842468,~
27751067.026179034,~
7558922.293021217,~
77495856.68842468,~
28025030.469231177,~
7569713.181521442,~
77495856.68842468,~
28301698.527859297,~
7580519.474767226,~
77495856.68842468,~
28581097.90250683,~
7591341.194749917,~
77495856.68842468,~
28863255.557208702,~
7602178.363492257,~
77495856.68842468,~
29148198.722193576,~
7613031.003048428,~
77495856.68842468,~
29435954.89651174,~
7623899.135504096,~
77495856.68842468,~
29726551.85068898,~
7634782.782976453,~
77495856.68842468,~
30020017.629406612,~
7645681.967614268,~
77495856.68842468,~
30316380.554208018,~
7656596.711597928,~
77495856.68842468,~
30615669.226231866,~
7667527.037139483,~
77495856.68842468,~
30917912.52897232,~
7678472.966482693,~
77495856.68842468,~
31223139.631066512,~
7689434.521903074,~
169767923.6255481,~
28888349.191732313,~
24125460.70636703,~
171282508.34135973,~
29093104.11321321,~
24030278.99125671,~
172810605.4263656,~
29299310.29719417,~
23935472.7947324,~
174352335.43118227,~
29506978.02993756,~
23841040.63526786,~
175907819.98191863,~
29716117.670612756,~
23746981.037181895,~
177477181.78977114,~
29926739.65181287,~
23653292.530615274,~
179060544.6607043,~
30138854.480075188,~
23559973.651507776,~
180658033.50521767,~
30352472.736405257,~
23467022.941575315,~
182269774.34819993,~
30567605.0768047,~
23374438.94828714,~
183895894.33887097,~
30784262.232802782,~
23282220.224843144,~
185536521.76081258,~
31002455.01199173,~
23190365.33015125,~
187191786.0420887,~
31222194.298565857,~
23098872.82880489,~
188861817.76545578,~
31443491.053864487,~
23007741.291060593,~
190546748.67866462,~
31666356.316918768,~
22916969.29281561,~
192246711.7048536,~
31890801.205002315,~
22826555.41558569,~
193961840.95303506,~
32116836.914185792,~
22736498.24648289,~
195692271.72867507,~
32344474.7198954,~
22646796.378193513,~
197438140.54436755,~
32573725.977475338,~
22557448.408956107,~
199199585.13060367,~
32804602.122754246,~
22468452.942539565,~
200976744.4466373,~
33037114.672615662,~
22379808.588221304,~
202769758.6914475,~
33271275.22557252,~
22291513.96076553,~
204578769.31479862,~
33507095.462345727,~
22203567.68040159,~
206403919.0283993,~
33744587.14644684,~
22115968.37280242,~
208245351.81716076,~
33983762.12476486,~
22028714.669063058,~
210103212.95055583,~
34224632.32815721,~
21941805.205679256,~
211977648.99407908,~
34467209.77204486,~
21855238.624526177,~
213868807.8208093,~
34711506.55701174,~
21769013.572837163,~
215776838.6230751,~
34957534.8694083,~
21683128.703182604,~
217701891.92422462,~
35205306.98195947,~
21597582.673448876,~
219644119.59050024,~
35454835.254376814,~
21512374.146817368,~
221603674.84301916,~
35706132.1339751,~
21427501.7917436,~
223580712.26986095,~
35959210.15629321,~
21342964.281936403,~
225575387.83826292,~
36214081.94571945,~
21258760.296337202,~
227587858.9069242,~
36470760.2161213,~
21174888.519099366,~
229618284.23841977,~
36729257.77147963,~
21091347.63956765,~
231666824.01172513,~
36989587.506527394,~
21008136.352257714,~
233733639.8348526,~
37251762.407392874,~
20925253.356835715,~
235818894.75760067,~
37515795.55224747,~
20842697.358098,~
237922753.28441665,~
37781700.11195808,~
20760467.065950852,~
240045381.38737455,~
38049489.3507441,~
20678561.195390332,~
242186946.5192684,~
38319176.62683911,~
20596978.466482215,~
244347617.6268225,~
38590775.393157214,~
20515717.60434196,~
246527565.16401955,~
38864299.19796411,~
20434777.339114822,~
248726961.10554764,~
39139761.68555293,~
20354156.40595597,~
250945978.9603672,~
39417176.596924886,~
20273853.545010757,~
253184793.7853991,~
39696557.770474665,~
20193867.501395006,~
255443582.19933468,~
39977919.14268079,~
20114197.02517541,~
257722522.3965691,~
40261274.74880078,~
20034840.87135001,~
260021794.16125906,~
40546638.7235713,~
19955797.79982872,~
262341578.8815058,~
40834025.30191324,~
19877066.575413957,~
264682059.56366467,~
41123448.8196418,~
19798645.967781346)
NodeLocation: 104,160,1
NodeSize: 64,40
WindState: 2,410,157,1194,571
DefnState: 2,542,153,1116,459,0,DFNM
ValueState: 2,270,24,1251,794,0,MIDM
GraphSetup: Att_CatLineStyle Graph_Primary_Valdim:9~
Att_StackedBar Graph_Primary_Valdim:1~
{!50007|Graph_BarOutline:1}
ReformDef: [Building_Stock_Year,All_PV_Sectors]
ReformVal: [All_Utilities,Building_Stock_Year]
NumberFormat: 2,F,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15,
DisplayOutputs: Object Object, Object Variable, Object Decision
Att__TotalsIndex: []
Att_ResultSliceState: [Area_Type,1,Spatial_ID,1,All_PV_Sectors,2,Building_Stock_Year,1,All_Utilities,1]
Att_EditSliceState: [Area_Type,1,Spatial_ID,1,All_PV_Sectors,1,Building_Stock_Year,1]
{!40600|Att_StackingIndex: Area_Type}
{!40600|Att_ClusterIndex: Spatial_ID}
{!50000|Att_ColumnWidths: [,All_Sectors,\([,,,])]}

Alias Al416789699
Title: Building Stock
Definition: 1
NodeLocation: 104,56,1
NodeSize: 64,40
Original: Building_Stock

Variable Usable_PV_Area_to_Bu
Title: Usable PV Area to Buildings Ratio
Units: PV stock units
Description: Total usable PV stock (either m2 on usable installation area or # of technicall suitable buildings, depending on the PV building stock basis)
Definition: local area:=ZIDZ(Usable_PV_Area~
, ~
Applied_Building_Stk[Building_Stock_Year=Year_of_Consump_Data,All_Spatial_ID=PV_Spatial_ID,All_Sectors=PV_Sectors]) ;~
IF area=null THEN 0 ELSE area
NodeLocation: 440,160,1
NodeSize: 64,40
WindState: 2,-6,84,720,350
ValueState: 2,455,92,814,741,0,MIDM
ReformVal: [PV_Spatial_ID,PV_Sectors]
Att_ResultSliceState: [Area_Type,1,PV_Sectors,1,PV_Spatial_ID,1]

Index Roof_Dummy
Title: Roof Dummy
Description: Only used to facilitate importing total roof area as a vector rather than a matrix, due to the way the data were developed and input into Excel (and to avoid re-coding to fix the warning that appears otherwise). This could someday be eliminated with some import code changes or changes to the import tab arrangement
Definition: ['dummy']
NodeLocation: 104,504,1
NodeSize: 64,40
DisplayOutputs: Object Object, Object Decision

Index Area_Type
Att_PrevIndexValue: ['Roof']
Title: Area Type
Description: need to create import ability in categorical indexes
Definition: ['Roof']
NodeLocation: 104,384,1
NodeSize: 64,40
WindState: 2,408,-14,824,781
NodeColor: 65535,1,1
DisplayOutputs: Object Object, Object Variable, Object Decision
{!40300|Att_SlicerPopupSize: 977,80}

Alias Al1460632099
Title: Eligible Bldgs for Retrofit
Definition: 1
NodeLocation: 760,160,1
NodeSize: 64,40
NodeColor: 65535,65535,65535
Original: Eligible_PV_Stock_fo

Variable Usable_PV_Area
Title: Usable PV Area
Units: m2
Description: m2 of PV area by area type. Not relevant for combined EV sectors. Also not relevant for any sectors where building count will be used as the basis for solar PV potential rather than roof area.
Definition: Total_PV_Area[All_PV_Sectors=PV_Sectors,Spatial_ID=PV_Spatial_ID,Building_Stock_Year=Year_of_Consump_Data,All_Utilities=Selected_Utility] *~
PV_suitability[All_PV_Sectors=PV_Sectors,All_Utilities=Selected_Utility]
NodeLocation: 280,160,1
NodeSize: 64,40
ValueState: 2,540,77,727,716,0,MIDM
ReformVal: [0,PV_Sectors]
NumberFormat: 2,F,2,0,1,0,2,0,$,0,"ABBREV",0,,,0,0,15,
Att__TotalsIndex: [PV_Spatial_ID,PV_Sectors]
Att_ResultSliceState: [PV_Spatial_ID,0,Area_Type,3,PV_Sectors,1,Use_facility_level_d,1]

Alias Al204929571
Title: Applied Building Stock
Definition: 1
NodeLocation: 440,56,1
NodeSize: 64,40
Original: Applied_Building_Stk

Close Roofspace_Per_Buildi

Module Power_and_Module_Den
Title: Power and Module Density
Author: JamesMilford
Date: Wed, Nov 7, 2018 1:59 PM
NodeLocation: 264,240,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,33,27,1325,652,17,10
NodeColor: 65535,65535,65535
AcpStyles: FrameNode: FrameNode_1545066590

Constant Power_Density
Title: Power Density
Units: W-DC/m2
Description: The power density of common solar PV modules. This input is a function of module efficiency and not a function of orientation which is determined by the input capacity factor. A module power density of 200 W-DC /m2 corresponds with a 20% efficiency module, assuming all area is used for the module itself.~
~
W DC (nameplate) / m2 of solar panel module~
~

Definition: Table(All_PV_Sectors,Area_Type)(~
200,~
200,~
200)
NodeLocation: 144,104,1
NodeSize: 64,40
WindState: 2,621,249,720,350
DefnState: 2,888,179,498,655,0,DFNM
Aliases: Alias Al1568696777, FormNode Fo1568696778, FormNode Fo1541457042
ReformDef: [Area_Type,All_PV_Sectors]
DisplayOutputs: Object Object, Object Decision

Constant Module_to_Area_Ratio
Title: Module to Area Ratio
Units: module m2/installat m2
Description: The ratio of module area to placement area based on prevalent tilt and racking configurations.~
~
https://www.nrel.gov/docs/fy16osti/65298.pdf (p. 13)~
~
See ~
See https://eta-publications.lbl.gov/sites/default/files/land_requirements_for_utility-scale_pv.pdf for ground cover for ground mount fixed tilt coverage ratios (0.4 - 0.5)
Definition: Table(All_PV_Sectors,Area_Type)(~
0.7,~
0.7,~
0.7)
NodeLocation: 152,240,1
NodeSize: 64,40
WindState: 2,693,459,720,350
DefnState: 2,631,78,500,660,0,DFNM
ValueState: 2,327,216,416,303,,MIDM
Aliases: Alias Al1568696778, FormNode Fo1568696779, FormNode Fo1541457043
ReformDef: [Area_Type,All_PV_Sectors]
DisplayOutputs: Object Object, Object Decision

Variable DC_Watts_per_m2_usab
Title: DC Watts per m2 usable installation area
Units: W-DC/m2
Description: The watts per m2 of roofspace.
Definition: Power_Density[All_PV_Sectors=PV_Sectors] * ~
Module_to_Area_Ratio[All_PV_Sectors=PV_Sectors]
NodeLocation: 320,112,1
NodeSize: 64,40
WindState: 2,102,82,925,287
ValueState: 2,1034,89,504,644,0,MIDM
Aliases: Alias Al97954067
ReformVal: [Area_Type,PV_Sectors]

FormNode Fo1541457042
Title: Power Density
Definition: 0
NodeLocation: 144,156,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Power_Density

FormNode Fo1541457043
Title: Module to Roof Area Ratio
Definition: 0
NodeLocation: 152,292,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Module_to_Area_Ratio

Variable m2_usable_area_per_k
Title: m2 usable area per kW-DC
Units: m2/kW-DC
Description: The m2 of roofspace required per kW-DC of solar PV.
Definition: 1 / (DC_Watts_per_m2_usab * kW_per_W)
NodeLocation: 488,112,1
NodeSize: 64,40
ValueState: 2,300,504,535,356,0,MIDM

Variable kW_AC_per_PV_stock_U
Title: kW-AC per PV stock Unit
Units: kW-AC/bldg unit
Definition: {IF PV_Stock_Basis_by_Se[All_Sectors=PV_Sectors] = Buildings_Label~
THEN Forecast_AC_System_S~
ELSE }DC_Watts_per_m2_usab * kW_per_W * AC_to_DC_Ratio_by_PV
NodeLocation: 504,208,1
NodeSize: 64,40
WindState: 2,39,303,720,350
ValueState: 2,340,59,1246,680,0,MIDM
Aliases: Alias Al1542831105
GraphSetup: Att_GraphIndexRange PV_Spatial_ID:1,1~
Att_CatLineStyle Graph_Primary_Valdim:5
ReformVal: [PV_Spatial_ID,Time_Solar_PV]
Att_ResultSliceState: [PV_Sectors,1,Area_Type,1,PV_Spatial_ID,1]

Text FrameNode_1545066590
NodeLocation: 1056,336,-20
NodeSize: 360,304
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus: yes~
Show_description:20

Constant PV_suitability
Title: PV suitability
Units: %
Description: m2 of usable area divided by m2 of input total PV area (when m2 is the PV building stock basis)
Definition: Table(All_Utilities,All_PV_Sectors,Area_Type)(~
0.2732860803766868,~
0.5603771334583653,~
0.7499721822009746,~
0.2732860803766868,~
0.5603771334583653,~
0.7499721822009746,~
0.23070729862302725,~
0.5620134604832271,~
0.8076986597806559,~
0.23070729862302725,~
0.5620134604832271,~
0.8076986597806559,~
0.24704216516096808,~
0.5660442121490014,~
0.742093452144499,~
0.24704216516096808,~
0.5660442121490014,~
0.742093452144499)
NodeLocation: 152,376,1
NodeSize: 64,40
DefnState: 2,671,126,503,654,0,DFNM
Aliases: FormNode Fo120842787
ReformDef: [All_PV_Sectors,All_Utilities]
NumberFormat: 2,%,2,2,0,0,2,0,$,0,"ABBREV",0,,,0,0,15,
DisplayOutputs: Object Object, Object Decision
{!40700|Att_CellFormat: CellAlignment('Center')}
{!50000|Att_ColumnWidths: [,Area_Type,\([])]}

FormNode Fo120842787
Title: Area suitability
Definition: 0
NodeLocation: 160,424,1
NodeSize: 56,16
NodeInfo: 1,,,0
Original: PV_suitability

Alias Al1775675667
Title: PV Production per kW DC
NodeLocation: 312,480,1
NodeSize: 64,40
Original: PV_Production_per_kW

Alias Al97954067
Title: DC Watts per m2 usable installation area
NodeLocation: 464,480,1
NodeSize: 64,40
Original: DC_Watts_per_m2_usab

Variable PV_Prodn_per_Area
Title: PV Production per usable Area
Units: kWh/m2
Definition: PV_Production_per_kW {kWh / kW-DC}~
* (DC_Watts_per_m2_usab {W-DC/m2} * kW_per_W {kW-DC/W-DC})
NodeLocation: 616,480,1
NodeSize: 64,40
ValueState: 2,343,320,436,184,,MIDM
Aliases: Alias Al1303619859

Close Power_and_Module_Den

Variable NewConst_Elig_Factor
Title: NewConstr Eligibility Factor
Units: bldg units/bldg
Description: The fraction of new construction stock that is suitable and eligible for PV installation. If the stock basis is m2 of roofspace, this will also include a conversion from buildings to m2 of roofspace.
Definition: PV_New_Construction_[All_PV_Sectors=PV_Sectors, NC_Suitability_Scens=Sel_NC_Suitable_Scen]~
~
/*IF PV_Sectors = Residential_Label~
THEN Retrofit_Eligibility * NewConst_Suitability[All_Sectors=PV_Sectors, NC_Suitability_Scens=Sel_NC_Suitable_Scen]~
ELSE Retrofit_Eligibility * NewConst_Suitability[All_Sectors=PV_Sectors, NC_Suitability_Scens=Sel_NC_Suitable_Scen]
NodeLocation: 912,384,1
NodeSize: 64,40
ValueState: 2,249,97,1069,730,1,MIDM
Aliases: Alias Al1541540874

Constant PV_New_Construction_
Title: PV New Construction Suitability
Units: fraction
Description: Residential new construction PV applicability assumption (i.e., the percentage of new construction homes that would use solar PV to help meet Title 24 requirements, since other options exist).
Definition: Table(NC_Suitability_Scens,All_PV_Sectors)(~
1,1,1,~
1,1,1,~
1,1,1)
NodeLocation: 592,384,1
NodeSize: 64,40
WindState: 2,465,549,720,350
DefnState: 2,920,119,486,681,0,DFNM
Aliases: Alias Al1568696273, FormNode Fo1568696273, Alias Al1541540869, FormNode Fo1541540881, FormNode Fo1544641553
NodeColor: 65535,52427,52427
ReformDef: [NC_Suitability_Scens,All_Sectors]
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
DisplayOutputs: Object Object, Object Decision

Text Te1541540991
Title: Technical and Eligible Potential
NodeLocation: 764,144,-1
NodeSize: 244,120
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Text Te1541541044
Title: Eligibility Factors
NodeLocation: 764,444,-1
NodeSize: 244,164
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Text FrameNode_1544920370
NodeLocation: 1400,328,-20
NodeSize: 360,304
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus: yes~
Show_description:20

Text Te691644691
Description: To be deleted
NodeLocation: 260,88,-1
NodeSize: 196,72

Alias Al1303619859
Title: PV Production per usable Area
NodeLocation: 600,104,1
NodeSize: 64,40
Original: PV_Prodn_per_Area

Alias Al1752410387
Title: Eligible PV Stock for Retrofit
NodeLocation: 600,200,1
NodeSize: 64,40
NodeColor: 65535,65535,65535
Original: Eligible_PV_Stock_fo

Variable Technical_PV_Potenti
Title: Technical PV Potential
Definition: (Eligible_PV_Stock_fo - Initial_PV_Adopters1) {m2 of usable area}~
* PV_Prodn_per_Area {kWh / m2 of usable area} ~
/ 1000 {converts kWh to MWh}
NodeLocation: 800,160,1
NodeSize: 64,40
ValueState: 2,541,318,899,245,0,MIDM
NumberFormat: 2,F,2,0,1,0,2,0,$,0,"ABBREV",0,,,0,0,15,,0

Close Technical_Potential

Module DC_to_AC_Ratios
Title: DC to AC Ratios
Author: CWelch
Date: Mon, Feb 21, 2022 12:08 PM
NodeLocation: 688,152,1
NodeSize: 64,40
DiagState: 2,310,234,740,383,17,10
NodeColor: 65535,65535,65535

Constant DC_to_AC_Ratio
Title: DC to AC Ratio
Units: kW DC / kW AC
Description: The DC to AC ratio used to translate the AC values stored from historical interconnection data (or manually input data) into DC values (for calculating system costs, etc.). This value should be consistent with the definition of AC per whatever data source is imported (accounting for the same losses, etc.). For instance, the CEC includes only certain losses in its estimates, whereas some calcs of AC may include additional losses.
Definition: Table(All_PV_Sectors,PV_Climate_Zone)(~
1.2,~
1.2,~
1.2)
NodeLocation: 112,64,1
NodeSize: 64,40
WindState: 2,196,231,720,350
DefnState: 2,723,103,757,693,0,DFNM
ValueState: 2,1150,86,547,651,,MIDM
ReformDef: [PV_Climate_Zone,All_PV_Sectors]
DisplayOutputs: Object Object, Object Decision

Variable DC_to_AC_Ratio_by_PV
Title: DC to AC Ratio by PVSpID
Units: kW DC / kW AC
Definition: DC_to_AC_Ratio[PV_Climate_Zone=Climate_Zone_Map, All_PV_Sectors=PV_Sectors]
NodeLocation: 256,64,1
NodeSize: 64,40
ValueState: 2,894,230,801,535,0,MIDM
Aliases: Alias Al1088777763
ReformVal: [PV_Spatial_ID,PV_Sectors]

Variable AC_to_DC_Ratio_by_PV
Title: AC to DC Ratio by PVSpID
Definition: Divide(1, DC_to_AC_Ratio_by_PV, True )
NodeLocation: 400,64,1
NodeSize: 64,40
ValueState: 2,52,58,590,485,,MIDM

Close DC_to_AC_Ratios

Close PV_Details

Text Te1545083753
NodeLocation: 380,188,-1
NodeSize: 356,92
NodeInfo: 1,1,1,,1,1

Module Define_PV_Scenarios
Title: Define PV Scenarios
Author: coryw
Date: Mon, Mar 18, 2019 12:52 PM
NodeLocation: 632,184,1
NodeSize: 72,64
DiagState: 2,2085,43,1520,715,17
NodeColor: 65535,65535,65535
Pict: (00000000002B003A006D0004FA03000089504E470D0A1A0A0000000D4948445200000098000000860806000000211E43CA000000017352474200AECE1CE90000000467414D410000B18F0BFC6105000000097048597300000EC300000EC301C76FA8640000037F49444154785EEDDAC16DDC3A184561979136D2416A480D29247B6FB209902202A48C0029CA8A09D81B839438E4DCB994EEF9807F3FA2CE131DF23D6D801081418AC0204560902230481118A4080C5204062902831481412A26B05FFFBE6FDFFE7CD93EFF7CB24EF91D4922022B2FB5F6B25D9314594460B597EC9E14114FBAC2D6F87152B0451A862DF2825689AC7C4D93E47CAB614160902230481118A4080C520406290283544C60E51C8CCBEEC78B088C937C9F88C06A2FD93D29229E94CB6E1FB648C3B0455ED02A9171D90DDC1181418AC0204560902230481118A462022BC714DC453E5E44601CB4FA4404567BC9EE4911F1A4DC45FAB0451A862DF28256898CBB48E08E080C5204062902831481418AC02015135839A6E02EF2F12202E3A0D52722B0DA4B764F8A8827E52ED2872DD2306C9117B44A64DC4502774460902230481118A4080C520406A998C0CA310577918F17111807AD3E1181AD76559474D81A1158ED25BB27055F30D3A4887852FE06F389F94F6995C892E22A72BED5B02030481118A4080C520406290283D45C607F9FB797DF5FB7971F9FAC537EC791723CC065F7E38D0756E2AABC6CD7EC45B6CA19D8FB2445361C58ED25BBA7A5F692DD93623CB005B6C68FD3C25DA40F5BA461D8227BAD12D9EBD7F4C82A9125FDBF6045CEB71A1604062902831481418AC0204560909A0BAC1C53701779D3249D8115E38171D03A3C1CB476A8BD64F7B4D45EB27B528C07C65DE4D4A4608B340C5B64AF5522E32E725939DF6A581018A4080C5204062902831481416A2EB0724CC15DE44DD3750676A2753D321ED82A67606FB3B718A73A683DD1BAF6180EACF663DCD3527BC9EE69A93D977B668C07C65DE4D4B49C695D7BB0451A862DB2D72A8B71B5BBC813ADEB91B9C0800304062902831481418AC0204560909A0BACFC73FA247766E59882BBC8DBA6675D8F8C07B6CA59CDDBEC2D0607ADE3331BD97060B51FE39E96DA4B764F4BEDB9DC33633CB013DD997117393733D8220DC316D96B95C5E8B8335B2532EE22813B2230481118A4080C520406290283D45C60E59FD327B9332BC714DC45DE363DEB7A643CB055CE6ADE666F3138681D9FD9C886035BEE4A63E75070B5ABA2BDC3D633AD6B8FF1C06A3FC63C2DB597EC9E96DA73B967C675BE60AFD3C265F7DCCC180E8CBFC1C687BFC17A2DB2183D8BB04A64BB71BD3BD1BA1E990B0C384060902230481118A4080C520406290283D0B6FD07E2669F838370D9A90000000049454E44AE426082)
AcpStyles: FrameNode: PV_Frame

Text PV_Frame
NodeLocation: 968,332,-4
NodeSize: 400,324
NodeInfo: 1,0,0,1,0,0,0,,0,,0,,,
NodeColor: 65535,65535,65535
AcpStyles: Show_index_menus:yes~
Show_description:20

FormNode Fo1544570136
Title: Retail Rate Escalation
Definition: 0
NodeLocation: 416,148,1
NodeSize: 56,20
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 49344,49344,49344
Original: Retail_Rate_Escalate

FormNode Fo1544570137
Title: Selected Rate Escalation
Definition: 0
NodeLocation: 200,148,2
NodeSize: 176,20
NodeInfo: 1,,,,,,0,110,,,,,,0
Original: Select_Rate_Escalate

FormNode Fo1544631509
Title: NewConstr Market Share
Definition: 0
NodeLocation: 416,188,1
NodeSize: 56,20
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 49344,49344,49344
Original: NewConstr_Mkt_Share

FormNode Fo1544635313
Title: Building Stock Growth Rate Scenarios
Definition: 0
NodeLocation: 416,228,1
NodeSize: 56,20
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 49344,49344,49344
Original: BldgStk_Growth_Rates

FormNode Fo1544635314
Title: Selected Bldg Growth Rate Scenario
Definition: 0
NodeLocation: 200,228,4
NodeSize: 176,20
NodeInfo: 1,,,,,,0,110,,,,,,0
Original: Building_Growth_Scen

FormNode Fo1544635478
Title: PV Cost Change Rate
Definition: 0
NodeLocation: 416,68,1
NodeSize: 56,20
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 49344,49344,49344
Original: DER_Cost_Change_Rate

FormNode Fo1544635738
Title: PV Installed Price
Definition: 1
NodeLocation: 504,68,8
NodeSize: 56,20
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 65278,37008,6168
Original: Equipment_Cost_Resul

FormNode Fo1544635850
Title: Bldg Stock by Time
Definition: 1
NodeLocation: 504,228,9
NodeSize: 56,20
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 65278,37008,6168
Original: Bldg_Stock_by_Time

FormNode Fo1544638294
Title: Residential NewConstr System Size
Definition: 0
NodeLocation: 416,268,1
NodeSize: 56,20
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 49344,49344,49344
Original: NewConstr_Code_Sys_S

FormNode Fo1544641553
Title: New Construction Suitability
Definition: 0
NodeLocation: 416,308,1
NodeSize: 56,20
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 49344,49344,49344
Original: PV_New_Construction_

FormNode Fo1544641554
Title: Selected NewConstr Suitability Scenario
Definition: 0
NodeLocation: 200,308,6
NodeSize: 176,20
NodeInfo: 1,,,,,,0,110,,,,,,0
Original: Sel_NC_Suitable_Scen

Text Te1544641825
Title: Scenarios
NodeLocation: 292,192,-5
NodeSize: 276,176
NodeInfo: 1,0,0,1,1,1,1,,0,,0,,,
WindState: 2,102,83,476,224
NodeColor: 65535,65535,65535
NodeFont: Arial,21

FormNode Fo1544881571
Title: Selected PV Cost Scenario
Definition: 0
NodeLocation: 200,68,7
NodeSize: 176,20
NodeInfo: 1,,,,,,0,110,,,,,,0
Original: Select_DER_Cost_Scen

FormNode Fo1544916731
Title: Base Year for PV Cost Decline
Definition: 0
NodeLocation: 200,108,1
NodeSize: 176,20
NodeInfo: 1,,,,,,0,110,,,,,,0
Original: Base_Yr_of_Cost_Decl

FormNode Fo1545084106
Title: ITC Scenario
Definition: 0
NodeLocation: 200,348,1
NodeSize: 176,20
NodeInfo: 1,,,,,,0,110,,,,,,0
Original: Selected_ITC_Scen

FormNode Fo1545084105
Title: Investment Tax Credit
Definition: 0
NodeLocation: 416,348,1
NodeSize: 56,20
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
NodeColor: 49344,49344,49344
Original: Invest_Tax_Credit

Close Define_PV_Scenarios

Close Solar_PV

