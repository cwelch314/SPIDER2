{ Analytica Model Outputs_for_Tableau, encoding="UTF-8" }
SoftwareVersion 6.1.0

{!-60000|Attribute AcpStyles}


LinkModule Outputs_for_Tableau
Title: Outputs for Tableau
Author: JamesMilford
Date: Tue, Nov 13, 2018 7:23 PM
DefaultSize: 64,40
NodeSize: 80,56
DiagState: 2,26,74,1852,648,17,10
NodeColor: 57311,57311,57311
DiagramColor: 52428,52428,52428
Pict: (000000000000003800370004740A000089504E470D0A1A0A0000000D4948445200000037000000380806000000598D6093000000017352474200AECE1CE90000000467414D410000B18F0BFC6105000000097048597300000EC300000EC301C76FA864000009F9494441546843DD9A7954D35716C7D3696BEBD2B19B75B763DD46EBBE306A6B8B56AB1D4F6DEBCC69AB200AA21EC09DA94E47C751EB72C67A2C22E012D428A0208A05D7D6115496CA2AC81AEBC21A08212140129290BC37EFFE6A1892DCDFAF84C3AF7F0CE77CCEE1DDEFCDCBEF9EF7DE7DEFDDFC2494D2DF04B3D9FC426969E97883C1F012A68B016A1483EAEAEAA1BEBEBE9A82828299982E06A8510C140AC5702F2FAFE6FCFCFC0F305D0C50A318B0911BE6EDEDDDC4466E16A68B016A1403086ED9B265BAC2C2C2FFBF69A9D7EB7BAE5CB9B2AEB8B87806A68B016A14A4C5F822553F18491B2BDE44F5A72426262E974AA5A7C2C2C23882828262D9C8E977ECD871C7663B7CF83020532A9543B03E38AC2DCF51CDA3E154FB640825D6DFA13E3CA04641EA8A47D3F0916AF2BDC715547F4A5C5CDC561648E6962D5B38366FDE9CE7E9E9695EB76EDD239B6DEBD6AD40467979F918AC0F0E435D2F727C7229899C9947CDBA1EA80F0FA8511055FE787AB41F25D11FDD45751ED8FED6332020A0323333F3134CE7455FDB9B1C7AD348A463ABA9A9C9A53D12350AA22A184743FB52726E4132AAF3A056AB07F8F9F929D2D2D23EC7745E0CAA3748D8B006727C5299F823575738968640701FA7504A9E417D10B45A6D1F9892376FDEF4C5745EB8E0866B49F8C4726A6CE889FAF0801A85209A8723C8A141261AF5412E35EBBB633E180D0D0DBDD6AE5DFBE4F2E5CB8198CE8B51FB0A65A3468E8C52D126C500D48707D42888B674085B03CD2472561E6D69EE8AFA20E874BA57F6EDDB77393939D913D37931EB5EA2B23F3D224721B8EAFEA80F0FA851106DD95B5C70307216D30BA84F6762D6F7680D4EA7EC8BFAF0801A69B3E63592B0EC7B1AED5E4023DEB783C8A6FD4C82FA1212C2023C3DA3C851A731EE0524C1FBA24B8BDF62EE426E6C94C2671DFB23A7DE2D26C103CD2478400B914D973BEAF40CFB4CECA7B76953E540C77EED1AADE8947D58470FA8B41F85CC68072493A03E941E64386A4038DB2664EFC8A9C985C5CF660089FDEC167CD6A93FF67D14BE0F80FF1D75B62DD1C323EAA9F6F150C77EED1AAD10CBB3DCFC6E281BEC84226B1A39365A49C22754D09A1C37D4073EEBD26982655DBDB20FD61751CB479108F77C2BCC942789F3301FDA5839885ACDCF3BF66BD768173065A5E3ABC809B7C72E8D4E8721CF90B3F332AC217F3010CDA361B80F0E6A14A4B16A209C16B8E00CB5BD519FCEA4C5D08D9C99936D0D1DAC272A76F4C37C78408D82C0598FAD477274B4929B12980F42C243D9D2BD19FEA1514541EB882B53D662EA42CE2F4CA207FB5B88226B2AEAC3036A14846DAAE434CB62474668A8E6E170D407212071DEB5A937247461FCC8A216647DF0C26E05E4E297D721A190CA9FDE437D78408D4D4D4DAF353737E3A9BCB9FE55D802B8E0EADBBF06D6DF5A10EF764542BFBC3221C7E5E0E23EFF11B233A9BCEB741734994C5DE1F44308719A0D760D1B7BF6ECB971F5EAD5F598460D2CA19C609B2A5BE0B4BEFD23B73E8905775942175D9998ED7270E7D936C1D23EA9487BDF514F4F4FFF0B5C9BE004E4A8D9356CAC59B3A6343A3A7A37A6C1918BE49DF42759219B2050D407614B8A67C4940409FD6BC2DB053A73C3EF311F14B63E49F1794F7277FFBFB894EFA02725252D677F6CF01A7A396A760D1B1B376E94C7C6C6EEC0B48EB2236D79F8947809FD347E44497DB3EA75CCA723DCBE7D7BD9AA55AB6A1B1B1B9DFAB46BD880E02E5CB8B00DD33ACADE74FF5018B98509A30A2969FF55E9D76007F125101CD4681C3589C56279CE6834F6800462233030B0242A2A6A5F5B1BF8305FDEB5925A757DEEEE7B2B8E7D731707466C528C84CE88EEA9DD9AB2E434E6B32B6BC5B11CE51DC102124B20DDDA3E576262E20A084EA954BED5D6CE9EB7BB243737779EAFAFAF69C99225AD2C5EBC9878787858DADA7C7C7C4CD7AE5D5B877D21109AFBCF9DEF244B2864448C49E72474C269099D7886B52F39EB6E5725745AA28446157F8727B2A76CDAB4E9BEB7B777EB73C1732E5AB488B67D562F2F2FD3EAD5ABCBE1FADF9F5DFD3D5252525AD9B061839C65CC1FDBDAC0A7B2B27224F685408C3CD47FEEB5DE35B36371A69FEDAE9B10C9828C7CD632F3DCEB2A279FF3BD6BE65CEA5D73E57184E07D2F3B3BFBE3D4D4D4D6E78A888838C0128A362121E1ABB6CF0B5914ED60E7CE9DB7222323BFC5343E20BDEB5B9A7AF0B13F6BFD77532E4AE8DCB801153FD7E78FC67C0097B609467E7EFE6C7F7FFFAAFAFA7A766DB0D7EC1A36B66DDB962A93C98231ADA384DCFBC76E086E5EDCC07285BECC29A577948C8C8CCFFCFCFCAAABAAAA9CF65CBB868D5DBB76DD944AA54731ADA39C28D8F3F5E40B120A5352AECE1D87F974849C9C9CF96CE41458EDD3AE6163FFFEFDF1070F1E8CC63476B67C9996C42D26657766A33A0FB2C27F6F82E0DC635E5597A87326603E1D017E588192E183070FA63B6A760D1B070E1C880B090989C4B4D6A2ECD98FD2519D8713057BFF6E0B4EAEB9371EF3413136F42437361CA7B7B604538BF14547BDA8A8C81D32230B6E9AA366D7B0A1D168FA610B94038AB261B6BA25A2F370AAF0DBBF4170EF45BF5C5FA4CE9A84F9A0C09D911D9AAD61C3B4D4D8E8746C63FB59B7DADADAC166B3D92970BB46BB68AD387F7207D579882909F5878333EC73193589EDFF19AB6DC559F4727A5DD11812D28F9098F93F71B516CC07E15679FC02AFFFB8A52FFF61C69DA2BAEC89980F0A17DCD0467262722935895C4E279A47C3C9A141461A352BCF952FB3B0AB8BC1ACEB6EB418BA5A5DB98973359BB1D5E4E8981AA8CAA13E3CA046419A1403E02E47A266DF73F5F7B20E01855FD9D4875C5156AF7A03F5E101350A96F62A5267C2C89153338AA95A3E0AF5E9C4D21EAD2D1C478F4F2C2787D9CDBF2A733AEAE35269EF578AB25C4196AF482A4651164A0C9D5694152AA79F9A2EE74ADB50E2C6CADB9D5D4E877A0D5B065628E19F9CFAD05177BD9C2E84BEB60F918E5390936E8F69B3BAD36ED4BC5859E067E7667245D93AB60C301F1E50A320BA9A7EFF0BAECEA96EC1073B14F40D0E0E8E2E2B2B1B8BE9BCB0530939F361D62FC195BC8DFAF0801A05816C190EE5F4294FB82480F92028148A117009BE7FFFFE1C4CE7E537AD38C37A849F958E8CACA3F5CE8B988F0EBF41042317333FCD7A68A08928EFB77FF367A04641A0280B0BFDC81FD5AE14656DC1B9FC065167579C0581E058966447A20657CAE97010F7F1F16990CBE54E571341B8E0BEF8E197E09C2BCE42A04641B8919B95478EB1E390C0B4747CC9060A3B6CCD59A16CE8D24B365CC599A57AB88994A7BAA33E3CA04641AC2DCF43599B94267D28F43603F67AD4D2A54BF5DBB76F4F76E9F528765A22495F875096318932DFA54B2E6A1403A83706040454E4E4E4FC19D30581AB0E9B31308AA8CE036A1483366F107D81E962801AC580DDEEFBC3C82527277B60BA18A04631805F610203038BAF5FBFBE1AD3C500358A010407C5D34B972E7D85E962801AC5A0A5A5A54B4949C9BB2A954AF025D4CE834AFE0BD962D7954B87CFAD0000000049454E44AE426082)
FontStyle: Arial Narrow,19
FileInfo: 0,LinkModule Outputs_for_Tableau,2,2,0,0,Outputs for Tableau.ana

Module Sequential_Historic_
Title: Sequential Historic + Forecast
Author: JamesMilford
Date: Sun, Nov 18, 2018 11:53 PM
NodeLocation: 736,792,1
NodeSize: 64,40
DiagState: 2,85,32,1671,656,17,10

Variable Cumulative_Data_Plus
Title: Cumulative Data Plus
Definition: IF Output_Prd_Plus_Map <= PV_Calibration_End~
THEN Replace_X_with_Y(Historical_PV_Adopti[Interconnect_Date=Output_Prd_Plus_Map, PV_Adopt_Data_Types=PV_Cumul_Data_Type], Null, 0)~
ELSE PV_Adoption_Forecast[Time_Solar_PV=Output_Prd_Plus_Map, System_Types=PV_Retrofit_Label, PV_Adopt_Data_Types=PV_Cumul_Data_Type]
NodeLocation: 264,216,1
NodeSize: 64,40
ValueState: 2,15,14,1489,815,1,MIDM
ReformVal: [Output_Periods_Plus,Null]
Att__TotalsIndex: [PV_Sectors,PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,0,PV_Cumul_Data_Type,2,PV_Spatial_ID,0,Output_Periods_Plus,1]

Alias Al1542347463
Title: PV Adoption Forecasts
Definition: 1
NodeLocation: 112,216,1
NodeSize: 64,40
NodeColor: 19661,48336,65535
Original: PV_Adoption_Forecast

Alias Al1542347481
Title: Historic PV Adoption
Definition: 1
NodeLocation: 112,112,1
NodeSize: 64,40
NodeColor: 19661,48336,65535
Original: Historical_PV_Adopti

Variable Incremental_Data
Title: Incremental Data
Description: Although the Cumulative Data Types index suggests these values are cumulative, they are in fact incremental and represent units/period. These will be mapped back to the incremental values in the Adoption Data Types index in downstream nodes.
Definition: IF Cumulative_Data_Plus[Output_Periods_Plus=Output_Periods] = Null~
THEN Null~
ELSE Uncumulate(Cumulative_Data_Plus, Output_Periods_Plus)[Output_Periods_Plus=Output_Periods]~

NodeLocation: 416,320,1
NodeSize: 64,40
WindState: 2,1840,105,808,428
ValueState: 2,313,22,1282,720,1,MIDM
ReformVal: [Output_Periods,PV_Spatial_ID]
Att__TotalsIndex: [Spatial_ID,PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,1,PV_Cumul_Data_Type,2,PV_Spatial_ID,0,PV_Spatial_ID,0,Output_Periods,1]
Att_ColorRole: Null

Variable Increm_Data_Cumulate
Title: Increm Data Cumulated
Definition: IF Incremental_Data = Null~
THEN Null~
ELSE Cumulative_Data_Plus[Output_Periods_Plus=Slice(Output_Periods_Plus,1)] + Cumulate(Incremental_Data, Output_Periods)
NodeLocation: 416,216,1
NodeSize: 64,40
ValueState: 2,440,442,416,303,1,MIDM

Variable Cumulative_QC_Check
Title: Cumulative QC Check
Definition: [Cumulative_Data,Increm_Data_Cumulate]
NodeLocation: 416,80,1
NodeSize: 64,40
ValueState: 2,17,-1,1443,836,1,MIDM
NodeColor: 65535,19661,50247
ReformVal: [Output_Periods,Self]
Att__TotalsIndex: [Spatial_ID,Output_Periods,PV_Spatial_ID,PV_Sectors]
Att_ResultSliceState: [PV_Sectors,0,PV_Spatial_ID,0,PV_Cumul_Data_Type,2,Self,1,Output_Periods,1]

Variable Cumulative_Data
Title: Cumulative Data
Definition: Cumulative_Data_Plus[Output_Periods_Plus=Output_Periods]
NodeLocation: 264,112,1
NodeSize: 64,40
ValueState: 2,2036,314,726,521,,MIDM
Att_ResultSliceState: [PV_Sectors,2,Output_Periods,1,PV_Spatial_ID,1]

Variable PV_Adoption_Data
Title: PV Adoption Data
Definition: IF PV_Map_Increm_Cumul = Null~
THEN IF Actual_vs_Sim_Map THEN Cumulative_Data[PV_Cumul_Data_Type=PV_Adopt_Data_Types] ELSE Null~
ELSE IF Actual_vs_Sim_Map THEN Incremental_Data[PV_Cumul_Data_Type=PV_Map_Increm_Cumul] ELSE Null
NodeLocation: 576,184,1
NodeSize: 64,40
WindState: 2,1300,82,952,350
ValueState: 2,21,76,1292,693,0,MIDM
ReformVal: [Output_Periods,Act_vs_Sim]
NumberFormat: 2,F,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [PV_Spatial_ID,PV_Sectors]
Att_ResultSliceState: [PV_Sectors,0,PV_Adopt_Data_Types,5,PV_Spatial_ID,0,Act_vs_Sim,2,Output_Periods,1]

Alias Al1542351006
Title: Map Incremental to Cumulative
Definition: 1
NodeLocation: 576,88,1
NodeSize: 64,40
Original: PV_Map_Increm_Cumul

FormNode Fo1542351091
Title: Map Incremental to Cumulative
Definition: 0
NodeLocation: 576,36,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: PV_Map_Increm_Cumul

Variable Actual_vs_Sim_Map
Title: Actual vs Simulated Map
Definition: IF (Act_vs_Sim = Actual_Label) AND (Output_Period_Map <= MAX(Interconnect_Date))~
THEN 1~
ELSE IF (Act_vs_Sim = SImulated_Label) AND (Output_Period_Map > MAX(Interconnect_Date))~
THEN 1~
ELSE Null
NodeLocation: 576,320,1
NodeSize: 64,40
WindState: 2,687,161,720,350
ValueState: 2,273,106,1110,604,0,MIDM

Variable Cumulative_Data_Plu4
Title: Cumulative Data Plus
Definition: IF Output_Periods_Plus <= VehStk_Year_EOP_Map[Vehicle_Stock_DataYr=EV_Calibration_End]~
THEN Interp_Hist_EV_Adopt~
ELSE Interp_Sim_EV_Adopt
NodeLocation: 408,560,1
NodeSize: 64,40
ValueState: 2,104,80,1498,819,1,MIDM
ReformVal: [Output_Periods_Plus,Null]
Att__TotalsIndex: [EV_Spatial_ID]
Att_ResultSliceState: [EV_Sectors,1,EV_Cumul_Data_Type,2,EV_Spatial_ID,0,Output_Periods_Plus,1]
Att_ColorRole: Null

Variable Incremental_Data5
Title: Incremental Data
Description: Although the Cumulative Data Types index suggests these values are cumulative, they are in fact incremental and represent units/period. These will be mapped back to the incremental values in the Adoption Data Types index in downstream nodes.
Definition: ~
IF (Interp_Sim_EV_Adopt[Output_Periods_Plus=Output_Periods] = Null) OR ((EV_Spatial_ID<>Aggregation_1_Label) AND (Output_Periods <= VehStk_Year_EOP_Map[Vehicle_Stock_DataYr=EV_Calibration_End]))~
THEN Null~
ELSE Uncumulate(Interp_Sim_EV_Adopt, Output_Periods_Plus)[Output_Periods_Plus=Output_Periods]~

NodeLocation: 560,664,1
NodeSize: 64,40
WindState: 2,2101,179,808,428
ValueState: 2,263,93,1585,720,1,MIDM
ReformVal: [Output_Periods,PV_Spatial_ID]
Att__TotalsIndex: [Spatial_ID,PV_Spatial_ID,EV_Spatial_ID]
Att_ResultSliceState: [EV_Sectors,1,EV_Cumul_Data_Type,1,EV_Spatial_ID,0,EV_Spatial_ID,0,Output_Periods,1]
Att_ColorRole: Null

Variable Increm_Data_Cumulat4
Title: Increm Data Cumulated
Definition: IF Incremental_Data5 = Null~
THEN Null~
ELSE Cumulative_Data_Plu4[Output_Periods_Plus=Slice(Output_Periods_Plus,1)] + Cumulate(Incremental_Data5, Output_Periods)
NodeLocation: 560,560,1
NodeSize: 64,40
ValueState: 2,416,176,1131,637,1,MIDM
Att_ResultSliceState: [EV_Sectors,1,EV_Cumul_Data_Type,1,EV_Spatial_ID,1,Output_Periods,1]

Variable Cumulative_QC_Check4
Title: Cumulative QC Check
Definition: [Cumulative_Data5,Increm_Data_Cumulat4]
NodeLocation: 560,424,1
NodeSize: 64,40
ValueState: 2,17,-1,1443,836,1,MIDM
NodeColor: 65535,19661,50247
ReformVal: [Output_Periods,Self]
Att__TotalsIndex: [Spatial_ID,Output_Periods,PV_Spatial_ID]
Att_ResultSliceState: [EV_Spatial_ID,1,EV_Sectors,1,Sel_Ag_EV_LRMS,1,EV_Cumul_Data_Type,2,Self,1,Output_Periods,1]

Variable Cumulative_Data5
Title: Cumulative Data
Definition: Cumulative_Data_Plu4[Output_Periods_Plus=Output_Periods]
NodeLocation: 408,456,1
NodeSize: 64,40
ValueState: 2,2036,314,726,521,,MIDM
Att_ResultSliceState: [EV_Sectors,1,EV_Cumul_Data_Type,2,All_Vehicle_Techs,1,EV_Spatial_ID,1,Output_Periods,1]

Variable EV_Adoption_Data
Title: EV Adoption Data
Description: NEED TO MAKE THE NULL FOR EV INCREMENTAL MORE ROBUST
Definition: IF EV_Map_Increm_Cumul = Null~
THEN IF Actual_vs_Sim_Map2 THEN Cumulative_Data5[EV_Cumul_Data_Type=EV_Adopt_Data_Types] ELSE Null~
ELSE IF Actual_vs_Sim_Map2 THEN Incremental_Data5[EV_Cumul_Data_Type=EV_Map_Increm_Cumul] ELSE Null;
NodeLocation: 720,528,1
NodeSize: 64,40
NodeInfo: 1,1,1,1,1,1,0,,0,,0,,,
ValueState: 2,242,38,1123,763,1,MIDM
ReformVal: [Output_Periods,Act_vs_Sim]
NumberFormat: 2,F,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [EV_Spatial_ID,69,EV_Sectors,1,EV_Adopt_Data_Types,3,Act_vs_Sim,1,Output_Periods,1]

Variable Actual_vs_Sim_Map2
Title: Actual vs Simulated Map
Definition: IF (Act_vs_Sim = Actual_Label) AND (Output_Periods <= VehStk_Year_EOP_Map[Vehicle_Stock_DataYr=EV_Calibration_End])~
THEN 1~
ELSE IF (Act_vs_Sim = SImulated_Label) AND (Output_Periods > VehStk_Year_EOP_Map[Vehicle_Stock_DataYr=EV_Calibration_End])~
THEN 1~
ELSE Null
NodeLocation: 720,664,1
NodeSize: 64,40
WindState: 2,687,161,720,350
ValueState: 2,26,13,1224,640,0,MIDM

Alias Al1542873268
Title: EV Adoption Forecasts
Definition: 1
NodeLocation: 104,656,1
NodeSize: 64,40
NodeColor: 19661,48336,65535
Original: EV_Adoption_Forecast

Alias Al1542873284
Title: Historic EV Adoption
Definition: 1
NodeLocation: 104,352,1
NodeSize: 64,40
NodeColor: 19661,48336,65535
Original: Historic_EV_Adoption

Variable Interp_Sim_EV_Adopt
Title: Interp Simulated EV Adoption
Definition: LinearInterp(EV_Time_EOP_Map, Total_EV_Forecasts[EV_Adopt_Data_Types=EV_Cumul_Data_Type], Equal_Prd_Output_Map, Time_Vehicles)
NodeLocation: 256,560,1
NodeSize: 64,40
WindState: 2,269,323,720,445
ValueState: 2,386,21,1114,821,1,MIDM
Aliases: Alias Al1542998770
ReformVal: [Null,Output_Periods_Plus]
Att__TotalsIndex: [EV_Spatial_ID]
Att_ResultSliceState: [EV_Sectors,1,EV_Cumul_Data_Type,1,EV_Spatial_ID,0,Output_Periods_Plus,1]
Att_ColorRole: Null

Variable Interp_Hist_EV_Adopt
Title: Interp Historic EV Adoption
Definition: IF (Output_Periods_Plus <= VehStk_Year_EOP_Map[Vehicle_Stock_DataYr=EV_Calibration_End]) AND (Output_Periods_Plus<>EV_TimeOpt_EOP_Map[Veh_Sim_Strt_Yr_Opti=EV_CalStart_Minus1])~
THEN Total_Historic_EVs[EV_Adopt_Data_Types=EV_Cumul_Data_Type, Vehicle_Stock_DataYr=SubIndex(VehStk_Year_EOP_Map, Output_Periods_Plus, Vehicle_Stock_DataYr)]~
ELSE Null
NodeLocation: 256,448,1
NodeSize: 64,40
WindState: 2,98,82,1082,287
ValueState: 2,73,14,1315,721,1,MIDM
Aliases: Alias Al1542998771
ReformVal: [Output_Periods_Plus,Null]
Att__TotalsIndex: [EV_Spatial_ID]
Att_ResultSliceState: [EV_Sectors,1,EV_Cumul_Data_Type,2,EV_Spatial_ID,0,Output_Periods_Plus,1]
Att_ColorRole: Null

Alias Al1542876315
Title: EV Map Incremental to Cumulative
Definition: 1
NodeLocation: 720,432,1
NodeSize: 64,40
Original: EV_Map_Increm_Cumul

FormNode Fo1542876324
Title: Map Incremental to Cumulative
Definition: 0
NodeLocation: 720,380,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: EV_Map_Increm_Cumul

Variable PV_Sequent_Outputs
Title: PV Sequential Outputs
Definition: PV_Adoption_Data[PV_Adopt_Data_Types=Map_Seq_Outputs[All_DER_Types=PV_DER_Label], PV_Spatial_ID = Spatial_ID, PV_Sectors=All_Sectors]
NodeLocation: 728,184,1
NodeSize: 64,40
ValueState: 2,153,14,1523,855,1,MIDM
ReformVal: [Output_Periods,Act_vs_Sim]
Att__TotalsIndex: [Spatial_ID]
Att_ResultSliceState: [Sequential_Outputs,2,All_Sectors,1,Spatial_ID,0,Opt_Storage_Systems,1,Act_vs_Sim,1,Output_Periods,1]

Variable EV_Sequent_Outputs
Title: EV Sequential Outputs
Definition: EV_Adoption_Data[EV_Adopt_Data_Types=Map_Seq_Outputs[All_DER_Types=EV_DER_Label], EV_Spatial_ID=Spatial_ID, EV_Sectors=All_Sectors]
NodeLocation: 872,528,1
NodeSize: 64,40
WindState: 2,1300,82,1463,748
ValueState: 2,86,9,1343,761,1,MIDM
ReformVal: [Output_Periods,Act_vs_Sim]
Att__TotalsIndex: [Spatial_ID]
Att_ResultSliceState: [Sequential_Outputs,2,All_Sectors,3,Spatial_ID,0,All_Vehicle_Techs,3,Act_vs_Sim,1,Output_Periods,1]

Index Sequential_Outputs
Att_PrevIndexValue: ['Incremental Count','Cumulative Count','Incremental MW-AC','Cumulative MW-AC']
Title: Sequential Outputs
Definition: ['Incremental Count','Cumulative Count','Incremental MW-AC','Cumulative MW-AC']
NodeLocation: 1064,88,1
NodeSize: 64,40
WindState: 2,837,82,720,350
Aliases: FormNode Fo1543018175
{!40300|Att_SlicerPopupSize: 282,84}

Decision Map_Seq_Outputs
Title: Map Sequential Outputs
Description: Maps DER-specific outputs to the output names associated with sequential (eg, historic then simulated) outputs.
Definition: Table(All_DER_Types,Sequential_Outputs)(~
Choice(PV_Adopt_Types_None,2,0),Choice(PV_Adopt_Types_None,5,0),Choice(PV_Adopt_Types_None,3,0),Choice(PV_Adopt_Types_None,6,0),~
Choice(EV_Adopt_Types_None,2,0),Choice(EV_Adopt_Types_None,4,0),Choice(EV_Adopt_Types_None,3,0),Choice(EV_Adopt_Types_None,5,0),~
Null,Null,Null,Null,~
Null,Null,Null,Null,~
Choice(BESS_AdoptTypes_None,2,0),Choice(BESS_AdoptTypes_None,5,0),Choice(BESS_AdoptTypes_None,3,0),Choice(BESS_AdoptTypes_None,6,0))
NodeLocation: 872,336,1
NodeSize: 64,40
DefnState: 2,512,348,1311,287,0,DFNM
Aliases: FormNode Fo1543005910
ReformDef: [All_DER_Types,Sequential_Outputs]
TableCellDefault: Default_Sequent_Map

Decision Default_Sequent_Map
Title: Default Sequential Map
Definition: Table(All_DER_Types)(Choice(PV_Adopt_Types_None,1,0),Choice(EV_Adopt_Types_None,1,0),Null,Null,Null)
NodeLocation: 1208,88,1
NodeSize: 64,40
DefnState: 2,1007,346,416,303,0,DFNM
Aliases: FormNode Fo1543018271

FormNode Fo1543005910
Title: Map Sequential Outputs
Definition: 0
NodeLocation: 872,388,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Map_Seq_Outputs

Objective Sequent_Data_Handles
Title: Sequential Data Handles
Definition: Table(All_DER_Types)(Handle(PV_Sequent_Outputs),Handle(EV_Sequent_Outputs),Handle(Null),Handle(Null),Handle(BESS_Sequential_Outp))
NodeLocation: 1032,336,1
NodeSize: 64,40
NodeInfo: 1,1,1,1,1,1,0,,0,,0,,,
WindState: 2,184,31,1441,756
DefnState: 2,512,229,935,303,0,DFNM
ValueState: 2,268,6,1024,661,,MIDM
NodeColor: 19661,48336,65535
TableCellDefault: Handle(Null)

Variable Sel_Sequential_Data
Title: Selected Sequential Data
Definition: FOR J:=Output_DER_Types DO (~
   VAR data:=Sequent_Data_Handles[All_DER_Types=J];~
   data~
);~

NodeLocation: 1184,336,1
NodeSize: 64,40
ValueState: 2,472,0,1258,843,1,MIDM
Aliases: Alias Al1543025118
GraphSetup: Att_GraphIndexRange Output_Periods:1,0,1,,,,10,41675.51013508439,42759.229737997055,0~
{!40600|Att_WaterfallBar Graph_Primary_Valdim:0}~
Att_CatLineStyle Graph_Primary_Valdim:9~
Att_Stacked_Lines Graph_Primary_Valdim:0~
Att_AreaFill Graph_Primary_Valdim:0~
Att_ContLineStyle Graph_Primary_Valdim:5~
{!50007|Graph_BarOutline:0}~
Att_GraphValueRange Sel_Sequential_Data:1,,1,,,,10,811.7702901363373,1536.0971689224243,0
ReformVal: [Output_Periods,Act_vs_Sim]
Att__TotalsIndex: [Spatial_ID,All_Sectors]
Att_ResultSliceState: [All_Sectors,0,Spatial_ID,0,Sequential_Outputs,3,Output_DER_Types,3,Act_vs_Sim,2,Output_Periods,1]

Variable Flat_Sequential_Data
Title: Flat Sequential Data
Definition: MdArrayToTable(Sel_Sequential_Data, valueIndex: Sequential_Outputs, omitZero: False, omitNull: True)
NodeLocation: 1336,336,1
NodeSize: 64,40
ValueState: 2,1612,25,1474,742,,MIDM

Index Sequential_Columns
Att_PrevIndexValue: [Spatial_ID,Act_vs_Sim,Output_DER_Types,Output_Periods,All_Sectors,'Incremental Count','Cumulative Count','Incremental MW-AC','Cumulative MW-AC']
Title: Sequential Columns
Definition: CopyIndex(Flat_Sequential_Data.Col)
NodeLocation: 1352,176,1
NodeSize: 64,40
ValueState: 2,0,24,1013,488,0,MIDM

Index Sequential_Order_Num
Att_PrevIndexValue: [1,2,3,4,5,6,7,8,9]
Title: Sequential Order Number
Definition: 1..Size(Sequential_Columns)
NodeLocation: 1352,88,1
NodeSize: 64,40

Decision Order_of_Seq_Cols
Title: Order of Sequential Columns
Description: Specify the order in which columns will appear in the output results for sequential (historic then simulated) results.
Definition: Table(Sequential_Columns)(Choice(Sequential_Order_Num,1,0),Choice(Sequential_Order_Num,4,0),Choice(Sequential_Order_Num,2,0),Choice(Sequential_Order_Num,5,0),Choice(Sequential_Order_Num,3,0),Choice(Sequential_Order_Num,6,0),Choice(Sequential_Order_Num,7,0),Choice(Sequential_Order_Num,8,0),Choice(Sequential_Order_Num,9,0))
NodeLocation: 1488,432,1
NodeSize: 64,40
DefnState: 2,12,315,501,447,0,DFNM
ValueState: 2,52,58,416,303,0,MIDM
Aliases: FormNode Fo1543007705
TableCellDefault: Choice(Sequential_Order_Num,1,0)

FormNode Fo1543007705
Title: Order of Sequential Columns
Definition: 0
NodeLocation: 1488,484,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Order_of_Seq_Cols

Variable Format_Sequent_Data
Title: Formatted Sequential Data
Definition: INDEX orderedCols:=CopyIndex(SubIndex(Order_of_Seq_Cols, @Sequential_Columns, Sequential_Columns));~
Flat_Sequential_Data[.Row=Sequential_Row_Num, .Col=orderedCols, @orderedCols=@Sequential_Text_Cols]
NodeLocation: 1480,336,1
NodeSize: 64,40
ValueState: 2,248,24,1410,681,0,MIDM
ReformVal: [Sequential_Text_Cols,Sequential_Row_Num]

Index Sequential_Text_Cols
Att_PrevIndexValue: ['Spatial ID','Output DER Types','All Sectors','Act vs Sim','Output Periods','Incremental Count','Cumulative Count','Incremental MW-AC','Cumulative MW-AC']
Title: Sequential Text Columns
Definition: INDEX orderedCols:=CopyIndex(SubIndex(Order_of_Seq_Cols, @Sequential_Columns, Sequential_Columns));~
VAR textParse:=FOR J:=@orderedCols DO (~
   IF IsHandle(Slice(orderedCols, J))~
   THEN Title of Slice(orderedCols, J)~
   ELSE Slice(orderedCols, J)~
);~
CopyIndex(textParse)
NodeLocation: 1488,88,1
NodeSize: 64,40
ValueState: 2,12,79,1235,511,0,MIDM
ReformVal: [Self,Undefined]

Index Sequential_Row_Num
Title: Sequential Row Number
Definition: CopyIndex(Flat_Sequential_Data.Row)
NodeLocation: 1488,176,1
NodeSize: 64,40

FormNode Fo1543018175
Title: Sequential Outputs
Definition: 0
NodeLocation: 1064,140,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Sequential_Outputs

FormNode Fo1543018271
Title: Default Sequential Map
Definition: 0
NodeLocation: 1208,140,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Default_Sequent_Map

Variable PV_Cumul_Adoption
Title: PV Cumulative Adoption
Units: MW-AC
Description: Nameplate MW-AC from Solar PV, cumulative for all time. Excludes any T&D losses. Values are end-of-period.
Definition: PV_Sequent_Outputs[Sequential_Outputs=Seq_Cumul_MW_Label, All_Sectors=PV_Sectors]
NodeLocation: 888,128,1
NodeSize: 64,40
WindState: 2,102,82,1261,505
ValueState: 2,2292,107,1153,706,1,MIDM
NodeColor: 65535,1,1
GraphSetup: Att_ContLineStyle Graph_Primary_Valdim:5~
Att_GraphIndexRange Output_Periods:1,0,0,,,,10,39313.61553065479,46678.22570681572,0~
Att_GraphValueRange PV_Cumul_Adoption:1,,1,,,0,,0,49.4598925113678,0~
Att_Stacked_Lines Graph_Primary_Valdim:0~
Att_AreaFill Graph_Primary_Valdim:0~
Att_CatLineStyle Graph_Primary_Valdim:9~
Graph_FillTransparen:0~
{!50007|Graph_BarOutline:0}
ReformVal: [Output_Periods,Act_vs_Sim]
NumberFormat: 2,F,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: []
Att_ResultSliceState: [Area_Type,1,Spatial_ID,1,PV_Sectors,2,Act_vs_Sim,2,Output_Periods,167]
{!40600|Att_StackingIndex: PV_Sectors}
{!40600|Att_ClusterIndex: Null}

Variable EV_Cumul_MW_Impact
Title: EV Cumulative MW Impact
Units: MW-AC
Description: Coincident peak MW-AC impact of EVs, using CEC assumption of 0.25 kW/vehicle. Values are end-of-period.
Definition: EV_Sequent_Outputs[Sequential_Outputs=Seq_Cumul_MW_Label, All_Sectors=EV_Sectors]
NodeLocation: 1024,528,1
NodeSize: 64,40
WindState: 2,893,-2,720,350
ValueState: 2,181,20,1042,839,1,MIDM
Aliases: FormNode Fo1544977998
GraphSetup: Att_GraphValueRange EV_Cumul_MW_Impact:1,,1,,,0,5,0.0018696824554353952,0.45907679200172424,0~
Att_ContLineStyle Graph_Primary_Valdim:5
ReformVal: [Output_Periods,Act_vs_Sim]
NumberFormat: 2,F,4,1,1,0,4,1,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [Spatial_ID]
Att_ResultSliceState: [EV_Sectors,1,Spatial_ID,0,Act_vs_Sim,2,Output_Periods,1]

Variable PV_Increm_Adoption
Title: PV Incremental Adoption
Units: MW-AC/month
Description: Incremental (e.g., MW-AC per month) nameplate capacity of new solar PV installations. Values are end-of-period.
Definition: PV_Sequent_Outputs[Sequential_Outputs=Seq_Increm_MW_Label, All_Sectors=PV_Sectors]
NodeLocation: 888,224,1
NodeSize: 64,40
WindState: 2,102,82,1095,453
ValueState: 2,597,96,1158,796,1,MIDM
GraphSetup: Att_GraphValueRange PV_Increm_Adoption:1,,1,,,,10,1.038821429014206,3.2670102417469025,0~
Att_GraphIndexRange Output_Periods:1,,1,,,,10,40322.05666282028,42513.92516282201,0~
Flip:0
ReformVal: [Output_Periods,Act_vs_Sim]
Att__TotalsIndex: [Act_vs_Sim,Spatial_ID]
Att_GraphValueRange: 1,,,,,,10
Att_ResultSliceState: [PV_Sectors,1,Spatial_ID,0,Act_vs_Sim,0,Output_Periods,1]

Variable Cumulative_EV_Stock
Title: Cumulative EV Stock
Units: vehicles
Description: Total electric vehicle stock (BEVs + PHEVs). Values are End of Period.
Definition: EV_Sequent_Outputs[Sequential_Outputs=Seq_Cumul_Cnt_Label, All_Sectors=EV_Sectors]
NodeLocation: 1024,624,1
NodeSize: 64,40
ValueState: 2,366,68,965,719,1,MIDM
GraphSetup: Att_GraphValueRange Cumulative_EV_Stock:1,,1,,,,10,0,337.07015216350555,0~
Att_GraphIndexRange Output_Periods:1,,1,,,,10,45884.044605612755,45935.10080528259,0~
Graph_LineThickness:5
ReformVal: [Output_Periods,Act_vs_Sim]
NumberFormat: 2,F,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [Spatial_ID]
Att_GraphValueRange: 1,,,,,,10
Att_ResultSliceState: [EV_Sectors,1,Spatial_ID,0,Act_vs_Sim,2,Output_Periods,1]

Decision Seq_Cumul_MW_Label
Title: Seq Cumul MW Label
Definition: Choice(Sequential_Outputs,4,0)
NodeLocation: 1176,528,1
NodeSize: 64,40
Aliases: FormNode Fo1550774526

FormNode Fo1550774526
Title: Demo Rate Label
Definition: 0
NodeLocation: 1180,480,1
NodeSize: 68,16
NodeInfo: 1,0,0,0,0,0,0,102,0,,0,,,
Original: Seq_Cumul_MW_Label

Decision Seq_Cumul_Cnt_Label
Title: Seq Cumul Count Label
Definition: Choice(Sequential_Outputs,2,0)
NodeLocation: 1176,624,1
NodeSize: 64,40
Aliases: FormNode Fo1550774606

FormNode Fo1550774606
Title: Demo Rate Label
Definition: 0
NodeLocation: 1188,664,1
NodeSize: 68,16
NodeInfo: 1,0,0,0,0,0,0,102,0,,0,,,
Original: Seq_Cumul_Cnt_Label

Decision Seq_Increm_MW_Label
Title: Seq Increm MW Label
Definition: Choice(Sequential_Outputs,3,0)
NodeLocation: 1040,224,1
NodeSize: 64,40
Aliases: FormNode Fo1550774658

FormNode Fo1550774658
Title: Demo Rate Label
Definition: 0
NodeLocation: 1052,264,1
NodeSize: 68,16
NodeInfo: 1,0,0,0,0,0,0,102,0,,0,,,
Original: Seq_Increm_MW_Label

Variable Total_Historic_EVs
Title: Total Historic EVs
Description: The total historic EV adoption summed over EV types.
Definition: Sum(Historic_EV_Adoption, EV_Vehicles)
NodeLocation: 104,448,1
NodeSize: 64,40
WindState: 2,203,1,720,350
ValueState: 2,212,136,788,570,,MIDM
ReformVal: [Vehicle_Stock_DataYr,EV_Spatial_ID]
Att_ResultSliceState: [EV_Adopt_Data_Types,3,EV_Sectors,1,Vehicle_Stock_DataYr,1,EV_Spatial_ID,1]

Variable Total_EV_Forecasts
Title: Total EV Forecasts
Description: The total forecasted EV adoption summed over EV types.
Definition: Sum(EV_Adoption_Forecast, EV_Vehicles)
NodeLocation: 104,560,1
NodeSize: 64,40
ValueState: 2,308,314,818,485,,MIDM

Variable Cumulative_Data_Plu2
Title: Cumulative Data Plus
Definition: IF Output_Periods_Plus <= BESS_TimeOpt_EOP_Map[BESS_Sim_Strt_Yr_Opt=BESS_Calibration_End]~
THEN Historic_BESS_Adopt~
ELSE Interp_SimBESS_Adopt
NodeLocation: 408,1016,1
NodeSize: 64,40
ValueState: 2,28,24,1674,819,0,MIDM
GraphSetup: Att_GraphValueRange Cumulative_Data_Plu2:1,,1,,,,,5.098435096442699,189.2478570342064,0~
Att_GraphIndexRange Output_Periods_Plus:1,,1,,,,,41966.60496470332,42798.44138753414,0
ReformVal: [Output_Periods_Plus,Null]
Att__TotalsIndex: [BESS_Spatial_ID,BESS_Sectors]
Att_ResultSliceState: [BESS_Sectors,0,BESS_Spatial_ID,0,BESS_Cumul_DataTypes,2,Output_Periods_Plus,1]
Att_ColorRole: Null

Variable Incremental_Data2
Title: Incremental Data
Description: Although the Cumulative Data Types index suggests these values are cumulative, they are in fact incremental and represent units/period. These will be mapped back to the incremental values in the Adoption Data Types index in downstream nodes.
Definition: IF Cumulative_Data_Plu2[Output_Periods_Plus=Output_Periods] = Null~
THEN Null~
ELSE Uncumulate(Cumulative_Data_Plu2, Output_Periods_Plus)[Output_Periods_Plus=Output_Periods]~

NodeLocation: 560,1120,1
NodeSize: 64,40
WindState: 2,1840,105,808,428
ValueState: 2,85,9,1585,762,1,MIDM
ReformVal: [Output_Periods,PV_Spatial_ID]
Att__TotalsIndex: [Spatial_ID,PV_Spatial_ID,EV_Spatial_ID,BESS_Spatial_ID,BESS_Sectors]
Att_ResultSliceState: [BESS_Sectors,0,BESS_Spatial_ID,0,BESS_Cumul_DataTypes,2,BESS_Spatial_ID,0,Output_Periods,1]
Att_ColorRole: Null

Variable Increm_Data_Cumulat2
Title: Increm Data Cumulated
Definition: IF Incremental_Data2 = Null~
THEN Null~
ELSE Replace_X_with_Y(Cumulative_Data_Plu2[Output_Periods_Plus=Slice(Output_Periods_Plus,1)], Null, 0) + Cumulate(Incremental_Data2, Output_Periods)
NodeLocation: 560,1016,1
NodeSize: 64,40
ValueState: 2,416,176,1131,637,1,MIDM
Att__TotalsIndex: [BESS_Sectors]
Att_ResultSliceState: [BESS_Sectors,0,BESS_Cumul_DataTypes,1,BESS_Spatial_ID,1,Output_Periods,1]

Variable Cumulative_QC_Check2
Title: Cumulative QC Check
Definition: [Cumulative_Data2,Increm_Data_Cumulat2]
NodeLocation: 560,880,1
NodeSize: 64,40
ValueState: 2,17,-1,1443,836,1,MIDM
NodeColor: 65535,19661,50247
ReformVal: [Output_Periods,Self]
Att__TotalsIndex: [Spatial_ID,Output_Periods,PV_Spatial_ID,BESS_Spatial_ID,BESS_Sectors]
Att_ResultSliceState: [BESS_Sectors,0,BESS_Spatial_ID,0,BESS_Cumul_DataTypes,2,Self,1,Output_Periods,1]

Variable Cumulative_Data2
Title: Cumulative Data
Definition: Cumulative_Data_Plu2[Output_Periods_Plus=Output_Periods]
NodeLocation: 408,912,1
NodeSize: 64,40
ValueState: 2,2036,314,726,521,,MIDM
Att_ResultSliceState: [EV_Sectors,1,Sel_Ag_EV_LRMS,1,EV_Cumul_Data_Type,2,EV_Spatial_ID,1,Output_Periods,1]

Variable BESS_Adoption_Data
Title: BESS Adoption Data
Description: NEED TO MAKE THE NULL FOR EV INCREMENTAL MORE ROBUST
Definition: IF BESS_Map_IncremCumul = Null~
THEN IF Actual_vs_Sim_Map1 THEN Cumulative_Data2[BESS_Cumul_DataTypes=BESS_Adopt_DataTypes] ELSE Null~
ELSE IF Actual_vs_Sim_Map1 THEN Incremental_Data2[BESS_Cumul_DataTypes=BESS_Map_IncremCumul] ELSE Null;
NodeLocation: 720,984,1
NodeSize: 64,40
NodeInfo: 1,1,1,1,1,1,0,,0,,0,,,
ValueState: 2,369,3,1123,763,1,MIDM
ReformVal: [Output_Periods,Act_vs_Sim]
NumberFormat: 2,F,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [PV_Spatial_ID,BESS_Spatial_ID,BESS_Sectors]
Att_ResultSliceState: [BESS_Sectors,0,BESS_Spatial_ID,0,BESS_Adopt_DataTypes,6,Act_vs_Sim,1,Output_Periods,1]

Variable Actual_vs_Sim_Map1
Title: Actual vs Simulated Map
Definition: IF (Act_vs_Sim = Actual_Label) AND (Output_Period_Map <= BESS_TimeOpt_EOP_Map[BESS_Sim_Strt_Yr_Opt=BESS_Calibration_End])~
THEN 1~
ELSE IF (Act_vs_Sim = SImulated_Label) AND (Output_Period_Map > BESS_TimeOpt_EOP_Map[BESS_Sim_Strt_Yr_Opt=BESS_Calibration_End])~
THEN 1~
ELSE Null
NodeLocation: 720,1120,1
NodeSize: 64,40
WindState: 2,687,161,720,350
ValueState: 2,26,13,1224,640,0,MIDM

Variable Interp_SimBESS_Adopt
Title: Interp Sim BESS Adoption
Definition: VAR adoption:=IF BESS_Sim_Strt_Yr_Opt = BESS_SimStart_Minus1~
   THEN Historical_BESS_Adop[All_Sectors=BESS_Sectors, All_Spatial_ID=BESS_Spatial_ID, AESS_Time=SubIndex(AESS_Time_EOP_Map, BESS_TimeOpt_EOP_Map[BESS_Sim_Strt_Yr_Opt=BESS_SimStart_Minus1], AESS_Time)]~
   ELSE BESS_Adoption_Fcst[Time_Storage=BESS_Sim_Strt_Yr_Opt];~
~
IF (Output_Periods_Plus > BESS_TimeOpt_EOP_Map[BESS_Sim_Strt_Yr_Opt=BESS_SimStart_Minus1]) AND (Output_Periods_Plus <= BESS_TimeOpt_EOP_Map[BESS_Sim_Strt_Yr_Opt=BESS_Sim_End_Year])~
THEN LinearInterp(BESS_TimeOpt_EOP_Map, adoption[BESS_Adopt_DataTypes=BESS_Cumul_DataTypes], Equal_Prd_by_Qtr_Map, BESS_Sim_Strt_Yr_Opt)~
ELSE Null~
~

NodeLocation: 256,1016,1
NodeSize: 64,40
WindState: 2,269,323,720,445
ValueState: 2,316,0,1511,818,1,MIDM
Aliases: Alias Al1579125380
ReformVal: [BESS_Sim_Strt_Yr_Opt,Null]
Att__TotalsIndex: [BESS_Sectors,BESS_Spatial_ID]
Att_ResultSliceState: [BESS_Sectors,0,BESS_Spatial_ID,0,BESS_Cumul_DataTypes,2,Output_Periods_Plus,1]
Att_ColorRole: Null

Variable Historic_BESS_Adopt
Title: Historic BESS Adoption
Definition: Historical_BESS_Adop[BESS_Adopt_DataTypes=BESS_Cumul_DataTypes, AESS_Time=SubIndex(AESS_Time_EOP_Map, Output_Periods_Plus, AESS_Time), All_Spatial_ID=BESS_Spatial_ID, All_Sectors=BESS_Sectors]
NodeLocation: 256,912,1
NodeSize: 64,40
WindState: 2,98,82,1082,287
ValueState: 2,73,14,1315,721,1,MIDM
ReformVal: [Output_Periods_Plus,Null]
Att__TotalsIndex: [BESS_Spatial_ID,BESS_Sectors]
Att_ResultSliceState: [BESS_Sectors,0,BESS_Spatial_ID,0,BESS_Cumul_DataTypes,2,Output_Periods_Plus,1]
Att_ColorRole: Null

Variable BESS_Sequential_Outp
Title: BESS Sequential Outputs
Definition: BESS_Adoption_Data[BESS_Adopt_DataTypes=Map_Seq_Outputs[All_DER_Types=BESS_DER_Label], BESS_Spatial_ID=Spatial_ID, BESS_Sectors=All_Sectors]
NodeLocation: 872,984,1
NodeSize: 64,40
WindState: 2,1300,82,1463,748
ValueState: 2,471,183,1343,761,1,MIDM
ReformVal: [Output_Periods,Act_vs_Sim]
Att__TotalsIndex: [Spatial_ID,All_Sectors]
Att_ResultSliceState: [Sequential_Outputs,4,All_Sectors,0,Spatial_ID,0,Act_vs_Sim,1,Output_Periods,1]

Alias Al1579093082
Title: BESS Adoption Forecasts
Definition: 1
NodeLocation: 104,1016,1
NodeSize: 64,40
NodeColor: 19661,48336,65535
Original: BESS_Adoption_Fcst

Alias Al1579095081
Title: Historical BESS Adoption
Definition: 1
NodeLocation: 104,912,1
NodeSize: 64,40
Original: Historical_BESS_Adop

Alias Al1579111866
Title: BESS Map Incremental to Cumulative
Definition: 1
NodeLocation: 720,880,1
NodeSize: 64,40
Original: BESS_Map_IncremCumul

FormNode Fo1579111871
Title: Map Incremental to Cumulative
Definition: 0
NodeLocation: 720,828,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: BESS_Map_IncremCumul

Alias Al80744189
Title: Final EV Historic Period
Definition: 1
NodeLocation: 264,664,1
NodeSize: 64,40
Original: Final_EV_Hist_Period

FormNode Fo80744189
Title: Final EV Historic Period
Definition: 0
NodeLocation: 268,720,1
NodeSize: 100,8
NodeInfo: 1,,,0,,,,150,,,0,,,0
Original: Final_EV_Hist_Period

Text Te2108239395
Title: Doesn't do historical correctly if not from interconnectd data
NodeLocation: 864,80,-1
NodeSize: 64,72

Close Sequential_Historic_

Module Compare_Actual_vs_Si
Title: Compare Actual vs Simulated
Author: JamesMilford
Date: Sun, Nov 18, 2018 11:53 PM
NodeLocation: 736,888,1
NodeSize: 64,40
DiagState: 2,0,63,1649,656,17,10

Variable Cumulative_Data_Plu1
Title: Cumulative Data Plus
Definition: VAR historic:=IF (Output_Prd_Plus_Map >= PV_CalStart_Minus1) AND (Output_Prd_Plus_Map <= PV_Calibration_End)~
   THEN Historical_PV_Adopti[Interconnect_Date=Output_Prd_Plus_Map, PV_Adopt_Data_Types=PV_Cumul_Data_Type]~
   ELSE Null;~
VAR actual:=IF (Output_Prd_Plus_Map >= PV_CalStart_Minus1) AND (Output_Prd_Plus_Map <= PV_Calibration_End)~
   THEN IgnoreWarnings(PV_Adoption_Forecast[Time_Solar_PV=Output_Prd_Plus_Map, System_Types=PV_Retrofit_Label, PV_Adopt_Data_Types=PV_Cumul_Data_Type])~
   ELSE Null;~
~
IF Act_vs_Sim = Actual_Label~
THEN historic~
ELSE actual
NodeLocation: 264,216,1
NodeSize: 64,40
WindState: 2,307,434,1269,399
ValueState: 2,16,13,1281,815,1,MIDM
ReformVal: [Output_Periods_Plus,Act_vs_Sim]
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,0,PV_Cumul_Data_Type,1,Act_vs_Sim,1,Output_Periods_Plus,1]

Alias Al1542352234
Title: PV Adoption Forecasts
Definition: 1
NodeLocation: 112,216,1
NodeSize: 64,40
NodeColor: 19661,48336,65535
Original: PV_Adoption_Forecast

Alias Al1542352235
Title: Historic PV Adoption
Definition: 1
NodeLocation: 112,112,1
NodeSize: 64,40
NodeColor: 19661,48336,65535
Original: Historical_PV_Adopti

Variable Incremental_Data1
Title: Incremental Data
Description: Although the Cumulative Data Types index suggests these values are cumulative, they are in fact incremental and represent units/period. These will be mapped back to the incremental values in the Adoption Data Types index in downstream nodes.
Definition: IF (Cumulative_Data_Plu1[Output_Periods_Plus=Output_Periods] = Null) OR (@Output_Periods <= PositionInIndex(Output_Period_Map, PV_CalStart_Minus1, Output_Periods) + 1)~
THEN Null~
ELSE Uncumulate(Cumulative_Data_Plu1, Output_Periods_Plus)[Output_Periods_Plus=Output_Periods]~

NodeLocation: 416,320,1
NodeSize: 64,40
WindState: 2,1840,105,808,428
ValueState: 2,-1,40,1282,692,0,MIDM
ReformVal: [Output_Periods,Act_vs_Sim]
Att__TotalsIndex: [Spatial_ID,PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,0,PV_Cumul_Data_Type,1,Act_vs_Sim,1,Output_Periods,1]

Variable Increm_Data_Cumulat1
Title: Increm Data Cumulated
Definition: IF Incremental_Data1 = Null~
THEN Null~
ELSE Cumulative_Data_Plu1[Output_Periods_Plus=Slice(Output_Periods_Plus,1)] + Cumulate(Incremental_Data1, Output_Periods)
NodeLocation: 416,216,1
NodeSize: 64,40
ValueState: 2,240,72,833,569,1,MIDM

Variable Cumulative_QC_Check1
Title: Cumulative QC Check
Definition: [Cumulative_Data1,Increm_Data_Cumulat1]
NodeLocation: 416,80,1
NodeSize: 64,40
ValueState: 2,94,18,1443,836,1,MIDM
NodeColor: 65535,19661,50247
ReformVal: [Output_Periods,Self]
Att__TotalsIndex: [Spatial_ID,Output_Periods,PV_Spatial_ID]
Att_ResultSliceState: [PV_Spatial_ID,0,PV_Sectors,1,Cumulative_Data_Type,1,Act_vs_Sim,2,Self,1,Output_Periods,0]

Variable Cumulative_Data1
Title: Cumulative Data
Definition: Cumulative_Data_Plu1[Output_Periods_Plus=Output_Periods]
NodeLocation: 264,112,1
NodeSize: 64,40
ValueState: 2,2036,314,726,521,,MIDM
Att_ResultSliceState: [PV_Sectors,2,Output_Periods,1,PV_Spatial_ID,1]

Variable PV_Adoption_Compare
Title: PV Adoption Comparison
Definition: IF PV_Map_Increm_Cumul = Null~
THEN Cumulative_Data1[PV_Cumul_Data_Type=PV_Adopt_Data_Types]~
ELSE Incremental_Data1[PV_Cumul_Data_Type=PV_Map_Increm_Cumul]
NodeLocation: 576,184,1
NodeSize: 64,40
ValueState: 2,255,155,1324,709,1,MIDM
ReformVal: [Output_Periods,Act_vs_Sim]
NumberFormat: 2,F,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,0,PV_Adopt_Data_Types,4,Act_vs_Sim,1,Output_Periods,1]

Alias Al1542352236
Title: Map Incremental to Cumulative
Definition: 1
NodeLocation: 576,88,1
NodeSize: 64,40
Original: PV_Map_Increm_Cumul

FormNode Fo1542352234
Title: Map Incremental to Cumulative
Definition: 0
NodeLocation: 576,36,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: PV_Map_Increm_Cumul

Module Stored_PV_Historic_C
Title: Stored PV Historic Comparisons
Author: JamesMilford
Date: Wed, Nov 21, 2018 11:59 AM
NodeLocation: 576,288,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,315,193,1408,400,17

Button Save_PV_Hist_Compare
Title: Save PV Historic Comparison
Description: This button saves results that compare the historic PV adoption to calibrated, simulated adoption. The PV simulation time must overlap with some portion of the historic data years. 
NodeLocation: 112,72,1
NodeSize: 64,40
WindState: 2,102,82,878,485
OnClick: Set_PV_Time_to_Calib;   {Set PV simulation time to calibration time}~
~
{Define the output periods based on calibration periods for all DERs}~
(Output_Start_Period:=Calib_Start_Period);~
(Output_End_Period:=Calib_End_Period);~
~
{Save static time indices for storing calibration comparisons}~
(Comparison_Time_Plus:=CopyIndex(Output_Periods_Plus));~
(Comparison_Time:=CopyIndex(Output_Periods));~
~
(Stored_PV_Comparison:=Cumulative_Data_Plu1[Output_Periods_Plus=Comparison_Time_Plus, PV_Sectors=All_Sectors, PV_Spatial_ID=Spatial_ID]);   {Save the PV historical comparison}~


Index Comparison_Time_Plus
Att_PrevIndexValue: [31-Dec-2009,31-Jan-2010,28-Feb-2010,31-Mar-2010,30-Apr-2010,31-May-2010,30-Jun-2010,31-Jul-2010,31-Aug-2010,30-Sep-2010,31-Oct-2010,30-Nov-2010,31-Dec-2010,31-Jan-2011,28-Feb-2011,31-Mar-2011,30-Apr-2011,31-May-2011,30-Jun-2011,31-Jul-2011,31-Aug-2011,30-Sep-2011,31-Oct-2011,30-Nov-2011,31-Dec-2011,31-Jan-2012,28-Feb-2012,31-Mar-2012,30-Apr-2012,31-May-2012,30-Jun-2012,31-Jul-2012,31-Aug-2012,30-Sep-2012,31-Oct-2012,30-Nov-2012,31-Dec-2012,31-Jan-2013,28-Feb-2013,31-Mar-2013,30-Apr-2013,31-May-2013,30-Jun-2013,31-Jul-2013,31-Aug-2013,30-Sep-2013,31-Oct-2013,30-Nov-2013,31-Dec-2013,31-Jan-2014,28-Feb-2014,31-Mar-2014,30-Apr-2014,31-May-2014,30-Jun-2014,31-Jul-2014,31-Aug-2014,30-Sep-2014,31-Oct-2014,30-Nov-2014,31-Dec-2014,31-Jan-2015,28-Feb-2015,31-Mar-2015,30-Apr-2015,31-May-2015,30-Jun-2015,31-Jul-2015,31-Aug-2015,30-Sep-2015,31-Oct-2015,30-Nov-2015,31-Dec-2015,31-Jan-2016,28-Feb-2016,31-Mar-2016,30-Apr-2016,31-May-2016,30-Jun-2016,31-Jul-2016,31-Aug-2016,30-Sep-2016,31-Oct-2016,30-Nov-2016,31-Dec-2016,31-Jan-2017,28-Feb-2017,31-Mar-2017,30-Apr-2017,31-May-2017,30-Jun-2017,31-Jul-2017,31-Aug-2017,30-Sep-2017,31-Oct-2017,30-Nov-2017,31-Dec-2017,31-Jan-2018,28-Feb-2018,31-Mar-2018,30-Apr-2018,31-May-2018,30-Jun-2018,31-Jul-2018,31-Aug-2018,30-Sep-2018,31-Oct-2018,30-Nov-2018,31-Dec-2018,31-Jan-2019,28-Feb-2019,31-Mar-2019,30-Apr-2019,31-May-2019,30-Jun-2019,31-Jul-2019,31-Aug-2019,30-Sep-2019,31-Oct-2019,30-Nov-2019,31-Dec-2019,31-Jan-2020,28-Feb-2020,31-Mar-2020,30-Apr-2020,31-May-2020,30-Jun-2020,31-Jul-2020,31-Aug-2020,30-Sep-2020]
Title: Comparison Time Plus
Definition: [31-Dec-2009,31-Jan-2010,28-Feb-2010,31-Mar-2010,30-Apr-2010,31-May-2010,30-Jun-2010,31-Jul-2010,31-Aug-2010,30-Sep-2010,31-Oct-2010,30-Nov-2010,31-Dec-2010,31-Jan-2011,28-Feb-2011,31-Mar-2011,30-Apr-2011,31-May-2011,30-Jun-2011,31-Jul-2011,31-Aug-2011,30-Sep-2011,31-Oct-2011,30-Nov-2011,31-Dec-2011,31-Jan-2012,28-Feb-2012,31-Mar-2012,30-Apr-2012,31-May-2012,30-Jun-2012,31-Jul-2012,31-Aug-2012,30-Sep-2012,31-Oct-2012,30-Nov-2012,31-Dec-2012,31-Jan-2013,28-Feb-2013,31-Mar-2013,30-Apr-2013,31-May-2013,30-Jun-2013,31-Jul-2013,31-Aug-2013,30-Sep-2013,31-Oct-2013,30-Nov-2013,31-Dec-2013,31-Jan-2014,28-Feb-2014,31-Mar-2014,30-Apr-2014,31-May-2014,30-Jun-2014,31-Jul-2014,31-Aug-2014,30-Sep-2014,31-Oct-2014,30-Nov-2014,31-Dec-2014,31-Jan-2015,28-Feb-2015,31-Mar-2015,30-Apr-2015,31-May-2015,30-Jun-2015,31-Jul-2015,31-Aug-2015,30-Sep-2015,31-Oct-2015,30-Nov-2015,31-Dec-2015,31-Jan-2016,28-Feb-2016,31-Mar-2016,30-Apr-2016,31-May-2016,30-Jun-2016,31-Jul-2016,31-Aug-2016,30-Sep-2016,31-Oct-2016,30-Nov-2016,31-Dec-2016,31-Jan-2017,28-Feb-2017,31-Mar-2017,30-Apr-2017,31-May-2017,30-Jun-2017,31-Jul-2017,31-Aug-2017,30-Sep-2017,31-Oct-2017,30-Nov-2017,31-Dec-2017,31-Jan-2018,28-Feb-2018,31-Mar-2018,30-Apr-2018,31-May-2018,30-Jun-2018,31-Jul-2018,31-Aug-2018,30-Sep-2018,31-Oct-2018,30-Nov-2018,31-Dec-2018,31-Jan-2019,28-Feb-2019,31-Mar-2019,30-Apr-2019,31-May-2019,30-Jun-2019,31-Jul-2019,31-Aug-2019,30-Sep-2019,31-Oct-2019,30-Nov-2019,31-Dec-2019,31-Jan-2020,28-Feb-2020,31-Mar-2020,30-Apr-2020,31-May-2020,30-Jun-2020,31-Jul-2020,31-Aug-2020,30-Sep-2020]
NodeLocation: 272,72,1
NodeSize: 64,40

Constant Stored_PV_Comparison
Title: Stored PV Comparison Results
Definition: Table(Spatial_ID,Act_vs_Sim,Comparison_Time_Plus,All_Sectors,PV_Cumul_Data_Type)(~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null,~
0,0,0,0,0,~
0,0,0,0,0,~
Null,Null,Null,Null,Null)
NodeLocation: 272,176,1
NodeSize: 64,40
WindState: 2,98,82,720,429
DefnState: 2,185,43,1487,796,0,DFNM
ValueState: 2,544,6,1332,840,0,MIDM
ReformVal: [Comparison_Time_Plus,Act_vs_Sim]
Att__TotalsIndex: [Spatial_ID]
Att_ResultSliceState: [Spatial_ID,0,All_Sectors,2,PV_Cumul_Data_Type,2,Act_vs_Sim,1,Comparison_Time_Plus,1]
Att_EditSliceState: [Act_vs_Sim,2,All_Sectors,2,PV_Cumul_Data_Type,2,Comparison_Time_Plus,1,Spatial_ID,1]

Index Comparison_Time
Title: Comparison Time
Definition: [31-Jan-2010,28-Feb-2010,31-Mar-2010,30-Apr-2010,31-May-2010,30-Jun-2010,31-Jul-2010,31-Aug-2010,30-Sep-2010,31-Oct-2010,30-Nov-2010,31-Dec-2010,31-Jan-2011,28-Feb-2011,31-Mar-2011,30-Apr-2011,31-May-2011,30-Jun-2011,31-Jul-2011,31-Aug-2011,30-Sep-2011,31-Oct-2011,30-Nov-2011,31-Dec-2011,31-Jan-2012,28-Feb-2012,31-Mar-2012,30-Apr-2012,31-May-2012,30-Jun-2012,31-Jul-2012,31-Aug-2012,30-Sep-2012,31-Oct-2012,30-Nov-2012,31-Dec-2012,31-Jan-2013,28-Feb-2013,31-Mar-2013,30-Apr-2013,31-May-2013,30-Jun-2013,31-Jul-2013,31-Aug-2013,30-Sep-2013,31-Oct-2013,30-Nov-2013,31-Dec-2013,31-Jan-2014,28-Feb-2014,31-Mar-2014,30-Apr-2014,31-May-2014,30-Jun-2014,31-Jul-2014,31-Aug-2014,30-Sep-2014,31-Oct-2014,30-Nov-2014,31-Dec-2014,31-Jan-2015,28-Feb-2015,31-Mar-2015,30-Apr-2015,31-May-2015,30-Jun-2015,31-Jul-2015,31-Aug-2015,30-Sep-2015,31-Oct-2015,30-Nov-2015,31-Dec-2015,31-Jan-2016,28-Feb-2016,31-Mar-2016,30-Apr-2016,31-May-2016,30-Jun-2016,31-Jul-2016,31-Aug-2016,30-Sep-2016,31-Oct-2016,30-Nov-2016,31-Dec-2016,31-Jan-2017,28-Feb-2017,31-Mar-2017,30-Apr-2017,31-May-2017,30-Jun-2017,31-Jul-2017,31-Aug-2017,30-Sep-2017,31-Oct-2017,30-Nov-2017,31-Dec-2017,31-Jan-2018,28-Feb-2018,31-Mar-2018,30-Apr-2018,31-May-2018,30-Jun-2018,31-Jul-2018,31-Aug-2018,30-Sep-2018,31-Oct-2018,30-Nov-2018,31-Dec-2018,31-Jan-2019,28-Feb-2019,31-Mar-2019,30-Apr-2019,31-May-2019,30-Jun-2019,31-Jul-2019,31-Aug-2019,30-Sep-2019,31-Oct-2019,30-Nov-2019,31-Dec-2019,31-Jan-2020,28-Feb-2020,31-Mar-2020,30-Apr-2020,31-May-2020,30-Jun-2020,31-Jul-2020,31-Aug-2020,30-Sep-2020]
NodeLocation: 408,72,1
NodeSize: 64,40
ValueState: 2,12,156,723,702,0,MIDM

Variable Incremental_Data4
Title: Incremental Data
Description: Although the Cumulative Data Types index suggests these values are cumulative, they are in fact incremental and represent units/period. These will be mapped back to the incremental values in the Adoption Data Types index in downstream nodes.
Definition: IF (Stored_PV_Comparison[Comparison_Time_Plus=Comparison_Time] = Null) OR (Comparison_Time <= SubIndex(Output_Period_Map, PV_Calibration_Start, Output_Periods))~
THEN Null~
ELSE Uncumulate(Stored_PV_Comparison, Comparison_Time_Plus)[Comparison_Time_Plus=Comparison_Time]~

NodeLocation: 424,288,1
NodeSize: 64,40
WindState: 2,44,97,1815,774
ValueState: 2,72,0,1282,692,1,MIDM
ReformVal: [Comparison_Time,Act_vs_Sim]
Att__TotalsIndex: [Spatial_ID,PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,0,Cumulative_Data_Type,1,Act_vs_Sim,1,Output_Periods,1]

Variable Cumulative_Data4
Title: Cumulative Data
Definition: Stored_PV_Comparison[Comparison_Time_Plus=Comparison_Time]
NodeLocation: 424,176,1
NodeSize: 64,40
ValueState: 2,2428,63,726,521,,MIDM
Att_ResultSliceState: [PV_Cumul_Data_Type,1,All_Sectors,1,Act_vs_Sim,2,PV_Comparison_Time,1,Spatial_ID,1]

Variable PV_Adoption_Compare2
Title: PV Adoption Comparison
Definition: IF PV_Map_Increm_Cumul = Null~
THEN Cumulative_Data4[PV_Cumul_Data_Type=PV_Adopt_Data_Types]~
ELSE Incremental_Data4[PV_Cumul_Data_Type=PV_Map_Increm_Cumul]
NodeLocation: 576,240,1
NodeSize: 64,40
ValueState: 2,2238,46,1064,706,1,MIDM
Aliases: Alias Al1543161772
ReformVal: [Comparison_Time,Act_vs_Sim]
NumberFormat: 2,F,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [PV_Spatial_ID,All_Spatial_ID,Spatial_ID]
Att_ResultSliceState: [PV_Adopt_Data_Types,4,All_Sectors,2,Spatial_ID,0,Act_vs_Sim,1,PV_Comparison_Time,1]

Close Stored_PV_Historic_C

Variable Cumulative_Data_Plu5
Title: Cumulative Data Plus
Definition: IF Act_vs_Sim = Actual_Label~
THEN Interp_Hist_EV_Adopt~
ELSE IF Output_Periods_Plus <= VehStk_Year_EOP_Map[Vehicle_Stock_DataYr=Final_EV_Hist_Period]~
   THEN Interp_Sim_EV_Adopt~
   ELSE Null
NodeLocation: 264,584,1
NodeSize: 64,40
ValueState: 2,36,70,1298,815,1,MIDM
ReformVal: [Output_Periods_Plus,Act_vs_Sim]
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [EV_Spatial_ID,2,EV_Sectors,1,Sel_Ag_EV_LRMS,1,EV_Cumul_Data_Type,2,Act_vs_Sim,1,Output_Periods_Plus,1]

Variable Incremental_Data6
Title: Incremental Data
Description: Although the Cumulative Data Types index suggests these values are cumulative, they are in fact incremental and represent units/period. These will be mapped back to the incremental values in the Adoption Data Types index in downstream nodes.
Definition: IF (Cumulative_Data_Plu5[Output_Periods_Plus=Output_Periods] = Null) OR ((Act_vs_Sim = Actual_Label) AND (EV_Spatial_ID <> Aggregation_1_Label))~
THEN Null~
ELSE Uncumulate(Cumulative_Data_Plu5, Output_Periods_Plus)[Output_Periods_Plus=Output_Periods];
NodeLocation: 416,688,1
NodeSize: 64,40
WindState: 2,1840,105,808,428
ValueState: 2,100,-5,1695,790,1,MIDM
ReformVal: [Output_Periods,Act_vs_Sim]
Att__TotalsIndex: [Spatial_ID,PV_Spatial_ID,EV_Spatial_ID]
Att_ResultSliceState: [EV_Spatial_ID,0,EV_Sectors,1,Sel_Ag_EV_LRMS,1,EV_Cumul_Data_Type,1,Act_vs_Sim,1,Output_Periods,1]

Variable Increm_Data_Cumulat5
Title: Increm Data Cumulated
Definition: IF Incremental_Data6 = Null~
THEN Null~
ELSE Cumulative_Data_Plu5[Output_Periods_Plus=Slice(Output_Periods_Plus,1)] + Cumulate(Incremental_Data6, Output_Periods)
NodeLocation: 416,584,1
NodeSize: 64,40
ValueState: 2,240,72,833,569,1,MIDM

Variable Cumulative_QC_Check5
Title: Cumulative QC Check
Definition: [Cumulative_Data6,Increm_Data_Cumulat5]
NodeLocation: 416,448,1
NodeSize: 64,40
ValueState: 2,-62,30,1443,836,1,MIDM
NodeColor: 65535,19661,50247
ReformVal: [Output_Periods,Self]
Att__TotalsIndex: [Spatial_ID,Output_Periods,PV_Spatial_ID,EV_Spatial_ID]
Att_ResultSliceState: [EV_Spatial_ID,0,EV_Sectors,1,Act_vs_Sim,2,Sel_Ag_EV_LRMS,1,EV_Cumul_Data_Type,1,Self,1,Output_Periods,1]

Variable Cumulative_Data6
Title: Cumulative Data
Definition: Cumulative_Data_Plu5[Output_Periods_Plus=Output_Periods]
NodeLocation: 264,480,1
NodeSize: 64,40
ValueState: 2,2036,314,726,521,,MIDM
Att_ResultSliceState: [PV_Sectors,2,Output_Periods,1,PV_Spatial_ID,1]

Variable EV_Adoption_Compare
Title: EV Adoption Comparison
Definition: IF EV_Map_Increm_Cumul = Null~
THEN Cumulative_Data6[EV_Cumul_Data_Type=EV_Adopt_Data_Types]~
ELSE Incremental_Data6[EV_Cumul_Data_Type=EV_Map_Increm_Cumul]
NodeLocation: 576,552,1
NodeSize: 64,40
ValueState: 2,49,-3,1324,709,1,MIDM
ReformVal: [Output_Periods,Act_vs_Sim]
NumberFormat: 2,F,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [EV_Sectors,1,EV_Adopt_Data_Types,3,EV_Spatial_ID,1,Sel_Ag_EV_LRMS,1,Act_vs_Sim,1,Output_Periods,1]

Alias Al1542998770
Title: Interp Simulated EV Adoption
Definition: 1
NodeLocation: 112,584,1
NodeSize: 64,40
Original: Interp_Sim_EV_Adopt

Alias Al1542998771
Title: Interp Historic EV Adoption
Definition: 1
NodeLocation: 112,480,1
NodeSize: 64,40
Original: Interp_Hist_EV_Adopt

Variable PV_Compare_Outputs
Title: PV Comparison Outputs
Definition: PV_Adoption_Compare2[Comparison_Time=Output_Periods, PV_Adopt_Data_Types=Map_Compare_Output[All_DER_Types=PV_DER_Label], PV_Spatial_ID = Spatial_ID, PV_Sectors=All_Sectors]
NodeLocation: 728,184,1
NodeSize: 64,40
ValueState: 2,320,227,1209,667,1,MIDM
ReformVal: [Output_Periods,Act_vs_Sim]
Att__TotalsIndex: [Spatial_ID]
Att_ResultSliceState: [All_Sectors,2,Spatial_ID,0,Comparison_Outputs,4,Act_vs_Sim,1,Output_Periods,1]

Variable EV_Compare_Outputs
Title: EV Comparison Outputs
Definition: EV_Adoption_Compare[EV_Adopt_Data_Types=Map_Compare_Output[All_DER_Types=EV_DER_Label], EV_Spatial_ID=Spatial_ID, EV_Sectors=All_Sectors]
NodeLocation: 728,552,1
NodeSize: 64,40
WindState: 2,1751,13,1463,748
ValueState: 2,61,-11,1161,734,1,MIDM
ReformVal: [Output_Periods,Act_vs_Sim]
Att__TotalsIndex: [Spatial_ID]
Att_ResultSliceState: [All_Sectors,3,Comparison_Outputs,2,Spatial_ID,0,Act_vs_Sim,1,Output_Periods,1]

Index Comparison_Outputs
Att_PrevIndexValue: ['Incremental Count (Calibration)','Cumulative Count (Calibration)','Incremental MW-AC (Calibration)','Cumulative MW-AC (Calibration)']
Title: Comparison Outputs
Definition: ['Incremental Count (Calibration)','Cumulative Count (Calibration)','Incremental MW-AC (Calibration)','Cumulative MW-AC (Calibration)']
IndexVals: ['item 1']
NodeLocation: 912,88,1
NodeSize: 64,40
WindState: 2,2104,168,720,350
Aliases: FormNode Fo1543018416
{!40300|Att_SlicerPopupSize: 247,84}

Decision Map_Compare_Output
Title: Map Comparison Outputs
Description: Maps DER-specific outputs to the output names associated with sequential (eg, historic then simulated) outputs.
Definition: Table(All_DER_Types,Comparison_Outputs)(~
Choice(PV_Adopt_Types_None,2,0),Choice(PV_Adopt_Types_None,5,0),Choice(PV_Adopt_Types_None,3,0),Choice(PV_Adopt_Types_None,6,0),~
Choice(EV_Adopt_Types_None,2,0),Choice(EV_Adopt_Types_None,4,0),Choice(EV_Adopt_Types_None,3,0),Choice(EV_Adopt_Types_None,5,0),~
Null,Null,Null,Null,~
Null,Null,Null,Null,~
Choice(BESS_AdoptTypes_None,2,0),Choice(BESS_AdoptTypes_None,5,0),Choice(BESS_AdoptTypes_None,3,0),Choice(BESS_AdoptTypes_None,6,0))
NodeLocation: 728,336,1
NodeSize: 64,40
DefnState: 2,12,134,1366,610,0,DFNM
Aliases: FormNode Fo1543018414
ReformDef: [All_DER_Types,Comparison_Outputs]
TableCellDefault: Default_Compare_Map

Decision Default_Compare_Map
Title: Default Comparison Map
Definition: Table(All_DER_Types)(Choice(PV_Adopt_Types_None,1,0),Choice(EV_Adopt_Types_None,1,0),Null,Null,Null)
NodeLocation: 1056,88,1
NodeSize: 64,40
DefnState: 2,1560,181,416,303,,DFNM
Aliases: FormNode Fo1543018417

FormNode Fo1543018414
Title: Map Sequential Outputs
Definition: 0
NodeLocation: 728,388,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Map_Compare_Output

Objective Compare_Data_Handles
Title: Comparison Data Handles
Definition: Table(All_DER_Types)(Handle(PV_Compare_Outputs),Handle(EV_Compare_Outputs),Handle(Null),Handle(Null),Handle(BESS_Comparison_Outp))
NodeLocation: 880,336,1
NodeSize: 64,40
NodeInfo: 1,1,1,1,1,1,0,,0,,0,,,
WindState: 2,1702,32,1441,756
DefnState: 2,693,422,935,303,0,DFNM
ValueState: 2,268,6,1024,661,,MIDM
NodeColor: 19661,48336,65535
TableCellDefault: Handle(Null)

Variable Sel_Compare_Data
Title: Selected Comparison Data
Definition: FOR J:=Output_DER_Types DO (~
   VAR data:=Compare_Data_Handles[All_DER_Types=J];~
   IF Include_Output_Type[All_DER_Types=J]~
   THEN data~
   ELSE Null~
)~
~

NodeLocation: 1032,336,1
NodeSize: 64,40
ValueState: 2,459,51,1020,771,1,MIDM
Aliases: Alias Al1543025108
ReformVal: [Output_Periods,Act_vs_Sim]
Att__TotalsIndex: [Spatial_ID]
Att_ResultSliceState: [All_Sectors,3,Spatial_ID,0,Output_DER_Types,2,Comparison_Outputs,2,Act_vs_Sim,1,Output_Periods,1]

Variable Flat_Comparison_Data
Title: Flat Comparison Data
Definition: MdArrayToTable(Sel_Compare_Data, valueIndex: Comparison_Outputs, omitZero: False, omitNull: True)
NodeLocation: 1184,336,1
NodeSize: 64,40
ValueState: 2,1612,25,1474,742,,MIDM

Index Comparison_Columns
Att_PrevIndexValue: [Spatial_ID,Act_vs_Sim,Output_DER_Types,Output_Periods,All_Sectors,'Incremental Count (Calibration)','Cumulative Count (Calibration)','Incremental MW-AC (Calibration)','Cumulative MW-AC (Calibration)']
Title: Comparison Columns
Definition: CopyIndex(Flat_Comparison_Data.Col)
NodeLocation: 1200,176,1
NodeSize: 64,40
ValueState: 2,11,87,416,303,,MIDM

Index Comparison_Order_Num
Att_PrevIndexValue: [1,2,3,4,5,6,7,8,9]
Title: Comparison Order Number
Definition: 1..Size(Comparison_Columns)
NodeLocation: 1200,88,1
NodeSize: 64,40

Decision Order_Compare_Cols
Title: Order of Comparison Columns
Description: Specify the order in which columns will appear in the output results for sequential (historic then simulated) results.
Definition: Table(Comparison_Columns)(Choice(Comparison_Order_Num,1,0),Choice(Comparison_Order_Num,4,0),Choice(Comparison_Order_Num,2,0),Choice(Comparison_Order_Num,5,0),Choice(Comparison_Order_Num,3,0),Choice(Comparison_Order_Num,6,0),Choice(Comparison_Order_Num,7,0),Choice(Comparison_Order_Num,8,0),Choice(Comparison_Order_Num,9,0))
NodeLocation: 1256,432,1
NodeSize: 64,40
DefnState: 2,9,177,501,447,0,DFNM
Aliases: FormNode Fo1543018415
TableCellDefault: Choice(Comparison_Order_Num,1,0)

FormNode Fo1543018415
Title: Order of Sequential Columns
Definition: 0
NodeLocation: 1256,484,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Order_Compare_Cols

Variable Format_Compare_Data
Title: Formatted Comparison Data
Definition: INDEX orderedCols:=CopyIndex(SubIndex(Order_Compare_Cols, @Comparison_Columns, Comparison_Columns));~
Flat_Comparison_Data[.Row=Comparison_Row_Num, .Col=orderedCols, @orderedCols=@Comparison_Text_Cols]
NodeLocation: 1328,336,1
NodeSize: 64,40
ValueState: 2,76,7,1617,890,0,MIDM
ReformVal: [Comparison_Text_Cols,Comparison_Row_Num]

Index Comparison_Text_Cols
Title: Comparison Text Columns
Definition: INDEX orderedCols:=CopyIndex(SubIndex(Order_Compare_Cols, @Comparison_Columns, Comparison_Columns));~
VAR textParse:=FOR J:=@orderedCols DO (~
   IF IsHandle(Slice(orderedCols, J))~
   THEN Title of Slice(orderedCols, J)~
   ELSE Slice(orderedCols, J)~
);~
CopyIndex(textParse)
NodeLocation: 1336,88,1
NodeSize: 64,40
ValueState: 2,2242,172,1180,511,,MIDM
ReformVal: [Self,Undefined]

Index Comparison_Row_Num
Title: Comparison Row Number
Definition: CopyIndex(Flat_Comparison_Data.Row)
NodeLocation: 1336,176,1
NodeSize: 64,40

FormNode Fo1543018416
Title: Sequential Outputs
Definition: 0
NodeLocation: 912,140,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Comparison_Outputs

FormNode Fo1543018417
Title: Default Sequential Map
Definition: 0
NodeLocation: 1056,140,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Default_Compare_Map

Alias Al1543018959
Title: EV Map Incremental to Cumulative
Definition: 1
NodeLocation: 576,648,1
NodeSize: 64,40
Original: EV_Map_Increm_Cumul

FormNode Fo1543018972
Title: Map Incremental to Cumulative
Definition: 0
NodeLocation: 576,700,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: EV_Map_Increm_Cumul

Alias Al1543161772
Title: PV Adoption Comparison
Definition: 1
NodeLocation: 728,88,1
NodeSize: 64,40
Original: PV_Adoption_Compare2

Decision Include_Output_Type
Title: Include Output Type
Units: boolean
Description: Select which output types to include in the export. Generally, we only want to show the outputs used for the actual calibration (eg, residential PV system counts, commercial MW of PV, and EV vehicle counts).
Definition: Table(All_Sectors,Comparison_Outputs,All_DER_Types)(~
Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),~
Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),~
Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),~
Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),~
Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),~
Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),~
Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),~
Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),~
Checkbox(0),Checkbox(1),Checkbox(0),Checkbox(0),Checkbox(0),~
Checkbox(0),Checkbox(1),Checkbox(0),Checkbox(0),Checkbox(0),~
Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),~
Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0))
NodeLocation: 1032,432,1
NodeSize: 64,40
WindState: 2,98,82,1030,418
DefnState: 2,310,412,1035,268,0,DFNM
Aliases: FormNode Fo1574705357
NodeColor: 65535,65531,1
ReformDef: [All_Sectors,Comparison_Outputs]
TableCellDefault: Checkbox(0)
Att_EditSliceState: [All_DER_Types,1,Comparison_Outputs,1,All_Sectors,1]

FormNode Fo1574705357
Title: Include Output Type
Definition: 0
NodeLocation: 1032,484,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Include_Output_Type

Variable Cumulative_Data_Plu3
Title: Cumulative Data Plus
Definition: VAR historic:=IF (Output_Periods_Plus > BESS_TimeOpt_EOP_Map[BESS_Sim_Strt_Yr_Opt=BESS_CalStart_Minus1]) AND (Output_Periods_Plus <= BESS_TimeOpt_EOP_Map[BESS_Sim_Strt_Yr_Opt=BESS_Calibration_End])~
   THEN IgnoreWarnings(Historical_BESS_Adop[AESS_Time=Output_Prd_Plus_Map, BESS_Adopt_DataTypes=BESS_Cumul_DataTypes, All_Spatial_ID=BESS_Spatial_ID, All_Sectors=BESS_Sectors])~
   ELSE Null;~
VAR actual:=IF (Output_Periods_Plus > BESS_TimeOpt_EOP_Map[BESS_Sim_Strt_Yr_Opt=BESS_CalStart_Minus1]) AND (Output_Periods_Plus <= BESS_TimeOpt_EOP_Map[BESS_Sim_Strt_Yr_Opt=BESS_Calibration_End])~
   THEN Interp_SimBESS_Adopt[BESS_Adopt_DataTypes=BESS_Cumul_DataTypes]~
   ELSE Null;~
~
IF Act_vs_Sim = Actual_Label~
THEN historic~
ELSE actual;
NodeLocation: 264,960,1
NodeSize: 64,40
ValueState: 2,161,102,1281,815,1,MIDM
GraphSetup: Att_GraphValueRange Cumulative_Data_Plu3:1,,1,,,,,4.511707741767168,123.30097407102585,0~
Att_GraphIndexRange Output_Periods_Plus:1,,1,,,,,42038.71919479966,42650.509313464165,0
ReformVal: [Output_Periods_Plus,Act_vs_Sim]
Att__TotalsIndex: [PV_Spatial_ID,BESS_Spatial_ID,BESS_Sectors]
Att_ResultSliceState: [BESS_Sectors,0,BESS_Spatial_ID,0,BESS_Cumul_DataTypes,2,Act_vs_Sim,1,Output_Periods_Plus,1]

Variable Incremental_Data3
Title: Incremental Data
Description: Although the Cumulative Data Types index suggests these values are cumulative, they are in fact incremental and represent units/period. These will be mapped back to the incremental values in the Adoption Data Types index in downstream nodes.
Definition: IF (Cumulative_Data_Plu3[Output_Periods_Plus=Output_Periods] = Null) OR (@Output_Periods <= PositionInIndex(Output_Periods, BESS_TimeOpt_EOP_Map[BESS_Sim_Strt_Yr_Opt=BESS_CalStart_Minus1], Output_Periods) + 1)~
THEN Null~
ELSE Uncumulate(Replace_X_with_Y(Cumulative_Data_Plu3, Null, 0), Output_Periods_Plus)[Output_Periods_Plus=Output_Periods]~

NodeLocation: 416,1064,1
NodeSize: 64,40
WindState: 2,1840,105,808,428
ValueState: 2,30,53,1282,692,1,MIDM
ReformVal: [Output_Periods,Act_vs_Sim]
Att__TotalsIndex: [Spatial_ID,PV_Spatial_ID,BESS_Spatial_ID,BESS_Sectors]
Att_ResultSliceState: [BESS_Sectors,0,BESS_Spatial_ID,0,BESS_Cumul_DataTypes,2,Act_vs_Sim,1,Output_Periods,1]

Variable Increm_Data_Cumulat3
Title: Increm Data Cumulated
Definition: IF Incremental_Data3 = Null~
THEN Null~
ELSE Replace_X_with_Y(Cumulative_Data_Plu3[Output_Periods_Plus=Slice(Output_Periods_Plus,1)], Null, 0) + Cumulate(Incremental_Data3, Output_Periods)
NodeLocation: 416,960,1
NodeSize: 64,40
ValueState: 2,240,72,833,569,1,MIDM
ReformVal: [Output_Periods,Act_vs_Sim]
Att__TotalsIndex: [BESS_Spatial_ID,BESS_Sectors]
Att_ResultSliceState: [Act_vs_Sim,1,BESS_Sectors,0,BESS_Cumul_DataTypes,2,BESS_Spatial_ID,0,Output_Periods,1]

Variable Cumulative_QC_Check3
Title: Cumulative QC Check
Definition: [Cumulative_Data3,Increm_Data_Cumulat3]
NodeLocation: 416,824,1
NodeSize: 64,40
ValueState: 2,94,18,1443,836,1,MIDM
NodeColor: 65535,19661,50247
ReformVal: [Output_Periods,Self]
Att__TotalsIndex: [Spatial_ID,Output_Periods,PV_Spatial_ID,BESS_Sectors,BESS_Spatial_ID]
Att_ResultSliceState: [Act_vs_Sim,2,BESS_Sectors,0,BESS_Spatial_ID,0,BESS_Cumul_DataTypes,2,Self,1,Output_Periods,1]

Variable Cumulative_Data3
Title: Cumulative Data
Definition: Cumulative_Data_Plu3[Output_Periods_Plus=Output_Periods]
NodeLocation: 264,856,1
NodeSize: 64,40
ValueState: 2,2036,314,726,521,,MIDM
Att_ResultSliceState: [PV_Sectors,2,Output_Periods,1,PV_Spatial_ID,1]

Variable BESS_Adoption_Compar
Title: BESS Adoption Comparison
Definition: IF BESS_Map_IncremCumul = Null~
THEN Cumulative_Data3[BESS_Cumul_DataTypes=BESS_Adopt_DataTypes]~
ELSE Incremental_Data3[BESS_Cumul_DataTypes=BESS_Map_IncremCumul]
NodeLocation: 576,928,1
NodeSize: 64,40
ValueState: 2,255,155,1324,709,1,MIDM
ReformVal: [Output_Periods,Act_vs_Sim]
NumberFormat: 2,F,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [BESS_Spatial_ID,BESS_Sectors]
Att_ResultSliceState: [BESS_Sectors,0,BESS_Spatial_ID,0,BESS_Adopt_DataTypes,2,Act_vs_Sim,1,Output_Periods,1]

Module Stored_BESS_Historic
Title: Stored BESS Historic Comparisons
Author: JamesMilford
Date: Wed, Nov 21, 2018 11:59 AM
NodeLocation: 576,1032,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,162,103,1656,365,17

Button Save_BESSHistCompare
Title: Save BESS Historic Comparison
Description: This button saves results that compare the historic BESS adoption to calibrated, simulated adoption. The BESS simulation time must overlap with some portion of the historic data years.
NodeLocation: 112,72,1
NodeSize: 64,40
WindState: 2,-25,274,1535,520
OnClick: Set_PV_Time_to_Fcst;   {We need to simulate PV adoption first, so set PV time to the forecast period}~
Set_BESS_Time_Calib;   {Set the BESS time to the calibration period}~
Stored_BESS_Compare:=Cumulative_Data_Plu3[Output_Periods_Plus=Comparison_Time_Plus, BESS_Sectors=All_Sectors, BESS_Spatial_ID=Spatial_ID];   {Save the BESS calibration comparison}~


Index BESS_Comp_TimePlus
Title: BESS Comparison Time Plus
Definition: [31-Jan-2012,28-Feb-2012,31-Mar-2012,30-Apr-2012,31-May-2012,30-Jun-2012,31-Jul-2012,31-Aug-2012,30-Sep-2012,31-Oct-2012,30-Nov-2012,31-Dec-2012,31-Jan-2013,28-Feb-2013,31-Mar-2013,30-Apr-2013,31-May-2013,30-Jun-2013,31-Jul-2013,31-Aug-2013,30-Sep-2013,31-Oct-2013,30-Nov-2013,31-Dec-2013,31-Jan-2014,28-Feb-2014,31-Mar-2014,30-Apr-2014,31-May-2014,30-Jun-2014,31-Jul-2014,31-Aug-2014,30-Sep-2014,31-Oct-2014,30-Nov-2014,31-Dec-2014,31-Jan-2015,28-Feb-2015,31-Mar-2015,30-Apr-2015,31-May-2015,30-Jun-2015,31-Jul-2015,31-Aug-2015,30-Sep-2015,31-Oct-2015,30-Nov-2015,31-Dec-2015,31-Jan-2016,28-Feb-2016,31-Mar-2016,30-Apr-2016,31-May-2016,30-Jun-2016,31-Jul-2016,31-Aug-2016,30-Sep-2016,31-Oct-2016,30-Nov-2016,31-Dec-2016,31-Jan-2017,28-Feb-2017,31-Mar-2017,30-Apr-2017,31-May-2017,30-Jun-2017,31-Jul-2017,31-Aug-2017,30-Sep-2017,31-Oct-2017,30-Nov-2017,31-Dec-2017,31-Jan-2018,28-Feb-2018,31-Mar-2018,30-Apr-2018,31-May-2018,30-Jun-2018,31-Jul-2018,31-Aug-2018,30-Sep-2018,31-Oct-2018,30-Nov-2018,31-Dec-2018,31-Jan-2019,28-Feb-2019,31-Mar-2019,30-Apr-2019,31-May-2019,30-Jun-2019,31-Jul-2019,31-Aug-2019]
NodeLocation: 272,64,1
NodeSize: 64,40

Constant Stored_BESS_Compare
Title: Stored BESS Comparison Results
Definition: Table(Spatial_ID,Act_vs_Sim,Comparison_Time_Plus,All_Sectors,BESS_Cumul_DataTypes)(~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null,~
0,0,0,~
0,0,0,~
Null,Null,Null)
NodeLocation: 272,168,1
NodeSize: 64,40
ValueState: 2,3,-3,1332,840,0,MIDM
ReformVal: [Comparison_Time_Plus,Act_vs_Sim]
Att__TotalsIndex: [Spatial_ID,All_Sectors]
Att_ResultSliceState: [Spatial_ID,0,All_Sectors,0,BESS_Cumul_DataTypes,2,Act_vs_Sim,1,Comparison_Time_Plus,1]

Index PV_Comparison_Time1
Title: BESS Comparison Time
Definition: [28-Feb-2012,31-Mar-2012,30-Apr-2012,31-May-2012,30-Jun-2012,31-Jul-2012,31-Aug-2012,30-Sep-2012,31-Oct-2012,30-Nov-2012,31-Dec-2012,31-Jan-2013,28-Feb-2013,31-Mar-2013,30-Apr-2013,31-May-2013,30-Jun-2013,31-Jul-2013,31-Aug-2013,30-Sep-2013,31-Oct-2013,30-Nov-2013,31-Dec-2013,31-Jan-2014,28-Feb-2014,31-Mar-2014,30-Apr-2014,31-May-2014,30-Jun-2014,31-Jul-2014,31-Aug-2014,30-Sep-2014,31-Oct-2014,30-Nov-2014,31-Dec-2014,31-Jan-2015,28-Feb-2015,31-Mar-2015,30-Apr-2015,31-May-2015,30-Jun-2015,31-Jul-2015,31-Aug-2015,30-Sep-2015,31-Oct-2015,30-Nov-2015,31-Dec-2015,31-Jan-2016,28-Feb-2016,31-Mar-2016,30-Apr-2016,31-May-2016,30-Jun-2016,31-Jul-2016,31-Aug-2016,30-Sep-2016,31-Oct-2016,30-Nov-2016,31-Dec-2016,31-Jan-2017,28-Feb-2017,31-Mar-2017,30-Apr-2017,31-May-2017,30-Jun-2017,31-Jul-2017,31-Aug-2017,30-Sep-2017,31-Oct-2017,30-Nov-2017,31-Dec-2017,31-Jan-2018,28-Feb-2018,31-Mar-2018,30-Apr-2018,31-May-2018,30-Jun-2018,31-Jul-2018,31-Aug-2018,30-Sep-2018,31-Oct-2018,30-Nov-2018,31-Dec-2018,31-Jan-2019,28-Feb-2019,31-Mar-2019,30-Apr-2019,31-May-2019,30-Jun-2019,31-Jul-2019,31-Aug-2019]
NodeLocation: 408,64,1
NodeSize: 64,40
ValueState: 2,2021,156,273,702,,MIDM

Variable Incremental_Data7
Title: Incremental Data
Description: Although the Cumulative Data Types index suggests these values are cumulative, they are in fact incremental and represent units/period. These will be mapped back to the incremental values in the Adoption Data Types index in downstream nodes.
Definition: IF (Stored_BESS_Compare[Comparison_Time_Plus=Comparison_Time] = Null) OR (@Comparison_Time <= PositionInIndex(Comparison_Time, BESS_TimeOpt_EOP_Map[BESS_Sim_Strt_Yr_Opt=BESS_CalStart_Minus1], Comparison_Time) + 1)~
THEN Null~
ELSE Uncumulate(Replace_X_with_Y(Stored_BESS_Compare, Null, 0), Comparison_Time_Plus)[Comparison_Time_Plus=Comparison_Time]~

NodeLocation: 424,280,1
NodeSize: 64,40
WindState: 2,1840,105,808,428
ValueState: 2,337,151,1282,692,1,MIDM
ReformVal: [Comparison_Time,Act_vs_Sim]
Att__TotalsIndex: [Spatial_ID,PV_Spatial_ID,All_Sectors]
Att_ResultSliceState: [Spatial_ID,0,All_Sectors,0,BESS_Cumul_DataTypes,2,Act_vs_Sim,1,Comparison_Time,1]

Variable Cumulative_Data7
Title: Cumulative Data
Definition: Stored_BESS_Compare[Comparison_Time_Plus=Comparison_Time]
NodeLocation: 424,168,1
NodeSize: 64,40
ValueState: 2,2428,63,726,521,,MIDM
Att_ResultSliceState: [PV_Cumul_Data_Type,1,All_Sectors,1,Act_vs_Sim,2,PV_Comparison_Time,1,Spatial_ID,1]

Variable BESS_Adoption_Compa1
Title: BESS Adoption Comparison
Definition: IF BESS_Map_IncremCumul = Null~
THEN Cumulative_Data7[BESS_Cumul_DataTypes=BESS_Adopt_DataTypes]~
ELSE Incremental_Data7[BESS_Cumul_DataTypes=BESS_Map_IncremCumul]
NodeLocation: 576,232,1
NodeSize: 64,40
ValueState: 2,2238,46,1064,706,1,MIDM
Aliases: Alias Al1579124568
ReformVal: [Comparison_Time,Act_vs_Sim]
NumberFormat: 2,F,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [PV_Spatial_ID,All_Spatial_ID,Spatial_ID,All_Sectors]
Att_ResultSliceState: [Spatial_ID,0,All_Sectors,0,BESS_Adopt_DataTypes,1,Act_vs_Sim,1,Comparison_Time,1]

Close Stored_BESS_Historic

Variable BESS_Comparison_Outp
Title: BESS Comparison Outputs
Definition: BESS_Adoption_Compa1[Comparison_Time=Output_Periods, BESS_Adopt_DataTypes=Map_Compare_Output[All_DER_Types=BESS_DER_Label], BESS_Spatial_ID = Spatial_ID, BESS_Sectors=All_Sectors]
NodeLocation: 728,928,1
NodeSize: 64,40
ValueState: 2,320,227,1209,667,1,MIDM
ReformVal: [Output_Periods,Act_vs_Sim]
Att__TotalsIndex: [Spatial_ID,All_Sectors]
Att_ResultSliceState: [All_Sectors,0,Spatial_ID,0,Comparison_Outputs,3,Act_vs_Sim,1,Output_Periods,1]

Alias Al1579124568
Title: PV Adoption Comparison
Definition: 1
NodeLocation: 728,832,1
NodeSize: 64,40
Original: BESS_Adoption_Compa1

Alias Al1579125369
Title: Historical BESS Adoption
Definition: 1
NodeLocation: 112,856,1
NodeSize: 64,40
Original: Historical_BESS_Adop

Alias Al1579125380
Title: Interp Sim BESS Adoption
Definition: 1
NodeLocation: 112,960,1
NodeSize: 64,40
Original: Interp_SimBESS_Adopt

Alias Al1579128988
Title: BESS Map Incremental to Cumulative
Definition: 1
NodeLocation: 576,832,1
NodeSize: 64,40
Original: BESS_Map_IncremCumul

FormNode Fo1579128988
Title: Map Incremental to Cumulative
Definition: 0
NodeLocation: 576,780,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: BESS_Map_IncremCumul

Close Compare_Actual_vs_Si

Module Deltas_from_Base_Per
Title: Deltas from Base Period
Author: coryw
Date: Fri, Nov 23, 2018 10:59 AM
NodeLocation: 736,984,1
NodeSize: 64,40
DiagState: 2,232,4,1477,675,17,10

Constant Base_Period_Deltas
Title: Base Period for Deltas
Definition: 1-Jan-2022
NodeLocation: 216,168,1
NodeSize: 64,40
WindState: 2,253,9,1093,710
Aliases: FormNode New1543539727, FormNode Fo1543023735, Alias Al1550771575, FormNode Fo1550771576

Variable PV_Delta_Data
Title: PV Delta Data
Definition: VAR cumulData:=PV_Adoption_Fcst_NR[PV_Adopt_Data_Types=PV_Cumul_Data_Type, Time_Solar_PV=Output_Prd_Plus_Map];~
VAR deltas:=cumulData[Output_Periods_Plus=Delta_Output_Periods] - cumulData[Output_Periods_Plus=Base_Period_Deltas];~
IF Act_vs_Sim=Simulated_Label THEN deltas[New_or_Retrofit=Installation_Type] ELSE Null
NodeLocation: 216,288,1
NodeSize: 64,40
WindState: 2,102,82,1389,428
ValueState: 2,2342,393,1155,392,0,MIDM
GraphSetup: Att_GraphValueRange PV_Delta_Data:1,,1,,,,,0,11.283043026924133,0~
Att_GraphIndexRange Delta_Output_Periods:1,,1,,,,10,43100,43392.91278048605,0~
Flip:0~
Att_AreaFill Graph_Primary_Valdim:0~
Att_Stacked_Lines Graph_Primary_Valdim:0
ReformVal: [Delta_Output_Periods,PV_Spatial_ID]
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,1,PV_Cumul_Data_Type,4,Installation_Type,2,Act_vs_Sim,2,Area_Type,1,PV_Spatial_ID,0,Delta_Output_Periods,1]
{!40700|Att_CellFormat: CellSpan(Delta_Output_Periods,CellSpan(PV_Spatial_ID,CellNumberFormat('Fixed Point',3,0,0,dateFormat:'ABBREV',fullPrecision:0,numbersAsDates:0,datesAsNumbers:0,digits_:2,zeroes_:3),5,header:0),1,header:0)}

Index Delta_Output_Periods
Title: Delta Output Periods
Definition: Subset(Output_Periods > Base_Period_Deltas)
NodeLocation: 464,168,1
NodeSize: 64,40
ValueState: 2,556,108,1014,775,0,MIDM
Att_GraphIndexRange: 1,,,,,,10
{!40300|Att_SlicerPopupSize: 232,785}

Variable EV_Delta_Data
Title: EV Delta Data
Definition: VAR deltas:=Sum(EV_Adoption_Data[Output_Periods=Delta_Output_Periods, EV_Adopt_Data_Types=EV_Cumul_Data_Type], Act_vs_Sim) - Cumulative_Data_Plu4[Output_Periods_Plus=Base_Period_Deltas];~
IF (Act_vs_Sim=Simulated_Label) AND (Installation_Type=NA_Label)~
THEN deltas ~
ELSE Null
NodeLocation: 216,528,1
NodeSize: 64,40
WindState: 2,102,82,1389,428
ValueState: 2,227,28,1155,786,1,MIDM
ReformVal: [Delta_Output_Periods,PV_Spatial_ID]
Att_ResultSliceState: [EV_Sectors,1,Act_vs_Sim,2,Installation_Type,3,EV_Cumul_Data_Type,1,EV_Spatial_ID,1,Delta_Output_Periods,1]

Variable PV_Delta_Outputs
Title: PV Delta Outputs
Definition: PV_Delta_Data[PV_Cumul_Data_Type=Map_Delta_Outputs[All_DER_Types=PV_DER_Label], PV_Spatial_ID = Spatial_ID, PV_Sectors=All_Sectors]
NodeLocation: 424,288,1
NodeSize: 64,40
ValueState: 2,24,48,1209,771,1,MIDM
GraphSetup: Att_AreaFill Graph_Primary_Valdim:1~
Att_Stacked_Lines Graph_Primary_Valdim:1~
Att_ContLineStyle Graph_Primary_Valdim:1
ReformVal: [Delta_Output_Periods,Delta_Outputs]
Att__TotalsIndex: [Spatial_ID]
Att_ResultSliceState: [All_Sectors,1,Act_vs_Sim,2,Spatial_ID,0,Installation_Type,1,Delta_Outputs,2,Delta_Output_Periods,10]

Variable EV_Delta_Outputs
Title: EV Delta Outputs
Definition: EV_Delta_Data[EV_Cumul_Data_Type=Map_Delta_Outputs[All_DER_Types=EV_DER_Label], EV_Spatial_ID=Spatial_ID, EV_Sectors=All_Sectors]
NodeLocation: 424,528,1
NodeSize: 64,40
WindState: 2,1751,13,1463,748
ValueState: 2,630,113,1161,734,1,MIDM
ReformVal: [Output_Periods,Act_vs_Sim]
Att__TotalsIndex: [Spatial_ID]
Att_ResultSliceState: [All_Sectors,3,Delta_Outputs,4,Spatial_ID,0,Act_vs_Sim,1,Output_Periods,1]

Index Delta_Outputs
Att_PrevIndexValue: ['Cumulative MW-AC (Delta)']
Title: Delta Outputs
Definition: ['Cumulative MW-AC (Delta)']
IndexVals: ['item 1']
NodeLocation: 608,168,1
NodeSize: 64,40
WindState: 2,286,501,720,350
Aliases: FormNode New1543539730
{!40300|Att_SlicerPopupSize: 247,56}

Decision Map_Delta_Outputs
Title: Map Delta Outputs
Description: Maps DER-specific outputs to the output names associated with sequential (eg, historic then simulated) outputs.
Definition: Table(All_DER_Types,Delta_Outputs)(~
Choice(PV_CumulDataTyp_None,3,0),~
Choice(EV_CumulDataTyp_None,3,0),~
Null,~
Null,~
Choice(BESSCumulDataTypNone,3,0))
NodeLocation: 424,392,1
NodeSize: 64,40
WindState: 2,35,96,1360,572
DefnState: 2,351,236,1331,387,0,DFNM
ValueState: 2,148,154,1403,445,,MIDM
Aliases: FormNode New1543539728
TableCellDefault: Default_Delta_Map

Decision Default_Delta_Map
Title: Default Delta Map
Definition: Table(All_DER_Types)(Choice(PV_CumulDataTyp_None,1,0),Choice(EV_CumulDataTyp_None,1,0),Null,Null,Null)
NodeLocation: 752,168,1
NodeSize: 64,40
WindState: 2,15,197,720,350
DefnState: 2,1138,196,416,303,0,DFNM
Aliases: FormNode New1543539731

Objective Delta_Data_Handles
Title: Delta Data Handles
Definition: Table(All_DER_Types)(Handle(PV_Delta_Outputs),Handle(EV_Delta_Outputs),Handle(Null),Handle(Null),Handle(BESS_Delta_Outputs))
NodeLocation: 576,392,1
NodeSize: 64,40
NodeInfo: 1,1,1,1,1,1,0,,0,,0,,,
WindState: 2,1702,32,1441,756
DefnState: 2,2214,222,935,303,0,DFNM
ValueState: 2,268,6,1024,661,,MIDM
NodeColor: 19661,48336,65535
TableCellDefault: Handle(Null)

Variable Selected_Delta_Data
Title: Selected Delta Data
Definition: FOR J:=Output_DER_Types DO (~
   VAR data:=Delta_Data_Handles[All_DER_Types=J];~
   data~
);~

NodeLocation: 728,392,1
NodeSize: 64,40
ValueState: 2,167,100,1320,753,0,MIDM
Aliases: Alias Al1543025086
ReformVal: [Delta_Output_Periods,All_Sectors]
Att__TotalsIndex: [Spatial_ID,All_Sectors,Installation_Type]
Att_ResultSliceState: [Output_DER_Types,2,Act_vs_Sim,2,Delta_Outputs,1,Installation_Type,0,Spatial_ID,0,All_Sectors,0,Delta_Output_Periods,1]

Variable Flat_Delta_Data
Title: Flat Delta Data
Definition: MdArrayToTable(Selected_Delta_Data, valueIndex: Delta_Outputs, omitZero: False, omitNull: True)
NodeLocation: 880,392,1
NodeSize: 64,40
ValueState: 2,2085,28,1474,742,,MIDM

Index Delta_Columns
Att_PrevIndexValue: [Spatial_ID,Act_vs_Sim,Delta_Output_Periods,Output_DER_Types,All_Sectors,Installation_Type,'Cumulative MW-AC (Delta)']
Title: Delta Columns
Definition: CopyIndex(Flat_Delta_Data.Col)
NodeLocation: 896,256,1
NodeSize: 64,40
ValueState: 2,11,87,416,303,,MIDM

Index Delta_Order_Number
Att_PrevIndexValue: [1,2,3,4,5,6,7]
Title: Delta Order Number
Definition: 1..Size(Delta_Columns)
NodeLocation: 896,168,1
NodeSize: 64,40

Decision Order_of_Delta_Colum
Title: Order of Delta Columns
Description: Specify the order in which columns will appear in the output results for sequential (historic then simulated) results.
Definition: Table(Delta_Columns)(Choice(Delta_Order_Number,1,0),Choice(Delta_Order_Number,2,0),Choice(Delta_Order_Number,3,0),Choice(Delta_Order_Number,4,0),Choice(Delta_Order_Number,5,0),Choice(Delta_Order_Number,6,0),Choice(Delta_Order_Number,7,0))
NodeLocation: 952,488,1
NodeSize: 64,40
DefnState: 2,581,20,606,410,0,DFNM
ValueState: 2,2043,151,416,303,,MIDM
Aliases: FormNode New1543539729
TableCellDefault: Choice(Delta_Order_Number,1,0)

Variable Format_Delta_Data
Title: Formatted Delta Data
Definition: INDEX orderedCols:=CopyIndex(SubIndex(Order_of_Delta_Colum, @Delta_Columns, Delta_Columns));~
Flat_Delta_Data[.Row=Delta_Row_Num, .Col=orderedCols, @orderedCols=@Delta_Text_Cols]
NodeLocation: 1024,392,1
NodeSize: 64,40
ValueState: 2,77,11,1367,845,0,MIDM
ReformVal: [Delta_Text_Cols,Delta_Row_Num]

Index Delta_Text_Cols
Title: Delta Text Columns
Definition: INDEX orderedCols:=CopyIndex(SubIndex(Order_of_Delta_Colum, @Delta_Columns, Delta_Columns));~
VAR textParse:=FOR J:=@orderedCols DO (~
   IF IsHandle(Slice(orderedCols, J))~
   THEN Title of Slice(orderedCols, J)~
   ELSE Slice(orderedCols, J)~
);~
CopyIndex(textParse)
NodeLocation: 1032,168,1
NodeSize: 64,40
ValueState: 2,65,165,1671,511,,MIDM
ReformVal: [Self,Null]

Index Delta_Row_Num
Title: Delta Row Number
Definition: CopyIndex(Flat_Delta_Data.Row)
NodeLocation: 1032,256,1
NodeSize: 64,40

FormNode New1543539727
Title: Base Period for Deltas
Definition: 0
NodeLocation: 200,116,1
NodeSize: 104,12
NodeInfo: 1,,,0,,,,158,,,0,,,0
Original: Base_Period_Deltas

FormNode New1543539728
Title: Map Sequential Outputs
Definition: 0
NodeLocation: 424,444,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Map_Delta_Outputs

FormNode New1543539729
Title: Order of Sequential Columns
Definition: 0
NodeLocation: 952,540,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Order_of_Delta_Colum

FormNode New1543539730
Title: Sequential Outputs
Definition: 0
NodeLocation: 608,220,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Delta_Outputs

FormNode New1543539731
Title: Default Sequential Map
Definition: 0
NodeLocation: 752,220,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Default_Delta_Map

Index PV_CumulDataTyp_None
Att_PrevIndexValue: ['None','Cumulative System Count','Cumulative Nameplate CEC-MW-AC','Cumulative Coincident Peak Avg MW-AC','Cumulative Nameplate MW-DC','Cumulative Non-Coincident Peak MW-AC']
Title: PV Cumul Data Types with None
Definition: Concat(None_Label, PV_Cumul_Data_Type)
NodeLocation: 464,56,1
NodeSize: 64,40

Index EV_CumulDataTyp_None
Att_PrevIndexValue: ['None','Cumulative Vehicle Count','Cumulative MW-AC']
Title: EV Cumul Data Types with None
Definition: Concat(None_Label, EV_Cumul_Data_Type)
NodeLocation: 608,56,1
NodeSize: 64,40

Variable Cumulative_PV_Delta
Title: Cumulative PV Delta
Units: MW-AC
Description: Cumulative Nameplate MW-AC delta installations after the input Base Period for Deltas. Values are End of Period.
Definition: sum(Selected_Delta_Data[Act_vs_Sim=Simulated_Label, Output_DER_Types=SolarPV_Out_Label, All_Sectors=PV_Sectors,Delta_Outputs='Cumulative MW-AC (Delta)'], Installation_Type)
NodeLocation: 728,488,1
NodeSize: 64,40
WindState: 2,789,352,720,350
ValueState: 2,344,44,1189,708,1,MIDM
GraphSetup: Graph_ColorSeq:[12593,38293,0,65278,37008,6168,32639,32639,32639,0,0,0,34952,29298,56540,29298,53713,56540,56540,29298,55769,53456,44975,25186,65535,0,0,0,0,65535,65535,46003,65535,0,65535,65535,0,32896,0,65535,42405,0,0,0,35723,42405,10794,10794,65535,49344,52171,65535,65535,0,0,65535,0,32896,0,0,28784,32896,37008,0,32896,32896,32896,0,32896,37008,61166,37008,12593,41891,0]~
Att_Stacked_Lines Graph_Primary_Valdim:0~
Att_AreaFill Graph_Primary_Valdim:0
ReformVal: [Delta_Output_Periods,Null]
NumberFormat: 2,F,4,2,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [Spatial_ID,PV_Sectors,Installation_Type]
Att_GraphValueRange: 1,,,,,,10
Att_ResultSliceState: [PV_Sectors,0,Installation_Type,0,Spatial_ID,0,Delta_Output_Periods,1]
Att_ColorRole: Null

Text Te1544917827
Description: We should consider tying this to the Sequential output so that the Base Period for Deltas can easily be changed by the user and not break.
NodeLocation: 176,400,2
NodeSize: 160,56
NodeInfo: 1,,,,,1
NodeColor: 57311,57311,57311
AcpStyles: Show_object: no

Variable Cumulative_EV_Delta
Title: Cumulative EV Delta
Units: MW-AC
Description: Cumulative MW-AC delta installations after the input Base Period for Deltas. This value assumes 0.25 kW/vehicle per CEC and is an estimated 1:2 coincident peak impact (different units from cumulative PV delta, which is nameplate). Values are End of Period.
Definition: Selected_Delta_Data[Act_vs_Sim=Simulated_Label, Output_DER_Types=EV_Out_Label, All_Sectors=EV_Sectors, Installation_Type=NA_Label, Delta_Outputs=Cumul_MW_Delta_Label, Installation_Type=NA_Label]
NodeLocation: 728,584,1
NodeSize: 64,40
WindState: 2,789,352,720,350
ValueState: 2,334,-7,1201,755,1,MIDM
Aliases: FormNode Fo1544977999
GraphSetup: Att_GraphValueRange Cumulative_EV_Delta:1,,,,,0,10
ReformVal: [Delta_Output_Periods,Null]
NumberFormat: 2,F,4,1,1,0,4,1,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [Spatial_ID]
Att_GraphValueRange: 1,,,,,,10
Att_ResultSliceState: [EV_Sectors,1,Spatial_ID,0,Delta_Output_Periods,1]
Att_ColorRole: Null

Decision Cumul_MW_Delta_Label
Title: Cumul MW Delta Label
Definition: Choice(Delta_Outputs,1,0)
NodeLocation: 752,56,1
NodeSize: 64,40
WindState: 2,15,197,720,350
DefnState: 2,1138,196,416,303,0,DFNM
Aliases: FormNode New1550771263

FormNode New1550771263
Title: Default Sequential Map
Definition: 0
NodeLocation: 752,108,1
NodeSize: 72,12
NodeInfo: 1,0,0,0,0,0,0,102,0,,0,,,0
Original: Cumul_MW_Delta_Label

Variable BESS_Delta_Data
Title: BESS Delta Data
Definition: VAR delta:=Interp_BESS_by_Type[Output_Periods_Plus=Delta_Output_Periods, BESS_Adopt_DataTypes=BESS_Cumul_DataTypes] - Interp_BESS_by_Type[Output_Periods_Plus=Base_Period_Deltas, BESS_Adopt_DataTypes=BESS_Cumul_DataTypes];~
IF Act_vs_Sim=Simulated_Label~
THEN delta[BESS_Types=Installation_Type]~
ELSE Null
NodeLocation: 216,624,1
NodeSize: 64,40
WindState: 2,102,82,1389,428
ValueState: 2,108,111,1155,786,1,MIDM
ReformVal: [Delta_Output_Periods,Installation_Type]
Att__TotalsIndex: [BESS_Spatial_ID,BESS_Sectors]
Att_ResultSliceState: [BESS_Sectors,0,BESS_Spatial_ID,0,BESS_Cumul_DataTypes,2,Act_vs_Sim,2,Delta_Output_Periods,1]

Variable BESS_Delta_Outputs
Title: BESS Delta Outputs
Definition: BESS_Delta_Data[BESS_Cumul_DataTypes=Map_Delta_Outputs[All_DER_Types=BESS_DER_Label], BESS_Spatial_ID=Spatial_ID, BESS_Sectors=All_Sectors]
NodeLocation: 424,624,1
NodeSize: 64,40
WindState: 2,1751,13,1463,748
ValueState: 2,507,7,1161,734,1,MIDM
GraphSetup: Att_Stacked_Lines Graph_Primary_Valdim:1~
Att_AreaFill Graph_Primary_Valdim:1
ReformVal: [Delta_Output_Periods,Null]
Att__TotalsIndex: [Spatial_ID,All_Sectors,Installation_Type]
Att_ResultSliceState: [All_Sectors,0,Spatial_ID,0,Delta_Outputs,1,Act_vs_Sim,2,Installation_Type,0,Delta_Output_Periods,1]
Att_ColorRole: Null

Index BESSCumulDataTypNone
Att_PrevIndexValue: ['None','Cumulative System Count','Cumulative Nameplate MW-AC','Cumulative Nameplate MWh']
Title: BESS Cumul Data Types with None
Definition: Concat(None_Label, BESS_Cumul_DataTypes)
NodeLocation: 320,56,1
NodeSize: 64,40

Variable Interp_BESS_by_Type
Title: Interp BESS by Type
Definition: VAR adoption:=IF BESS_Sim_Strt_Yr_Opt = BESS_SimStart_Minus1~
   THEN Historical_BESS_Adop[All_Sectors=BESS_Sectors, All_Spatial_ID=BESS_Spatial_ID, AESS_Time=SubIndex(AESS_Time_EOP_Map, BESS_TimeOpt_EOP_Map[BESS_Sim_Strt_Yr_Opt=BESS_SimStart_Minus1], AESS_Time)]~
   ELSE BESS_Adoption_Fcst[Time_Storage=BESS_Sim_Strt_Yr_Opt];~
~
IF (Output_Periods_Plus > BESS_TimeOpt_EOP_Map[BESS_Sim_Strt_Yr_Opt=BESS_SimStart_Minus1]) AND (Output_Periods_Plus <= BESS_TimeOpt_EOP_Map[BESS_Sim_Strt_Yr_Opt=BESS_Sim_End_Year])~
THEN LinearInterp(BESS_Time_EOP_Map, BESS_Adopt_by_Type, Equal_Prd_by_Qtr_Map, Time_Storage)~
ELSE Null~
~

NodeLocation: 72,624,1
NodeSize: 64,40
WindState: 2,269,323,720,445
ValueState: 2,316,0,1511,818,1,MIDM
ReformVal: [BESS_Sim_Strt_Yr_Opt,Null]
Att__TotalsIndex: [BESS_Sectors,BESS_Spatial_ID]
Att_ResultSliceState: [BESS_Sectors,0,BESS_Spatial_ID,0,Delta_Outputs,1,BESS_Types,1,Output_Periods_Plus,1]
Att_ColorRole: Null

Close Deltas_from_Base_Per

Index Output_DER_Types
Att_PrevIndexValue: ['Solar PV','Electric Vehicles','Battery Storage']
Title: Output DER Types
Definition: Subset(DER_Types_to_Output)
NodeLocation: 736,1488,1
NodeSize: 64,40
{!40300|Att_SlicerPopupSize: 277,56}

Decision DER_Types_to_Output
Title: DER Types to Output
Definition: Table(All_DER_Types)(Checkbox(1),Checkbox(1),Checkbox(0),Checkbox(0),Checkbox(1))
NodeLocation: 736,1288,1
NodeSize: 64,40
Aliases: FormNode Fo1543006188, FormNode Fo1543024741
TableCellDefault: Checkbox(0)

FormNode Fo1543006188
Title: DER Types to Output
Definition: 0
NodeLocation: 736,1340,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: DER_Types_to_Output

Module DB_Read_Write
Att_PrevIndexValue: ['Full Range','Clear Range']
Title: DB Read/Write
Description: The maximum number of database tables you wish to write. 
Author: coryw
Date: Fri, Nov 23, 2018 9:50 PM
NodeLocation: 1064,888,1
NodeSize: 64,40
DiagState: 2,205,154,1349,532,17

Index Analytica_Data_Types
Att_PrevIndexValue: ['Number','Integer','DateTime','ComplexNumber','Text','Null']
Title: Analytica Data Types
Definition: ['Number','Integer','DateTime','ComplexNumber','Text','Null']
NodeLocation: 112,64,1
NodeSize: 64,40

Index SQL_Data_Types
Att_PrevIndexValue: ['FLOAT','VARCHAR(255)','VARCHAR(5000)','BIGINT','DATE']
Title: SQL Data Types
Definition: ['FLOAT','VARCHAR(255)','VARCHAR(5000)','BIGINT','DATE']
NodeLocation: 264,64,1
NodeSize: 64,40

Decision Map_Analytica_to_SQL
Title: Map Analytica & SQL Data Types
Definition: Table(Analytica_Data_Types)(Choice(SQL_Data_Types,1,0),Choice(SQL_Data_Types,1,0),Choice(SQL_Data_Types,5,0),Choice(SQL_Data_Types,1,0),Choice(SQL_Data_Types,2,0),Choice(SQL_Data_Types,3,0))
NodeLocation: 112,160,1
NodeSize: 64,40
WindState: 2,102,82,720,350
DefnState: 2,101,289,416,303,,DFNM
TableCellDefault: Choice(SQL_Data_Types,1,0)

Function Find_SQL_Type(data; rows: Index)
Title: Find SQL Type
Description: Finds the SQL data type for each column included in data. If multiple data types show up in different rows of the same column, the first non-Null type will be returned.~
~
[data]: a table indexed by rows~
[rows]: an index over which the data type will be estimated
Definition: VAR all_types:=TypeOf(data);~
VAR cumul_flags:=Cumulate(Cumulate(all_types <> 'Null', rows), rows);   {Double-cumulate to ensure only one cell can contain the value of 1}~
VAR nonNull_pos:=PositionInIndex(cumul_flags, 1, rows);~
VAR ana_type:=IF nonNull_pos~
   THEN all_types[@rows=nonNull_pos]~
   ELSE 'Null';~
~
Map_Analytica_to_SQL[Analytica_Data_Types=ana_type]
NodeLocation: 424,64,1
NodeSize: 64,40
WindState: 2,1592,226,1253,478

Index dB_Driver_Options
Att_PrevIndexValue: ['SQL Server','Microsoft Access dBASE Driver (*.dbf, *.ndx, *.mdx)','ODBC Driver 13 for SQL Server','PostgreSQL ANSI(x64)','PostgreSQL Unicode(x64)','Amazon Redshift (x64)','Microsoft Access Driver (*.mdb, *.accdb)','Microsoft Excel Driver (*.xls, *.xlsx, *.xlsm, *.xlsb)','Microsoft Access Text Driver (*.txt, *.csv)']
Title: DB Driver Options
Definition: SQLDriverInfo()
NodeLocation: 584,64,1
NodeSize: 64,40
ValueState: 2,1096,183,476,319,,MIDM

Decision Driver_Type
Title: Driver Type
Definition: Choice(dB_Driver_Options,7,0)
NodeLocation: 728,192,1
NodeSize: 64,40
Aliases: FormNode Fo1542880085

FormNode Fo1542880085
Title: Driver Type
Definition: 0
NodeLocation: 736,240,1
NodeSize: 72,16
NodeInfo: 1,0,0,0,0,0,0,110,0,,0,,,0
Original: Driver_Type

Decision DB_Path
Title: DB Path
Definition: 'C:\Users\JamesMilford\OneDrive - Lumidyne Consulting LLC\Documents\SDGE_DER_Forecasting_2018\DER Tableau Output File Template Final.accdb'
NodeLocation: 728,72,1
NodeSize: 64,40
Aliases: FormNode Fo1542880429

FormNode Fo1542880429
Title: DB Path
Definition: 0
NodeLocation: 740,120,1
NodeSize: 76,16
NodeInfo: 1,0,0,0,0,0,0,118,0,,0,,,0
Original: DB_Path

Decision SQL_String5
Title: SQL String
NodeLocation: 544,168,1
NodeSize: 64,40

Text Te1543353873
Description: http://wiki.analytica.com/index.php?title=Database_access#DbWrite.28.29:_Writing_to_a_database
NodeLocation: 940,652,-1
NodeSize: 364,20
NodeInfo: 1,,,,,,0,0,,,,,,0
NodeColor: 65535,65535,65535

{!40404|FreePassObjectCount ynx7q8bwAivzqrVKAzzMkoz43lJ1d2dcadaOG3u8dtCCL5mV1hDa5p$8sfJoQwFWUYOVtNxJs_BF8A4pUsKa5ywqyeXCy44vHH6sfSHNbtzqgbN_KyPUabgY3hPv1lAtEbzNnCe5Z2Y3a6gEpP1fHxcH_hP8ufRE2siYPIB50xusqqqstw$39GNWfq$BOcr4LcvCWsCZxKj8Z0TyQwRzW4fErS3jN2jQ8tcM7viWLB1vnhbWSPNMLM}
Library Odbc_library
Title: ODBC Library
Author: Lonnie
Date: Thu, Sep 11, 1997 2:15 PM
DefaultSize: 48,24
NodeLocation: 240,448,1
NodeSize: 64,32
NodeInfo: 1,1,1,1,1,1,0,0,0,0,,,,0
DiagState: 2,844,49,743,322,17
FontStyle: Arial, 13
Att_PreLoadScript: {!40404|FreePassObjectCount ynx7q8bwAivzqrVKAzzMkoz43lJ1d2dcadaOG3u8dtCCL5mV1hDa5p$8sfJoQwFWUYOVtNxJs_BF8A4pUsKa5ywqyeXCy44vHH6sfSHNbtzqgbN_KyPUabgY3hPv1lAtEbzNnCe5Z2Y3a6gEpP1fHxcH_hP8ufRE2siYPIB50xusqqqstw$39GNWfq$BOcr4LcvCWsCZxKj8Z0TyQwRzW4fErS3jN2jQ8tcM7viWLB1vnhbWSPNMLM}
{!40400|Att_clearTypeFonts: -1}

Function Insertrecsql(A:ArrayType;I:IndexType;L:IndexType;row;dbTableName)
Title: InsertRecSql
Description: Generates the SQL "INSERT INTO" statement for one line of table A.  A is a 2-D table indexed by rows I and columns L.  L's domain serves as the column names in the database table.  dbTableName is the name of the table in the database.  The result begins with two semi-colons, since it will be used with an SQL statement preceeding it.
Definition: (';;INSERT INTO ' & MakeValidSqlTableNam(dbTableName) & ~
   '(' & JoinText(MakeValidSQLName(L),L,',') & ') VALUES (' & Vallist_fixed(A[I=row],L)) & ')'
NodeLocation: 184,32,1
NodeSize: 52,24
WindState: 2,260,34,603,423

Function Vallist_fixed(V:ArrayType;I:IndexType)
Title: ValList
Description: Takes a list of values, and returns a string which the concatenation of each value, separated by commas, and with each value quoted.~
~
Original: ~
var quoted := if IsNumber(V) then V ~
                      else '''' & TextReplace(V,"'","''",true) & '''';~
JoinText( quoted, I, ',')
Definition: var quoted := if IsNumber(V) then "'" & V & "'" ~
                      else if IsUndef(V) THEN 'NULL' ~
				else '''' & TextReplace(V,"'","''",true) & '''';~
JoinText( quoted, I, ',')
NodeLocation: 72,32,0
NodeSize: 52,24
WindState: 2,515,178,1097,450
NumberFormat: 2,F,4,14,0,0,4,0,$,0,"ABBREV",0,,,0,0

Function Writetablesql(Tabl:ArrayType;RowIndex:IndexType;LabelIndex:IndexType;dbTableName)
Title: WriteTableSql(Table,Rows,Labels,dbTableName)
Description: Returns the SQL that will write the table to the database table.~
This can be used as the second argument to DBWrite.~
This SQL statement replaces the entire contents of an existing table with the new data.
Definition: 'DELETE FROM '& MakeValidSqlTableNam(Dbtablename) & JoinText(Insertrecsql(Tabl, Rowindex, Labelindex, Rowindex, Dbtablename),RowIndex)
NodeLocation: 360,32,1
NodeSize: 120,24
WindState: 2,220,436,1145,476

Function Isvalidsqlname(s:coerce text)
Title: IsValidSQLName(s)
Description: In SQL, a table name or column label should begin with a letter and then contain only alphanumerics and underscores.  If so, it can appear in SQL without special treatment.  If it violates this, such as if it contains a space, then it must be surrounded by brackets. ~
~
This function tests whether a name adheres to the valid unbracketed naming convention.  If so, then you don't need to bracket when it appears in the SQL statement.
Definition: FindInText("^" & Reg_exp_SQL_ident & "$", s, re:1, caseInsensitive:true, return:'P')>0
NodeLocation: 96,96,1
NodeSize: 72,24
WindState: 2,598,420,1016,411

Function Makevalidsqlname(s : coerce text)
Title: MakeValidSqlName(s)
Description: In SQL, a table name or column label should begin with a letter and then contain only alphanumerics and underscores.  If so, it can appear in SQL without special treatment.  If it violates this, such as if it contains a space, then it must be surrounded by brackets.~
~
This brackets s if necessary.~
~
It does not handle the case where s contains brackets, which would cause problems on the db side anyway.
Definition: if IsValidSQLName(s) then s else "[" & s & "]"
NodeLocation: 264,96,1
NodeSize: 80,24
WindState: 2,98,83,814,354

Constant Reg_exp_SQL_ident
Title: Reg exp SQL ident
Description: A regular expression for a valid SQL identifier. ~
~
It says that an SQL identifier ma be either of: ~
1. Opening '[' followed by any sequence of characters, excluding a square brackets, followed by a closing bracket~
2. First character: Letter, underscore, @, or #.~
    Remaining characters: Letter, digit, underscore, @ or #.
Definition: "^(?:(?:\[[^\[\]]+\])|(?:(?:\w|[_@#])(?:\w|\d|[_@#\$])*))$"
NodeLocation: 72,160,1
NodeSize: 48,24
WindState: 2,348,484,720,350

Function MakeValidSqlTableNam(s:atom text)
Title: MakeValidSqlTableName(s)
Description: Adds brackets as necessary to turn s into a valid SQL table name.~
Names with special characters or spaces need to be surrounded with brackets. So the table name "My table" needs to be "[My table]".  Unlike a simple SQL identifier, table names can have multiple levels, like "[dbo].[My table]" or "dbo.[My table]".~
~
If it can't make it valid, it returns the original.
Definition: index part := SplitText(s,'.');~
Var opens := SelectText(part,1,1)='[';~
Var closes := SelectText(part, TextLength(part))=']';~
Var openWt := opens and not closes;~
Var closeWt := (closes and not opens)[@part=@part-1,defVal:0];~
Var nesting := Cumulate(openWt - closeWt,part);~
Var fixed := if nesting=0 then Makevalidsqlname(part) else part;~
JoinText(fixed,part,'.')
NodeLocation: 432,96,1
NodeSize: 72,24
WindState: 2,739,410,841,477

Close Odbc_library

Variable Write_to_dB
Title: Write to dB
Description: recomp;~
DbWrite('DSN=SPIDEROutput', Writetablesql( Format_Sequent_Data, Sequential_Row_Num, Sequential_Text_Cols, 'Sequential'));~
'done'
Definition: DbWrite('DSN=SPIDEROutput', Writetablesql( Format_Sequent_Data, Sequential_Row_Num, Sequential_Text_Cols, 'Sequential'));~
DbWrite('DSN=SPIDEROutput', Writetablesql( Format_Delta_Data, Delta_Row_Num, Delta_Text_Cols, 'Deltas'));~
DbWrite('DSN=SPIDEROutput', Writetablesql( Format_Compare_Data, Comparison_Row_Num, Comparison_Text_Cols, 'Comparison'));~
'done'
NodeLocation: 240,328,1
NodeSize: 64,40
WindState: 2,518,98,1157,574
ValueState: 2,409,431,416,303,,MIDM

Variable Va8
Definition: IsUndef(Format_Sequent_Data)
NodeLocation: 1024,216,1
NodeSize: 64,40
ValueState: 2,408,410,1306,303,,MIDM
ReformVal: [Sequential_Text_Cols,Sequential_Row_Num]

Text Te1543369736
NodeLocation: 928,128,-1
NodeSize: 64,40
NodeInfo: 1,,,,,,0,0,,,,,,0
NodeColor: 65535,65535,65535

Text Te1543369748
NodeLocation: 1120,128,-1
NodeSize: 64,40
NodeInfo: 1,,,,,,0,0,,,,,,0
NodeColor: 65535,65535,65535

Module Crap
Title: Crap
Author: coryw
Date: Wed, Nov 28, 2018 11:13 AM
NodeLocation: 408,448,1
NodeSize: 64,40

Constant Database_DSN
Title: Database DSN
Description: Input in single quotes the name of the DSN created. 
Definition: 'SPIDEROutput'
NodeLocation: 112,64,1
NodeSize: 64,40
WindState: 2,102,82,720,350

Variable dBRecords
Title: dBRecords
Definition: recomp;~
DbQuery("DSN=SPIDEROutput", 'SELECT * FROM Sequential')
NodeLocation: 272,64,1
NodeSize: 64,40
ValueState: 2,1264,99,255,565,,MIDM

Variable Labels3
Title: Labels
Definition: DbLabels(dBRecords)
NodeLocation: 112,168,1
NodeSize: 64,40

Variable Va5
Definition: Writetablesql( Format_Sequent_Data,  Sequential_Row_Num, Sequential_Text_Cols, 'Sequential' )
NodeLocation: 1232,144,1
NodeSize: 64,40
ValueState: 2,344,346,1387,303,,MIDM
{!50000|Att_ColumnWidths: [1083]}

Variable Test_SQL_String
Title: Test SQL String
Definition: recomp;~
DbWrite('DSN=SPIDEROutput', "DELETE FROM Sequential;;INSERT INTO Sequential([Spatial ID],[Output DER Types],[All Sectors],[Act vs Sim],[Output Periods],[Incremental Count],[Cumulative Count],[Incremental MW-AC],[Cumulative MW-AC]) VALUES ('91901','Solar PV','Residential','Actual','1-Feb-2012','9','242',NULL,NULL)")
NodeLocation: 704,208,1
NodeSize: 64,40
ValueState: 2,976,217,416,303,,MIDM

Variable Va10
Definition: DbTable(dBRecords,Labels3)
NodeLocation: 272,168,1
NodeSize: 64,40
ValueState: 2,315,118,1385,737,,MIDM
ReformVal: [Labels3,dBRecords]

Variable New_Sequential
Title: New Sequential
Definition: Format_Sequent_Data
NodeLocation: 1072,224,1
NodeSize: 64,40
ValueState: 2,258,103,1491,671,,MIDM
ReformVal: [Sequential_Text_Cols,Sequential_Row_Num]

Index Seq_Cols_Plus_ID
Title: Seq Cols Plus ID
Definition: concat(['ID'],Sequential_Text_Cols)
NodeLocation: 1072,128,1
NodeSize: 64,40

Button Force_Recompute
Title: Force Recompute
NodeLocation: 872,192,1
NodeSize: 64,40
OnClick: ( recomp:= NOT recomp)

Variable recomp
Title: recomp
Definition: 0
NodeLocation: 792,72,1
NodeSize: 64,40

Index dB_Table
Att_PrevIndexValue: ['Sequential']
Title: dB Table
Definition: ['Sequential']
NodeLocation: 112,272,1
NodeSize: 64,40

Constant Max_dB_Tables
Title: Max dB Tables
Definition: 3
NodeLocation: 112,360,1
NodeSize: 64,40

Variable Va11
NodeLocation: 1248,232,1
NodeSize: 64,40

Index dB_Table_Parameter
Att_PrevIndexValue: ['Output Node Handle (handle)','Rows Index (handle)','Columns Index (handle)']
Title: dB Table Parameter
Definition: ['Output Node Handle (handle)','Rows Index (handle)','Columns Index (handle)']
NodeLocation: 280,272,1
NodeSize: 64,40

Variable dBs_to_Write
Title: dBs to Write
Definition: Table(dB_Table,dB_Table_Parameter)(~
handle(Format_Sequent_Data),handle(Sequential_row_num),handle(Sequential_Text_Cols))
NodeLocation: 280,360,1
NodeSize: 64,40
DefnState: 2,730,570,946,206,,DFNM
ValueState: 2,711,179,1035,279,,MIDM
ReformDef: [dB_Table_Parameter,dB_Table]
MetaOnly: 1

Function Write_Multiple_dB_Ta(tableName: text; tableNode: variable; rowIndex, colIndex: index)
Title: Write Multiple dB Tables
Definition: DbWrite('DSN=SPIDEROutput', Writetablesql( tableNode, rowIndex, colIndex, tableName));
NodeLocation: 600,120,1
NodeSize: 64,40

Variable Write_to_dB1
Title: Write to dB
Description: recomp;~
DbWrite('DSN=SPIDEROutput', Writetablesql( Format_Sequent_Data, Sequential_Row_Num, Sequential_Text_Cols, 'Sequential'));~
'done'
Definition: Multi_Write(dBs_to_Write)
NodeLocation: 488,272,1
NodeSize: 64,40
WindState: 2,518,98,1157,574
ValueState: 2,409,431,416,303,,MIDM

Variable Va13
Definition: (dBs_to_Write[ dB_Table='Sequential', dB_Table_Parameter='Rows Index (handle)'])
NodeLocation: 696,296,1
NodeSize: 64,40

Function Multi_Write(tableDef: variable)
Title: Multi Write
Definition: For x:= dB_Table DO~
	(metaindex row:=tableDef[ dB_Table=x, dB_Table_Parameter= 'Rows Index (handle)'];~
	metaindex col:= tableDef[ dB_Table=x, dB_Table_Parameter= 'Columns Index (handle)'];~
	Write_Multiple_dB_Ta( ~
			tableName:x, ~
			tableNode: tableDef[ dB_Table=x, dB_Table_Parameter= 'Output Node Handle (handle)'], ~
			rowIndex:  row,  ~
			colIndex: col~
			));~
'done'
NodeLocation: 496,368,1
NodeSize: 64,40
WindState: 2,102,82,1150,350

Variable Va14
Definition:  Va13
NodeLocation: 848,336,1
NodeSize: 64,40

Close Crap

Button Output_to_Tableau
Title: Output to Tableau
NodeLocation: 408,328,1
NodeSize: 64,40
OnClick: Write_to_dB

Close DB_Read_Write

FormNode Fo1544582166
Title: Tableau Output Filename
Definition: 0
NodeLocation: 888,268,1
NodeSize: 232,20
NodeInfo: 1,,,,,,0,238,,,,,,0
NodeColor: 49344,49344,49344
Original: Tableau_Output_File

FormNode Fo1543021295
Title: Data Export Settings
Definition: 0
NodeLocation: 888,192,1
NodeSize: 232,20
NodeInfo: 1,,,,,,,78,,,,,
NodeColor: 49344,49344,49344
Original: Data_Export_Settings

Alias Al1543021300
Title: Run Excel Export
Definition: 1
NodeLocation: 1296,768,1
NodeSize: 72,40
Original: Run_Data_Export

FormNode Fo1543021306
Title: Number of Export Datasets
Definition: 0
NodeLocation: 888,120,1
NodeSize: 232,20
NodeInfo: 1,,,,,,,78,,,,,
NodeColor: 49344,49344,49344
Original: Num_Export_Datasets

Text Te1543023667
Title: Step 3 -- Run delta outputs
Description: ~
Select the base year to begin the deltas. Results will be shown for subsequent periods only.
NodeLocation: 320,300,-1
NodeSize: 280,60
NodeInfo: 1,0,0,1,1,1,1,,0,,0,,,
NodeColor: 65535,65535,65535
NodeFont: Arial Narrow,16

FormNode Fo1543023735
Title: Base Period for Deltas
Definition: 0
NodeLocation: 320,324,1
NodeSize: 232,20
NodeInfo: 1,0,0,1,0,0,0,174,0,,0,,,
NodeColor: 65535,32766,1
Original: Base_Period_Deltas

Text Te1543023861
Title: Step 4 -- Select data to be exported:
NodeLocation: 320,420,-1
NodeSize: 280,52
NodeInfo: 1,0,0,1,1,1,1,,0,,0,,,
NodeColor: 65535,65535,65535
NodeFont: Arial Narrow,16

FormNode Fo1543024741
Title: DER Types to Output
Definition: 0
NodeLocation: 304,428,1
NodeSize: 232,20
NodeInfo: 1,0,0,1,0,0,0,78,0,,0,,,
NodeColor: 49344,49344,49344
Original: DER_Types_to_Output

Text Te1543024819
Title: Step 5 -- Configure export settings:
Description: ~
If necessary, extend the size of the configuration table to accommodate a larger number of exported datasets.~
~
~
~
Configure which datasets will be exported to Excel.~
~
~
~
Specify the path to the spreadsheet file. ~
~
~
~
~
~
Press the button to initiate the export.~
~

NodeLocation: 888,276,-1
NodeSize: 280,260
NodeInfo: 1,0,0,1,1,1,1,,0,,0,,,
NodeColor: 65535,65535,65535
NodeFont: Arial Narrow,16

Alias Al1543025086
Title: Selected Delta Data
Definition: 1
NodeLocation: 888,984,1
NodeSize: 64,40
Original: Selected_Delta_Data

Alias Al1543025108
Title: Selected Comparison Data
Definition: 1
NodeLocation: 888,888,1
NodeSize: 64,40
Original: Sel_Compare_Data

Alias Al1543025118
Title: Selected Sequential Data
Definition: 1
NodeLocation: 888,792,1
NodeSize: 64,40
Original: Sel_Sequential_Data

Text Te1543070956
Description: Could the base period for Deltas possibly be before the start of the final output period (i.e., inclusive of some historic data? ~
~
We should divorce this input from the Output Time periods to avoid possible inadvertent changes to it (it should be pretty fixed for any given resource planning year), perhaps putting some checks on it instead?~
~
Temporary solution in there for now. Let's figure out what is most robust (right now it could theoretically permit a time period not in the Output time index, which would fail if the output dt Choice is not the same as the timestep for the pv simulation.
NodeLocation: 1368,196,-1
NodeSize: 192,180
NodeColor: 65535,65535,65535

Text Te1543073576
Title: Let's also chat about BOY & EOY w.r.t. output
NodeLocation: 1632,64,-1
NodeSize: 64,48
NodeColor: 65535,65535,65535

Button Save_Historic_Compar
Title: Save Historic Comparisons
Description: Hitting this button will auto-assign the Output Start Period, Output End Period, PV Sim Start Year, and PV Sim End Year to be consistent with the PV_Calibration_Time index. ~
~
Use as desired to speed up the export process, or customize the inputs if preferred.~
~
SHOULD BE UPDATED TO ASSIGN OUTPUT END PERIOD TO ONE PERIOD AFTER THE PV SIM START YEAR
NodeLocation: 208,80,1
NodeSize: 120,24
WindState: 2,-38,89,720,355
Aliases: Alias Al822263293
OnClick: Save_PV_Hist_Compare;   {Must run PV calibration before running BESS forecasts}~
Save_BESSHistCompare;   {Run BESS calibration}~
~


Button Assign_Forecast_Prds
Title: Assign Forecast Periods
NodeLocation: 208,192,1
NodeSize: 120,24
WindState: 2,216,405,720,487
OnClick: Set_PV_Time_to_Fcst;   {Set PV Simulation start and end times for forecast period}~
Set_BESSTime_to_Fcst;   {Set BESS Simulation start and end times for forecast period}~
Set_EV_Time_to_Fcst;   {Set EV simulation start and end times for forecast period}~
~
{Set Output start and end times}~
(Output_Start_Period:=Calib_Start_Period);~
(Output_End_Period:=Simulation_End_Yr);~
~


Text Te1543100498
Title: Just for making life easy. To be refined.
NodeLocation: 1508,616,-1
NodeSize: 292,208
NodeInfo: 1,0,0,1,1,0,0,,0,,0,,,
NodeColor: 65535,65535,65535

Variable Final_PV_Sim_Period
Title: Final PV Sim Period
Definition: Slice(PV_Sim_End_Yr_Option, Size(PV_Sim_End_Yr_Option))
NodeLocation: 1600,584,1
NodeSize: 64,40
ValueState: 2,1065,178,416,303,,MIDM

Variable PV_Cal_End_Plus_1
Title: PV Cal End+1 Period
Description: One time period after the PV calibration end year, the most likely starting point for the sequential outputs for PV Sim Start Year.
Definition: Slice(PV_Sim_Strt_Yr_Opt, PositionInIndex(PV_Sim_Strt_Yr_Opt, PV_Calibration_End, PV_Sim_Strt_Yr_Opt) + 1)
NodeLocation: 1456,488,1
NodeSize: 64,40

Variable PV_Cal_Start_Plus_1
Title: PV Cal Start + 1 Period
Description: One time period after the PV Calibration Start Year, the most likely time period for the Output Start Period.
Definition: Slice(PV_Sim_Strt_Yr_Opt, PositionInIndex(PV_Sim_Strt_Yr_Opt, PV_Calibration_Start, PV_Sim_Strt_Yr_Opt) + 1)
NodeLocation: 1600,488,1
NodeSize: 64,40

Button Export_to_Tableau1
Title: Export to Tableau
Description: Exports data to an Excel file. Only one scenario can be selected and exported at a time.~
~
TURNED OFF SAVE PV HIS COMPARE FOR TESTING
NodeLocation: 768,484,1
NodeSize: 96,20
WindState: 2,102,59,1068,600
OnClick: Export_Prep();~
Set_Type_of_Export(CSV_Tableau_Label);~
Run_Data_Export

Decision Set_Sequential_Outpu
Title: Set Sequential Output Dates?
Definition: Checkbox(0)
NodeLocation: 1456,584,1
NodeSize: 64,40
Aliases: FormNode Fo1543159699, FormNode Fo1543160456

FormNode Fo1543159699
Title: Auto-assign sequential data storage dates?
Definition: 0
NodeLocation: 1520,616,1
NodeSize: 24,16
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Set_Sequential_Outpu

FormNode Fo1543160456
Att_PrevIndexValue: [2017,2018,2019,2020,2021,2022,2023,2024,2025,2026,2027,2028,2029,2030]
Title: Auto-assign sequential data storage dates?
Definition: 0
Author: JamesMilford
Date: Thu, Nov 29, 2018 9:50 AM
NodeLocation: 816,416,1
NodeSize: 160,16
Original: Set_Sequential_Outpu

Variable Final_PV_Sim___1_Yea
Title: Final PV Sim - 1 Year?
Definition: PV_Sim_End_Yr_Option[@PV_Sim_End_Yr_Option=size(PV_Sim_End_Yr_Option)-1/dT_PV_Data]
NodeLocation: 1600,680,1
NodeSize: 64,40

Module CEC_Allocations
Title: CEC Allocations
Author: coryw
Date: Thu, Dec 6, 2018 1:23 PM
NodeLocation: 736,1080,1
NodeSize: 64,40
DiagState: 2,104,-6,1433,888,17

Variable Cumul_Sim_PV_Forecst
Title: Cumul Sim PV Forecast
Units: MW-AC
Definition: Sum(PV_Adoption_Data[PV_Adopt_Data_Types=PV_Cumul_MW_Label, Output_Periods=Period_for_CEC_Year, PV_Spatial_ID=Spatial_ID] * Non_Agg_Spatial_IDs[PV_Spatial_ID=Spatial_ID], Act_vs_Sim, PV_Sectors)
NodeLocation: 248,312,1
NodeSize: 64,40
ValueState: 2,537,22,1138,849,0,MIDM
ReformVal: [CEC_Forecast_Years,PV_Spatial_ID]
Att_ResultSliceState: [PV_Adopt_Data_Types,3,PV_Spatial_ID,1,CEC_Forecast_Years,1]

Variable Comp_Forecst_PV
Title: Compare Forecast with CEC
Units: MW-AC
Definition: [CEC_PV_Forecast,Sum(Cumul_Sim_PV_Forecst,Spatial_ID)]
NodeLocation: 704,312,1
NodeSize: 64,40
NodeInfo: 1,1,1,1,1,1,0,0,0,0,,0,1,0
ValueState: 2,290,122,1113,719,1,MIDM

Variable PV_Forecast_Growth
Title: PV Forecast Growth
Units: fraction
Description: The forecast growth between the first and final CEC year.
Definition: Comp_Forecst_PV[CEC_Forecast_Years=Max(CEC_Forecast_Years)] / Comp_Forecst_PV[CEC_Forecast_Years=Min(CEC_Forecast_Years)] - 1
NodeLocation: 856,312,1
NodeSize: 64,40
WindState: 2,102,82,1197,484
ValueState: 2,361,28,982,636,1,MIDM
GraphSetup: Att_CatLineStyle Graph_Primary_Valdim:9
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15

Variable Cumul_Sim_EV_Forecst
Title: Cumul Sim EV Forecast
Units: MW-AC
Definition: Sum(Interp_Sim_EV_Adopt[EV_Cumul_Data_Type=EV_Cumul_MW_Label, Output_Periods_Plus=Period_for_CEC_Year, EV_Spatial_ID=Spatial_ID] * (NOT All_Agg_Spatial_IDs[All_Spatial_ID=Spatial_ID]), Act_vs_Sim, EV_Sectors)
NodeLocation: 248,416,1
NodeSize: 64,40
ValueState: 2,280,108,913,741,0,MIDM
Att_ResultSliceState: [Act_vs_Sim,2,Sel_Ag_EV_LRMS,1,CEC_Forecast_Years,1,Spatial_ID,1]

Index CEC_Forecast_Years
Att_PrevIndexValue: [2020,2021,2022,2023,2024,2025,2026,2027,2028,2029,2030]
Title: CEC Forecast Years
Definition: 2020..2030
NodeLocation: 80,528,1
NodeSize: 64,40

Constant CEC_PV_Forecast
Title: CEC PV Forecast
Units: MW-AC
Description: PV forecasts from the CEC. These are coincident peak 1 in 2 (MW) impacts.~
~
Source:~
SDGE requested that the AAPV from the low scenario be used in conjunction with the self-gen PV from the mid scenario. The low scenario's AAPV had to be estimated, per the SDGE calculations in "Mid to Low AAEE-AAPV calcs.xlsx" (sent by W. Wood on 11/21/2019).~
~
Corrected SDGE Load Modifiers Mid Baseline Mid AAEE/AAPV CEDU 2018 TN-226271 Submitted 1/7/2019.~
Source: https://ww2.energy.ca.gov/2018_energypolicy/documents/cedu_2018-2030/2018_loadmodifiers.php~
"TN226271_20190107T134813_Corrected SDGE Load Modifiers Mid Baseline Mid AAEECEDU 2018.xlsx"
Definition: Table(CEC_Forecast_Years)(793.7312217427708,909.6021582332892,1021.6630349266635,1118.2031688276431,1191.000863714547,1243.0774228014602,1283.2169003965712,1318.3971967594916,1352.5445997258132,1386.4241316601108,1420.4718360649351)
NodeLocation: 400,200,1
NodeSize: 64,40
WindState: 2,60,277,1119,558
DefnState: 2,340,346,1015,303,0,DFNM
ValueState: 2,263,522,704,385,0,MIDM
Aliases: FormNode Fo1543859936
ReformDef: [CEC_Forecast_Years,Undefined]

Constant CEC_EV_Forecast
Title: CEC EV Forecast
Units: MW-AC
Description: EV forecasts from the CEC. These are coincident peak 1 in 2 (MW) impacts.~
~
Source:~
Corrected SDGE Load Modifiers Mid Baseline Mid AAEE/AAPV CEDU 2018 TN-226271 Submitted 1/7/2019.~
Source: https://ww2.energy.ca.gov/2018_energypolicy/documents/cedu_2018-2030/2018_loadmodifiers.php~
"TN226271_20190107T134813_Corrected SDGE Load Modifiers Mid Baseline Mid AAEECEDU 2018.xlsx"
Definition: Table(CEC_Forecast_Years)(34.78698400623668,45.49643115044225,56.58011297626569,67.85630516855852,77.5725932189735,86.2366228581012,92.94601684748538,98.90753063361043,104.81133230130236,110.89137365163778,117.29251370737128)
NodeLocation: 400,520,1
NodeSize: 64,40
WindState: 2,542,530,993,350
DefnState: 2,358,205,1217,446,0,DFNM
ValueState: 2,138,364,416,548,0,MIDM
Aliases: FormNode Fo1543859937
ReformDef: [CEC_Forecast_Years,Undefined]

Variable Period_for_CEC_Year
Title: Period for CEC Year
Definition: MakeDate(CEC_Forecast_Years, 6, 31)
NodeLocation: 88,360,1
NodeSize: 64,40
ValueState: 2,296,298,579,576,0,MIDM

Variable Incr_Sim_PV_Forecst
Title: Increm Sim PV Forecast
Units: MW-AC/year
Definition: IF CEC_Forecast_Years = Slice(CEC_Forecast_Years, 1)~
THEN Null~
ELSE Uncumulate(Cumul_Sim_PV_Forecst, CEC_Forecast_Years)
NodeLocation: 400,312,1
NodeSize: 64,40
ValueState: 2,237,133,1295,692,1,MIDM
ReformVal: [CEC_Forecast_Years,Spatial_ID]

Variable Incr_CEC_PV_Forecst
Title: Increm CEC PV Forecast
Units: MW-AC/year
Definition: IF CEC_Forecast_Years = Slice(CEC_Forecast_Years, 1)~
THEN Null~
ELSE Uncumulate(CEC_PV_Forecast, CEC_Forecast_Years)
NodeLocation: 400,104,1
NodeSize: 64,40
ValueState: 2,961,75,869,625,1,MIDM
Att__TotalsIndex: [PV_Spatial_ID]

Variable Alloc_CEC_PV_Forecst
Title: Allocated CEC PV Forecast
Units: MW-AC
Definition: VAR uncumul:=IF CEC_Forecast_Years = Slice(CEC_Forecast_Years, 1)~
   THEN CEC_PV_Forecast * PV_Allocation_by_Zip~
   ELSE Incr_CEC_PV_Forecst * PV_Allocation_by_Zip;~
~
Cumulate(uncumul, CEC_Forecast_Years)
NodeLocation: 552,104,1
NodeSize: 64,40
ValueState: 2,331,5,1213,868,0,MIDM
ReformVal: [Null,CEC_Forecast_Years]
Att__TotalsIndex: [PV_Spatial_ID,Spatial_ID]
Att_ResultSliceState: [Spatial_ID,0,CEC_Forecast_Years,1]

Variable PV_Allocation_by_Zip
Title: PV Allocation by Zip
Units: fraction
Definition: IF CEC_Forecast_Years = Slice(CEC_Forecast_Years, 1)~
THEN Divide(Cumul_Sim_PV_Forecst, Sum(Cumul_Sim_PV_Forecst, Spatial_ID), True)~
ELSE DIvide(Incr_Sim_PV_Forecst, Sum(Incr_Sim_PV_Forecst, Spatial_ID), True)
NodeLocation: 552,312,1
NodeSize: 64,40
ValueState: 2,75,11,1312,873,1,MIDM
ReformVal: [CEC_Forecast_Years,Spatial_ID]
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: []

Variable Comp_Forecst_EV
Title: Compare Forecast with CEC
Units: MW-AC
Definition: [CEC_EV_Forecast,Sum(Cumul_Sim_EV_Forecst,Spatial_ID)]
NodeLocation: 704,416,1
NodeSize: 64,40
NodeInfo: 1,1,1,1,1,1,0,0,0,0,,0,1,0
ValueState: 2,419,98,957,719,1,MIDM

Variable EV_Forecast_Growth
Title: EV Forecast Growth
Units: fraction
Description: The forecast growth between the first and final CEC year.
Definition: Comp_Forecst_EV[CEC_Forecast_Years=Max(CEC_Forecast_Years)] / Comp_Forecst_EV[CEC_Forecast_Years=Min(CEC_Forecast_Years)] - 1
NodeLocation: 856,416,1
NodeSize: 64,40
WindState: 2,102,82,1197,484
ValueState: 2,361,28,1157,752,,MIDM
GraphSetup: Att_CatLineStyle Graph_Primary_Valdim:9
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15

Variable Incr_Sim_EV_Forecst
Title: Increm Sim EV Forecast
Units: MW-AC/year
Definition: IF CEC_Forecast_Years = Slice(CEC_Forecast_Years, 1)~
THEN Null~
ELSE Uncumulate(Cumul_Sim_EV_Forecst, CEC_Forecast_Years)
NodeLocation: 400,416,1
NodeSize: 64,40
ValueState: 2,200,202,748,633,,MIDM

Variable Incr_CEC_EV_Forecst
Title: Increm CEC EV Forecast
Units: MW-AC/year
Definition: IF CEC_Forecast_Years = Slice(CEC_Forecast_Years, 1)~
THEN Null~
ELSE Uncumulate(CEC_EV_Forecast, CEC_Forecast_Years)
NodeLocation: 400,640,1
NodeSize: 64,40
ValueState: 2,377,384,416,514,0,MIDM
Att__TotalsIndex: [PV_Spatial_ID]

Variable Alloc_CEC_EV_Forecst
Title: Allocated CEC EV Forecast
Units: MW-AC
Definition: VAR uncumul:=IF CEC_Forecast_Years = Slice(CEC_Forecast_Years, 1)~
   THEN CEC_EV_Forecast * EV_Allocation_by_Zip~
   ELSE Incr_CEC_EV_Forecst * EV_Allocation_by_Zip;~
~
Cumulate(uncumul, CEC_Forecast_Years)
NodeLocation: 552,640,1
NodeSize: 64,40
ValueState: 2,647,7,1213,868,0,MIDM
ReformVal: [Null,CEC_Forecast_Years]
Att__TotalsIndex: [PV_Spatial_ID,EV_Spatial_ID,Spatial_ID]
Att_ResultSliceState: [Sel_Ag_EV_LRMS,1,Act_vs_Sim,1,Spatial_ID,0,CEC_Forecast_Years,1]

Variable EV_Allocation_by_Zip
Title: EV Allocation by Zip
Units: fraction
Definition: IF CEC_Forecast_Years = Slice(CEC_Forecast_Years, 1)~
THEN Divide(Cumul_Sim_EV_Forecst, Sum(Cumul_Sim_EV_Forecst, Spatial_ID), True)~
ELSE DIvide(Incr_Sim_EV_Forecst, Sum(Incr_Sim_EV_Forecst, Spatial_ID), True)
NodeLocation: 552,416,1
NodeSize: 64,40
ValueState: 2,513,51,1312,873,0,MIDM
ReformVal: [Spatial_ID,CEC_Forecast_Years]
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: []
Att_ResultSliceState: [Spatial_ID,1,CEC_Forecast_Years,1]

FormNode Fo1543859936
Title: CEC PV Forecast
Definition: 0
NodeLocation: 400,244,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: CEC_PV_Forecast

FormNode Fo1543859937
Title: CEC EV Forecast
Definition: 0
NodeLocation: 400,564,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: CEC_EV_Forecast

Text Te1543860580
Description: Ensure that EV and PV simulation periods extend to 2030, the final year of the CEC forecast period. Additionally, ensure that the PV simulation period starts one period after the calibration end period.
NodeLocation: 536,32,-1
NodeSize: 512,24
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Decision PV_Cumul_MW_Label
Title: PV Cumul MW Label
Definition: Choice(PV_Adopt_Data_Types,5,0)
NodeLocation: 248,208,1
NodeSize: 64,40
Aliases: FormNode Fo1543861089

FormNode Fo1543861089
Title: PV Cumul MW Label
Definition: 0
NodeLocation: 252,160,1
NodeSize: 68,16
NodeInfo: 1,0,0,0,0,0,0,102,0,,0,,,0
Original: PV_Cumul_MW_Label

Decision EV_Cumul_MW_Label
Title: EV Cumul MW Label
Definition: Choice(EV_Adopt_Data_Types,4,0)
NodeLocation: 248,512,1
NodeSize: 64,40
Aliases: FormNode Fo1543861237

FormNode Fo1543861237
Title: PV Cumul MW Label
Definition: 0
NodeLocation: 252,560,1
NodeSize: 68,16
NodeInfo: 1,0,0,0,0,0,0,102,0,,0,,,0
Original: EV_Cumul_MW_Label

Objective CEC_Allocat_Handles
Title: CEC Allocation Handles
Definition: Table(All_DER_Types)(Handle(Alloc_CEC_PV_Forecst),Handle(Alloc_CEC_EV_Forecst),0,0,Handle(Alloc_CEC_BESS_Fcst))
NodeLocation: 1008,368,1
NodeSize: 64,40
DefnState: 2,44,169,416,303,,DFNM
ValueState: 2,581,303,416,303,,MIDM
NodeColor: 19661,48336,65535
TableCellDefault: Handle(Null)

Variable Select_Allocat_Data
Title: Selected Allocation Data
Units: MW-AC
Definition: FOR J:=Output_DER_Types DO (~
   VAR data:=CEC_Allocat_Handles[All_DER_Types=J];~
   data~
);~

NodeLocation: 1160,368,1
NodeSize: 64,40
ValueState: 2,347,45,1136,834,0,MIDM
Aliases: Alias Al1544645465
ReformVal: [CEC_Forecast_Years,Output_DER_Types]
Att__TotalsIndex: [All_Sectors,Spatial_ID]
Att_ResultSliceState: [Output_DER_Types,2,Spatial_ID,0,CEC_Forecast_Years,1]

Variable Flat_Allocation_Data
Title: Flat Allocation Data
Units: MW-AC
Definition: MdArrayToTable(Select_Allocat_Data, omitZero: False, omitNull: True)
NodeLocation: 1312,368,1
NodeSize: 64,40
ValueState: 2,1612,25,1474,742,,MIDM

Index Allocation_Columns
Att_PrevIndexValue: [Spatial_ID,Output_DER_Types,CEC_Forecast_Years,'Value']
Title: Allocation Columns
Definition: CopyIndex(Flat_Allocation_Data.Col)
NodeLocation: 1232,264,1
NodeSize: 64,40
ValueState: 2,11,87,416,303,,MIDM

Index Allocation_Order_Num
Att_PrevIndexValue: [1,2,3,4]
Title: Allocation Order Number
Definition: 1..Size(Allocation_Columns)
NodeLocation: 1232,176,1
NodeSize: 64,40

Decision Order_of_Alloc_Cols
Title: Order of Allocation Columns
Description: Specify the order in which columns will appear in the output results for allocation results.
Definition: Table(Allocation_Columns)(Choice(Allocation_Order_Num,2,0),Choice(Allocation_Order_Num,3,0),Choice(Allocation_Order_Num,1,0),Choice(Allocation_Order_Num,4,0))
NodeLocation: 1384,464,1
NodeSize: 64,40
WindState: 2,102,82,720,350
DefnState: 2,1350,41,501,447,0,DFNM
Aliases: FormNode Fo1544644445
TableCellDefault: Choice(Allocation_Order_Num,1,0)

FormNode Fo1544644445
Title: Order of Sequential Columns
Definition: 0
NodeLocation: 1384,516,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Order_of_Alloc_Cols

Variable Format_Allocat_Data
Title: Formatted Allocation Data
Units: MW-AC
Definition: INDEX orderedCols:=CopyIndex(SubIndex(Order_of_Alloc_Cols, @Allocation_Columns, Allocation_Columns));~
Flat_Allocation_Data[.Row=Allocation_Row_Num, .Col=orderedCols, @orderedCols=@Allocation_Text_Cols]
NodeLocation: 1464,368,1
NodeSize: 64,40
ValueState: 2,313,227,1410,681,0,MIDM
ReformVal: [Allocation_Text_Cols,Allocation_Row_Num]

Index Allocation_Text_Cols
Title: Allocation Text Columns
Definition: INDEX orderedCols:=CopyIndex(SubIndex(Order_of_Alloc_Cols, @Allocation_Columns, Allocation_Columns));~
VAR textParse:=FOR J:=@orderedCols DO (~
   IF IsHandle(Slice(orderedCols, J))~
   THEN Title of Slice(orderedCols, J)~
   ELSE Slice(orderedCols, J)~
);~
CopyIndex(textParse)
NodeLocation: 1368,176,1
NodeSize: 64,40
WindState: 2,-11,257,720,350
ValueState: 2,12,79,1235,511,0,MIDM
ReformVal: [Undefined,Self]

Index Allocation_Row_Num
Title: Allocation Row Number
Definition: CopyIndex(Flat_Allocation_Data.Row)
NodeLocation: 1368,264,1
NodeSize: 64,40

Text Te1574709838
Description: This should reflect periods near the peak demand month
NodeLocation: 88,260,-1
NodeSize: 72,52
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Variable Cumul_Sim_BESS_Fcst
Title: Cumul Sim BESS Forecast
Units: MW-AC
Definition: Sum(Replace_X_with_Y(BESS_Adoption_Data[BESS_Adopt_DataTypes=BESS_Cumul_MW_Label, Output_Periods=Period_for_CEC_Year, BESS_Spatial_ID=Spatial_ID], Null, 0) * (NOT All_Agg_Spatial_IDs[All_Spatial_ID=Spatial_ID]), Act_vs_Sim, BESS_Sectors)
NodeLocation: 248,736,1
NodeSize: 64,40
ValueState: 2,280,108,1470,741,0,MIDM
GraphSetup: Att_GraphIndexRange Spatial_ID:1,1~
Att_CatLineStyle Graph_Primary_Valdim:5
ReformVal: [CEC_Forecast_Years,Spatial_ID]
Att__TotalsIndex: [Spatial_ID]
Att_ResultSliceState: [CEC_Forecast_Years,10,Spatial_ID,1,Output_Periods,1]

Constant CEC_BESS_Forecast
Title: CEC BESS Forecast
Units: MW-AC
Description: EV forecasts from the CEC. These are coincident peak 1 in 2 (MW) impacts.~
~
Source:~
Corrected SDGE Load Modifiers Mid Baseline Mid AAEE/AAPV CEDU 2018 TN-226271 Submitted 1/7/2019.~
Source: https://ww2.energy.ca.gov/2018_energypolicy/documents/cedu_2018-2030/2018_loadmodifiers.php~
"TN226271_20190107T134813_Corrected SDGE Load Modifiers Mid Baseline Mid AAEECEDU 2018.xlsx"
Definition: Table(CEC_Forecast_Years)(0.4832917071807937,0.6440357209327358,0.7995986061543316,0.9508169075895673,1.0986826553403326,1.243963997686705,1.387110566061488,1.5282730239084712,1.6674894718736368,1.8048004304505127,1.9402321572213452)
NodeLocation: 400,840,1
NodeSize: 64,40
WindState: 2,542,530,993,350
DefnState: 2,600,351,1217,446,0,DFNM
ValueState: 2,138,364,416,548,0,MIDM
Aliases: FormNode Fo1579150417
ReformDef: [CEC_Forecast_Years,Undefined]

Variable Comp_Forecst_BESS
Title: Compare Forecast with CEC
Units: MW-AC
Definition: [CEC_BESS_Forecast,Sum(Cumul_Sim_BESS_Fcst,Spatial_ID)]
NodeLocation: 704,736,1
NodeSize: 64,40
NodeInfo: 1,1,1,1,1,1,0,0,0,0,,0,1,0
ValueState: 2,290,122,957,719,1,MIDM
GraphSetup: Att_GraphValueRange Comp_Forecst_BESS:1,,1,,,,,0,3.091017007827759,0~
Att_GraphIndexRange CEC_Forecast_Years:1,,1,,,,,2024.5518335700035,2024.6463787555695,0

Variable BESS_Forecast_Growth
Title: BESS Forecast Growth
Units: fraction
Description: The forecast growth between the first and final CEC year.
Definition: Comp_Forecst_BESS[CEC_Forecast_Years=Max(CEC_Forecast_Years)] / Comp_Forecst_BESS[CEC_Forecast_Years=Min(CEC_Forecast_Years)] - 1
NodeLocation: 856,736,1
NodeSize: 64,40
WindState: 2,102,82,1197,484
ValueState: 2,546,175,824,587,,MIDM
GraphSetup: Att_CatLineStyle Graph_Primary_Valdim:9
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15

Variable Incr_Sim_BESS_Fcst
Title: Increm Sim BESS Forecast
Units: MW-AC/year
Definition: IF CEC_Forecast_Years = Slice(CEC_Forecast_Years, 1)~
THEN Null~
ELSE Uncumulate(Cumul_Sim_BESS_Fcst, CEC_Forecast_Years)
NodeLocation: 400,736,1
NodeSize: 64,40
ValueState: 2,200,202,748,633,,MIDM

Variable Incr_CEC_EV_Forecst1
Title: Increm CEC BESS Forecast
Units: MW-AC/year
Definition: IF CEC_Forecast_Years = Slice(CEC_Forecast_Years, 1)~
THEN Null~
ELSE Uncumulate(CEC_BESS_Forecast, CEC_Forecast_Years)
NodeLocation: 400,960,1
NodeSize: 64,40
ValueState: 2,377,384,416,514,0,MIDM
Att__TotalsIndex: [PV_Spatial_ID]

Variable Alloc_CEC_BESS_Fcst
Title: Allocated CEC BESS Forecast
Units: MW-AC
Definition: VAR uncumul:=IF CEC_Forecast_Years = Slice(CEC_Forecast_Years, 1)~
   THEN CEC_BESS_Forecast * BESS_Allocat_by_Zip~
   ELSE Incr_CEC_EV_Forecst1 * BESS_Allocat_by_Zip;~
~
Cumulate(uncumul, CEC_Forecast_Years)
NodeLocation: 552,960,1
NodeSize: 64,40
ValueState: 2,479,3,1213,868,0,MIDM
ReformVal: [Null,CEC_Forecast_Years]
Att__TotalsIndex: [PV_Spatial_ID,EV_Spatial_ID,Spatial_ID]
Att_ResultSliceState: [Sel_Ag_EV_LRMS,1,Act_vs_Sim,1,Spatial_ID,0,CEC_Forecast_Years,1]

Variable BESS_Allocat_by_Zip
Title: BESS Allocation by Zip
Units: fraction
Definition: IF CEC_Forecast_Years = Slice(CEC_Forecast_Years, 1)~
THEN Divide(Cumul_Sim_BESS_Fcst, Sum(Cumul_Sim_BESS_Fcst, Spatial_ID), True)~
ELSE DIvide(Incr_Sim_BESS_Fcst, Sum(Incr_Sim_BESS_Fcst, Spatial_ID), True)
NodeLocation: 552,736,1
NodeSize: 64,40
ValueState: 2,513,51,1312,873,0,MIDM
ReformVal: [CEC_Forecast_Years,Spatial_ID]
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [Spatial_ID]
Att_ResultSliceState: [Spatial_ID,1,CEC_Forecast_Years,1]

FormNode Fo1579150417
Title: CEC EV Forecast
Definition: 0
NodeLocation: 400,884,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: CEC_BESS_Forecast

Decision BESS_Cumul_MW_Label
Title: BESS Cumul MW Label
Definition: Choice(BESS_Adopt_DataTypes,5,0)
NodeLocation: 248,832,1
NodeSize: 64,40
Aliases: FormNode Fo1579150418

FormNode Fo1579150418
Title: PV Cumul MW Label
Definition: 0
NodeLocation: 252,880,1
NodeSize: 68,16
NodeInfo: 1,0,0,0,0,0,0,102,0,,0,,,0
Original: BESS_Cumul_MW_Label

Variable EV_Growth_Multiplier
Title: EV Growth Multiplier
Definition: Comp_Forecst_EV[CEC_Forecast_Years=Max(CEC_Forecast_Years)] / Comp_Forecst_EV[CEC_Forecast_Years=Min(CEC_Forecast_Years)] 
NodeLocation: 856,520,1
NodeSize: 64,40
ValueState: 2,995,167,441,218,,MIDM

Index Forecast_Type
Att_PrevIndexValue: ['CEC','SDGE']
Title: Forecast Type
Definition: ['CEC','SDGE']
NodeLocation: 1040,872,1
NodeSize: 64,40

Variable Relative_Growth
Title: Relative Growth
Definition: Table(Forecast_Type)(CEC_BESS_Forecast,Sum(Cumul_Sim_BESS_Fcst,Spatial_ID))
NodeLocation: 1040,736,1
NodeSize: 64,40

Variable All_DER_Compare_with
Title: All DER Compare with CEC
Definition: Table(Output_DER_Types,Forecast_Type)(~
CEC_PV_Forecast,Sum(Cumul_Sim_PV_Forecst,Spatial_ID),~
CEC_EV_Forecast,Sum(Cumul_Sim_EV_Forecst,Spatial_ID),~
CEC_BESS_Forecast,Sum(Cumul_Sim_BESS_Fcst,Spatial_ID))
NodeLocation: 856,616,1
NodeSize: 64,40
DefnState: 2,1185,322,523,303,0,DFNM
ValueState: 2,298,156,878,432,1,MIDM
ReformDef: [Forecast_Type,Output_DER_Types]
ReformVal: [Output_DER_Types,Forecast_Type]

Variable Compare_Relative_For
Title: Compare Relative Forecasts
Units: dimensionless
Description: Fractional increase in cumulative adoption for each DER, for each forecast type.
Definition: All_DER_Compare_with/All_DER_Compare_with[@CEC_Forecast_Years=1]
NodeLocation: 1040,616,1
NodeSize: 64,40
ValueState: 2,495,86,986,746,,MIDM
GraphSetup: Att_GraphValueRange Compare_Relative_For:1,,1,,,,,0,10,0
ReformVal: [CEC_Forecast_Years,Forecast_Type]
Att_ResultSliceState: [Output_DER_Types,3,Forecast_Type,1,CEC_Forecast_Years,1]

Close CEC_Allocations

Variable Final_EV_Sim_Period
Title: Final EV Sim Period
Definition: StepInterp(Veh_Sim_End_Yr_Opt, Veh_Sim_End_Yr_Opt, Final_PV_Sim_Period, LeftLookup: True)
NodeLocation: 1744,584,1
NodeSize: 64,40

Alias Al1544645465
Title: Selected Allocation Data
Definition: 1
NodeLocation: 888,1080,1
NodeSize: 64,40
Original: Select_Allocat_Data

FormNode Fo1544825832
Title: Output Filename
Definition: 0
NodeLocation: 888,308,1
NodeSize: 232,20
NodeInfo: 1,,,,,,,238,,,,,
NodeColor: 49344,49344,49344
Original: Output_Filename

Decision SolarPV_Out_Label
Title: SolarPV Out Label
Definition: Choice(Output_DER_Types,3,0)
NodeLocation: 736,1584,1
NodeSize: 64,40
Aliases: FormNode Fo1544918127

FormNode Fo1544918127
Title: SolarPV Out Label
Definition: 0
NodeLocation: 740,1628,1
NodeSize: 108,12
NodeInfo: 1,0,0,0,0,0,0,166,0,,0,,,0
Original: SolarPV_Out_Label

FormNode Fo1544918161
Title: SolarPV Out Label
Definition: 0
NodeLocation: 732,1740,2
NodeSize: 108,12
NodeInfo: 1,0,0,0,0,0,0,166,0,,0,,,0
Original: EV_Out_Label

Decision EV_Out_Label
Title: EV Out Label
Definition: Choice(Output_DER_Types,2,0)
NodeLocation: 736,1696,1
NodeSize: 64,40
Aliases: FormNode Fo1544918161

Text Te1545005451
Description: We really need to perform a dimensionality check before exporting CSV or Excel data. 
NodeLocation: 1280,888,-1
NodeSize: 112,40
NodeInfo: 1,,,,,1
NodeColor: 65535,65533,52427

Function Export_Prep()
Title: Export Prep
Description: Prepares settings for exporting data. These settings apply regardless of the type of data being exported (e.g., CSV only, Excel files)
Definition: {Ensures the appropriate sectors are output to Excel}~
PV_Sectors:=Subset(Sectors_for_Export[All_DER_Types=PV_DER_Label]); ~
EV_Sectors:=Subset(Sectors_for_Export[All_DER_Types=EV_DER_Label]); ~
BESS_Sectors:=Subset(Sectors_for_Export[All_DER_Types=BESS_DER_Label]); ~
~
{Ensures the appropriate spatial IDs are output to Excel}~
(PV_Spatial_ID:=Spatial_ID);   ~
(EV_Spatial_ID:=Spatial_ID);   ~
(BESS_Spatial_ID:=Spatial_ID);   ~
~
Check_Export_Indices(Allowed_Indices_Exp, ExpVar_Index_Check);   {Check for extra dimensions in exported data}
NodeLocation: 1664,888,1
NodeSize: 64,40
WindState: 2,15,339,873,458

Decision Data_Export_Setting1
Title: Data Export Settings
Description: For csv files, the "Sheet Name" and "Data Start Cell" parameters are not required. If "Clear Before Writing?" is not selected for a csv file, then the data will be appended to the bottom of the csv file, rather than overwriting any existing data.
Definition: Table(Export_Parameter,Export_Dataset_Num)(~
Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),~
0,0,0,0,0,0,0,0,0,0,0,0,0,0,~
'Sequential historic then actual data','Calibration comparison','Deltas from base period','CEC Forecast by Zip','Timestamp','Deliverable sequential historic then actual data','Deliverable calibration comparison','Deliverable deltas from base period','Deliverable CEC Forecast by Zip','Deliverable timestamp','Sequential historic then actual data (CSV)','Calibration comparison (CSV)','Deltas from base period (CSV)','CEC Forecast by Zip (CSV)',~
Handle(Format_Sequent_Data),Handle(Format_Compare_Data),Handle(Format_Delta_Data),Handle(Format_Allocat_Data),Handle(Indexed_Timestamp),Handle(Format_Sequent_Data),Handle(Format_Compare_Data),Handle(Format_Delta_Data),Handle(Format_Allocat_Data),Handle(Indexed_Timestamp),Handle(Format_Sequent_Data),Handle(Format_Compare_Data),Handle(Format_Delta_Data),Handle(Format_Allocat_Data),~
Handle(Sequential_Row_Num),Handle(Comparison_Row_Num),Handle(Delta_Row_Num),Handle(Allocation_Row_Num),Handle(Dummy_Rows),Handle(Sequential_Row_Num),Handle(Comparison_Row_Num),Handle(Delta_Row_Num),Handle(Allocation_Row_Num),Handle(Dummy_Rows),Handle(Sequential_Row_Num),Handle(Comparison_Row_Num),Handle(Delta_Row_Num),Handle(Allocation_Row_Num),~
Handle(Sequential_Text_Cols),Handle(Comparison_Text_Cols),Handle(Delta_Text_Cols),Handle(Allocation_Text_Cols),Handle(Dummy_Cols),Handle(Sequential_Text_Cols),Handle(Comparison_Text_Cols),Handle(Delta_Text_Cols),Handle(Allocation_Text_Cols),Handle(Dummy_Cols),Handle(Sequential_Text_Cols),Handle(Comparison_Text_Cols),Handle(Delta_Text_Cols),Handle(Allocation_Text_Cols),~
Model_Path(Tableau_Output_File),Model_Path(Tableau_Output_File),Model_Path(Tableau_Output_File),Model_Path(Tableau_Output_File),Model_Path(Tableau_Output_File),Model_Path(Output_Filename),Model_Path(Output_Filename),Model_Path(Output_Filename),Model_Path(Output_Filename),Model_Path(Output_Filename),Model_Path('CSV Files\Sequential_Export.csv'),Model_Path('CSV Files\Comparison_Export.csv'),Model_Path('CSV Files\Deltas_Export.csv'),Model_Path('CSV Files\CEC_Forecast_Export.csv'),~
'Sequential','Comparison','Deltas','CEC Forecasts','Version History','Sequential','Comparison','Deltas','CEC','Contents',Null,Null,Null,Null,~
'A2','A2','A2','A2','B3','A3','A3','A3','A3','C18',Null,Null,Null,Null,~
Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(0),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(0),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1))
NodeLocation: 1480,1000,1
NodeSize: 64,40
WindState: 2,265,331,972,490
DefnState: 2,75,419,1785,493,0,DFNM
ReformDef: [Export_Parameter,Export_Dataset_Num]
TableCellDefault: Default_ExportConfig

Index Output_Data_Type
Att_PrevIndexValue: ['CSV Tableau','Excel Deliverable','Excel Tableau']
Title: Output Data Type
Description: A list of the types of data that can be output, for use in export scripts
Definition: ['CSV Tableau','Excel Deliverable','Excel Tableau']
NodeLocation: 1480,1096,1
NodeSize: 64,40

Decision Select_Data_Export_T
Title: Select Data Export Type
Description: Used by export scripts to determine which data should be exported.~
Choice(Output_Data_Type,1,0)
Definition: Choice(Output_Data_Type,2,0)
NodeLocation: 1480,888,1
NodeSize: 64,40
Aliases: FormNode Fo1552601603, FormNode Fo1878834685

Decision CSV_Tableau_Label
Title: CSV Tableau Label
Definition: Choice(Output_Data_Type,1,0)
NodeLocation: 1480,1176,1
NodeSize: 64,32
NodeInfo: 1,1,1,1,1,1,0,0,0,0,,0,1,0
Aliases: FormNode Fo1552601468

FormNode Fo1552601468
Title: CSV_Label
Definition: 0
NodeLocation: 1480,1208,1
NodeSize: 112,16
NodeInfo: 1,0,0,0,0,0,0,174,0,,0,,,
Original: CSV_Tableau_Label

FormNode Fo1552601603
Title: Select Data Export Type
Definition: 0
NodeLocation: 892,376,1
NodeSize: 236,16
NodeInfo: 1,,,,,,,174
Original: Select_Data_Export_T

Decision Excel_Deliv_Label
Title: Excel Deliv Label
Definition: Choice(Output_Data_Type,2,0)
NodeLocation: 1480,1264,1
NodeSize: 64,32
NodeInfo: 1,1,1,1,1,1,0,0,0,0,,0,1,0
Aliases: FormNode Fo1552601699

FormNode Fo1552601699
Title: CSV_Label
Definition: 0
NodeLocation: 1480,1296,1
NodeSize: 112,16
NodeInfo: 1,0,0,0,0,0,0,174,0,,0,,,
Original: Excel_Deliv_Label

Decision Excel_Tableau_Label
Title: Excel Tableau Label
Definition: Choice(Output_Data_Type,3,0)
NodeLocation: 1480,1352,1
NodeSize: 64,32
NodeInfo: 1,1,1,1,1,1,0,0,0,0,,0,1,0
Aliases: FormNode Fo1552601721

FormNode Fo1552601721
Title: CSV_Label
Definition: 0
NodeLocation: 1480,1384,1
NodeSize: 112,16
NodeInfo: 1,0,0,0,0,0,0,174,0,,0,,,
Original: Excel_Tableau_Label

Button Write_to_Excel
Title: Write to Excel
Description: Exports data to an Excel file. Only one scenario can be selected and exported at a time.~

NodeLocation: 984,484,1
NodeSize: 96,20
WindState: 2,102,59,1068,600
OnClick: Export_Prep();~
Set_Type_of_Export(Excel_Deliv_Label);~
Run_Data_Export

Function Set_Type_of_Export(DataType)
Title: Set Type of Export Data
Definition: (Select_Data_Export_T:=DataType)
NodeLocation: 1664,992,1
NodeSize: 64,40

Index Indices_for_Export
Att_PrevIndexValue: ['Index 1','Index 2','Index 3','Index 4','Index 5','Index 6','Index 7']
Title: Indices for Export
Definition: INDEX seq:=1..7;~
CopyIndex("Index " & seq)
NodeLocation: 1296,1624,1
NodeSize: 64,40

Index ExpVar_Index_Check
Att_PrevIndexValue: [Sel_Sequential_Data,Sel_Compare_Data,Selected_Delta_Data,Select_Allocat_Data]
Title: Export Vars for Index Check
Description: A list of handles to variables that will be exported and must have a pre-defined collection of indices to ensure Excel and Tableau compatibility.
Definition: [Sel_Sequential_Data,Sel_Compare_Data,Selected_Delta_Data,Select_Allocat_Data]
NodeLocation: 1152,1624,1
NodeSize: 64,40
WindState: 2,760,84,720,350
Aliases: FormNode Fo1556568223
MetaOnly: 1

Decision Allowed_Indices_Exp
Title: Allowed Indices for Export Vars
Description: Specify the allowed indices for each of the export variables that must follow a pre-defined structure for Excel and/or Tableau compatibility.
Definition: Table(Indices_for_Export,ExpVar_Index_Check)(~
Handle(All_Sectors),Handle(All_Sectors),Handle(All_Sectors),Handle(CEC_Forecast_Years),~
Handle(Spatial_ID),Handle(Spatial_ID),Handle(Spatial_ID),Handle(Spatial_ID),~
Handle(Sequential_Outputs),Handle(Comparison_Outputs),Handle(Delta_Outputs),Handle(Output_DER_Types),~
Handle(Act_vs_Sim),Handle(Act_vs_Sim),Handle(Act_vs_Sim),Null,~
Handle(Output_Periods),Handle(Output_Periods),Handle(Delta_Output_Periods),Null,~
Handle(Output_DER_Types),Handle(Output_DER_Types),Handle(Output_DER_Types),Null,~
Null,Null,Handle(Installation_Type),Null)
NodeLocation: 1152,1496,1
NodeSize: 64,40
DefnState: 2,276,158,1273,260,0,DFNM
ValueState: 2,532,538,1021,384,,MIDM
Aliases: FormNode Fo1556568212
ReformDef: [Indices_for_Export,ExpVar_Index_Check]
TableCellDefault: Null

Function Create_Index_Warning(indHandles; varHandles: INDEX)
Title: Create Export Index Warnings
Description: Checks the list of export variables (varHandles) to ensure that they only have the indices included in indHandles. If any unwanted indices are present, this will return a textual warning message.~
~
[indHandles]: a table indexed by varHandles that includes handles to indices belonging to the variables specified in varHandles.~
[varHandles]: a list of handles to variables that are exported.
Definition: FOR J:=@varHandles DO (~
   LocalAlias currentVar:=Slice(varHandles, J);~
   INDEX allowedInd:=CopyIndex(indHandles[@varHandles=J]);~
   INDEX expectedInd:=Subset(allowedInd <> Null);~
   INDEX simulationInd:=IndexesOf(currentVar);~
   VAR equalSets:=SetsAreEqual([\expectedInd, \simulationInd]);~
   IF equalSets~
   THEN Null~
   ELSE (VAR setDiff:= SetDifference(\simulationInd, \expectedInd);~
             VAR varTitle:=Title of currentVar;~
             INDEX diff_handles:=CopyIndex(#setDiff);~
             VAR diff_titles[]:=Title of diff_handles;   ~
             INDEX title_ind:=CopyIndex(diff_handles);~
            VAR joinDiff:=JoinText(title_ind, title_ind, ", ");~
             "Warning: the results for " & varTitle & " include extra dimensionality (e.g., " & joinDiff & ") and cannot be exported. Ensure that no scenario options are set to 'All', as only one scenario can be exported at a time."~
             )~
)~

NodeLocation: 1440,1624,1
NodeSize: 64,40
WindState: 2,24,159,720,609

Variable Export_Index_Warning
Title: Export Index Warnings
Definition: Create_Index_Warning(Allowed_Indices_Exp, ExpVar_Index_Check)
NodeLocation: 1296,1496,1
NodeSize: 64,40
ValueState: 2,82,389,990,345,0,MIDM

Function Check_Export_Indices(indHandles; varHandles: INDEX)
Title: Check Export Indices
Description: Checks the list of export variables (varHandles) to ensure that they only have the indices included in indHandles. If any unwanted indices are present, this will return a textual warning message.~
~
[indHandles]: a table indexed by varHandles that includes handles to indices belonging to the variables specified in varHandles.~
[varHandles]: a list of handles to variables that are exported.
Definition: VAR warnings:=Create_Index_Warning(indHandles, varHandles);~
VAR errorDetected:=warnings <> Null;~
IF Sum(errorDetected, varHandles) = 0~
THEN Null~
ELSE FOR J:=@varHandles DO (~
   Error(warnings[@varHandles=J])~
 )
NodeLocation: 1440,1496,1
NodeSize: 64,40
WindState: 2,24,159,720,609

Text Te1556568172
Title: Index Checking for Exported Results
NodeLocation: 1300,1560,-1
NodeSize: 236,144
NodeInfo: 1,0,0,1,1,1,1,,0,,0,,,
NodeColor: 65535,65535,65535
NodeFont: Arial Narrow,16

FormNode Fo1556568212
Title: Allowed Indices for Export Vars
Definition: 0
NodeLocation: 1160,1548,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Allowed_Indices_Exp

FormNode Fo1556568223
Title: Export Vars for Index Check
Definition: 0
NodeLocation: 1160,1676,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: ExpVar_Index_Check

Index Output_Periods
Att_PrevIndexValue: [28-Feb-2012,31-Mar-2012,30-Apr-2012,31-May-2012,30-Jun-2012,31-Jul-2012,31-Aug-2012,30-Sep-2012,31-Oct-2012,30-Nov-2012,31-Dec-2012,31-Jan-2013,28-Feb-2013,31-Mar-2013,30-Apr-2013,31-May-2013,30-Jun-2013,31-Jul-2013,31-Aug-2013,30-Sep-2013,31-Oct-2013,30-Nov-2013,31-Dec-2013,31-Jan-2014,28-Feb-2014,31-Mar-2014,30-Apr-2014,31-May-2014,30-Jun-2014,31-Jul-2014,31-Aug-2014,30-Sep-2014,31-Oct-2014,30-Nov-2014,31-Dec-2014,31-Jan-2015,28-Feb-2015,31-Mar-2015,30-Apr-2015,31-May-2015,30-Jun-2015,31-Jul-2015,31-Aug-2015,30-Sep-2015,31-Oct-2015,30-Nov-2015,31-Dec-2015,31-Jan-2016,28-Feb-2016,31-Mar-2016,30-Apr-2016,31-May-2016,30-Jun-2016,31-Jul-2016,31-Aug-2016,30-Sep-2016,31-Oct-2016,30-Nov-2016,31-Dec-2016,31-Jan-2017,28-Feb-2017,31-Mar-2017,30-Apr-2017,31-May-2017,30-Jun-2017,31-Jul-2017,31-Aug-2017,30-Sep-2017,31-Oct-2017,30-Nov-2017,31-Dec-2017,31-Jan-2018,28-Feb-2018,31-Mar-2018,30-Apr-2018,31-May-2018,30-Jun-2018,31-Jul-2018,31-Aug-2018,30-Sep-2018,31-Oct-2018,30-Nov-2018,31-Dec-2018,31-Jan-2019,28-Feb-2019,31-Mar-2019,30-Apr-2019,31-May-2019,30-Jun-2019,31-Jul-2019,31-Aug-2019,30-Sep-2019,31-Oct-2019,30-Nov-2019,31-Dec-2019,31-Jan-2020,28-Feb-2020,31-Mar-2020,30-Apr-2020,31-May-2020,30-Jun-2020,31-Jul-2020,31-Aug-2020,30-Sep-2020,31-Oct-2020,30-Nov-2020,31-Dec-2020,31-Jan-2021,28-Feb-2021,31-Mar-2021,30-Apr-2021,31-May-2021,30-Jun-2021,31-Jul-2021,31-Aug-2021,30-Sep-2021,31-Oct-2021,30-Nov-2021,31-Dec-2021,31-Jan-2022,28-Feb-2022,31-Mar-2022,30-Apr-2022,31-May-2022,30-Jun-2022,31-Jul-2022,31-Aug-2022,30-Sep-2022,31-Oct-2022,30-Nov-2022,31-Dec-2022,31-Jan-2023,28-Feb-2023,31-Mar-2023,30-Apr-2023,31-May-2023,30-Jun-2023,31-Jul-2023,31-Aug-2023,30-Sep-2023,31-Oct-2023,30-Nov-2023,31-Dec-2023,31-Jan-2024,28-Feb-2024,31-Mar-2024,30-Apr-2024,31-May-2024,30-Jun-2024,31-Jul-2024,31-Aug-2024,30-Sep-2024,31-Oct-2024,30-Nov-2024,31-Dec-2024,31-Jan-2025,28-Feb-2025,31-Mar-2025,30-Apr-2025,31-May-2025,30-Jun-2025,31-Jul-2025,31-Aug-2025,30-Sep-2025,31-Oct-2025,30-Nov-2025,31-Dec-2025,31-Jan-2026,28-Feb-2026,31-Mar-2026,30-Apr-2026,31-May-2026,30-Jun-2026,31-Jul-2026,31-Aug-2026,30-Sep-2026,31-Oct-2026,30-Nov-2026,31-Dec-2026,31-Jan-2027,28-Feb-2027,31-Mar-2027,30-Apr-2027,31-May-2027,30-Jun-2027,31-Jul-2027,31-Aug-2027,30-Sep-2027,31-Oct-2027,30-Nov-2027,31-Dec-2027,31-Jan-2028,28-Feb-2028,31-Mar-2028,30-Apr-2028,31-May-2028,30-Jun-2028,31-Jul-2028,31-Aug-2028,30-Sep-2028,31-Oct-2028,30-Nov-2028,31-Dec-2028,31-Jan-2029,28-Feb-2029,31-Mar-2029,30-Apr-2029,31-May-2029,30-Jun-2029,31-Jul-2029,31-Aug-2029,30-Sep-2029,31-Oct-2029,30-Nov-2029,31-Dec-2029,31-Jan-2030,28-Feb-2030,31-Mar-2030,30-Apr-2030,31-May-2030,30-Jun-2030,31-Jul-2030,31-Aug-2030,30-Sep-2030,31-Oct-2030,30-Nov-2030,31-Dec-2030,31-Jan-2031,28-Feb-2031,31-Mar-2031,30-Apr-2031,31-May-2031,30-Jun-2031,31-Jul-2031,31-Aug-2031,30-Sep-2031,31-Oct-2031,30-Nov-2031,31-Dec-2031]
Title: Output Periods
Description: Ths is the time index used for simulating vehicle adoption. It is allowed to be different from other DERs, for instance, due to differences in the granularity of available historical data on adoption (e.g., solar PV data are monthly, whereas vehicle data are, at best, quarterly, or in some cases, annual)
Definition: INDEX beginOfPeriod:=Sequence(Output_Start_Period, Output_End_Period,step: Timestep_Months[Timestep_Options=Output_dT_Choice],dateUnit: 'M');~
VAR months:=DatePart(beginOfPeriod, 'M');~
VAR years:=DatePart(beginOfPeriod, 'Y');~
VAR days:=Floor(Days_Per_Month[@Month=months]);~
CopyIndex(MakeDate(years, months, days))
NodeLocation: 248,1416,1
NodeSize: 64,40
WindState: 2,13,63,1168,700
ValueState: 2,859,158,300,585,0,MIDM
NumberFormat: 2,F,4,4,0,0,4,0,$,0,"SHORT",0,,,0,0,15
Att_GraphIndexRange: 1,,,,,,10
{!40300|Att_SlicerPopupSize: 477,742}

Constant Output_Start_Period
Title: Output Start Period
Description: The start period for the output horizon.~
~
Choice(Time,1,0)
Definition: Choice(Time,122,0)
NodeLocation: 248,1080,1
NodeSize: 64,40
ValueState: 2,795,362,320,151,,MIDM
Aliases: FormNode Fo1542347298, Alias Al1550771680, FormNode Fo1550771684

Constant Output_End_Period
Title: Output End Period
Description: The end period for the output horizon.
Definition: Choice(Time,600,0)
NodeLocation: 248,1192,1
NodeSize: 64,40
WindState: 2,501,236,909,580
ValueState: 2,955,360,416,303,,MIDM
Aliases: FormNode Fo1542347299, Alias Al1550771681, FormNode Fo1550771685, FormNode Fo1545071279, FormNode Fo1686057469
NumberFormat: 2,I,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15

Constant Output_dT_Choice
Title: Output dT Choice
Description: The timestep for the output horizon.
Definition: Choice(Timestep_Options,1,0)
NodeLocation: 248,1304,1
NodeSize: 64,40
WindState: 2,837,82,720,350
Aliases: FormNode Fo1542347300, Alias Al1550771683, FormNode Fo1550771687

Index Output_Periods_Plus
Title: Output Periods Plus One
Definition: VAR pos:= positionInIndex(Time, Output_Period_Map[@Output_Periods=1], Time);~
VAR lookback:=Slice(Time, pos -Timestep_Months[Timestep_Options=Output_dT_Choice]);~
VAR months:=DatePart(lookback, 'M');~
VAR years:=DatePart(lookback, 'Y');~
VAR days:=Floor(Days_Per_Month[@Month=months]);~
VAR startDate:=MakeDate(years, months, days);~
~
Concat(startDate, Output_Periods)
NodeLocation: 248,1504,1
NodeSize: 64,40
ValueState: 2,131,165,416,487,0,MIDM
{!40300|Att_SlicerPopupSize: 227,1001}

FormNode Fo1542347298
Title: Output Start Period
Definition: 0
NodeLocation: 260,1128,1
NodeSize: 84,16
NodeInfo: 1,0,0,0,0,0,0,134,0,,0,,,0
Original: Output_Start_Period

FormNode Fo1542347299
Title: Output End Period
Definition: 0
NodeLocation: 260,1240,1
NodeSize: 84,16
NodeInfo: 1,0,0,0,0,0,0,134,0,,0,,,
Original: Output_End_Period

FormNode Fo1542347300
Title: Output dT Choice
Definition: 0
NodeLocation: 248,1352,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,
Original: Output_dT_Choice

Variable Output_Period_Map
Title: Output Period Map
Definition: VAR months:=DatePart(Output_Periods, 'M');~
VAR years:=DatePart(Output_Periods, 'Y');~
~
MakeDate(years, months, 1);
NodeLocation: 248,1592,1
NodeSize: 64,40
ValueState: 2,798,39,555,722,0,MIDM

Variable Output_Prd_Plus_Map
Title: Output Period Plus One Map
Definition: VAR months:=DatePart(Output_Periods_Plus, 'M');~
VAR years:=DatePart(Output_Periods_Plus, 'Y');~
~
MakeDate(years, months, 1);
NodeLocation: 248,1680,1
NodeSize: 64,40
ValueState: 2,333,24,552,769,0,MIDM

Variable Equal_Prd_Output_Map
Title: Equal Period Output Time Map
Description: A mapping of output time to equal period monthly estimates.
Definition: Equal_Prd_Time_Map[Time=Output_Prd_Plus_Map]
NodeLocation: 248,1768,1
NodeSize: 64,40
ValueState: 2,76,27,1802,803,0,MIDM

Variable Equal_Prd_by_Qtr_Map
Title: Equal Period by Qtr Map
Description: A mapping of output time to equal period monthly estimates within each quarter.
Definition: Equal_Prd_in_Qtr_Map[Time=Output_Prd_Plus_Map]
NodeLocation: 248,1856,1
NodeSize: 64,40
WindState: 2,98,82,880,423
ValueState: 2,230,2,416,689,0,MIDM

Variable Calib_Start_Period
Title: Calibration Start Period
Description: The earliest calibration start period across all DERs.
Definition: MIN([BESS_CalStart_Minus1, PV_Cal_Start_Plus_1, EV_CalStart_Minus1]) 
NodeLocation: 1456,776,1
NodeSize: 64,40
WindState: 2,10,12,720,350

Variable Calib_End_Period
Title: Calibration End Period
Description: The latest calibration end period across all DERs.
Definition: VAR endDate:=MAX([BESS_TimeOpt_EOP_Map[BESS_Sim_Strt_Yr_Opt=BESS_Calibration_End], PV_Calibration_End, EV_Time_EOP_Map[Time_Vehicles=EV_Calibration_End]]);~
StepInterp(Time, Time, endDate, LeftLookup: True)
NodeLocation: 1600,776,1
NodeSize: 64,40
WindState: 2,10,12,720,350
ValueState: 2,573,394,416,303,,MIDM

Text Te1579726717
Title: Step 1 -- Run calibration comparisons
NodeLocation: 320,68,-1
NodeSize: 280,52
NodeInfo: 1,0,0,1,1,1,1,,0,,0,,,
NodeColor: 65535,65535,65535
NodeFont: Arial Narrow,16

Text Te1579726772
Title: Step 2 -- Run forecasts
NodeLocation: 320,180,-1
NodeSize: 280,52
NodeInfo: 1,0,0,1,1,1,1,,0,,0,,,
NodeColor: 65535,65535,65535
NodeFont: Arial Narrow,16

Decision Sectors_for_Export
Title: Sectors for Export
Definition: Table(All_Sectors,All_DER_Types)(~
Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),~
Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),~
Checkbox(0),Checkbox(1),Checkbox(0),Checkbox(0),Checkbox(0))
NodeLocation: 1664,1096,1
NodeSize: 64,40
DefnState: 2,292,298,980,460,0,DFNM
Aliases: FormNode Fo1579728179
TableCellDefault: Checkbox(0)

FormNode Fo1579728179
Title: Sectors for Export
Definition: 0
NodeLocation: 1664,1148,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Sectors_for_Export

Close Outputs_for_Tableau

