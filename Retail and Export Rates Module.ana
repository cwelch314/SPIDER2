{ From user JamesMilford, Model Retail_and_Export_Ra at 8-Jan-2019 4:29:28 PM, encoding="UTF-8" }
SoftwareVersion 5.1.6



LinkModule Retail_and_Export_Ra
Title: Retail and Export Rates
Author: JamesMilford
Date: Wed, Aug 8, 2018 7:49 AM
SaveAuthor: JamesMilford
SaveDate: Tue, Jan 8, 2019 4:29 PM
DefaultSize: 64,40
NodeSize: 80,56
DiagState: 2,392,437,778,372,17
Pict: (000000000010003A004A0004AF06000089504E470D0A1A0A0000000D494844520000005A0000005A080600000038A84102000000017352474200AECE1CE90000000467414D410000B18F0BFC6105000000097048597300000EC300000EC301C76FA8640000063449444154785EED97CBB1E4441045C70CDCC0036CC007ECC00036B3C300B658C08615C1820D3ECC062BA6D1159DCD5556565566FDA4D7A113712366D4D552D6512A5BEFD3E36609B7E845DCA217718B5EC42D7A11B7E845DCA217718B5EC4E5447FFDF2C77FF9F3A7C7D75FBFFF3F9FBFB183CFB0F699AB72BAE897D892CC965C4CFC69A2A7C8CDE502C2978A0ECBC55A351ACC78CEB9AD3B9325A25D8245EAB6B687977C7DFE77176D6E5A22DDDA29D7425FF76CA689DEBB98367AC880CEAD71B8DEC9DD0CA688CE76F102C120B97E45F46BFDC41B3254F4DEC590C99B44160916F4F54B24376552ADC344EF92B960C9C42EB148C455AE9FAC777E2FCA10D166B18BBB58D0B5D4E0B54906CAEE169D937C16873A2AA292DAADBD0C92DD257A66612D58E24A586B67EDA959F4AC827AD0F59448EAA7DA67ECAD49B4F9C377B6E482380BBD5E939C0FE9F8CD6913AD0B385932A889D3F0DA5CFD96EC56C2A2938B5F403288D4A4F75022D96FE30F7D48F4A88B8E26A9AB263AB016ECAFAAC1EF6862A2F962C809EFC916BAAE12D19B221CBE8304F7EE16DD5AE06CA275E9F55E921780E0D3EC129D6CA67364FCF5CFEF8F6F7FF9B4E7E7BF7F7C1E6D232A8ED7D66E8A26192181AE6E13DD393244B2A487435D1571D19BA2E9E9EAEA2E13C9C12EB018253ADA00878E6CDC47F49A4258F4088689A6BA6ADD6575E37EAC120B7D1E0F75D17CD2CE6EC66CFEE1B7EF12D12D733AE9AC4A6DC97A6F0C91872703C9DC10A6283A29CE71C21C96609D88705D5B0D5E1B8EDAF7DEEDFCB9A3ABCBA28327B3C875712E58EBE1505BA59B4173476FB13874758FE8E4AE39366311912CA9C98E7633B3EF2B173D1290EDB8C5BEDEB14EC88BEED88C8051A005F23BB404E81B521A235C576B0368CC8EAF9CFBB0B6D2D579D1C147C322278E8F2382968D9BA2493A6980E816C920E2282F3A78518DEE66868FF367BADBADAE4EA4E0FF85D4D8D7F1F99EE7F4A0BF5BC2141D9D3F16DC9D5A18CB4418FE1EFEAD39D4E549A1F61EC920E2C9161DB8533958644474E9494836E649465CAF64C1FBFD25A2F5ACE5CF10468F0F8D29A81463F3E60D6B900CBC73DA161D18F2395856A4A3818C0F6B46D778D5FD8C66A464304E746311A5592BC72516D61B478DA4DB55EDA325833ED1030AD12380C5F1716414874D6FD1F0677B0A62BCE89B9B639A68A0858A6C7D7C0449B7EA6E56376184647009D1FA0D02B18E8D406F98EB9E25195C4234E0599D4BCB8F9EE650F31621914C9F8DE032A281D5C5565A85EBCD4ACDC971641B3123E913CD5D30403498295B77ED7E6C8164304EF4C07906F4DB8815EB4FEF1CD68FE02AC9E070AD82ABE5A281168B2ED6B3DCDBD98954AE5D324932F0BAAA8BDE321A168A085AB607AED3CC762366E2BD962D5A3D8EA361992CB4F4478E85392238932503EFF55CA25B1FBD9C28968930DCD5B5596D8E09C90AC9014FD9E7F3708286A2E52DC3922522258C7E3BC9916C92B34032C075F8BA25F2A29D433E07CBD29DCD9F218C1E1F39F4265F592419441CE54507EE9605CBD26F10FC19C2B83B9A6A7B65A16410B9765E74E79C2ECD5A1689302C3A37A3CD6E5E2D59D7D02A1AF48C0FDD993C3EF838C2F071FD240887BA1C9B9C81165DC32F1A0974B59EB5DC9D7C1C11F829E0E39A9E0618C5C18BE3469745EBF111DC9416271DCAC710DC94DCDA1C7B4705C7D92874377BEA288A063D5D0DB4404FB8FBAFC8C1C7160F75D19D5D6D756B299797ACBBD93136405534E8ED6AA07F1CAD5C5D323878D8E2C527BAB3AB05C8B6844330BF955C95D66E062ED16044570B5AF447A04732F08BD65D8D34CAFE90A23BF71EDA6572571B47C84713DDDBCD20BCCB6484345C94E774ED7DF96C463557533B1D2E8C34C8FE08249291C671D926DA9AD76F26DB94DCB1C7E60139BA902B31A391BA7E89DE51F6AC3D758906EF247BE65EBA4503B340BC9D34FE709C41F236850C6C9821A281297B70B13330E7F184BA87890625D957EBEE5DB0D5C5C8845A878A16AEDCDDBBE05C7D13C7DD14D120BB19E4840E2F763032B909A689168AC2B1F1C91BAC0A9ED8C5CC74D160975D128E3CA5F78A7F892DC945160916968816760935E11C929F8D472A67B16061A968E625C992313A4FB96708164E13CDBCBAD392D41AC8C5394F94CB5C4234F31A2F1208CB75BE7C4652AF22567339D1EFCA2D7A11B7E845DCA297F078FC0B2974BAFDB7801CB40000000049454E44AE426082)
FontStyle: Arial Narrow,19
FileInfo: 0,LinkModule Retail_and_Export_Ra,2,2,0,0,Retail and Export Rates Module.ana

Module Filter_USURDB_Data
Title: Filter USURDB Data
Description: Concat(Fact_Cols_for_Dim[Result_Dimensions=Selected_Result_Lvls], Numeric_Flat_Data, Selected_Result_Lvls, Numeric_Columns, Fact_and_Value_Cols)
Author: JMILFORD
Date: Fri, Oct 9, 2015 12:52 AM
SaveAuthor: JMILFORD
SaveDate: Tue, Oct 20, 2015 9:21 AM
DefaultSize: 56,32
NodeLocation: 280,104,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,0,0,,0,,,0
DiagState: 2,639,60,1060,638,17
DiagramColor: 65535,65535,65535
FontStyle: Arial,13

Decision None_Label
Title: None Label
Description: The "None" label in the Filter1 Indexes index.
Definition: "None"
NodeLocation: 400,368,1
NodeSize: 56,32

Decision Separator
Title: Separator
Description: A character used to separate the subscripts.
Definition: " | "
NodeLocation: 272,368,1
NodeSize: 56,32
DisplayOutputs: Index Histogram_Outputs

Index Filtered_USURDB_Rows
Title: Filtered USURDB Rows
Description: The rows corresponding to the filter selections.
Definition: [35863,40203,44336,45412,27671,34900,30129,4195,40183,44320,45413,8078,34892,28547,39580,40186,44324,45416,26074,34899,7031,39487,40184,44322,45414,21979,34897,15516,39488,40185,44323,45415,45404,45408,45407,45411,45406,45410,45405,45409]
NodeLocation: 424,272,1
NodeSize: 56,32

Variable Filtered_USURDB_Data
Title: Filtered USURDB Data
Description: The USURDB database filtered by the user's filter selections.
Definition: USURDB_Data[All_USURDB_Rows=Rows_for_Rate_Names]
NodeLocation: 736,160,1
NodeSize: 64,40
WindState: 2,3,5,720,350
ValueState: 2,40,42,1301,648,,MIDM
ReformVal: [Null,USURDB_Columns]
Att_ResultSliceState: [Rate_Names,1,USURDB_Columns,1]

Decision Rate_Name_Label
Title: Rate Name Label
Definition: Choice(USURDB_Columns,3,0)
NodeLocation: 128,160,1
NodeSize: 64,40
Aliases: FormNode Fo1533744780
{!40200|Att_ChoiceIndexes: Index USURDB_Columns}

FormNode Fo1533744780
Title: Tier Label
Definition: 0
NodeLocation: 128,212,1
NodeSize: 64,12
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,0
Original: Rate_Name_Label

Variable Rows_for_Rate_Names
Title: Rows for Rate Names
Description: The USURDB row number for the filtered rate names.
Definition: SubIndex(Rate_Names_and_Dates, Rate_Names, Filtered_USURDB_Rows)
NodeLocation: 584,160,1
NodeSize: 64,40
WindState: 2,716,118,1025,491
ValueState: 2,136,138,471,636,,MIDM

Variable Filtered_Rate_Names
Title: Filtered Rate Names
Description: The USURDB row number for the filtered rate names.
Definition: USURDB_Data[All_USURDB_Rows=Filtered_USURDB_Rows, USURDB_Columns=Rate_Name_Label]
NodeLocation: 280,160,1
NodeSize: 64,40
WindState: 2,716,118,1025,491
ValueState: 2,136,138,471,636,,MIDM

Variable Filtered_Start_Dates
Title: Filtered Start Dates
Description: Start dates (year - month) for each rate.
Definition: VAR date:=USURDB_Data[All_USURDB_Rows=Filtered_USURDB_Rows, USURDB_Columns=Start_Date_Label];~
VAR year:=DatePart(date, 'Y');~
VAR month:=DatePart(date, 'M');~
month:=IF month < 10 ~
   THEN 0 & month ~
   ELSE month;~
~
year & "-" & month
NodeLocation: 280,272,1
NodeSize: 64,40
WindState: 2,670,329,1025,491
ValueState: 2,136,38,455,759,,MIDM
NumberFormat: 2,D,4,4,0,0,4,0,$,0,"yyyy-MM",0,,,0,0,15
{!40700|Att_CellFormat: Undefined}

Decision Start_Date_Label
Title: Start Date Label
Definition: Choice(USURDB_Columns,4,0)
NodeLocation: 128,272,1
NodeSize: 64,40
Aliases: FormNode Fo1539730363
{!40200|Att_ChoiceIndexes: Index USURDB_Columns}

FormNode Fo1539730363
Title: Tier Label
Definition: 0
NodeLocation: 128,324,1
NodeSize: 64,12
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,0
Original: Start_Date_Label

Variable Rate_Names_and_Dates
Title: Rate Names and Dates
Definition: Filtered_Rate_Names & Separator & Filtered_Start_Dates
NodeLocation: 432,160,1
NodeSize: 64,40
ValueState: 2,552,285,416,572,,MIDM
NumberFormat: 2,F,4,4,0,0,4,0,$,0,"yyyy-MM",0,,,0,0,15

Close Filter_USURDB_Data

Module Find_Periods_Tiers
Title: Find Periods & Tiers
Author: JamesMilford
Date: Wed, Aug 8, 2018 1:55 PM
NodeLocation: 432,104,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,240,45,841,417,17

Decision Tier_Period_Labels
Title: Tier & Period Labels
Description: Select USURDB columns that include data specific to different tiers and periods. These are used to define the tier and period indices.
Definition: Table(USURDB_Columns)(Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(0),Checkbox(0))
NodeLocation: 120,200,1
NodeSize: 64,40
DefnState: 2,120,12,529,652,,DFNM
Aliases: FormNode Fo1533739282
TableCellDefault: Checkbox(0)

FormNode Fo1533739282
Title: Period Label
Definition: 0
NodeLocation: 120,256,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,
Original: Tier_Period_Labels

Variable Tier_Period_Data
Title: Tier & Period Data
Description: USURDB data that is differentiated by tier and period.
Definition: Filtered_USURDB_Data[USURDB_Columns=Tier_Period_Column]
NodeLocation: 272,200,1
NodeSize: 64,40
ValueState: 2,184,13,1045,674,,MIDM

Variable NonNull_TiersPeriods
Title: Non-Null Tiers & Periods
Description: A list of data entries (differentiated by tier and periods) that are populated in the USURDB.
Definition: VAR flags:=Sum(Tier_Period_Data <> NULL, Rate_Names);~
Subset(flags)
NodeLocation: 424,200,1
NodeSize: 64,40
ValueState: 2,84,26,410,400,,MIDM

Variable Find_Valid_TiersPrds
Title: Find Valid Tiers and Periods
Description: Returns references to lists of periods and tiers for which data is populated in the USURDB.
Definition: Parse_USURDB_Columns(NonNull_TiersPeriods, Period_String, Tier_Period_Separat, Data_Attribute)
NodeLocation: 576,200,1
NodeSize: 64,40
ValueState: 2,344,88,1120,561,,MIDM
ReformVal: [Sys_LocalIndex('subscripts'),NonNull_TiersPeriods]

Function Parse_USURDB_Columns(colLabels, periodStr, sepStr: Text; excludeStr: Index)
Title: Parse USURDB Columns
Description: This finds the unique periods and tiers included in the USURDB data.~
~
colLabels: the column header labels associated with data differentiated by tiers and periods~
periodStr: the text string for periods~
sepStr: the text string used to separate components of the column header labels (eg, '/')~
excludeStr: a list of text strings used to differentiate the data types (eg, 'rate', 'max', etc.)
Definition: colLabels:=SelectText(colLabels, FindInText(periodStr, colLabels));   {Remove string describing structure identification}~
FOR J:=excludeStr DO (   {For each excluded string}~
  colLabels:=TextReplace(colLabels, J, "")   {Remove the string from the column labels}~
);~
~
INDEX subscripts:=['periods', 'tiers'];~
VAR components:=SplitText(colLabels, sepStr, resultIndex: subscripts);   {Split the strings into their period and tier components}~
~
FOR J:=subscripts DO (~
  INDEX all_vals:=CopyIndex(components[subscripts=J]);   {Turn the Jth component column into an index}~
  INDEX uniq_vals:=Unique(all_vals, all_vals);   {Find the unique elements}~
  \SortIndex(uniq_vals)   {Sort the unique elements alphabetically and return a reference to the index}~
) 
NodeLocation: 584,296,1
NodeSize: 64,40
WindState: 2,44,17,798,395

Decision Period_String
Title: Period String
Description: The text string indicating the period designation within USURDB column headers.
Definition: 'period'
NodeLocation: 520,96,1
NodeSize: 64,40
Aliases: FormNode Fo1533754084

Decision Tier_Period_Separat
Title: Tier & Period Separator
Description: The text string separating the period and tier designations within USURDB column headers.
Definition: '/'
NodeLocation: 664,96,1
NodeSize: 64,40
Aliases: FormNode Fo1533754078

FormNode Fo1533754078
Title: Tier & Period Separator
Definition: 0
NodeLocation: 664,40,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,0
Original: Tier_Period_Separat

FormNode Fo1533754084
Title: Period String
Definition: 0
NodeLocation: 520,40,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,
Original: Period_String

Close Find_Periods_Tiers

Module Import_USURDB_Data
Title: Import USURDB Data
Author: JamesMilford
Date: Wed, Aug 8, 2018 1:55 PM
NodeLocation: 128,104,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,250,29,784,376,17

Decision USUDRB_Path
Title: USUDRB Path
Description: The file path to the US Utility Rate Database data.
Definition: 'C:\Users\JamesMilford\OneDrive - Lumidyne Consulting LLC\Documents\US_Utility_Rates_DB\usurdb_2018-10-11.xlsx'
NodeLocation: 120,96,1
NodeSize: 64,40
WindState: 2,102,82,982,350
Aliases: FormNode Fo1533680415

FormNode Fo1533680415
Title: USDRB Path
Definition: 0
NodeLocation: 140,40,1
NodeSize: 92,16
NodeInfo: 1,0,0,0,0,0,0,142,0,,0,,,0
Original: USUDRB_Path

Index USURDB_Columns
Title: USURDB Columns
Definition: ['label','eiaid','name','startdate','enddate','utility','sector','description','source','sourceparent','distributedgenrule','peakkwcapacitymin','peakkwcapacitymax','peakkwcapacityhistory','demandunits','peakkwhusagemin','peakkwhusagemax','peakkwhusagehistory','voltagecategory','phasewiring','voltageminimum','voltagemaximum','fixedchargefirstmeter','fixedchargeunits','fixedattrs','basicinformationcomments','flatdemandunit','flatdemandstructure/period0/tier0max','flatdemandstructure/period0/tier0rate','flatdemandstructure/period0/tier0adj','flatdemandstructure/period0/tier1max','flatdemandstructure/period0/tier1rate','flatdemandstructure/period0/tier1adj','flatdemandstructure/period0/tier2max','flatdemandstructure/period0/tier2rate','flatdemandstructure/period0/tier2adj','flatdemandstructure/period0/tier3max','flatdemandstructure/period0/tier3rate','flatdemandstructure/period0/tier3adj','flatdemandstructure/period0/tier4max','flatdemandstructure/period0/tier4rate','flatdemandstructure/period0/tier4adj','flatdemandstructure/period0/tier5max','flatdemandstructure/period0/tier5rate','flatdemandstructure/period0/tier5adj','flatdemandstructure/period0/tier6max','flatdemandstructure/period0/tier6rate','flatdemandstructure/period0/tier6adj','flatdemandstructure/period0/tier7max','flatdemandstructure/period0/tier7rate','flatdemandstructure/period0/tier7adj','flatdemandstructure/period0/tier8max','flatdemandstructure/period0/tier8rate','flatdemandstructure/period0/tier8adj','flatdemandstructure/period0/tier9max','flatdemandstructure/period0/tier9rate','flatdemandstructure/period0/tier9adj','flatdemandstructure/period0/tier10max','flatdemandstructure/period0/tier10rate','flatdemandstructure/period0/tier10adj','flatdemandstructure/period0/tier11max','flatdemandstructure/period0/tier11rate','flatdemandstructure/period0/tier11adj','flatdemandstructure/period0/tier12max','flatdemandstructure/period0/tier12rate','flatdemandstructure/period0/tier12adj','flatdemandstructure/period0/tier13max','flatdemandstructure/period0/tier13rate','flatdemandstructure/period0/tier13adj','flatdemandstructure/period0/tier14max','flatdemandstructure/period0/tier14rate','flatdemandstructure/period0/tier14adj','flatdemandstructure/period0/tier15max','flatdemandstructure/period0/tier15rate','flatdemandstructure/period0/tier15adj','flatdemandstructure/period0/tier16max','flatdemandstructure/period0/tier16rate','flatdemandstructure/period0/tier16adj','flatdemandstructure/period1/tier0max','flatdemandstructure/period1/tier0rate','flatdemandstructure/period1/tier0adj','flatdemandstructure/period1/tier1max','flatdemandstructure/period1/tier1rate','flatdemandstructure/period1/tier1adj','flatdemandstructure/period1/tier2max','flatdemandstructure/period1/tier2rate','flatdemandstructure/period1/tier2adj','flatdemandstructure/period1/tier3max','flatdemandstructure/period1/tier3rate','flatdemandstructure/period1/tier3adj','flatdemandstructure/period1/tier4max','flatdemandstructure/period1/tier4rate','flatdemandstructure/period1/tier4adj','flatdemandstructure/period2/tier0max','flatdemandstructure/period2/tier0rate','flatdemandstructure/period2/tier0adj','flatdemandstructure/period2/tier1max','flatdemandstructure/period2/tier1rate','flatdemandstructure/period2/tier1adj','flatdemandstructure/period2/tier2max','flatdemandstructure/period2/tier2rate','flatdemandstructure/period2/tier2adj','flatdemandstructure/period3/tier0max','flatdemandstructure/period3/tier0rate','flatdemandstructure/period3/tier0adj','flatdemandstructure/period4/tier0max','flatdemandstructure/period4/tier0rate','flatdemandstructure/period4/tier0adj','flatdemandstructure/period5/tier0max','flatdemandstructure/period5/tier0rate','flatdemandstructure/period5/tier0adj','flatdemandstructure/period6/tier0max','flatdemandstructure/period6/tier0rate','flatdemandstructure/period6/tier0adj','flatdemandstructure/period7/tier0max','flatdemandstructure/period7/tier0rate','flatdemandstructure/period7/tier0adj','demandrateunit','flatdemandmonth1','flatdemandmonth2','flatdemandmonth3','flatdemandmonth4','flatdemandmonth5','flatdemandmonth6','flatdemandmonth7','flatdemandmonth8','flatdemandmonth9','flatdemandmonth10','flatdemandmonth11','flatdemandmonth12','demandratestructure/period0/tier0max','demandratestructure/period0/tier0rate','demandratestructure/period0/tier0adj','demandratestructure/period0/tier1max','demandratestructure/period0/tier1rate','demandratestructure/period0/tier1adj','demandratestructure/period0/tier2max','demandratestructure/period0/tier2rate','demandratestructure/period0/tier2adj','demandratestructure/period0/tier3max','demandratestructure/period0/tier3rate','demandratestructure/period0/tier3adj','demandratestructure/period0/tier4max','demandratestructure/period0/tier4rate','demandratestructure/period0/tier4adj','demandratestructure/period0/tier5max','demandratestructure/period0/tier5rate','demandratestructure/period0/tier5adj','demandratestructure/period0/tier6max','demandratestructure/period0/tier6rate','demandratestructure/period0/tier6adj','demandratestructure/period0/tier7max','demandratestructure/period0/tier7rate','demandratestructure/period0/tier7adj','demandratestructure/period0/tier8max','demandratestructure/period0/tier8rate','demandratestructure/period0/tier8adj','demandratestructure/period0/tier9max','demandratestructure/period0/tier9rate','demandratestructure/period0/tier9adj','demandratestructure/period0/tier10max','demandratestructure/period0/tier10rate','demandratestructure/period0/tier10adj','demandratestructure/period0/tier11max','demandratestructure/period0/tier11rate','demandratestructure/period0/tier11adj','demandratestructure/period0/tier12max','demandratestructure/period0/tier12rate','demandratestructure/period0/tier12adj','demandratestructure/period0/tier13max','demandratestructure/period0/tier13rate','demandratestructure/period0/tier13adj','demandratestructure/period0/tier14max','demandratestructure/period0/tier14rate','demandratestructure/period0/tier14adj','demandratestructure/period0/tier15max','demandratestructure/period0/tier15rate','demandratestructure/period0/tier15adj','demandratestructure/period1/tier0max','demandratestructure/period1/tier0rate','demandratestructure/period1/tier0adj','demandratestructure/period1/tier1max','demandratestructure/period1/tier1rate','demandratestructure/period1/tier1adj','demandratestructure/period1/tier2max','demandratestructure/period1/tier2rate','demandratestructure/period1/tier2adj','demandratestructure/period1/tier3max','demandratestructure/period1/tier3rate','demandratestructure/period1/tier3adj','demandratestructure/period1/tier4max','demandratestructure/period1/tier4rate','demandratestructure/period1/tier4adj','demandratestructure/period1/tier5max','demandratestructure/period1/tier5rate','demandratestructure/period1/tier5adj','demandratestructure/period1/tier6max','demandratestructure/period1/tier6rate','demandratestructure/period1/tier6adj','demandratestructure/period1/tier7max','demandratestructure/period1/tier7rate','demandratestructure/period1/tier7adj','demandratestructure/period1/tier8max','demandratestructure/period1/tier8rate','demandratestructure/period1/tier8adj','demandratestructure/period1/tier9max','demandratestructure/period1/tier9rate','demandratestructure/period1/tier9adj','demandratestructure/period1/tier10max','demandratestructure/period1/tier10rate','demandratestructure/period1/tier10adj','demandratestructure/period1/tier11max','demandratestructure/period1/tier11rate','demandratestructure/period1/tier11adj','demandratestructure/period1/tier12max','demandratestructure/period1/tier12rate','demandratestructure/period1/tier12adj','demandratestructure/period1/tier13max','demandratestructure/period1/tier13rate','demandratestructure/period1/tier13adj','demandratestructure/period1/tier14max','demandratestructure/period1/tier14rate','demandratestructure/period1/tier14adj','demandratestructure/period1/tier15max','demandratestructure/period1/tier15rate','demandratestructure/period1/tier15adj','demandratestructure/period2/tier0max','demandratestructure/period2/tier0rate','demandratestructure/period2/tier0adj','demandratestructure/period2/tier1max','demandratestructure/period2/tier1rate','demandratestructure/period2/tier1adj','demandratestructure/period2/tier2max','demandratestructure/period2/tier2rate','demandratestructure/period2/tier2adj','demandratestructure/period3/tier0max','demandratestructure/period3/tier0rate','demandratestructure/period3/tier0adj','demandratestructure/period3/tier1max','demandratestructure/period3/tier1rate','demandratestructure/period3/tier1adj','demandratestructure/period3/tier2max','demandratestructure/period3/tier2rate','demandratestructure/period3/tier2adj','demandratestructure/period4/tier0max','demandratestructure/period4/tier0rate','demandratestructure/period4/tier0adj','demandratestructure/period4/tier1max','demandratestructure/period4/tier1rate','demandratestructure/period4/tier1adj','demandratestructure/period5/tier0max','demandratestructure/period5/tier0rate','demandratestructure/period5/tier0adj','demandratestructure/period6/tier0max','demandratestructure/period6/tier0rate','demandratestructure/period6/tier0adj','demandratestructure/period7/tier0max','demandratestructure/period7/tier0rate','demandratestructure/period7/tier0adj','demandratestructure/period8/tier0max','demandratestructure/period8/tier0rate','demandratestructure/period8/tier0adj','demandweekdayschedule','demandweekendschedule','demandreactivepowercharge','demandratchetpercentage','demandwindow','demandattrs','demandcomments','energyratestructure/period0/tier0max','energyratestructure/period0/tier0rate','energyratestructure/period0/tier0adj','energyratestructure/period0/tier0sell','energyratestructure/period0/tier1max','energyratestructure/period0/tier1rate','energyratestructure/period0/tier1adj','energyratestructure/period0/tier1sell','energyratestructure/period0/tier2max','energyratestructure/period0/tier2rate','energyratestructure/period0/tier2adj','energyratestructure/period0/tier2sell','energyratestructure/period0/tier3max','energyratestructure/period0/tier3rate','energyratestructure/period0/tier3adj','energyratestructure/period0/tier3sell','energyratestructure/period0/tier4max','energyratestructure/period0/tier4rate','energyratestructure/period0/tier4adj','energyratestructure/period0/tier4sell','energyratestructure/period0/tier5max','energyratestructure/period0/tier5rate','energyratestructure/period0/tier5adj','energyratestructure/period0/tier5sell','energyratestructure/period0/tier6max','energyratestructure/period0/tier6rate','energyratestructure/period0/tier6adj','energyratestructure/period0/tier6sell','energyratestructure/period0/tier7max','energyratestructure/period0/tier7rate','energyratestructure/period0/tier7adj','energyratestructure/period0/tier7sell','energyratestructure/period0/tier8max','energyratestructure/period0/tier8rate','energyratestructure/period0/tier8adj','energyratestructure/period0/tier8sell','energyratestructure/period0/tier9max','energyratestructure/period0/tier9rate','energyratestructure/period0/tier9adj','energyratestructure/period0/tier9sell','energyratestructure/period0/tier10max','energyratestructure/period0/tier10rate','energyratestructure/period0/tier10adj','energyratestructure/period0/tier10sell','energyratestructure/period1/tier0max','energyratestructure/period1/tier0rate','energyratestructure/period1/tier0adj','energyratestructure/period1/tier0sell','energyratestructure/period1/tier1max','energyratestructure/period1/tier1rate','energyratestructure/period1/tier1adj','energyratestructure/period1/tier1sell','energyratestructure/period1/tier2max','energyratestructure/period1/tier2rate','energyratestructure/period1/tier2adj','energyratestructure/period1/tier2sell','energyratestructure/period1/tier3max','energyratestructure/period1/tier3rate','energyratestructure/period1/tier3adj','energyratestructure/period1/tier3sell','energyratestructure/period1/tier4max','energyratestructure/period1/tier4rate','energyratestructure/period1/tier4adj','energyratestructure/period1/tier4sell','energyratestructure/period1/tier5max','energyratestructure/period1/tier5rate','energyratestructure/period1/tier5adj','energyratestructure/period1/tier5sell','energyratestructure/period1/tier6max','energyratestructure/period1/tier6rate','energyratestructure/period1/tier6adj','energyratestructure/period1/tier6sell','energyratestructure/period1/tier7max','energyratestructure/period1/tier7rate','energyratestructure/period1/tier7adj','energyratestructure/period1/tier7sell','energyratestructure/period2/tier0max','energyratestructure/period2/tier0rate','energyratestructure/period2/tier0adj','energyratestructure/period2/tier0sell','energyratestructure/period2/tier1max','energyratestructure/period2/tier1rate','energyratestructure/period2/tier1adj','energyratestructure/period2/tier1sell','energyratestructure/period2/tier2max','energyratestructure/period2/tier2rate','energyratestructure/period2/tier2adj','energyratestructure/period2/tier2sell','energyratestructure/period2/tier3max','energyratestructure/period2/tier3rate','energyratestructure/period2/tier3adj','energyratestructure/period2/tier3sell','energyratestructure/period2/tier4max','energyratestructure/period2/tier4rate','energyratestructure/period2/tier4adj','energyratestructure/period2/tier4sell','energyratestructure/period3/tier0max','energyratestructure/period3/tier0rate','energyratestructure/period3/tier0adj','energyratestructure/period3/tier0sell','energyratestructure/period3/tier1max','energyratestructure/period3/tier1rate','energyratestructure/period3/tier1adj','energyratestructure/period3/tier1sell','energyratestructure/period3/tier2max','energyratestructure/period3/tier2rate','energyratestructure/period3/tier2adj','energyratestructure/period3/tier2sell','energyratestructure/period3/tier3max','energyratestructure/period3/tier3rate','energyratestructure/period3/tier3adj','energyratestructure/period3/tier3sell','energyratestructure/period3/tier4max','energyratestructure/period3/tier4rate','energyratestructure/period3/tier4adj','energyratestructure/period3/tier4sell','energyratestructure/period4/tier0max','energyratestructure/period4/tier0rate','energyratestructure/period4/tier0adj','energyratestructure/period4/tier0sell','energyratestructure/period4/tier1max','energyratestructure/period4/tier1rate','energyratestructure/period4/tier1adj','energyratestructure/period4/tier1sell','energyratestructure/period4/tier2max','energyratestructure/period4/tier2rate','energyratestructure/period4/tier2adj','energyratestructure/period4/tier2sell','energyratestructure/period4/tier3max','energyratestructure/period4/tier3rate','energyratestructure/period4/tier3adj','energyratestructure/period4/tier3sell','energyratestructure/period4/tier4max','energyratestructure/period4/tier4rate','energyratestructure/period4/tier4adj','energyratestructure/period4/tier4sell','energyratestructure/period5/tier0max','energyratestructure/period5/tier0rate','energyratestructure/period5/tier0adj','energyratestructure/period5/tier0sell','energyratestructure/period5/tier1max','energyratestructure/period5/tier1rate','energyratestructure/period5/tier1adj','energyratestructure/period5/tier1sell','energyratestructure/period5/tier2max','energyratestructure/period5/tier2rate','energyratestructure/period5/tier2adj','energyratestructure/period5/tier2sell','energyratestructure/period5/tier3max','energyratestructure/period5/tier3rate','energyratestructure/period5/tier3adj','energyratestructure/period5/tier3sell','energyratestructure/period5/tier4max','energyratestructure/period5/tier4rate','energyratestructure/period5/tier4adj','energyratestructure/period5/tier4sell','energyratestructure/period6/tier0max','energyratestructure/period6/tier0rate','energyratestructure/period6/tier0adj','energyratestructure/period6/tier0sell','energyratestructure/period7/tier0max','energyratestructure/period7/tier0rate','energyratestructure/period7/tier0adj','energyratestructure/period7/tier0sell','energyratestructure/period8/tier0max','energyratestructure/period8/tier0rate','energyratestructure/period8/tier0adj','energyratestructure/period8/tier0sell','energyratestructure/period9/tier0max','energyratestructure/period9/tier0rate','energyratestructure/period9/tier0adj','energyratestructure/period9/tier0sell','energyratestructure/period10/tier0max','energyratestructure/period10/tier0rate','energyratestructure/period10/tier0adj','energyratestructure/period10/tier0sell','energyratestructure/period11/tier0max','energyratestructure/period11/tier0rate','energyratestructure/period11/tier0adj','energyratestructure/period11/tier0sell','energyratestructure/period12/tier0max','energyratestructure/period12/tier0rate','energyratestructure/period12/tier0adj','energyratestructure/period12/tier0sell','energyratestructure/period13/tier0max','energyratestructure/period13/tier0rate','energyratestructure/period13/tier0adj','energyratestructure/period13/tier0sell','energyratestructure/period14/tier0max','energyratestructure/period14/tier0rate','energyratestructure/period14/tier0adj','energyratestructure/period14/tier0sell','energyratestructure/period15/tier0max','energyratestructure/period15/tier0rate','energyratestructure/period15/tier0adj','energyratestructure/period15/tier0sell','energyratestructure/period16/tier0max','energyratestructure/period16/tier0rate','energyratestructure/period16/tier0adj','energyratestructure/period16/tier0sell','energyratestructure/period17/tier0max','energyratestructure/period17/tier0rate','energyratestructure/period17/tier0adj','energyratestructure/period17/tier0sell','energyratestructure/period18/tier0max','energyratestructure/period18/tier0rate','energyratestructure/period18/tier0adj','energyratestructure/period18/tier0sell','energyratestructure/period19/tier0max','energyratestructure/period19/tier0rate','energyratestructure/period19/tier0adj','energyratestructure/period19/tier0sell','energyratestructure/period20/tier0max','energyratestructure/period20/tier0rate','energyratestructure/period20/tier0adj','energyratestructure/period20/tier0sell','energyratestructure/period21/tier0max','energyratestructure/period21/tier0rate','energyratestructure/period21/tier0adj','energyratestructure/period21/tier0sell','energyratestructure/period22/tier0max','energyratestructure/period22/tier0rate','energyratestructure/period22/tier0adj','energyratestructure/period22/tier0sell','energyratestructure/period23/tier0max','energyratestructure/period23/tier0rate','energyratestructure/period23/tier0adj','energyratestructure/period23/tier0sell','energyrateunit','energyweekdayschedule','energyweekendschedule','energyattrs','energycomments','supersedes','mincharge','minchargeunits','coincidentrateunit','coincidentratestructure/period0/tier0max','coincidentratestructure/period0/tier0rate','coincidentratestructure/period0/tier0adj','coincidentratestructure/period1/tier0max','coincidentratestructure/period1/tier0rate','coincidentratestructure/period1/tier0adj','coincidentratestructure/period2/tier0max','coincidentratestructure/period2/tier0rate','coincidentratestructure/period2/tier0adj','coincidentschedule','lastupdate']
NodeLocation: 616,64,1
NodeSize: 64,40
WindState: 2,868,4,476,531
ValueState: 2,249,-11,416,631,0,MIDM
Att_PrevIndexValue: ['label','eiaid','name','startdate','enddate','utility','sector','description','source','sourceparent','distributedgenrule','peakkwcapacitymin','peakkwcapacitymax','peakkwcapacityhistory','demandunits','peakkwhusagemin','peakkwhusagemax','peakkwhusagehistory','voltagecategory','phasewiring','voltageminimum','voltagemaximum','fixedchargefirstmeter','fixedchargeunits','fixedattrs','basicinformationcomments','flatdemandunit','flatdemandstructure/period0/tier0max','flatdemandstructure/period0/tier0rate','flatdemandstructure/period0/tier0adj','flatdemandstructure/period0/tier1max','flatdemandstructure/period0/tier1rate','flatdemandstructure/period0/tier1adj','flatdemandstructure/period0/tier2max','flatdemandstructure/period0/tier2rate','flatdemandstructure/period0/tier2adj','flatdemandstructure/period0/tier3max','flatdemandstructure/period0/tier3rate','flatdemandstructure/period0/tier3adj','flatdemandstructure/period0/tier4max','flatdemandstructure/period0/tier4rate','flatdemandstructure/period0/tier4adj','flatdemandstructure/period0/tier5max','flatdemandstructure/period0/tier5rate','flatdemandstructure/period0/tier5adj','flatdemandstructure/period0/tier6max','flatdemandstructure/period0/tier6rate','flatdemandstructure/period0/tier6adj','flatdemandstructure/period0/tier7max','flatdemandstructure/period0/tier7rate','flatdemandstructure/period0/tier7adj','flatdemandstructure/period0/tier8max','flatdemandstructure/period0/tier8rate','flatdemandstructure/period0/tier8adj','flatdemandstructure/period0/tier9max','flatdemandstructure/period0/tier9rate','flatdemandstructure/period0/tier9adj','flatdemandstructure/period0/tier10max','flatdemandstructure/period0/tier10rate','flatdemandstructure/period0/tier10adj','flatdemandstructure/period0/tier11max','flatdemandstructure/period0/tier11rate','flatdemandstructure/period0/tier11adj','flatdemandstructure/period0/tier12max','flatdemandstructure/period0/tier12rate','flatdemandstructure/period0/tier12adj','flatdemandstructure/period0/tier13max','flatdemandstructure/period0/tier13rate','flatdemandstructure/period0/tier13adj','flatdemandstructure/period0/tier14max','flatdemandstructure/period0/tier14rate','flatdemandstructure/period0/tier14adj','flatdemandstructure/period0/tier15max','flatdemandstructure/period0/tier15rate','flatdemandstructure/period0/tier15adj','flatdemandstructure/period0/tier16max','flatdemandstructure/period0/tier16rate','flatdemandstructure/period0/tier16adj','flatdemandstructure/period1/tier0max','flatdemandstructure/period1/tier0rate','flatdemandstructure/period1/tier0adj','flatdemandstructure/period1/tier1max','flatdemandstructure/period1/tier1rate','flatdemandstructure/period1/tier1adj','flatdemandstructure/period1/tier2max','flatdemandstructure/period1/tier2rate','flatdemandstructure/period1/tier2adj','flatdemandstructure/period1/tier3max','flatdemandstructure/period1/tier3rate','flatdemandstructure/period1/tier3adj','flatdemandstructure/period1/tier4max','flatdemandstructure/period1/tier4rate','flatdemandstructure/period1/tier4adj','flatdemandstructure/period2/tier0max','flatdemandstructure/period2/tier0rate','flatdemandstructure/period2/tier0adj','flatdemandstructure/period2/tier1max','flatdemandstructure/period2/tier1rate','flatdemandstructure/period2/tier1adj','flatdemandstructure/period2/tier2max','flatdemandstructure/period2/tier2rate','flatdemandstructure/period2/tier2adj','flatdemandstructure/period3/tier0max','flatdemandstructure/period3/tier0rate','flatdemandstructure/period3/tier0adj','flatdemandstructure/period4/tier0max','flatdemandstructure/period4/tier0rate','flatdemandstructure/period4/tier0adj','flatdemandstructure/period5/tier0max','flatdemandstructure/period5/tier0rate','flatdemandstructure/period5/tier0adj','flatdemandstructure/period6/tier0max','flatdemandstructure/period6/tier0rate','flatdemandstructure/period6/tier0adj','flatdemandstructure/period7/tier0max','flatdemandstructure/period7/tier0rate','flatdemandstructure/period7/tier0adj','demandrateunit','flatdemandmonth1','flatdemandmonth2','flatdemandmonth3','flatdemandmonth4','flatdemandmonth5','flatdemandmonth6','flatdemandmonth7','flatdemandmonth8','flatdemandmonth9','flatdemandmonth10','flatdemandmonth11','flatdemandmonth12','demandratestructure/period0/tier0max','demandratestructure/period0/tier0rate','demandratestructure/period0/tier0adj','demandratestructure/period0/tier1max','demandratestructure/period0/tier1rate','demandratestructure/period0/tier1adj','demandratestructure/period0/tier2max','demandratestructure/period0/tier2rate','demandratestructure/period0/tier2adj','demandratestructure/period0/tier3max','demandratestructure/period0/tier3rate','demandratestructure/period0/tier3adj','demandratestructure/period0/tier4max','demandratestructure/period0/tier4rate','demandratestructure/period0/tier4adj','demandratestructure/period0/tier5max','demandratestructure/period0/tier5rate','demandratestructure/period0/tier5adj','demandratestructure/period0/tier6max','demandratestructure/period0/tier6rate','demandratestructure/period0/tier6adj','demandratestructure/period0/tier7max','demandratestructure/period0/tier7rate','demandratestructure/period0/tier7adj','demandratestructure/period0/tier8max','demandratestructure/period0/tier8rate','demandratestructure/period0/tier8adj','demandratestructure/period0/tier9max','demandratestructure/period0/tier9rate','demandratestructure/period0/tier9adj','demandratestructure/period0/tier10max','demandratestructure/period0/tier10rate','demandratestructure/period0/tier10adj','demandratestructure/period0/tier11max','demandratestructure/period0/tier11rate','demandratestructure/period0/tier11adj','demandratestructure/period0/tier12max','demandratestructure/period0/tier12rate','demandratestructure/period0/tier12adj','demandratestructure/period0/tier13max','demandratestructure/period0/tier13rate','demandratestructure/period0/tier13adj','demandratestructure/period0/tier14max','demandratestructure/period0/tier14rate','demandratestructure/period0/tier14adj','demandratestructure/period0/tier15max','demandratestructure/period0/tier15rate','demandratestructure/period0/tier15adj','demandratestructure/period1/tier0max','demandratestructure/period1/tier0rate','demandratestructure/period1/tier0adj','demandratestructure/period1/tier1max','demandratestructure/period1/tier1rate','demandratestructure/period1/tier1adj','demandratestructure/period1/tier2max','demandratestructure/period1/tier2rate','demandratestructure/period1/tier2adj','demandratestructure/period1/tier3max','demandratestructure/period1/tier3rate','demandratestructure/period1/tier3adj','demandratestructure/period1/tier4max','demandratestructure/period1/tier4rate','demandratestructure/period1/tier4adj','demandratestructure/period1/tier5max','demandratestructure/period1/tier5rate','demandratestructure/period1/tier5adj','demandratestructure/period1/tier6max','demandratestructure/period1/tier6rate','demandratestructure/period1/tier6adj','demandratestructure/period1/tier7max','demandratestructure/period1/tier7rate','demandratestructure/period1/tier7adj','demandratestructure/period1/tier8max','demandratestructure/period1/tier8rate','demandratestructure/period1/tier8adj','demandratestructure/period1/tier9max','demandratestructure/period1/tier9rate','demandratestructure/period1/tier9adj','demandratestructure/period1/tier10max','demandratestructure/period1/tier10rate','demandratestructure/period1/tier10adj','demandratestructure/period1/tier11max','demandratestructure/period1/tier11rate','demandratestructure/period1/tier11adj','demandratestructure/period1/tier12max','demandratestructure/period1/tier12rate','demandratestructure/period1/tier12adj','demandratestructure/period1/tier13max','demandratestructure/period1/tier13rate','demandratestructure/period1/tier13adj','demandratestructure/period1/tier14max','demandratestructure/period1/tier14rate','demandratestructure/period1/tier14adj','demandratestructure/period1/tier15max','demandratestructure/period1/tier15rate','demandratestructure/period1/tier15adj','demandratestructure/period2/tier0max','demandratestructure/period2/tier0rate','demandratestructure/period2/tier0adj','demandratestructure/period2/tier1max','demandratestructure/period2/tier1rate','demandratestructure/period2/tier1adj','demandratestructure/period2/tier2max','demandratestructure/period2/tier2rate','demandratestructure/period2/tier2adj','demandratestructure/period3/tier0max','demandratestructure/period3/tier0rate','demandratestructure/period3/tier0adj','demandratestructure/period3/tier1max','demandratestructure/period3/tier1rate','demandratestructure/period3/tier1adj','demandratestructure/period3/tier2max','demandratestructure/period3/tier2rate','demandratestructure/period3/tier2adj','demandratestructure/period4/tier0max','demandratestructure/period4/tier0rate','demandratestructure/period4/tier0adj','demandratestructure/period4/tier1max','demandratestructure/period4/tier1rate','demandratestructure/period4/tier1adj','demandratestructure/period5/tier0max','demandratestructure/period5/tier0rate','demandratestructure/period5/tier0adj','demandratestructure/period6/tier0max','demandratestructure/period6/tier0rate','demandratestructure/period6/tier0adj','demandratestructure/period7/tier0max','demandratestructure/period7/tier0rate','demandratestructure/period7/tier0adj','demandratestructure/period8/tier0max','demandratestructure/period8/tier0rate','demandratestructure/period8/tier0adj','demandweekdayschedule','demandweekendschedule','demandreactivepowercharge','demandratchetpercentage','demandwindow','demandattrs','demandcomments','energyratestructure/period0/tier0max','energyratestructure/period0/tier0rate','energyratestructure/period0/tier0adj','energyratestructure/period0/tier0sell','energyratestructure/period0/tier1max','energyratestructure/period0/tier1rate','energyratestructure/period0/tier1adj','energyratestructure/period0/tier1sell','energyratestructure/period0/tier2max','energyratestructure/period0/tier2rate','energyratestructure/period0/tier2adj','energyratestructure/period0/tier2sell','energyratestructure/period0/tier3max','energyratestructure/period0/tier3rate','energyratestructure/period0/tier3adj','energyratestructure/period0/tier3sell','energyratestructure/period0/tier4max','energyratestructure/period0/tier4rate','energyratestructure/period0/tier4adj','energyratestructure/period0/tier4sell','energyratestructure/period0/tier5max','energyratestructure/period0/tier5rate','energyratestructure/period0/tier5adj','energyratestructure/period0/tier5sell','energyratestructure/period0/tier6max','energyratestructure/period0/tier6rate','energyratestructure/period0/tier6adj','energyratestructure/period0/tier6sell','energyratestructure/period0/tier7max','energyratestructure/period0/tier7rate','energyratestructure/period0/tier7adj','energyratestructure/period0/tier7sell','energyratestructure/period0/tier8max','energyratestructure/period0/tier8rate','energyratestructure/period0/tier8adj','energyratestructure/period0/tier8sell','energyratestructure/period0/tier9max','energyratestructure/period0/tier9rate','energyratestructure/period0/tier9adj','energyratestructure/period0/tier9sell','energyratestructure/period0/tier10max','energyratestructure/period0/tier10rate','energyratestructure/period0/tier10adj','energyratestructure/period0/tier10sell','energyratestructure/period1/tier0max','energyratestructure/period1/tier0rate','energyratestructure/period1/tier0adj','energyratestructure/period1/tier0sell','energyratestructure/period1/tier1max','energyratestructure/period1/tier1rate','energyratestructure/period1/tier1adj','energyratestructure/period1/tier1sell','energyratestructure/period1/tier2max','energyratestructure/period1/tier2rate','energyratestructure/period1/tier2adj','energyratestructure/period1/tier2sell','energyratestructure/period1/tier3max','energyratestructure/period1/tier3rate','energyratestructure/period1/tier3adj','energyratestructure/period1/tier3sell','energyratestructure/period1/tier4max','energyratestructure/period1/tier4rate','energyratestructure/period1/tier4adj','energyratestructure/period1/tier4sell','energyratestructure/period1/tier5max','energyratestructure/period1/tier5rate','energyratestructure/period1/tier5adj','energyratestructure/period1/tier5sell','energyratestructure/period1/tier6max','energyratestructure/period1/tier6rate','energyratestructure/period1/tier6adj','energyratestructure/period1/tier6sell','energyratestructure/period1/tier7max','energyratestructure/period1/tier7rate','energyratestructure/period1/tier7adj','energyratestructure/period1/tier7sell','energyratestructure/period2/tier0max','energyratestructure/period2/tier0rate','energyratestructure/period2/tier0adj','energyratestructure/period2/tier0sell','energyratestructure/period2/tier1max','energyratestructure/period2/tier1rate','energyratestructure/period2/tier1adj','energyratestructure/period2/tier1sell','energyratestructure/period2/tier2max','energyratestructure/period2/tier2rate','energyratestructure/period2/tier2adj','energyratestructure/period2/tier2sell','energyratestructure/period2/tier3max','energyratestructure/period2/tier3rate','energyratestructure/period2/tier3adj','energyratestructure/period2/tier3sell','energyratestructure/period2/tier4max','energyratestructure/period2/tier4rate','energyratestructure/period2/tier4adj','energyratestructure/period2/tier4sell','energyratestructure/period3/tier0max','energyratestructure/period3/tier0rate','energyratestructure/period3/tier0adj','energyratestructure/period3/tier0sell','energyratestructure/period3/tier1max','energyratestructure/period3/tier1rate','energyratestructure/period3/tier1adj','energyratestructure/period3/tier1sell','energyratestructure/period3/tier2max','energyratestructure/period3/tier2rate','energyratestructure/period3/tier2adj','energyratestructure/period3/tier2sell','energyratestructure/period3/tier3max','energyratestructure/period3/tier3rate','energyratestructure/period3/tier3adj','energyratestructure/period3/tier3sell','energyratestructure/period3/tier4max','energyratestructure/period3/tier4rate','energyratestructure/period3/tier4adj','energyratestructure/period3/tier4sell','energyratestructure/period4/tier0max','energyratestructure/period4/tier0rate','energyratestructure/period4/tier0adj','energyratestructure/period4/tier0sell','energyratestructure/period4/tier1max','energyratestructure/period4/tier1rate','energyratestructure/period4/tier1adj','energyratestructure/period4/tier1sell','energyratestructure/period4/tier2max','energyratestructure/period4/tier2rate','energyratestructure/period4/tier2adj','energyratestructure/period4/tier2sell','energyratestructure/period4/tier3max','energyratestructure/period4/tier3rate','energyratestructure/period4/tier3adj','energyratestructure/period4/tier3sell','energyratestructure/period4/tier4max','energyratestructure/period4/tier4rate','energyratestructure/period4/tier4adj','energyratestructure/period4/tier4sell','energyratestructure/period5/tier0max','energyratestructure/period5/tier0rate','energyratestructure/period5/tier0adj','energyratestructure/period5/tier0sell','energyratestructure/period5/tier1max','energyratestructure/period5/tier1rate','energyratestructure/period5/tier1adj','energyratestructure/period5/tier1sell','energyratestructure/period5/tier2max','energyratestructure/period5/tier2rate','energyratestructure/period5/tier2adj','energyratestructure/period5/tier2sell','energyratestructure/period5/tier3max','energyratestructure/period5/tier3rate','energyratestructure/period5/tier3adj','energyratestructure/period5/tier3sell','energyratestructure/period5/tier4max','energyratestructure/period5/tier4rate','energyratestructure/period5/tier4adj','energyratestructure/period5/tier4sell','energyratestructure/period6/tier0max','energyratestructure/period6/tier0rate','energyratestructure/period6/tier0adj','energyratestructure/period6/tier0sell','energyratestructure/period7/tier0max','energyratestructure/period7/tier0rate','energyratestructure/period7/tier0adj','energyratestructure/period7/tier0sell','energyratestructure/period8/tier0max','energyratestructure/period8/tier0rate','energyratestructure/period8/tier0adj','energyratestructure/period8/tier0sell','energyratestructure/period9/tier0max','energyratestructure/period9/tier0rate','energyratestructure/period9/tier0adj','energyratestructure/period9/tier0sell','energyratestructure/period10/tier0max','energyratestructure/period10/tier0rate','energyratestructure/period10/tier0adj','energyratestructure/period10/tier0sell','energyratestructure/period11/tier0max','energyratestructure/period11/tier0rate','energyratestructure/period11/tier0adj','energyratestructure/period11/tier0sell','energyratestructure/period12/tier0max','energyratestructure/period12/tier0rate','energyratestructure/period12/tier0adj','energyratestructure/period12/tier0sell','energyratestructure/period13/tier0max','energyratestructure/period13/tier0rate','energyratestructure/period13/tier0adj','energyratestructure/period13/tier0sell','energyratestructure/period14/tier0max','energyratestructure/period14/tier0rate','energyratestructure/period14/tier0adj','energyratestructure/period14/tier0sell','energyratestructure/period15/tier0max','energyratestructure/period15/tier0rate','energyratestructure/period15/tier0adj','energyratestructure/period15/tier0sell','energyratestructure/period16/tier0max','energyratestructure/period16/tier0rate','energyratestructure/period16/tier0adj','energyratestructure/period16/tier0sell','energyratestructure/period17/tier0max','energyratestructure/period17/tier0rate','energyratestructure/period17/tier0adj','energyratestructure/period17/tier0sell','energyratestructure/period18/tier0max','energyratestructure/period18/tier0rate','energyratestructure/period18/tier0adj','energyratestructure/period18/tier0sell','energyratestructure/period19/tier0max','energyratestructure/period19/tier0rate','energyratestructure/period19/tier0adj','energyratestructure/period19/tier0sell','energyratestructure/period20/tier0max','energyratestructure/period20/tier0rate','energyratestructure/period20/tier0adj','energyratestructure/period20/tier0sell','energyratestructure/period21/tier0max','energyratestructure/period21/tier0rate','energyratestructure/period21/tier0adj','energyratestructure/period21/tier0sell','energyratestructure/period22/tier0max','energyratestructure/period22/tier0rate','energyratestructure/period22/tier0adj','energyratestructure/period22/tier0sell','energyratestructure/period23/tier0max','energyratestructure/period23/tier0rate','energyratestructure/period23/tier0adj','energyratestructure/period23/tier0sell','energyrateunit','energyweekdayschedule','energyweekendschedule','energyattrs','energycomments','supersedes','mincharge','minchargeunits','coincidentrateunit','coincidentratestructure/period0/tier0max','coincidentratestructure/period0/tier0rate','coincidentratestructure/period0/tier0adj','coincidentratestructure/period1/tier0max','coincidentratestructure/period1/tier0rate','coincidentratestructure/period1/tier0adj','coincidentratestructure/period2/tier0max','coincidentratestructure/period2/tier0rate','coincidentratestructure/period2/tier0adj','coincidentschedule','lastupdate']

Variable Read_USURDB
Title: Read USURDB
Description: US Utility Rate Database data read from the spreadsheet.
Definition: VAR workbook:=SpreadsheetOpen(USUDRB_Path);~
SpreadsheetRange(workbook, sheet: USUDRB_Tab_Name, howToIndex:4 )
NodeLocation: 304,152,1
NodeSize: 64,40
ValueState: 2,168,122,1125,440,,MIDM

Button Store_Import_USURDB
Title: Store Imported USURDB Data
Description: This stores the data read from the US Utility Rates Database. If the entire USURDB database is stored, it will increase the model size by more than 100 MB.
NodeLocation: 480,268,1
NodeSize: 64,44
OnClick: All_USURDB_Rows := CopyIndex(Read_USURDB.Row);~
USURDB_Columns := CopyIndex(Read_USURDB.Column);~
USURDB_Data := Read_USURDB[.Row=All_USURDB_Rows, .Column=USURDB_Columns];

Index All_USURDB_Rows
Title: All USURDB Rows
Definition: [35863,40203,44336,45412,27671,34900,30129,4195,40183,44320,45413,8078,34892,28547,39580,40186,44324,45416,26074,34899,7031,39487,40184,44322,45414,21979,34897,15516,39488,40185,44323,45415,45404,45408,45407,45411,45406,45410,45405,45409]
NodeLocation: 472,64,1
NodeSize: 64,40
Att_PrevIndexValue: [35.863K,40.203K,44.336K,45.412K,27.671K,34.9K,30.129K,4195,40.183K,44.32K,45.413K,8078,34.892K,28.547K,39.58K,40.186K,44.324K,45.416K,26.074K,34.899K,7031,39.487K,40.184K,44.322K,45.414K,21.979K,34.897K,15.516K,39.488K,40.185K,44.323K,45.415K,45.404K,45.408K,45.407K,45.411K,45.406K,45.41K,45.405K,45.409K]

Alias Al1534527214
Title: USURDB Data
Definition: 1
NodeLocation: 544,152,1
NodeSize: 64,40
Original: USURDB_Data

FormNode Fo1534527214
Title: USURDB Data
Definition: 0
NodeLocation: 552,188,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: USURDB_Data

Button Store_Filter_USURDB
Title: Store Filtered USURDB Data
Description: !! This button should not be pressed unless the Store Imported USURDB Data button (Store_Import_USURDB) has been pressed first. !!~
~
This stores the filtered data from the US Utility Rates Database, so as to avoid saving the entire database. If the entire USURDB database is stored, it will increase the model size by more than 100 MB.
NodeLocation: 624,268,1
NodeSize: 64,44
WindState: 2,700,235,720,350
OnClick: INDEX rows:=CopyIndex(Rows_for_Rate_Names);~
VAR data:=USURDB_Data[All_USURDB_Rows=rows];~
All_USURDB_Rows := CopyIndex(rows);~
USURDB_Data := data[rows=All_USURDB_Rows];

Decision USUDRB_Tab_Name
Title: USUDRB Tab Name
Description: The file path to the US Utility Rate Database data.
Definition: 'usurdb'
NodeLocation: 120,232,1
NodeSize: 64,40
Aliases: FormNode Fo1539268742

FormNode Fo1539268742
Title: USDRB Path
Definition: 0
NodeLocation: 140,176,1
NodeSize: 92,16
NodeInfo: 1,0,0,0,0,0,0,142,0,,0,,,0
Original: USUDRB_Tab_Name

Close Import_USURDB_Data

Module ODBC_Import_Test
Title: ODBC Import Test
Author: JamesMilford
Date: Wed, Aug 8, 2018 1:55 PM
NodeLocation: 128,200,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,1,0,1068,567,17

Variable Read_USUDRB_via_ODBC
Title: Read USUDRB via ODBC
Definition: Create_ODBC_Table(Driver_Info, USUDRB_Path1, SQL_String, Interconnect_Tab_Nam)
NodeLocation: 320,192,1
NodeSize: 64,40
WindState: 2,854,497,720,350
ValueState: 2,248,176,953,474,,MIDM

Decision Driver_Info
Title: Driver Info
Definition:  "Driver=Microsoft Excel Driver (*.xls, *.xlsx, *.xlsm, *.xlsb); ReadOnly=0;DBQ="
NodeLocation: 144,192,1
NodeSize: 64,40
ValueState: 2,152,154,1039,303,,MIDM

Function Create_ODBC_Table(connectionStr, path; sqlStr; tabName: Text )
Title: Create ODBC Table
Definition: VAR newConnectStr:=connectionStr & path;~
VAR newSQLstr:=sqlStr & tabName & "$]";~
INDEX rows:=DBQuery(newConnectStr, newSQLstr);~
INDEX cols:=DBLabels(rows);~
DBTable(rows, cols)
NodeLocation: 320,304,1
NodeSize: 64,40
WindState: 2,94,411,720,350

Decision SQL_String
Title: SQL String
Definition: "Select * from ["
NodeLocation: 320,96,1
NodeSize: 64,40

Decision USUDRB_Path1
Title: USUDRB Path
Definition: {'C:\Users\JamesMilford\OneDrive - Lumidyne Consulting LLC\Documents\US_Utility_Rates_DB\usurdb.xlsx'}~
'C:\Users\JamesMilford\Documents\US_Utility_Rates_DB\usurdb.xlsx'
NodeLocation: 144,96,1
NodeSize: 64,40
Aliases: FormNode Fo1533754823

FormNode Fo1533754823
Title: USDRB Path
Definition: 0
NodeLocation: 140,40,1
NodeSize: 92,16
NodeInfo: 1,0,0,0,0,0,0,150,0,,0,,,0
Original: USUDRB_Path1

Alias Al1533754985
Title: USUDRB Tab Name
Definition: 1
NodeLocation: 472,96,1
NodeSize: 64,40
Original: Interconnect_Tab_Nam

FormNode Fo1533760894
Title: USUDRB Tab Name
Definition: 0
NodeLocation: 492,40,1
NodeSize: 92,16
NodeInfo: 1,0,0,0,0,0,0,142,0,,0,,,0
Original: Interconnect_Tab_Nam

Close ODBC_Import_Test

Module Rate_Values_by_Perio
Title: Rate Values by Periods & Tiers
Author: JamesMilford
Date: Wed, Aug 8, 2018 7:26 PM
NodeLocation: 584,200,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,384,50,987,533,17

Variable Map_USURDB_Columns
Title: Map USURDB Columns to Data
Description: Maps the columns included in the USURDB data to the dimensionalized data fields.
Definition: Data_Type & Tier_Period_Separat & Periods & Tier_Period_Separat & Tiers & Data_Attribute
NodeLocation: 104,72,1
NodeSize: 64,40
WindState: 2,102,82,898,350
ValueState: 2,184,186,1153,347,,MIDM
Att_ResultSliceState: [Tiers,1,Data_Type,2,Data_Attribute,1,Periods,1]

Variable Check_Map
Title: Check Map
Description: Returns the USURDB column position matching the text string used in the map. If this returns a zero, then the text string does not match any column headers.
Definition: PositionInIndex(USURDB_Columns, Map_USURDB_Columns, USURDB_Columns) 
NodeLocation: 256,160,1
NodeSize: 64,40
ValueState: 2,216,218,974,450,,MIDM
Att_ResultSliceState: [Tiers,1,Data_Type,3,Data_Attribute,1,Periods,1]

Variable Data_by_Tier_Period
Title: Data by Tier & Period
Units: various
Description: USURDB data for rates and rate attributes (eg, max, adj, sell) mapped to periods and tiers.
Definition: IgnoreWarnings(Filtered_USURDB_Data[USURDB_Columns=Map_USURDB_Columns])
NodeLocation: 256,72,1
NodeSize: 64,40
ValueState: 2,392,28,826,539,,MIDM
ReformVal: [Tiers,Periods]
Att_ResultSliceState: [Data_Type,3,Data_Attribute,2,Rate_Names,10,Periods,1,Tiers,2]

Decision Map_USURDB_Units_to_
Title: Map USURDB Units to Type
Description: Map the USURDB column names associated with unit types to each of the data types.
Definition: Table(Data_Type)(Choice(USURDB_Columns,27,0),Choice(USURDB_Columns,118,0),Choice(USURDB_Columns,498,0),Choice(USURDB_Columns,506,0))
NodeLocation: 104,272,1
NodeSize: 64,40
Aliases: FormNode Fo1533747258
{!40200|Att_ChoiceIndexes: Index USURDB_Columns}

FormNode Fo1533747258
Title: Map USURDB Units to Type
Definition: 0
NodeLocation: 104,220,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Map_USURDB_Units_to_

Variable Units_for_Data_Types
Title: Units for Data Types
Description: The units associated with the rates for each data type.
Definition: IF Data_Type = Energy_Rate_Label~
THEN Energy_Units_Label~
ELSE Filtered_USURDB_Data[USURDB_Columns=Map_USURDB_Units_to_]
NodeLocation: 256,272,1
NodeSize: 64,40
ValueState: 2,104,106,1014,357,,MIDM

Variable Rate_Data_TOU_Sched
Title: Rate Data by TOU Schedule
Description: USURDB data for rates and rate attributes (eg, max, adj, sell) mapped to months and time of day.
Definition: IgnoreWarnings(Data_by_Tier_Period[Periods = Period_String & Periods_by_TOU_Sched])
NodeLocation: 416,72,1
NodeSize: 64,40
WindState: 2,102,82,720,427
ValueState: 2,427,142,1043,683,,MIDM
Aliases: FormNode Fo1534435166
ReformVal: [Month,Time_of_Day]
Att__TotalsIndex: []
Att_ResultSliceState: [Rate_Names,4,Tiers,1,Data_Attribute,1,Data_Type,2,Weekday_or_Weekend,2,Time_of_Day,1,Month,1]
{!40700|CellFormatExpression: CellFill(IF RateCellTransparency < 0 THEN 'Green' ELSE 'Red', .2+.6*Abs(RateCellTransparency))}
{!50000|Att_ColumnWidths: [,Month,\([,,,,,,,68])]}

Variable RateCellTransparency
Title: Rates Cell Transparency
Description: This finds the transparency level used in the cell formatting of retail rate data. It finds a gradient such that the median rate is the midpoint.~
~
-1.0 = The lowest rate~
-0.001 = The median rate~
+1.0 = The highest rate
Definition: VAR periodFlags:=Sum((Period_String & Periods_by_TOU_Sched) = Periods, Time_of_Day, Month);~
VAR periodMap:=IF periodFlags~
   THEN periods~
   ELSE Null;~
VAR validRates:=Data_by_Tier_Period[Periods=periodMap];~
VAR medianRate:=Median(validRates, Periods);~
VAR delta:=validRates - medianRate;~
VAR lowMax:=MAX(IF delta >= 0 THEN -INF ELSE delta, Periods);~
VAR lowDelta:=MIN(delta, Periods) - lowMax;~
VAR highDelta:=MAX(delta, Periods);~
VAR percentage:=IF delta <= 0    {If rate is less than or equal to the median}~
   THEN MIN([-Divide(delta - lowMax, lowDelta), -.001])   {Then return a negative percentage}~
   ELSE Divide(delta, highDelta);   {Else return a positive percentage}~
~
IgnoreWarnings(percentage[Periods=Period_String & Periods_by_TOU_Sched]);
NodeLocation: 416,160,1
NodeSize: 64,40
WindState: 2,592,254,1009,528
ValueState: 2,59,14,1304,640,0,MIDM
ReformVal: [Month,Time_of_Day]
Att_ResultSliceState: [Data_Type,3,Weekday_or_Weekend,2,Tiers,1,Data_Attribute,1,Rate_Names,10,Time_of_Day,1,Month,1]

Variable Weekly_Rate_Data
Title: Weekly Rate Data
Definition: Reindex_to_Week(Rate_Data_TOU_Sched)
NodeLocation: 576,72,1
NodeSize: 64,40
ValueState: 2,161,8,1643,820,0,MIDM
GraphSetup: Graph_KeyFont:,18,0~
Graph_KeyTitleFont:,18,1~
Graph_AxisLabelFont:,14,0~
Graph_AxisTitleFont:Arial,18,1~
Att_CatLineStyle Graph_Primary_Valdim:6
ReformVal: [Month,Day_and_Hour]
Att_ResultSliceState: [Tiers,1,Data_Attribute,1,Data_Type,3,Rate_Names,2,Day_and_Hour,1,Month,10]

Variable Rates
Title: Rates
Definition: Rate_Data_TOU_Sched[Data_Attribute=Rate_Attribute_Label] + Rate_Data_TOU_Sched[Data_Attribute=Adj_Attribute_Label] 
NodeLocation: 576,160,1
NodeSize: 64,40
ValueState: 2,40,42,1621,666,,MIDM
ReformVal: [Month,Time_of_Day]
Att_ResultSliceState: [Rate_Names,4,Tiers,3,Data_Type,3,Weekday_or_Weekend,1,Time_of_Day,1,Month,1]

Decision Rate_to_View
Title: Rate to View
Description: Select which rate you wish to view.
Definition: Choice(Rate_Names,34,0)
NodeLocation: 416,272,1
NodeSize: 64,40
Aliases: FormNode Fo1544371655
{!40200|Att_ChoiceIndexes: Index Rate_Names}

Variable Electric_Rates
Title: Electric Rates
Units: variable
Description: Energy in $/kWh~
Demand in $/kW-yr?
Definition: Rate_Data_TOU_Sched[Rate_Names=Rate_to_View, Data_Type=Data_Type_to_View]
NodeLocation: 560,272,1
NodeSize: 64,40
ValueState: 2,332,32,934,631,,MIDM
Aliases: FormNode Fo1544458683
ReformVal: [Month,Time_of_Day]
Att_ResultSliceState: [Tiers,1,Data_Attribute,1,Weekday_or_Weekend,1,Time_of_Day,1,Month,1]
{!40700|CellFormatExpression: CellFill(IF RateCellTransparency[Rate_Names=Rate_to_View, Data_Type=Data_Type_to_View] < 0 THEN 'Green' ELSE 'Red', .2+.6*Abs(RateCellTransparency[Rate_Names=Rate_to_View, Data_Type=Data_Type_to_View] ))}

Decision Data_Type_to_View
Title: Data Type to View
Definition: Choice(Data_Type,3,0)
NodeLocation: 416,408,1
NodeSize: 64,40
Aliases: FormNode Fo1544374357
{!40200|Att_ChoiceIndexes: Index Data_Type}

Close Rate_Values_by_Perio

Module Find_TOU_Schedules
Title: Find TOU Schedules
Author: JamesMilford
Date: Fri, Aug 10, 2018 2:24 PM
NodeLocation: 432,200,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,132,49,1116,588,17

Decision TOU_Schedule_Labels
Title: TOU Schedule Labels
Description: USURDB columns that include data specific to different tiers and periods, specifically data that can change by time of day. These are used to define the tier and period indices.
Definition: Table(USURDB_Columns)(Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(1),Checkbox(1),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(1),Checkbox(1),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(1),Checkbox(0))
NodeLocation: 112,184,1
NodeSize: 64,40
DefnState: 2,120,12,529,652,,DFNM
Aliases: FormNode Fo1533753820
TableCellDefault: Checkbox(0)

FormNode Fo1533753820
Title: Period Label
Definition: 0
NodeLocation: 112,240,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,
Original: TOU_Schedule_Labels

Decision Map_Schedules
Title: Map Schedules
Description: Maps USURDB columns to weekday or weekend designations. Rate types without a TOU or seasonal structure should use the "None" option.
Definition: Table(Data_Type,Weekday_or_Weekend)(~
Choice(Schedules_with_None,1,0),Choice(Schedules_with_None,1,0),~
Choice(Schedules_with_None,2,0),Choice(Schedules_with_None,3,0),~
Choice(Schedules_with_None,4,0),Choice(Schedules_with_None,5,0),~
Choice(Schedules_with_None,6,0),Choice(Schedules_with_None,6,0))
NodeLocation: 264,184,1
NodeSize: 64,40
WindState: 2,385,79,934,350
DefnState: 2,142,106,1091,440,0,DFNM
Aliases: FormNode Fo1533753970
TableCellDefault: Choice(Schedules_with_None,1,0)
{!40200|Att_ChoiceIndexes: Index Schedules_with_None}

FormNode Fo1533753970
Title: Map USURDB Units to Type
Definition: 0
NodeLocation: 264,236,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Map_Schedules

Variable Unformatted_TOU_Sche
Title: Unformatted TOU Schedules
Description: The TOU schedule before formatting for use in the model.
Definition: IgnoreWarnings(Filtered_USURDB_Data[USURDB_Columns=Map_Schedules])
NodeLocation: 416,184,1
NodeSize: 64,40
WindState: 2,431,266,1039,350
ValueState: 2,106,153,1181,511,,MIDM
ReformVal: [Null,Data_Type]
Att_ResultSliceState: [Weekday_or_Weekend,1,Rate_Names,2,Data_Type,1]

Function Parse_USURDB_Sched(sched, monthSep, hourSep; months, hours, excludeStr: Index)
Title: Parse USURDB Schedules
Description: This parses the text strings representing the TOU/seasonal schedules from the USURDB. The result is a matrix indexed by month and time of day.~
~
[sched]: text strings representing the USURDB TOU maps.~
[monthSep]: the text string separating months of data~
[hourSep]: the text string separating hours of data~
[months]: an index representing the calendar months~
[hours]: an index representing 24 hours in the day~
[excludeStr]: an index of text strings that must be removed from sched to reduce it to numeric values
Definition: VAR stringByMonth:=SplitText(sched, monthSep, resultIndex: month);    {Split data vectors into their associated months}~
FOR J:=excludeStr DO (   {For each excluded text string}~
   stringByMonth:=TextReplace(stringByMonth, J, "", all: True)   {Remove all values of the excluded text string}~
);~
~
ParseNumber(SplitText(stringByMonth, hourSep, resultIndex: hours))   {Split data vectors into their associated hours and parse text into numbers}
NodeLocation: 568,88,1
NodeSize: 64,40
WindState: 2,90,265,1154,350

Decision Month_Separator
Title: Month Separator
Description: The text string separating one month's period mappings from the subsequent month's.
Definition: '],'
NodeLocation: 416,280,1
NodeSize: 64,40

Decision Hour_Separator
Title: Hour Separator
Description: The text string separating one hour's period mappings from the subsequent hour's.
Definition: ','
NodeLocation: 568,280,1
NodeSize: 64,40

Variable TOU_Periods
Title: TOU Periods
Description: A matrix assigning TOU periods by month, time of day, and weekday/weekend.
Definition: Parse_USURDB_Sched(Unformatted_TOU_Sche, Month_Separator, Hour_Separator, Month, Time_of_Day, Strings_to_Exclude)
NodeLocation: 568,184,1
NodeSize: 64,40
WindState: 2,167,266,720,339
ValueState: 2,12,81,953,563,,MIDM
ReformVal: [Month,Time_of_Day]
Att_ResultSliceState: [Data_Type,3,Weekday_or_Weekend,2,Rate_Names,10,Time_of_Day,1,Month,1]

Index Strings_to_Exclude
Title: Strings to Exclude
Description: Text strings included in the TOU schedules that will be removed in order to facilitate mappings to a numeric period.
Definition: ['[',']',' ','L']
NodeLocation: 416,88,1
NodeSize: 64,40
Aliases: FormNode Fo1533782525

Decision Flat_Schedule_Labels
Title: Flat Schedule Labels
Description: USURDB columns that include data specific to different tiers and periods, specifically data that can change by month but not time of day. These are used to define the tier and period indices.
Definition: Table(USURDB_Columns)(Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0))
NodeLocation: 416,392,1
NodeSize: 64,40
DefnState: 2,120,12,529,652,,DFNM
Aliases: FormNode Fo1533781491
TableCellDefault: Checkbox(0)

FormNode Fo1533781491
Title: Period Label
Definition: 0
NodeLocation: 416,448,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,
Original: Flat_Schedule_Labels

FormNode Fo1533782525
Title: Strings to Exclude
Definition: 0
NodeLocation: 424,36,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Strings_to_Exclude

Variable Flat_Periods
Title: Flat Periods
Description: The periods associated with flat demand schedules.
Definition: Filtered_USURDB_Data[USURDB_Columns=Flat_Schedules, @Flat_Schedules=@Month]
NodeLocation: 568,392,1
NodeSize: 64,40
ValueState: 2,18,137,1119,421,,MIDM

Variable Periods_by_TOU_Sched
Title: Periods by TOU Schedule
Description: Time of use and seasonal schedules for the given rates.
Definition: IF Data_Type = Flat_Demand_Label~
THEN Flat_Periods~
ELSE TOU_Periods
NodeLocation: 768,280,1
NodeSize: 64,40
ValueState: 2,139,95,892,557,,MIDM
ReformVal: [Month,Time_of_Day]
Att_ResultSliceState: [Rate_Names,4,Data_Type,3,Weekday_or_Weekend,1,Time_of_Day,1,Month,1]
{!40700|CellFormatExpression: CellFill(SubIndex(@Cell_Colors, Self + 10, Cell_Colors), .3)}

Close Find_TOU_Schedules

Module Find_Fixed_Charges
Title: Find Fixed Charges
Author: JamesMilford
Date: Thu, Aug 16, 2018 5:26 AM
NodeLocation: 584,104,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,1,0,938,616,17

Variable Fixed_Charges_Units
Title: Fixed Charges Units
Description: The unit of measure for fixed charges.
Definition: Filtered_USURDB_Data[USURDB_Columns=FixedChrg_Unit_Label]
NodeLocation: 272,184,1
NodeSize: 64,40
ValueState: 2,104,106,1014,357,,MIDM

Decision FixedChrg_Unit_Label
Title: Fixed Charge Units Label
Definition: Choice(USURDB_Columns,24,0)
NodeLocation: 112,184,1
NodeSize: 64,40
Aliases: FormNode Fo1533827725
{!40200|Att_ChoiceIndexes: Index USURDB_Columns}

FormNode Fo1533827725
Title: Tier Label
Definition: 0
NodeLocation: 112,240,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,0
Original: FixedChrg_Unit_Label

Decision Fixed_Charges_Label
Title: Fixed Charges Label
Definition: Choice(USURDB_Columns,23,0)
NodeLocation: 112,64,1
NodeSize: 64,40
Aliases: FormNode Fo1533827804
{!40200|Att_ChoiceIndexes: Index USURDB_Columns}

FormNode Fo1533827804
Title: Tier Label
Definition: 0
NodeLocation: 112,120,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,0
Original: Fixed_Charges_Label

Variable Fixed_Charges
Title: Fixed Charges
Description: Fixed charges for meter connections.
Definition: Filtered_USURDB_Data[USURDB_Columns=Fixed_Charges_Label]
NodeLocation: 272,64,1
NodeSize: 64,40
ValueState: 2,104,106,1014,357,,MIDM

Variable Min_Charges_Units
Title: Min Charges Units
Description: The unit of measure for minimum bill charges.
Definition: Filtered_USURDB_Data[USURDB_Columns=Min_Chrg_Units_Label]
NodeLocation: 624,184,1
NodeSize: 64,40
ValueState: 2,104,106,1014,357,,MIDM

Decision Min_Chrg_Units_Label
Title: Min Charge Units Label
Definition: Choice(USURDB_Columns,505,0)
NodeLocation: 464,184,1
NodeSize: 64,40
Aliases: FormNode Fo1533828601
{!40200|Att_ChoiceIndexes: Index USURDB_Columns}

FormNode Fo1533828601
Title: Tier Label
Definition: 0
NodeLocation: 464,240,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,0
Original: Min_Chrg_Units_Label

Decision Min_Charge_Label
Title: Min Charge Label
Definition: Choice(USURDB_Columns,504,0)
NodeLocation: 464,64,1
NodeSize: 64,40
Aliases: FormNode Fo1533828602
{!40200|Att_ChoiceIndexes: Index USURDB_Columns}

FormNode Fo1533828602
Title: Tier Label
Definition: 0
NodeLocation: 464,120,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,0
Original: Min_Charge_Label

Variable Minimum_Charges
Title: Minimum Charges
Description: Minimum bill charges.
Definition: Filtered_USURDB_Data[USURDB_Columns=Min_Charge_Label]
NodeLocation: 624,64,1
NodeSize: 64,40
ValueState: 2,104,106,781,662,,MIDM

Close Find_Fixed_Charges

Module Rates_Auxiliary_Vari
Title: Rates Auxiliary Variables
Author: JamesMilford
Date: Wed, Oct 31, 2018 10:11 AM
NodeLocation: 280,200,1
NodeSize: 64,40
DiagState: 2,47,102,1240,715,17

Index Rate_Names
Title: Rate Names
Definition: INDEX names:=CopyIndex(Rate_Names_and_Dates);~
SortIndex(names)
NodeLocation: 976,88,1
NodeSize: 64,40
WindState: 2,102,82,1272,359
ValueState: 2,104,106,468,637,,MIDM
{!40300|Att_SlicerPopupSize: 530,202}
Att_PrevIndexValue: ['AL-TOU Secondary (0-500 KW) | 2015-05','AL-TOU Secondary (0-500 KW) | 2017-01','AL-TOU Secondary (0-500 KW) | 2018-01','AL-TOU Secondary (0-500 KW)* | 2018-01','DR - Coastal Baseline Region | 2014-02','DR - Coastal Baseline Region | 2014-08','DR - Coastal Baseline Region | 2015-05','DR - Coastal Baseline Region | 2016-07','DR - Coastal Baseline Region | 2017-01','DR - Coastal Baseline Region | 2018-01','DR - Coastal Baseline Region | 2018-10','DR - Desert Baseline Region | 2014-02','DR - Desert Baseline Region | 2014-08','DR - Desert Baseline Region | 2015-05','DR - Desert Baseline Region | 2016-07','DR - Desert Baseline Region | 2017-01','DR - Desert Baseline Region | 2018-01','DR - Desert Baseline Region | 2018-10','DR - Inland Baseline Region | 2014-02','DR - Inland Baseline Region | 2014-08','DR - Inland Baseline Region | 2015-05','DR - Inland Baseline Region | 2016-07','DR - Inland Baseline Region | 2017-01','DR - Inland Baseline Region | 2018-01','DR - Inland Baseline Region | 2018-10','DR - Mountain Baseline Region | 2014-02','DR - Mountain Baseline Region | 2014-08','DR - Mountain Baseline Region | 2015-05','DR - Mountain Baseline Region | 2016-07','DR - Mountain Baseline Region | 2017-01','DR - Mountain Baseline Region | 2018-01','DR - Mountain Baseline Region | 2018-10','TOU-DR1 Coastal (old) | 2018-01','TOU-DR1 Coastal | 2018-01','TOU-DR1 Desert (old) | 2018-01','TOU-DR1 Desert | 2018-01','TOU-DR1 Inland (old) | 2018-01','TOU-DR1 Inland | 2018-01','TOU-DR1 Mountain (old) | 2018-01','TOU-DR1 Mountain | 2018-01']

Index Tier_Period_Column
Title: Tier & Period Columns
Definition: Subset(Tier_Period_Labels)
NodeLocation: 832,88,1
NodeSize: 64,40
ValueState: 2,12,5,416,585,,MIDM

Index Periods
Att_PrevIndexValue: ['period0','period1','period2','period3','period4','period5']
Title: Periods
Definition: #Find_Valid_TiersPrds[.subscripts='periods']
NodeLocation: 832,272,1
NodeSize: 64,40

Index Tiers
Title: Tiers
Definition: #Find_Valid_TiersPrds[.subscripts='tiers']
NodeLocation: 832,184,1
NodeSize: 64,40
{!40300|Att_SlicerPopupSize: 257,56}

Index Data_Attribute
Title: Data Attribute
Definition: ['rate','max','adj','sell']
NodeLocation: 400,88,1
NodeSize: 64,40
{!40300|Att_SlicerPopupSize: 312,70}
Att_PrevIndexValue: ['rate','max','adj','sell']

Index Data_Type
Title: Data Type
Definition: ['flatdemandstructure','demandratestructure','energyratestructure','coincidentratestructure']
NodeLocation: 256,88,1
NodeSize: 64,40
WindState: 2,591,1,720,350
{!40300|Att_SlicerPopupSize: 382,70}
Att_PrevIndexValue: ['flatdemandstructure','demandratestructure','energyratestructure','coincidentratestructure']

Decision Energy_Rate_Label
Title: Energy Rate Label
Definition: Choice(Data_Type,3,0)
NodeLocation: 256,488,1
NodeSize: 64,40
Aliases: FormNode Fo1533827453
{!40200|Att_ChoiceIndexes: Index Data_Type}

FormNode Fo1533827453
Title: Tier Label
Definition: 0
NodeLocation: 256,536,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,0
Original: Energy_Rate_Label

Decision Energy_Units_Label
Title: Energy Units Label
Definition: 'kWh'
NodeLocation: 688,88,1
NodeSize: 64,40
Aliases: FormNode Fo1540241523

Decision Demand_Rate_Label
Title: Demand Rate Label
Definition: Choice(Data_Type,2,0)
NodeLocation: 256,264,1
NodeSize: 64,40
Aliases: FormNode Fo1534882918
{!40200|Att_ChoiceIndexes: Index Data_Type}

FormNode Fo1534882918
Title: Tier Label
Definition: 0
NodeLocation: 256,312,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,0
Original: Demand_Rate_Label

Decision Flat_Demand_Label
Title: Flat Demand Label
Definition: Choice(Data_Type,1,0)
NodeLocation: 256,376,1
NodeSize: 64,40
Aliases: FormNode Fo1533739020
{!40200|Att_ChoiceIndexes: Index Data_Type}

FormNode Fo1533739020
Title: Tier Label
Definition: 0
NodeLocation: 256,424,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,0
Original: Flat_Demand_Label

Index TOU_Schedules
Title: TOU Schedules
Definition: Subset(TOU_Schedule_Labels)
NodeLocation: 544,88,1
NodeSize: 64,40

Index Schedules_with_None
Title: Schedules with None
Definition: Concat(None_Label, TOU_Schedules)
NodeLocation: 544,176,1
NodeSize: 64,40
Att_PrevIndexValue: ['None','demandweekdayschedule','demandweekendschedule','energyweekdayschedule','energyweekendschedule','coincidentschedule']

Index Flat_Schedules
Title: Flat Schedules
Definition: Subset(Flat_Schedule_Labels)
NodeLocation: 544,264,1
NodeSize: 64,40

Decision Rate_Attribute_Label
Title: Rate Attribute Label
Definition: Choice(Data_Attribute,1,0)
NodeLocation: 400,400,1
NodeSize: 64,40
Aliases: FormNode Fo1534354909
{!40200|Att_ChoiceIndexes: Index Data_Attribute}

FormNode Fo1534354909
Title: Period Label
Definition: 0
NodeLocation: 400,448,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,
Original: Rate_Attribute_Label

Decision Max_Attribute_Label
Title: Max Attribute Label
Definition: Choice(Data_Attribute,2,0)
NodeLocation: 400,288,1
NodeSize: 64,40
Aliases: FormNode Fo1534876792
{!40200|Att_ChoiceIndexes: Index Data_Attribute}

FormNode Fo1534876792
Title: Period Label
Definition: 0
NodeLocation: 400,336,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,
Original: Max_Attribute_Label

Decision Adj_Attribute_Label
Title: Adj Attribute Label
Definition: Choice(Data_Attribute,3,0)
NodeLocation: 400,176,1
NodeSize: 64,40
Aliases: FormNode Fo1534879211
{!40200|Att_ChoiceIndexes: Index Data_Attribute}

FormNode Fo1534879211
Title: Period Label
Definition: 0
NodeLocation: 400,224,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,
Original: Adj_Attribute_Label

Decision Assign_Name_to_Perio
Title: Assign Name to Period
Definition: Table(Periods,Rate_Names)(~
0,0,0,'Summer On-Peak (energy)',0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,'Summer On-Peak',0,'Summer On-Peak',0,'Summer On-Peak',0,'Summer On-Peak',0,~
0,0,0,'Summer Semi-Peak (energy), Summer On-Peak (demand)',0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,'Summer Off-Peak',0,'Summer Off-Peak',0,'Summer Off-Peak',0,'Summer Off-Peak',0,~
0,0,0,'Summer Off-Peak (energy), Winter On-Peak (demand)',0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,'Summer Super Off-Peak',0,'Summer Super Off-Peak',0,'Summer Super Off-Peak',0,'Summer Super Off-Peak',0,~
0,0,0,'Winter On-Peak (energy)',0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,'Winter On-Peak',0,'Winter On-Peak',0,'Winter On-Peak',0,'Winter On-Peak',0,~
0,0,0,'Winter Semi-Peak (energy)',0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,'Winter-Off-Peak',0,'Winter-Off-Peak',0,'Winter-Off-Peak',0,'Winter-Off-Peak',0,~
0,0,0,'Winter Off-Peak (energy)',0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,'Winter Super Off-Peak',0,'Winter Super Off-Peak',0,'Winter Super Off-Peak',0,'Winter Super Off-Peak',0)
NodeLocation: 688,200,1
NodeSize: 64,40
DefnState: 2,110,53,1345,301,,DFNM

Index Demand_Data_Types
Title: Demand Data Types
Definition: Subset(Data_Type <> Energy_Rate_Label)
NodeLocation: 256,176,1
NodeSize: 64,40

FormNode Fo1540241523
Title: Energy Units Label
Definition: 0
NodeLocation: 688,136,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,
Original: Energy_Units_Label

Close Rates_Auxiliary_Vari

Close Retail_and_Export_Ra

