{ Analytica Model Import_Worksheets, encoding="UTF-8" }
SoftwareVersion 6.3.0

{!-60000|Attribute AcpStyles}


LinkModule Import_Worksheets
Title: Import Worksheets
Description: Module for importing data into an Analytica model from an Excel spreadsheet template. It imports from each specified sheet (tab) into a corresponding Analytica variable (Constant) transforming it from a relational table (or fact table) form into a multidimensional table with specified indexes.
Author: Max Henrion & Paul Sanford
Date: Sun, Jul 27, 2014 2:56 PM
DefaultSize: 64,40
NodeSize: 80,56
DiagState: 2,377,34,858,671,17,10
WindState: 2,355,67,533,321
NodeColor: 65535,65535,65535
DiagramColor: 65535,65535,65535
Pict: (000000000000003B003C00041608000089504E470D0A1A0A0000000D494844520000003C0000003B080600000027F9E9CA000000017352474200AECE1CE90000000467414D410000B18F0BFC6105000000097048597300000EC300000EC301C76FA8640000079B494441546843ED9B795454551CC7473B626569A7B2542C43532B7341105A2C154DCA236E9995A6765C52D1D23A6E95D87A523BA74C5974581C156610064196044713890015640BD9251762534174401878F7D7FD3DA4E6313F4F0E36C368F3C7E7BC99EFFDBD37F7FBEEEF77EF7DC3200380FF15A4889469CFF6FBEEF8329F1509AE71EE47261E3227CBE35DE3D626CE54E75E4A73A0FA763B9022B23D63FD26A768198C3A2003A79FCD488C0C1CC3F9E746CA607AF4E0FCE2EA9C2154FFDA0B29221E49F3F6A0E109A18F577C9E38276843E27B817834251EBFCDDDBB2E615688B3B26B83BD921BDF2F831931CFE61656670FA5FAD81E4811F92A65A1BFF341192C3B3CE130D56E2A7442A38D8BBA67D5C86019A069CCB0A991830A0AAAB38651F1C6428A48ABE1251A975FA8765351A7BBFAE09890872F3BA83AB1259AF147C6F2D7A378A64D8F199CFF5F98264544DF3003D6898A31055A5D6D7734EC1826838842BF4509A5516ECEFBBA3660794D891A58985F9D31823AEF562145A4C30DF3FADD97EFB902B5832541735E5677D3FE3DD2973387B73DEF562145C4120CABF27E5AD9AA1F280E58E018DC5970E2B3B75BE480E2D3ED5CB24811B134C388BA60C752E7902EBA515198DE4F17E55F363EBD4911B144C3C8FE42DFC568DA094D473F5D64ECE68414114B358CB498B669C4CDC9E448BB929C4BA98E541C052922966C185117EC5CE2B8AFB3209A8EEA7FE6F42D9A2645C4D20D2381B93F7E6CAF6AD99CBC11D1EFECEF174F385171FA9022620986D5053ECBA8187D30BD5F09EB5EEB18C167EF98FE67FECD3429221D65F85AE3951EAF863C54E3102A8355F16E5181B93F7CA2C8D9BC8E62CFE9EFD728F3B6AE9A1FFB62F2483ED2B859718DB02D4DAB383686BA36428A484719BEDEACED3621AC57392E3D98AA78C419F966600D3BAA5BCCA2697CDAF2489ABF9BBA36428A484719C6CFDACB47F5836363E31769C61C5B78E8D5847F03E3166BC6C6BB84F6ACC29BF065CA8200EADA0829221D65F876589FF84EB073AC0CB0EF543B428AC89D68784DC24CB5D5701B4811B11A26622C0DAB61025244AC8689184BC36A98801411AB6122C6D2B01A262045C46A988811D1D57523F586ABDD49FD7ACDC3507D6620D97613D8B5325BA8CC72802B7F0CA0DA5B31BDE1F253CEB0DF2D9965EE5A2ED173821641F8A413703ED145A223B1EE4A50D89742D9C9970DDADAC29AEF61A9DB3E05E5E87CF0B6AB638A911784048FAD37BBC9A6379CE6B90EF6D802F319580B35252DA3A6ADE823C8875640A02DC0F11F364AE2055D17E6CBDB76F5014897AF92B411B0E42D5F832F8FF5E7E0D1AFE5B57074BD37156F7AC395990ECCA7BF56EC500AEF1CD7D889AD1BB0638C8F0894A74BBF5F42C3FEF61740DE1B20C3FF43495B5B6A8A0731EF01D730961D987D909D8D7705CD4A05ECE4EF3D9F6C60159906DF529AA586D991D57271C4768D2A613CC559D0F84C50F0F79A8F1406F1683860E479D1706680F877A39B92A79E0B727E1D9E11ECCAF9A744ADF16A77E6FB7C2504709D38DF3C86719477F051F6EA054C39211D3C7B01783DA163A5C75F318837C6709AD75A4C63B6CBA9049A1BBAB6EA2CF19B2DA0187C0572540B24F11CB3184658F4C2304C35F0E260CA452D0807A1F91E8358630C17FD3C037CF8B57CFA360927B77DCA6E98668CF70527CBA6EBF7B53DC76C86A12CF5255EB3F5689879E2E8A6188E2E628CE1C6AB3D986A629A383F6CE759A374C982A46F37F3256D1019CF319F615C5BFD1DCEC18EDE20E08C5D57C97B48C4196318A9CAB6672A6E146B79379FF579EDB280A195AC386E2A156F3EC3B97C82F1EE23601D83776F26A4FBD27F2231D630A2D33EC0327C5741EC6235F37AAA5E5C967C879781B69CDF0569AC790CF35A624A9E7ABC76859F7A33B18683C667E08C6A106B544AD7F680D2A4B192EB14C5CC603BF872C76B1B7243E64BE2396631CC8A0F4E839D7D9BD876DB26217EC336E6CD4781A736CB512E3488D7379CBD67A941BB1E2C4BE18EEBB910B762AFBE2EEC1E9D276E4052F9A6474F474C6F5868B46161338E8AF5153A25915DAF7E4488783716D76121705C96C14CAA67989DDCBE5EACFDFACB8F42FDA59EAC9EBFD68FC565079725F97317415BC9EF10D77037277FA65A9CBDF3D4EF49E239A6375CCC970E5C8A70447343E6895A7EF86C31E5502F8C7A4B128F86FD86FF2976D87F442953BD768A29C767B2C071D92C74E22921DDEF9FDAAF2E7A46DCAD61A9EC9FA5116F50C8E464BC09827C4815ABBDD04F726D8EC90D33DC1EE25E5AE59ACA3707F78ABAA0B31182271DC7BD344BF3592D3987099D05F5B404712786BB25CC0C05078FC17DF9FA3DFF807E3C3BB9ED3331FD3116D31867699F3E02CBDEBB443FAE15D31BC694E435CC6ADA3CEEE1635C49EC345677F131898E605A96F0BA2FE6ED37C0D77086537BCE4E128B4F4B38B9A9C66583DFB07216FEE65128889C2589D1C32C93965968D6D94053FDFD982164FB0DEE1EC3B788D53001292256C3448CA561354C408A88BE61AADD12F94F0CBB1F7E4D43B55B22EB7E7D7B5FBB0D7F91FCBE027F023439DCAE6467D6975FF8667FED21CFFE6AA34592D5C2CCE82139F843F276FD8A67D389E55ECE712DBF9542E37702D857678D0C36F2C1A23C21A4886455A5BCB0F2985B94FBD18987DC7FB973C0FF794A2A8B7D9DF28490E2DD0BC8FE02F4F4ECCE4B813A9D0000000049454E44AE426082)
FontStyle: Arial Narrow,19
FileInfo: 0,LinkModule Import_Worksheets,2,2,0,0,Import Worksheets.ana

Button Show_Stored_Imported
Title: Show Stored Imported Data
Description: Press to show the variable where the imported dataset has been stored. The stored data has been dimensionalized using fact column indices and a value index (if applicable).
NodeLocation: 528,512,1
NodeSize: 64,40
OnClick: MetaVar varHandle:=Active_StoreLocatio1;~
VAR ident:=Identifier of varHandle;~
Show_Result(ident)

Button Release_Spreadsheet
Title: Release Spreadsheet
Description: After viewing a specific dataset, it may be necessary to "release" the spreadsheet so it can be opened and viewed (Analytica will open the spreadsheet to perform the import, but the spreadsheet may not be visible on the desktop). Pressing this button will release the spreadsheet, but it will also discard the data chosen for temporary viewing (though it does not discard any of the data stored in the model).
NodeLocation: 672,512,1
NodeSize: 64,40
Aliases: Alias Al246404387, Alias New1004128547, Alias New2010761507, Alias New1608108323, Alias New1397893411
OnClick: (Import_Reset1:=NOT Import_Reset1)

Module Structural_Settings_
Title: Structural Settings for Import
Author: JamesMilford
Date: Fri, Dec 21, 2018 10:51 AM
NodeLocation: 664,320,1
NodeSize: 72,40
DiagState: 2,39,12,1823,829,17,10
NodeColor: 65535,65535,65535

Module Excel_Import_Logic
Title: Excel Import Logic
Author: JamesMilford
Date: Sun, Dec 16, 2018 8:07 AM
NodeLocation: 696,656,1
NodeSize: 64,40
DiagState: 2,138,78,834,506,17,10

Module Import_Auxiliary_Var
Title: Import Auxiliary Variables
Author: JamesMilford
Date: Sun, Dec 16, 2018 8:07 AM
NodeLocation: 216,184,1
NodeSize: 64,40
DiagState: 2,17,69,1787,586,17,10

Index Import_Fixed_Params
Att_PrevIndexValue: ['Selected for Import','File Path','Tab Name','Data Start Cell','Data Type','Missing Data Default','Stored Location','Value Index']
Title: Import Fixed Params
Definition: ['Selected for Import','File Path','Tab Name','Data Start Cell','Data Type','Missing Data Default','Stored Location','Value Index']
NodeLocation: 88,80,1
NodeSize: 64,40
WindState: 2,651,5,720,350

Decision Max_Imported_Dim
Title: Max Imported Dimensions
Description: WARNING: Reducing this number may result in a loss of data.~
~
The maximum number of fact column dimensions that can be imported from Excel. This determines the size of the Excel Import Settings table. When reducing this number, ensure that it will not result in discarding previously defined fact column configurations.
Definition: 4
NodeLocation: 88,168,1
NodeSize: 64,40
WindState: 2,11,69,855,404
Aliases: FormNode New1322895651, FormNode New333039907

Index Fact_Col_Index_Param
Att_PrevIndexValue: ['Fact Column Index 1','Fact Column Index 2','Fact Column Index 3','Fact Column Index 4','Fact Column Index 5']
Title: Fact Col Index Params
Definition: INDEX dims:=1..Max_Imported_Dim;~
CopyIndex("Fact Column Index " & dims)
NodeLocation: 88,272,1
NodeSize: 64,40

Index Excel_Import_Params
Att_PrevIndexValue: ['Selected for Import','File Path','Tab Name','Data Start Cell','Data Type','Missing Data Default','Stored Location','Value Index','Fact Column Index 1','Fact Column Index 2','Fact Column Index 3','Fact Column Index 4']
Title: Excel Import Parameters
Definition: Concat(Import_Fixed_Params, Fact_Col_Index_Param)
NodeLocation: 88,360,1
NodeSize: 64,40
WindState: 2,1976,100,720,350
ValueState: 2,104,106,406,324,0,MIDM

Variable Variable_Identifier
Title: Variable Identifier
Definition: Null
NodeLocation: 240,360,1
NodeSize: 64,40

Index Index_Identifier
Title: Index Identifier
Definition: []
NodeLocation: 240,448,1
NodeSize: 64,40

Decision Import_Param_Default
Title: Import Param Default
Definition: Table(Excel_Import_Params)(Checkbox(0),Path_to_Global_Data1,'SheetName','A7',Choice(Import_Data_Types,1,0),Null,Handle(Variable_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier))
NodeLocation: 88,448,1
NodeSize: 64,40
DefnState: 2,313,331,884,477,0,DFNM
ValueState: 2,230,172,416,303,,MIDM
Aliases: FormNode New786024739
TableCellDefault: Handle(Index_Identifier)

Decision Excel_Import_Setting
Title: Excel Import Settings
Description: This tables defines:~
1) the datasets that will be imported from spreadsheets~
2) the spreadsheet names, tab names, and data start cell locations for each dataset~
3) the type of data expected, e.g., number, text, or date~
4) the dimensionality that will be applied to the imported data~
5) the variable location where the imported data will be stored in the model~
~
Parameter Instructions:~
Selected for Import - check this to include the dataset in the next import.~
File Path - the path to the spreadsheet file, which can be an identifier to another object/variable that holds the path.~
Tab Name - the name of the spreadsheet tab where the data resides.~
Data Start Cell - the upper leftmost cell where the dataset resides, which is often populated with a column header.~
Data Type - the required type of data; use "Any" of the data type is not important~
Missing Data Default - the value assigned to any missing coordinates in the dimensionalized dataset (e.g., Null, 0, 'missing', etc.)~
Stored Location - the handle to the variable where the imported data will be stored in the model; this must follow the Handle(Some_Identifier) syntax; often you'll need to add this storage variable to the model prior to specifying the handle in this import settings table.~
==== The following parameters must take the form of Handle(Identifier) when applicable, or Null when not applicable =====~
Value Index - the handle to the index that appears as columns in the spreadsheet and relates to data values, rather than data coordinates~
Fact Column Index 1 - the handle to the index that appears as the leftmost column in the spreadsheet and describes data coordinates, rather than values~
Fact Column Index 2 - the handle to the index that appears as the 2nd leftmost column in the spreadsheet and describes data coordinates, rather than values~
Fact Column Index N - the handle to the index that appears as the Nth leftmost column in the spreadsheet and describes data coordinates, rather than values~
~
Illustrative Excel Data (assume that 'FactCol1' appears in cell A1 of the spreadsheet):~
						ValueInd ->~
FactCol1	FactCol2	2020	2025	2030~
CO			Urban		103		122		136~
CO			Rural		45		51		66~
CA			Urban		567		632		777~
CO			Rural		112		161		202~
~
As an example, the table above would be characterized as follows:~
~
Data Start Cell: 			'A1'~
Value Index: 			Handle(Years)~
Fact Column Index 1: 	Handle(States)~
Fact Column Index 2: 	Handle(Land_Type)~
Fact Column Index 3..N: 	Null
Definition: DetermTable(Select_Model_for_Dat,Imported_Dataset_Num,Excel_Import_Params)(~
Checkbox(0),Path_to_Global_Data1,'SGIP_Data','A7',Choice(Import_Data_Types,1,0),Null,Handle(SGIP_Data),Handle(SGIP_Data_Columns),Handle(SGIP_Data_Rows),Null,Null,Null,~
Checkbox(1),Path_to_Global_Data1,'Single_Cell_Inputs','A7',Choice(Import_Data_Types,1,0),Null,Handle(Single_Cell_Inputs),Null,Handle(SingCell_Input_Names),Null,Null,Null,~
Checkbox(1),Path_to_Global_Data1,'Hourly_Profiles','A7',Choice(Import_Data_Types,1,0),Null,Handle(Hourly_Profile_Data),Handle(Hourly_Profile_Names),Handle(Hourly_Profile_Rows),Null,Null,Null,~
Checkbox(1),Path_to_Global_Data1,'Holiday_Dates','A7',Choice(Import_Data_Types,4,0),Null,Handle(Dates_of_Holidays),Handle(Holiday_Name),Handle(Holiday_Years),Null,Null,Null,~
Checkbox(0),'C:\Documents\Filename.xlsx','SheetName','A7',Choice(Import_Data_Types,1,0),Null,Handle(Variable_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Null,~
Checkbox(1),Path_to_Global_Data1,'PV_CapFactor','A7',Choice(Import_Data_Types,2,0),Null,Handle(PV_Capacity_Factor),Handle(Area_Type),Handle(PV_Climate_Zone),Handle(All_PV_Sectors),Null,Null,~
Checkbox(0),Path_to_Global_Data1,'PV_NewConstr_Size','A7',Choice(Import_Data_Types,2,0),Null,Handle(NewConstr_Code_Sys_S),Handle(NewConstr_Code_Param),Handle(PV_Climate_Zone),Handle(All_Sectors),Null,Null,~
Checkbox(1),Path_to_Global_Data1,'Battery_Specs','A7',Choice(Import_Data_Types,2,0),Null,Handle(Battery_Storage_Spec),Handle(All_Sectors),Handle(Battery_Specs),Null,Null,Null,~
Checkbox(0),'C:\Documents\Filename.xlsx','SheetName','A7',Choice(Import_Data_Types,1,0),Null,Handle(Variable_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Null,~
Checkbox(1),Path_to_Global_Data1,'DC_to_AC_Ratio','A7',Choice(Import_Data_Types,2,0),Null,Handle(DC_to_AC_Ratio),Handle(All_PV_Sectors),Handle(PV_Climate_Zone),Null,Null,Null,~
Checkbox(1),Path_to_Global_Data1,'Finance_Rates','A7',Choice(Import_Data_Types,2,0),Null,Handle(Debt_Equity_Rates),Handle(All_PV_Sectors),Handle(Debt_or_Equity),Null,Null,Null,~
Checkbox(1),Path_to_Global_Data1,'Fed_ITC','A7',Choice(Import_Data_Types,2,0),Null,Handle(Invest_Tax_Credit),Handle(All_Sectors),Handle(ITC_Scenario),Handle(Static_PV_Time),Null,Null,~
Checkbox(0),Path_to_Global_Data1,'Strg_Duration_Incent','A7',Choice(Import_Data_Types,2,0),Null,Handle(kWh_Incen_Dur_Derate),Handle(Incent_Durat_Inputs),Handle(Incent_Duration_Step),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'Vehicle_Stock_Data','A7',Choice(Import_Data_Types,2,0),Null,Handle(Vehicle_Stock_Data),Handle(Vehicle_Stock_DataYr),Handle(All_Sectors),Handle(All_Spatial_ID),Handle(All_Vehicle_Techs),Null,~
Checkbox(0),Path_to_Global_Data1,'Struct_Single_Cell_Inputs','A7',Choice(Import_Data_Types,1,0),Null,Handle(StructSingCell_Input),Null,Handle(StructSingCell_Names),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'Hist_Vehicle_Growth','A7',Choice(Import_Data_Types,2,0),Null,Handle(Hist_Veh_Growth_Rate),Null,Handle(All_Vehicle_Techs),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'EV_MktShare_Mults','A7',Choice(Import_Data_Types,2,0),Null,Handle(EV_Mkt_Share_Mult),Null,Handle(EV_Mkt_Share_Scen),Null,Null,Null,~
Checkbox(1),Path_to_Global_Data1,'Building_Stock','A7',Choice(Import_Data_Types,2,0),0.001,Handle(Building_Stock),Handle(Building_Stock_Year),Handle(All_Sectors),Handle(All_Spatial_ID),Null,Null,~
Checkbox(0),Path_to_Global_Data1,'Aggreg_Spatial_ID','A7',Choice(Import_Data_Types,2,0),Null,Handle(All_Agg_Spatial_IDs),Null,Handle(All_Spatial_ID),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'EV_Map_Increm_to_Cumul','A7',Choice(Import_Data_Types,1,0),Null,Handle(EV_Map_Increm_Cumul),Null,Handle(EV_Adopt_Data_Types),Null,Null,Null,~
Checkbox(1),Path_to_Global_Data1,'Climate_Zone_Map','A7',Choice(Import_Data_Types,3,0),Null,Handle(All_Spatial_ID_to_CZ),Null,Handle(All_Spatial_ID),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'Fuel_Prices','A7',Choice(Import_Data_Types,2,0),Null,Handle(Fuel_Prices),Handle(Vehicle_Input_Years),Handle(Fuel_Types),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'MPG','A7',Choice(Import_Data_Types,2,0),Null,Handle(MPG),Handle(Vehicle_Input_Years),Handle(All_Vehicle_Techs),Handle(Fuel_Types),Null,Null,~
Checkbox(0),Path_to_Global_Data1,'VMT','A7',Choice(Import_Data_Types,2,0),Null,Handle(VMT),Null,Handle(Vehicle_Input_Years),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'Fuel_Mix','A7',Choice(Import_Data_Types,2,0),Null,Handle(Fuel_Mix),Handle(Vehicle_Input_Years),Handle(Fuel_Types),Handle(All_Vehicle_Techs),Null,Null,~
Checkbox(0),Path_to_Global_Data1,'Vehicle_Price','A7',Choice(Import_Data_Types,2,0),Null,Handle(Vehicle_Price),Handle(Vehicle_Input_Years),Handle(All_Vehicle_Techs),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'Vehicle_Range','A7',Choice(Import_Data_Types,2,0),Null,Handle(Vehicle_Range),Handle(Vehicle_Input_Years),Handle(All_Vehicle_Techs),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'Maint_Costs','A7',Choice(Import_Data_Types,2,0),Null,Handle(Vehicle_Maint_Cost),Handle(Vehicle_Input_Years),Handle(All_Vehicle_Techs),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'Veh_Type_Map','A7',Choice(Import_Data_Types,1,0),Null,Handle(Vehicle_Type_Map),Null,Handle(All_Vehicle_Techs),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'Vehicle_Tech_Pref','A7',Choice(Import_Data_Types,2,0),Null,Handle(Vehicle_Tech_Pref),Null,Handle(All_Vehicle_Techs),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'Veh_Incentives','A7',Choice(Import_Data_Types,2,0),Null,Handle(Vehicle_Incents),Handle(Vehicle_Input_Years),Handle(All_Vehicle_Techs),Handle(Veh_Incentive_Type),Handle(EV_Incent_Scenario),Null,~
Checkbox(0),Path_to_Global_Data1,'Veh_DecisionVars','A7',Choice(Import_Data_Types,2,0),Null,Handle(Stored_EV_Dec_Vars),Handle(All_EV_Dec_Handles),Handle(All_Spatial_ID),Handle(All_Sectors),Null,Null,~
Checkbox(0),Path_to_Global_Data1,'Veh_OptStatus','A7',Choice(Import_Data_Types,3,0),Null,Handle(Stored_Opt_Status_EV),Handle(All_Sectors),Handle(All_Spatial_ID),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'Veh_R2Thresh','A7',Choice(Import_Data_Types,2,0),Null,Handle(R2_Threshold),Null,Handle(EV_Calibration_Stage),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'Veh_CalibDates','A7',Choice(Import_Data_Types,2,0),Null,Handle(EV_Dates_Incl_by_Stg),Handle(EV_Calibration_Stage),Handle(Time_EV_Calibration),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'Veh_CalibDecisions','A7',Choice(Import_Data_Types,2,0),Null,Handle(EV_Decisions_by_Stg),Handle(EV_Calibration_Stage),Handle(All_EV_Decisions),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'Veh_OptSetting','A7',Choice(Import_Data_Types,2,0),Null,Handle(EV_OptSettings_byStg),Handle(EV_Calibration_Stage),Handle(Opt_Settings_EVs),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'Veh_DecisBounds','A7',Choice(Import_Data_Types,2,0),Null,Handle(EV_Dec_Var_Bounds),Handle(Upper_Lower),Handle(All_EV_Decisions),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'Veh_Stock_Mults','A7',Choice(Import_Data_Types,2,0),Null,Handle(Vehicle_Stock_Multip),Null,Handle(All_Spatial_ID),Null,Null,Null,~
Checkbox(1),Path_to_Global_Data1,'Equip_Prices','A7',Choice(Import_Data_Types,2,0),Null,Handle(Base_Installed_Cost_),Handle(All_PV_Sectors),Handle(All_Equipment_Types),Handle(Static_PV_Time),Null,Null,~
Checkbox(1),Path_to_Global_Data1,'DER_PriceChangeRate','A7',Choice(Import_Data_Types,2,0),Null,Handle(DER_Cost_Change_Rate),Handle(All_PV_Sectors),Handle(DER_Cost_Scenario),Handle(All_Equipment_Types),Null,Null,~
Checkbox(1),Path_to_Global_Data1,'Equip_Lifetime','A7',Choice(Import_Data_Types,2,0),Null,Handle(Equipment_Lifetime),Null,Handle(All_Equipment_Types),Null,Null,Null,~
Checkbox(1),Path_to_Global_Data1,'OM_Cost','A7',Choice(Import_Data_Types,2,0),Null,Handle(O_M_Cost),Handle(All_PV_Sectors),Handle(All_Equipment_Types),Handle(Static_PV_Time),Null,Null,~
Checkbox(1),Path_to_Global_Data1,'Interconn_Fee','A7',Choice(Import_Data_Types,2,0),Null,Handle(Interconnect_Fee),Null,Handle(Static_PV_Time),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'PV_Hist_Capacity_Installs','A7',Choice(Import_Data_Types,1,0),Null,Handle(Historical_PV_Capaci),Handle(Interconnect_Date),Handle(All_Utilities),Handle(All_Sectors),Handle(All_Spatial_ID),Null,~
Checkbox(0),Path_to_Global_Data1,'PV_Historical_Installs','A7',Choice(Import_Data_Types,1,0),Null,Handle(Historical_PV_Instal),Handle(Interconnect_Date),Handle(All_Utilities),Handle(All_Sectors),Handle(All_Spatial_ID),Null,~
Checkbox(0),'C:\Documents\Filename.xlsx','SheetName','A7',Choice(Import_Data_Types,1,0),Null,Handle(Variable_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Null,~
Checkbox(0),'C:\Documents\Filename.xlsx','SheetName','A7',Choice(Import_Data_Types,1,0),Null,Handle(Variable_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Null,~
Checkbox(0),'C:\Documents\Filename.xlsx','SheetName','A7',Choice(Import_Data_Types,1,0),Null,Handle(Variable_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Null,~
Checkbox(1),Path_to_Global_Data1,'NewConstr_Suitability','A7',Choice(Import_Data_Types,2,0),Null,Handle(PV_New_Construction_),Handle(All_PV_Sectors),Handle(NC_Suitability_Scens),Null,Null,Null,~
Checkbox(0),'C:\Documents\Filename.xlsx','SheetName','A7',Choice(Import_Data_Types,1,0),Null,Handle(Variable_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Null,~
Checkbox(0),'C:\Documents\Filename.xlsx','SheetName','A7',Choice(Import_Data_Types,1,0),Null,Handle(Variable_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Null,~
Checkbox(0),'C:\Documents\Filename.xlsx','SheetName','A7',Choice(Import_Data_Types,1,0),Null,Handle(Variable_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Null,~
Checkbox(0),'C:\Documents\Filename.xlsx','SheetName','A7',Choice(Import_Data_Types,1,0),Null,Handle(Variable_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Null,~
Checkbox(1),Path_to_Global_Data1,'Stock_Basis','A7',Choice(Import_Data_Types,3,0),Null,Handle(PV_Stock_Basis_by_Se),Null,Handle(All_Sectors),Null,Null,Null,~
Checkbox(1),Path_to_Global_Data1,'PV_Power_Density','A7',Choice(Import_Data_Types,2,0),Null,Handle(Power_Density),Handle(Area_Type),Handle(All_PV_Sectors),Null,Null,Null,~
Checkbox(0),'C:\Documents\Filename.xlsx','SheetName','A7',Choice(Import_Data_Types,1,0),Null,Handle(Variable_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Null,~
Checkbox(1),Path_to_Global_Data1,'PV_Module_to_Area','A7',Choice(Import_Data_Types,2,0),Null,Handle(Module_to_Area_Ratio),Handle(Area_Type),Handle(All_PV_Sectors),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'PV_CalibDecis','A7',Choice(Import_Data_Types,2,0),Null,Handle(PV_Decisions_by_Stg),Handle(PV_Calibration_Stage),Handle(All_PV_Decisions),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'PV_Constraints','A7',Choice(Import_Data_Types,2,0),Null,Handle(PV_Constraints_by_St),Handle(PV_Calibration_Stage),Handle(All_PV_Constraints),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'PV_CalibDates','A7',Choice(Import_Data_Types,2,0),Null,Handle(PV_Dates_Incl_by_Stg),Handle(PV_Calibration_Stage),Handle(Time_PV_Calibration),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'PV_R2Thresh','A7',Choice(Import_Data_Types,2,0),Null,Handle(R2_Threshold1),Handle(PV_Calibration_Stage),Handle(All_Sectors),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'PV_CalibToler','A7',Choice(Import_Data_Types,2,0),Null,Handle(PV_Tolerance_by_Stag),Handle(PV_Calibration_Stage),Handle(Tolerance_Input),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'PV_OptSetting','A7',Choice(Import_Data_Types,2,0),Null,Handle(PV_OptSettings_byStg),Handle(PV_Calibration_Stage),Handle(Opt_Settings_PV),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'PV_DecisBounds','A7',Choice(Import_Data_Types,2,0),Null,Handle(PV_Dec_Var_Bounds),Handle(Upper_Lower),Handle(All_PV_Decisions),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'PV_DecisionVars','A7',Choice(Import_Data_Types,2,0),Null,Handle(Stored_PV_Dec_Vars),Handle(All_PV_Dec_Handles),Handle(All_Spatial_ID),Handle(All_Sectors),Null,Null,~
Checkbox(0),Path_to_Global_Data1,'PV_OptStatus','A7',Choice(Import_Data_Types,3,0),Null,Handle(Stored_Opt_Status_PV),Handle(All_Sectors),Handle(All_Spatial_ID),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'Strg_Cap_Derate','A7',Choice(Import_Data_Types,2,0),Null,Handle(kWh_Incent_DerateCap),Handle(Incent_MWhCap_Inputs),Handle(Incent_Capacity_Step),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'Strg_Incent_BaseRate','A7',Choice(Import_Data_Types,2,0),Null,Handle(Strg_kWh_Base_Rate),Handle(Incentive_Steps),Handle(ITC_Applied),Handle(All_Sectors),Handle(PV_Climate_Zone),Null,~
Checkbox(0),'C:\Documents\Filename.xlsx','SheetName','A7',Choice(Import_Data_Types,1,0),Null,Handle(Variable_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Null,~
Checkbox(0),'C:\Documents\Filename.xlsx','SheetName','A7',Choice(Import_Data_Types,1,0),Null,Handle(Variable_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Null,~
Checkbox(0),Path_to_Global_Data1,'Incent_StartMonth','A7',Choice(Import_Data_Types,1,0),Null,Handle(Incentive_Step_Start),Handle(Incentive_Steps),Handle(All_Sectors),Null,Null,Null,~
Checkbox(1),Path_to_Global_Data1,'MACRS','A7',Choice(Import_Data_Types,2,0),Null,Handle(MACRS_Schedule),Handle(All_Sectors),Handle(PV_Operating_Year),Null,Null,Null,~
Checkbox(1),Path_to_Global_Data1,'Tax_Rates','A7',Choice(Import_Data_Types,2,0),Null,Handle(Tax_Rates),Handle(Tax_Entity),Handle(Static_PV_Time),Null,Null,Null,~
Checkbox(1),Path_to_Global_Data1,'Bonus_Deprec','A7',Choice(Import_Data_Types,2,0),Null,Handle(Bonus_Deprec_Sched),Null,Handle(Static_PV_Time),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'NewConstr_Share','A7',Choice(Import_Data_Types,2,0),Null,Handle(NewConstr_Mkt_Share),Handle(Static_PV_Time),Handle(All_Sectors),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'Vehicle_Impact','A7',Choice(Import_Data_Types,2,0),Null,Handle(Impact_per_EV),Null,Handle(All_Vehicle_Techs),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'PV_Scale_Load','A7',Choice(Import_Data_Types,1,0),Null,Handle(Scale_PV_Size_by_Cov),Null,Handle(All_PV_Sectors),Null,Null,Null,~
Checkbox(1),Path_to_Global_Data1,'Consumption_by_Sector','A7',Choice(Import_Data_Types,2,0),0.001,Handle(Consumption_by_Secto),Null,Handle(All_PV_Sectors),Handle(Spatial_ID),Null,Null,~
Checkbox(1),Path_to_Global_Data1,'Load_Profiles','A7',Choice(Import_Data_Types,1,0),Null,Handle(Load_Profiles),Handle(All_Sectors),Handle(Hourly_Profile_Rows),Null,Null,Null,~
Checkbox(1),Path_to_Global_Data1,'Solar_Profile_Map','A7',Choice(Import_Data_Types,1,0),Null,Handle(Solar_Profile_Map),Handle(All_Sectors),Handle(PV_Climate_Zone),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'PV_Init_Adop_Fraction','A7',Choice(Import_Data_Types,1,0),Null,Handle(PV_Init_Adop_Fractio),Handle(All_PV_Sectors),Handle(Spatial_ID),Handle(Area_Type),Null,Null,~
Checkbox(1),Path_to_Global_Data1,'Total_PV_Area','A7',Choice(Import_Data_Types,1,0),Null,Handle(Total_PV_Area),Handle(All_PV_Sectors),Handle(Area_Type),Handle(Spatial_ID),Handle(Building_Stock_Year),Null,~
Checkbox(0),Path_to_Global_Data1,'EUI','A7',Choice(Import_Data_Types,1,0),Null,Handle(EUI),Handle(Roof_Dummy),Handle(Spatial_ID),Handle(All_PV_Sectors),Null,Null,~
Checkbox(0),Path_to_Global_Data1,'Facility_Data','A1',Choice(Import_Data_Types,1,0),Null,Handle(Facility_Data1),Handle(Facility_Parameter),Handle(Facility_Identifier),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'Park_To_GFA_Ratio','A7',Choice(Import_Data_Types,1,0),Null,Handle(Ratio_of_Parking_Ar1),Handle(Spatial_ID),Handle(All_PV_Sectors),Null,Null,Null,~
Checkbox(1),Path_to_Global_Data1,'PV_Suitability','A19',Choice(Import_Data_Types,1,0),Null,Handle(PV_suitability),Handle(Area_Type),Handle(All_PV_Sectors),Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'System_Size_Constraints','A7',Choice(Import_Data_Types,1,0),Null,Handle(System_Size_Constra2),Handle(Min_Max),Handle(Spatial_ID),Handle(Area_Type),Null,Null,~
Checkbox(0),Custom_Input_Filenam,'NYPA Market Fraction','A1',Choice(Import_Data_Types,1,0),Null,Handle(),Handle(Spatial_ID),Handle(All_PV_Sectors),Handle(Area_Type),Null,Null,~
Checkbox(0),Custom_Input_Filenam,'PV Incentives','A1',Choice(Import_Data_Types,1,0),Null,Handle(PV_kW_DC_Incentive),Handle(PV_Climate_Zone),Handle(PV_Incentive_Scen),Handle(Static_PV_Time),Null,Null,~
Checkbox(0),Custom_Input_Filenam,'SheetName','A1',Choice(Import_Data_Types,1,0),Null,Handle(Variable_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Null,Null,~
Checkbox(0),Custom_Input_Filenam,'SheetName','A1',Choice(Import_Data_Types,1,0),Null,Handle(Variable_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),~
Checkbox(0),Custom_Input_Filenam,'SheetName','A1',Choice(Import_Data_Types,1,0),Null,Handle(Variable_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),~
Checkbox(0),Custom_Input_Filenam,'SheetName','A1',Choice(Import_Data_Types,1,0),Null,Handle(Variable_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),~
Checkbox(0),Path_to_Global_Data1,'SheetName','A1',Choice(Import_Data_Types,1,0),Null,Handle(Variable_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),~
Checkbox(0),Path_to_Global_Data1,'SheetName','A1',Choice(Import_Data_Types,1,0),Null,Handle(Variable_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),~
Checkbox(0),Path_to_Global_Data1,'SheetName','A1',Choice(Import_Data_Types,1,0),Null,Handle(Variable_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),~
Checkbox(0),Path_to_Global_Data1,'SheetName','A1',Choice(Import_Data_Types,1,0),Null,Handle(Variable_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),~
Checkbox(0),Path_to_Global_Data1,'SheetName','A1',Choice(Import_Data_Types,1,0),Null,Handle(Variable_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),~
Checkbox(0),Path_to_Global_Data1,'SheetName','A1',Choice(Import_Data_Types,1,0),Null,Handle(Variable_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier))
NodeLocation: 88,552,1
NodeSize: 64,40
WindState: 2,64,77,1746,780
DefnState: 2,1921,6,1801,836,0,DFNM
ValueState: 2,-66,109,1540,509,0,MIDM
Aliases: FormNode New1771965635, FormNode New1859766563, FormNode New1675217187, FormNode New194800931
ReformDef: [Excel_Import_Params,Imported_Dataset_Num]
TableCellDefault: Import_Param_Default
Att_EditSliceState: [Sys_LocalIndex('DomainIndex'),2,Imported_Dataset_Num,1,Excel_Import_Params,1]
{!40700|Att_CellFormat: CellFormats(CellSpan(Imported_Dataset_Num,CellFill(0xffff0000),1,header:0),CellSpan(Excel_Import_Params,CellSpan(Imported_Dataset_Num,CellNumberFormat('Fixed Point',7,0,0,dateFormat:'ABBREV',fullPrecision:0,numbersAsDates:0,datesAsNumbers:0,digits_:2,zeroes_:7),79,header:0),6,header:0),CellSpan(Excel_Import_Params,CellSpan(Imported_Dataset_Num,CellNumberFormat('Fixed Point',5,0,0,dateFormat:'ABBREV',fullPrecision:0,numbersAsDates:0,datesAsNumbers:0,digits_:2,zeroes_:5),18,header:0),6,header:0),CellSpan(Imported_Dataset_Num,CellFill(0xffffffff),1,header:0),CellSpan(Excel_Import_Params,CellSpan(Imported_Dataset_Num,CellFill(0xffff0000),1,header:0),3,header:0),CellSpan(Excel_Import_Params,CellSpan(Imported_Dataset_Num,CellFill(0xffffffff),1,header:0),3,header:0),CellSpan(Excel_Import_Params,CellSpan(Imported_Dataset_Num,CellFill(0xffff0000),87,header:0),4,header:0))}

Decision Number_of_Datasets
Title: Number of Imported Datasets
Description: WARNING: Reducing this number may result in a loss of data.~
~
The number of datasets whose import configuration can be specified. This determines the size of the Excel Import Settings table. When reducing this number, ensure that it will not result in discarding previously defined dataset import configurations.
Definition: 100
NodeLocation: 240,80,1
NodeSize: 64,40
WindState: 2,42,72,720,350
Aliases: FormNode New517589283, FormNode New1406781731

Index Imported_Dataset_Num
Att_PrevIndexValue: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100]
Title: Imported Dataset Number
Definition: 1..Number_of_Datasets
NodeLocation: 240,184,1
NodeSize: 64,40

Index Selected_Import_Data
Title: Selected Import Datasets
Definition: Subset(Excel_Import_Setting[Excel_Import_Params=Select_Import_Label])
NodeLocation: 240,272,1
NodeSize: 64,40

Decision Select_Import_Label
Title: Select for Import Label
Definition: Choice(Excel_Import_Params,1,0)
NodeLocation: 392,80,1
NodeSize: 64,40
Aliases: FormNode New249153827

Decision Tab_Name_Label
Title: Tab Name Label
Definition: Choice(Excel_Import_Params,3,0)
NodeLocation: 392,392,1
NodeSize: 64,40
Aliases: FormNode New1591331107

Decision File_Path_Label
Title: File Path Label
Definition: Choice(Excel_Import_Params,2,0)
NodeLocation: 240,536,1
NodeSize: 64,40
Aliases: FormNode New1054460195

Decision Start_Cell_Label
Title: Start Cell Label
Definition: Choice(Excel_Import_Params,4,0)
NodeLocation: 392,184,1
NodeSize: 64,40
Aliases: FormNode New2128202019

Decision Data_Default_Label
Title: Data Default Label
Definition: Choice(Excel_Import_Params,6,0)
NodeLocation: 392,496,1
NodeSize: 64,40
Aliases: FormNode New31050019

Decision Stored_Locat_Label
Title: Stored Location Label
Definition: Choice(Excel_Import_Params,7,0)
NodeLocation: 240,640,1
NodeSize: 64,40
Aliases: FormNode New1104791843

Decision Value_Index_Label
Title: Value Index Label
Definition: Choice(Excel_Import_Params,8,0)
NodeLocation: 392,288,1
NodeSize: 64,40
Aliases: FormNode New567920931

Index Active_FactCol_Ind
Title: Active Fact Col Indices
Description: Handle objects to the fact column indices for the dataset that is currently being imported.
Definition: INDEX indHandles:=CopyIndex(Excel_Import_Setting[Excel_Import_Params=Fact_Col_Index_Param, Imported_Dataset_Num=Active_Dataset_Num1]);~
~
Subset(indHandles <> Null)
NodeLocation: 688,256,1
NodeSize: 64,40

Function Excel_Cell_Component(cell_ref)
Title: Excel Cell Components
Description: Takes a reference to an Excel cell (e.g., A15), and returns the column (A) and row (15) components.~
~
[cell_ref]: the reference location of a cell in an Excel spreadsheet.
Definition: INDEX textLen:=1..TextLength(cell_ref);~
VAR singleChars:=FOR J:=textLen DO (~
   SelectText(cell_ref, J, J)~
);~
VAR parsed:=ParseNumber(singleChars);~
VAR startCol:=JoinText(IF parsed = Null THEN singleChars ELSE Null, textLen);~
VAR startRow:=ParseNumber(JoinText(IF parsed = Null THEN Null ELSE singleChars, textLen));~
~
Array(Excel_Components, [startCol, startRow])
NodeLocation: 544,256,1
NodeSize: 64,40

Index Excel_Components
Att_PrevIndexValue: ['Excel Column','Excel Row']
Title: Excel Components
Definition: ['Excel Column','Excel Row']
IndexVals: ['item 1']
NodeLocation: 544,344,1
NodeSize: 64,40

Decision Excel_Row_Label
Title: Excel Row Label
Definition: Choice(Excel_Components,2,0)
NodeLocation: 544,432,1
NodeSize: 64,40
Aliases: FormNode New1641662755

Index Populated_Rows
Title: Populated Rows
Definition: Data_Start_Row1..End_Row
NodeLocation: 688,80,1
NodeSize: 64,40
ValueState: 2,17,98,416,303,0,MIDM

Index Expected_Cols
Title: Expected Cols
Definition: Concat(Active_FactCol_Ind, Import_Value_Cols)~
/* got rid of warning capability below to facilitate LibXl import. Might fix later.~
~
MetaVar valueInd:=Active_Value_Index1;~
VAR cols:=Concat(Active_FactCol_Ind, Import_Value_Cols);~
~
IF Size(Cols) <> Size(Non_Null_Cols1)~
THEN MsgBox("The number of columns on the tab '" & Active_Tab_Name1 & "' of workbook '" & Active_File_Path1 & "' does not match the number expected, per the settings specified for the data import.", 0, "Error: Mismatch in Number of Data Columns")~
ELSE Null;~
~
CopyIndex(cols)
NodeLocation: 688,168,1
NodeSize: 64,40
WindState: 2,51,200,720,350
ValueState: 2,1136,217,648,393,0,MIDM

Index Index_Titles
Title: Index Titles
Definition: VAR titles:=FOR J:=@Active_FactCol_Ind DO (~
   MetaVar indHandle:=Slice(Active_FactCol_Ind, J);~
   Title of indHandle~
);~
~
CopyIndex(titles)
NodeLocation: 688,344,1
NodeSize: 64,40

Index All_Index_Checks
Att_PrevIndexValue: ['Missing Subscripts','Incorrect Subscripts','Repeat Subscripts']
Title: All Index Checks
Definition: ['Missing Subscripts','Incorrect Subscripts','Repeat Subscripts']
NodeLocation: 688,520,1
NodeSize: 64,40

Index Index_Checks
Title: Index Checks
Definition: Subset(Apply_Index_Checks1)
NodeLocation: 688,608,1
NodeSize: 64,40

Function Show_Result(ident: Text)
Title: Show Result
Description: Opens the result window for the variable specified.~
~
[ident]: the identifier (in text form) of the variable whose result will be opened.
Definition: EvaluateScript("Open Result " & ident)
NodeLocation: 544,168,1
NodeSize: 64,40
WindState: 2,-3,6,720,350

Index Import_Data_Types
Att_PrevIndexValue: ['Any','Number','Text','Date']
Title: Import Data Types
Definition: ['Any','Number','Text','Date']
NodeLocation: 688,696,1
NodeSize: 64,40

Decision Data_Type_Label
Title: Data Type Label
Definition: Choice(Excel_Import_Params,5,0)
NodeLocation: 392,600,1
NodeSize: 64,40
Aliases: FormNode New299485475

Index Import_Value_Cols
Title: Import Value Cols
Definition: LocalAlias valueInd:=Active_Value_Index1;~
~
IF Active_Value_Index1 <> Null~
THEN CopyIndex(valueInd)~
ELSE ['Value']
NodeLocation: 688,432,1
NodeSize: 64,40

Function Return_Not_Specified(arg: Optional)
Title: Return Not Specified
Description: This is used to assign nothing (not even a Null value) to an object. The result returned can be used as an argument in a function, and it will be treated as though the argument has not been specified. This function should be called without any arguments, eg, Return_Not_Specified()~
~
[arg]: leave this blank
Definition: arg
NodeLocation: 544,80,1
NodeSize: 64,40

Decision Import_Selection_Sub
Title: Import Selection Subtable
Definition: Subtable(Excel_Import_Setting[Excel_Import_Params=Select_Import_Label])
NodeLocation: 88,656,1
NodeSize: 64,40
DefnState: 2,1269,182,270,635,0,DFNM
Aliases: FormNode New98158883
ReformDef: [Sys_LocalIndex('DomainIndex'),Imported_Dataset_Num]

Variable Tab_Names_by_Number
Title: Tab Names by Number
Definition: Excel_Import_Setting[Excel_Import_Params=Tab_Name_Label]
NodeLocation: 240,768,1
NodeSize: 64,40
WindState: 2,98,82,857,402
ValueState: 2,391,92,355,642,0,MIDM

Index Data_Selection_Optio
Att_PrevIndexValue: ['Tab Name','Selected for Import']
Title: Data Selection Options
Definition: CopyIndex([Tab_Name_Label,Select_Import_Label])
NodeLocation: 88,872,1
NodeSize: 64,40

Decision Last_Import_Time
Title: Last Import Time
Definition: 24-May-2022 16:35:36.137000
NodeLocation: 544,848,1
NodeSize: 64,40
Aliases: FormNode New1910098211, FormNode New2017052963
NumberFormat: 3,F,4,4,0,0,4,0,$,0,"d-MMM-yyyy h:mm:ss tt",0,"DATETIME",,0,0,15

Index Tab_Names
Title: Tab Names
Definition: CopyIndex(Tab_Names_by_Number)
NodeLocation: 240,872,1
NodeSize: 64,40

Decision Import_in_Progress
Title: Import in Progress
Definition: 0
NodeLocation: 544,656,1
NodeSize: 64,40
Aliases: FormNode New836356387

Variable Open_Error_Results
Title: Open Error Results
Definition: (Size(Selected_Import_Data) = 1) OR (NOT Import_in_Progress)~
 
NodeLocation: 544,760,1
NodeSize: 64,40

Index Stored_Vars_Selected
Title: Stored Variables for Selected
Definition: CopyIndex(Excel_Import_Setting[Excel_Import_Params=Stored_Locat_Label, Imported_Dataset_Num=Selected_Import_Data])
NodeLocation: 392,712,1
NodeSize: 64,40

Decision Select_Categ_Params
Title: Select Categorical Params
Definition: Table(Import_Fixed_Params)(Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0))
NodeLocation: 872,352,1
NodeSize: 64,40
Aliases: FormNode New165267747
TableCellDefault: Checkbox(0)

Index Cat_Index_Fix_Params
Title: Categ Index Fixed Params
Definition: Subset(Select_Categ_Params)
NodeLocation: 864,80,1
NodeSize: 64,40

Decision Max_Imported_Indexes
Title: Max Imported Indexes
Description: WARNING: Reducing this number may result in a loss of data.~
~
The maximum number of sequential index columns that can be imported from Excel. This determines the size of the Categorial Index Import Settings table. When reducing this number, ensure that it will not result in discarding previously defined index column configurations.
Definition: 24
NodeLocation: 864,168,1
NodeSize: 64,40
WindState: 2,11,69,855,404
Aliases: FormNode New1239009571, FormNode New735693091

Index Import_Index_Cols
Title: Import Index Cols
Definition: INDEX dims:=1..Max_Imported_Indexes;~
CopyIndex("Column " & dims & " Index")
NodeLocation: 872,264,1
NodeSize: 64,40

Index Categ_Index_Params
Att_PrevIndexValue: ['Selected for Import','File Path','Tab Name','Data Start Cell','Column 1 Index','Column 2 Index','Column 3 Index','Column 4 Index','Column 5 Index','Column 6 Index','Column 7 Index','Column 8 Index','Column 9 Index','Column 10 Index','Column 11 Index','Column 12 Index','Column 13 Index','Column 14 Index','Column 15 Index','Column 16 Index','Column 17 Index','Column 18 Index','Column 19 Index','Column 20 Index','Column 21 Index','Column 22 Index','Column 23 Index','Column 24 Index']
Title: Categorical Index Parameters
Definition: Concat(Cat_Index_Fix_Params, Import_Index_Cols)
NodeLocation: 872,464,1
NodeSize: 64,40

Decision Categ_Index_Default
Title: Categorical Index Default
Definition: Table(Categ_Index_Params)(Checkbox(0),Path_to_Global_Data1,'SheetName','A5',Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier),Handle(Index_Identifier))
NodeLocation: 872,552,1
NodeSize: 64,40
WindState: 2,102,82,720,350
DefnState: 2,1152,276,416,303,,DFNM
Aliases: FormNode New702138659
TableCellDefault: Handle(Index_Identifier)

Decision Num_Categ_Index_Tabs
Title: Number of Categorical Index Tabs
Description: WARNING: Reducing this number may result in a loss of data.~
~
The number of categorical index tabs whose import configuration can be specified. This determines the size of the Categorical Index Import Settings table. When reducing this number, ensure that it will not result in discarding previously defined index tab configurations.
Definition: 2
NodeLocation: 1016,80,1
NodeSize: 64,40
WindState: 2,42,72,720,350
Aliases: FormNode New1775880483, FormNode New1809434915

Index Categ_Index_Tabs
Att_PrevIndexValue: [1,2]
Title: Categorical Index Tabs
Definition: 1..Num_Categ_Index_Tabs
NodeLocation: 1016,184,1
NodeSize: 64,40

Decision CatInd_ImportSetting
Title: Categorical Index Import Settings
Description: This tables defines:~
1) the categorical indexes that will be imported from spreadsheets~
2) the spreadsheet names, tab names, and data start cell locations for each index~
3) the index location where the imported data will be stored in the model~
~
Parameter Instructions:~
Selected for Import - check this to include the dataset in the next import.~
File Path - the path to the spreadsheet file, which can be an identifier to another object/variable that holds the path.~
Tab Name - the name of the spreadsheet tab where the data resides.~
Data Start Cell - the upper leftmost cell where the dataset resides, which is often populated with a column header.~
==== The following parameters must take the form of Handle(Identifier) when applicable, or Null when not applicable =====~
Column 1 Index - the handle to the index that appears as the leftmost column in the spreadsheet~
Column 2 Index - the handle to the index that appears as the 2nd leftmost column in the spreadsheet~
Column N Index - the handle to the index that appears as the Nth leftmost column in the spreadsheet~
~
Illustrative Excel Data (assume that 'States' appears in cell A1 of the spreadsheet):~
						~
States		LandType	Years	~
CA			Urban		2020~
CO			Rural		2021~
UT						2022	~
WY						2023~
						2024~
						2025~
~
As an example, the index data above would be characterized as follows:~
~
Data Start Cell: 			'A1'~
Column 1 Index: 			Handle(States)~
Column 2 Index: 			Handle(Land_Type)~
Column 3 Index: 			Handle(Years)~
Column 4-N Index:		Null
Definition: DetermTable(Select_Model_for_Dat,Categ_Index_Tabs,Categ_Index_Params)(~
Checkbox(1),Path_to_Global_Data1,'Categorical_Indexes','A5',Handle(Hourly_Profile_Names),Handle(Holiday_Years),Handle(ITC_Scenario),Handle(EV_Mkt_Share_Scen),Handle(EV_AdEff_Scenario),Handle(EV_WOM_Scen),Handle(Fuel_Types),Handle(All_Vehicle_Techs),Handle(Gasoline_Price_Scens),Handle(EV_Incent_Scenario),Handle(Vehicle_Price_Scens),Handle(Vehicle_Range_Scens),Handle(Elect_Price_Scens),Handle(BldgGrowthRate_Scens),Handle(BESS_Incentive_Scen),Handle(Storage_Cost_Scen),Handle(PV_Incentive_Scen),Handle(DER_Cost_Scenario),Handle(NC_Suitability_Scens),Handle(All_PV_Sectors),Handle(Facility_Identifier),Handle(Spatial_ID),Handle(All_Utilities),Handle(PV_Climate_Zone),~
Checkbox(0),Path_to_Global_Data1,'Struct_Categ_Indexes','A5',Handle(SGIP_Data_Columns),Handle(Battery_Specs),Handle(All_System_Types),Handle(Debt_or_Equity),Handle(Incent_Durat_Inputs),Handle(Incent_MWhCap_Inputs),Handle(Timestep_Options),Handle(StructSingCell_Names),Handle(Vehicle_Types),Handle(SingCell_Input_Names),Handle(Hourly_Profile_Rows),Handle(Holiday_Name),Handle(Delta_Outputs),Handle(EV_Adopt_Data_Types),Handle(Sequential_Outputs),Handle(Veh_Incentive_Type),Null,Null,Null,Null,Null,Null,Null,Null)
NodeLocation: 872,664,1
NodeSize: 64,40
WindState: 2,102,82,1528,740
DefnState: 2,916,113,763,607,0,DFNM
ValueState: 2,769,178,771,486,0,MIDM
Aliases: FormNode New433703203, FormNode New467257635, FormNode New1268542755
ReformDef: [Categ_Index_Tabs,Categ_Index_Params]
ReformVal: [Categ_Index_Tabs,Categ_Index_Params]
TableCellDefault: Categ_Index_Default
Att_ResultSliceState: [Model_for_Data_Impo1,1,Categ_Index_Params,1,Categ_Index_Tabs,1]
Att_EditSliceState: [Sys_LocalIndex('DomainIndex'),1,Categ_Index_Params,1,Categ_Index_Tabs,1]
{!40700|Att_CellFormat: CellFormats(CellSpan(Categ_Index_Tabs,CellSpan(Categ_Index_Params,CellFill(0xff80ff80),5,17,header:0),1,header:0),CellSpan(Categ_Index_Tabs,CellSpan(Categ_Index_Params,CellFill(0xffff0000),14,header:0),2,header:0),CellSpan(Categ_Index_Tabs,CellSpan(Categ_Index_Params,CellFill(0xffff0000),14,16,header:0),2,header:0),CellSpan(Categ_Index_Tabs,CellSpan(Categ_Index_Params,CellFill(0xffffffff),14,20,header:0),2,header:0),CellSpan(Categ_Index_Params,CellFill(0xffffffff),5,17,header:0))}

Index Cat_Index_Tab_Names
Att_PrevIndexValue: ['Categorical_Indexes','Struct_Categ_Indexes']
Title: Categ Index Tab Names
Definition: CopyIndex(Categ_Index_Tab_Opt1)
NodeLocation: 1016,784,1
NodeSize: 64,40

Index Categ_Index_Rows
Title: Categ Index Rows
Definition: Cat_Index_Start_Row1..Categ_Index_End_Row1
NodeLocation: 1016,272,1
NodeSize: 64,40

Index Categ_Index_Handles
Title: Categorical Index Handles
Description: Handle objects to the categorical indices, where imported lists will be stored.
Definition: INDEX indHandles:=CopyIndex(CatInd_ImportSetting[Categ_Index_Params=Import_Index_Cols, Categ_Index_Tabs=Categ_Index_Tab_Num1]);~
~
Subset(indHandles <> Null)
NodeLocation: 1016,360,1
NodeSize: 64,40

Decision Excel_Col_Label
Title: Excel Col Label
Definition: Choice(Excel_Components,1,0)
NodeLocation: 544,544,1
NodeSize: 64,40
Aliases: FormNode New1507445027

Index Select_Categ_Indexes
Title: Selected Categorical Indexes
Definition: Subset(CatInd_ImportSetting[Categ_Index_Params=Select_Import_Label])
NodeLocation: 1016,880,1
NodeSize: 64,40
ValueState: 2,490,302,416,303,0,MIDM

Text Te1993984291
Title: Data Import
NodeLocation: 392,536,-1
NodeSize: 384,528
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Text Te249153827
Title: Categorical Index Import
NodeLocation: 944,536,-1
NodeSize: 160,528
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Decision CatIndex_Select_Sub1
Title: Categ Index Selection Subtable
Definition: Subtable(CatInd_ImportSetting[Categ_Index_Params=Select_Import_Label])
NodeLocation: 872,776,1
NodeSize: 64,40
DefnState: 2,1243,440,416,303,0,DFNM
Aliases: FormNode New2044315939

Text Te1322895651
Title: Sequential Index Import
NodeLocation: 1260,536,-1
NodeSize: 148,528
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Decision Select_Seq_Params1
Title: Select Sequence Params
Definition: Table(Import_Fixed_Params)(Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0))
NodeLocation: 1192,352,1
NodeSize: 64,40
DefnState: 2,40,338,416,303,,DFNM
Aliases: FormNode New1171900707
TableCellDefault: Checkbox(0)

Index Seq_Index_Fix_Param1
Title: Sequence Index Fixed Params
Definition: Subset(Select_Seq_Params1)
NodeLocation: 1192,80,1
NodeSize: 64,40

Decision Max_Import_Seq_Para1
Title: Max Imported Sequence Params
Description: WARNING: Reducing this number may result in a loss of data.~
~
The maximum number of sequence index parameters that can be imported from Excel. This determines the size of the Sequence Index Import Settings table. When reducing this number, ensure that it will not result in discarding previously defined parameter configurations.
Definition: 30
NodeLocation: 1192,168,1
NodeSize: 64,40
WindState: 2,11,69,855,404
Aliases: FormNode New635029795, FormNode New400148771

Index Import_Seq_Params1
Title: Import Sequence Params
Definition: INDEX dims:=1..Max_Import_Seq_Para1;~
CopyIndex("Row " & dims & " Parameter")
NodeLocation: 1192,264,1
NodeSize: 64,40

Index Seq_Index_Params1
Att_PrevIndexValue: ['Selected for Import','File Path','Tab Name','Data Start Cell','Row 1 Parameter','Row 2 Parameter','Row 3 Parameter','Row 4 Parameter','Row 5 Parameter','Row 6 Parameter','Row 7 Parameter','Row 8 Parameter','Row 9 Parameter','Row 10 Parameter','Row 11 Parameter','Row 12 Parameter','Row 13 Parameter','Row 14 Parameter','Row 15 Parameter','Row 16 Parameter','Row 17 Parameter','Row 18 Parameter','Row 19 Parameter','Row 20 Parameter','Row 21 Parameter','Row 22 Parameter','Row 23 Parameter','Row 24 Parameter','Row 25 Parameter','Row 26 Parameter','Row 27 Parameter','Row 28 Parameter','Row 29 Parameter','Row 30 Parameter']
Title: Sequence Index Parameters
Definition: Concat(Seq_Index_Fix_Param1, Import_Seq_Params1)
NodeLocation: 1192,464,1
NodeSize: 64,40

Decision Seq_Index_Default1
Title: Sequence Index Default
Definition: Table(Seq_Index_Params1)(Checkbox(0),Path_to_Global_Data1,'SheetName','A5',Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier),Handle(Variable_Identifier))
NodeLocation: 1192,552,1
NodeSize: 64,40
WindState: 2,102,82,720,350
DefnState: 2,1105,510,416,303,0,DFNM
Aliases: FormNode New1708771619
TableCellDefault: Handle(Variable_Identifier)

Decision Num_Seq_Index_Tabs1
Title: Number of Sequence Index Tabs
Description: WARNING: Reducing this number may result in a loss of data.~
~
The number of sequential index tabs whose import configuration can be specified. This determines the size of the Sequence Index Import Settings table. When reducing this number, ensure that it will not result in discarding previously defined import tab configurations.
Definition: 2
NodeLocation: 1336,80,1
NodeSize: 64,40
WindState: 2,42,72,720,350
Aliases: FormNode New366594339, FormNode New1473890595

Index Seq_Index_Tabs1
Att_PrevIndexValue: [1,2]
Title: Sequence Index Tabs
Definition: 1..Num_Seq_Index_Tabs1
NodeLocation: 1336,184,1
NodeSize: 64,40

Decision SeqInd_ImportSettin1
Title: Sequence Index Import Settings
Description: This tables defines:~
1) the parameters, imported from spreadsheets, used to define sequence indexes ~
2) the spreadsheet names, tab names, and data start cell locations for each tab~
3) the variable location where the imported data parameters will be stored in the model~
~
Parameter Instructions:~
Selected for Import - check this to include the dataset in the next import.~
File Path - the path to the spreadsheet file, which can be an identifier to another object/variable that holds the path.~
Tab Name - the name of the spreadsheet tab where the data resides.~
Data Start Cell - the upper leftmost cell where the dataset resides, which is often populated with a column header.~
==== The following parameters must take the form of Handle(Identifier) when applicable, or Null when not applicable =====~
Row 1 Parameter - the handle to the variable that appears as the 1st row in the spreadsheet data~
Row 2 Parameter - the handle to the variable that appears as the 2nd row in the spreadsheet data~
Row N Parameter - the handle to the variable that appears as the Nth row in the spreadsheet data~
~
Illustrative Excel Data (assume that 'Start Time' appears in cell A5 of the spreadsheet):~
						~
Start Time				2018		~
End Time				2030			~
Timestep				'Month'~
Number of Locations	10~
~
As an example, the index parameter data above would be characterized as follows:~
~
Data Start Cell: 			'A5'~
Row 1 Parameter: 		Handle(Start_Time)~
Row 2 Parameter: 		Handle(End_Time)~
Row 3 Parameter: 		Handle(Timestep)~
Row 4 Parameter:		Handle(Num_of_Locations)~
Row 5-N Parameter:		Null
Definition: DetermTable(Select_Model_for_Dat,Seq_Index_Tabs1,Seq_Index_Params1)(~
Checkbox(1),Path_to_Global_Data1,'Sequence_Index_Inputs','A5',Handle(Bldg_Stock_Start_Yea),Handle(Bldg_Stock_End_Year),Handle(Vehicle_Stk_Start_Yr),Handle(Vehicle_Stock_End_Yr),Handle(Vehicle_Sim_Start_Yr),Handle(Vehicle_Sim_End_Yr),Handle(Final_Hist_Incent_Yr),Handle(Final_EV_Hist_Period),Handle(Base_Period_Deltas),Handle(Output_Start_Period),Handle(Output_End_Period),Handle(Veh_Input_Start_Yr),Handle(Veh_Input_End_Yr),Handle(PV_Sim_Start_Year),Handle(PV_Sim_End_Year),Handle(Select_DER_Cost_Scen),Handle(Select_StrgCost_Scen),Handle(Base_Yr_of_Cost_Decl),Handle(BaseYr_Strg_Costs),Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,~
Checkbox(0),Path_to_Global_Data1,'Struct_Seq_Index_Inputs','A5',Handle(Num_SGIP_Data_Rows),Handle(PV_Static_Start_Year),Handle(PV_Static_End_Year),Handle(Num_Incent_Dur_Steps),Handle(Num_Incent_Cap_Steps),Handle(Num_Incentive_Steps),Handle(Vehicle_dT_Choice),Handle(Num_Vehicle_Vintages),Handle(Output_dT_Choice),Handle(Baseline_Veh_Tech),Handle(Final_EV_Hist_Period),Handle(Select_Opt_Method),Handle(EV_Calibration_Start),Handle(EV_Calibration_End),Handle(PV_Data_dT_Choice),Handle(PV_Calibration_Start),Handle(PV_Calibration_End),Handle(Max_PV_Calib_Stages),Handle(Select_PV_Opt_Method),Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null)
NodeLocation: 1192,664,1
NodeSize: 64,40
WindState: 2,26,10,1042,708
DefnState: 2,2426,99,659,746,0,DFNM
ValueState: 2,386,352,939,334,,MIDM
Aliases: FormNode New1440336163, FormNode New2077870371, FormNode New731671843
ReformDef: [Seq_Index_Tabs1,Seq_Index_Params1]
TableCellDefault: Seq_Index_Default1
Att_EditSliceState: [Sys_LocalIndex('DomainIndex'),1,Seq_Index_Params1,1,Seq_Index_Tabs1,1]

Index Seq_Index_Tab_Names1
Att_PrevIndexValue: ['Sequence_Index_Inputs','Struct_Seq_Index_Inputs']
Title: Sequence Index Tab Names
Definition: CopyIndex(Seq_Index_Tab_Opt1)
NodeLocation: 1336,784,1
NodeSize: 64,40

Index Seq_Index_Rows1
Title: Sequence Index Rows
Definition: Seq_Index_Start_Row1..Seq_Index_End_Row1
NodeLocation: 1336,272,1
NodeSize: 64,40

Index Seq_Index_Handles1
Title: Sequence Param Handles
Description: Handle objects to the sequential index parameters, where imported params will be stored.
Definition: INDEX indHandles:=CopyIndex(SeqInd_ImportSettin1[Seq_Index_Params1=Import_Seq_Params1, Seq_Index_Tabs1=Seq_Index_Tab_Num1]);~
~
Subset(indHandles <> Null)
NodeLocation: 1336,360,1
NodeSize: 64,40
WindState: 2,468,331,720,350
ValueState: 2,644,174,488,530,0,MIDM

Index Select_Seq_Indexes1
Title: Selected Sequence Params
Definition: Subset(SeqInd_ImportSettin1[Seq_Index_Params1=Select_Import_Label])
NodeLocation: 1336,880,1
NodeSize: 64,40

Decision SeqIndexes_to_Impor1
Title: Sequence Params to Import
Description: Check the sequence index tabs to import.
Definition: Subtable(SeqInd_ImportSettin1[Seq_Index_Params1=Sequence_Tab_Param])/*MultiTable(Data_Selection_Optio)(Seq_Index_Tab_Opt1&"",Seq_Index_Select_Su1)
NodeLocation: 1192,888,1
NodeSize: 64,40
DefnState: 2,784,330,695,253,0,DFNM
Aliases: FormNode New903465251, FormNode New937019683
ReformDef: [Sequence_Tab_Param,Seq_Index_Tabs1]
Att_EditSliceState: [Sys_LocalIndex('DomainIndex'),1,Seq_Index_Tabs1,1,Sequence_Tab_Param,1]

Decision Seq_Index_Select_Su1
Title: Seq Index Selection Subtable
Definition: Subtable(SeqInd_ImportSettin1[Seq_Index_Params1=Select_Import_Label])
NodeLocation: 1192,776,1
NodeSize: 64,40
Aliases: FormNode New1977207075

Decision Pipe_Separator3
Title: Pipe Separator
Definition: " | "
NodeLocation: 392,800,1
NodeSize: 64,40
Aliases: FormNode New232376611

Decision Import_Categor_Inde1
Title: Import Categorial Indexes?
Description: Check this box to import categorical indexes prior to importing data tabs.
Definition: Checkbox(0)
NodeLocation: 1520,80,1
NodeSize: 64,40
Aliases: FormNode New1306118435, FormNode New540657955, FormNode New70895907

Decision Import_Sequent_Inde1
Title: Import Sequential Indexes?
Description: Check this box to import sequential indexes prior to importing data tabs.
Definition: Checkbox(0)
NodeLocation: 1664,80,1
NodeSize: 64,40
Aliases: FormNode New769247523, FormNode New1614399779, FormNode New1144637731

Text Te786024739
Title: Index Then Data Import
NodeLocation: 1600,484,-1
NodeSize: 160,476
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

FormNode New249153827
Title: Select for Import Label
Definition: 0
NodeLocation: 392,128,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,0
Original: Select_Import_Label

FormNode New1322895651
Title: Max Imported Dimensions
Definition: 0
NodeLocation: 88,212,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Max_Imported_Dim

FormNode New786024739
Title: Import Param Default
Definition: 0
NodeLocation: 88,492,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Import_Param_Default

FormNode New1859766563
Title: Excel Import Configuration
Definition: 0
NodeLocation: 88,596,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Excel_Import_Setting

FormNode New517589283
Title: Number of Imported Datasets
Definition: 0
NodeLocation: 240,124,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Number_of_Datasets

FormNode New1591331107
Title: Select for Import Label
Definition: 0
NodeLocation: 392,440,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,0
Original: Tab_Name_Label

FormNode New1054460195
Title: Select for Import Label
Definition: 0
NodeLocation: 240,584,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,0
Original: File_Path_Label

FormNode New2128202019
Title: Select for Import Label
Definition: 0
NodeLocation: 392,232,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,0
Original: Start_Cell_Label

FormNode New31050019
Title: Select for Import Label
Definition: 0
NodeLocation: 392,544,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,0
Original: Data_Default_Label

FormNode New1104791843
Title: Select for Import Label
Definition: 0
NodeLocation: 240,688,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,0
Original: Stored_Locat_Label

FormNode New567920931
Title: Select for Import Label
Definition: 0
NodeLocation: 392,336,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,0
Original: Value_Index_Label

FormNode New1641662755
Title: Select for Import Label
Definition: 0
NodeLocation: 544,480,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,0
Original: Excel_Row_Label

FormNode New299485475
Title: Select for Import Label
Definition: 0
NodeLocation: 392,648,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,0
Original: Data_Type_Label

FormNode New836356387
Title: Import in Progress
Definition: 0
NodeLocation: 544,700,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Import_in_Progress

FormNode New1910098211
Title: Last Import Time
Definition: 0
NodeLocation: 548,900,1
NodeSize: 68,12
NodeInfo: 1,0,0,0,0,0,0,102,0,,0,,,0
Original: Last_Import_Time

FormNode New165267747
Title: Select Categorical Params
Definition: 0
NodeLocation: 872,404,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Select_Categ_Params

FormNode New1239009571
Title: Max Imported Dimensions
Definition: 0
NodeLocation: 864,204,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Max_Imported_Indexes

FormNode New702138659
Title: Categorical Index Default
Definition: 0
NodeLocation: 872,604,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Categ_Index_Default

FormNode New1775880483
Title: Number of Imported Datasets
Definition: 0
NodeLocation: 1016,124,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Num_Categ_Index_Tabs

FormNode New433703203
Title: Categorical Index Import Settings
Definition: 0
NodeLocation: 880,716,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: CatInd_ImportSetting

FormNode New1507445027
Title: Select for Import Label
Definition: 0
NodeLocation: 544,592,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,0
Original: Excel_Col_Label

FormNode New2044315939
Title: Categ Index Selection Subtable
Definition: 0
NodeLocation: 880,828,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: CatIndex_Select_Sub1

FormNode New98158883
Title: Import Selection Subtable
Definition: 0
NodeLocation: 88,708,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Import_Selection_Sub

FormNode New1171900707
Title: Select Categorical Params
Definition: 0
NodeLocation: 1192,404,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Select_Seq_Params1

FormNode New635029795
Title: Max Imported Dimensions
Definition: 0
NodeLocation: 1192,212,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Max_Import_Seq_Para1

FormNode New1708771619
Title: Categorical Index Default
Definition: 0
NodeLocation: 1192,604,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Seq_Index_Default1

FormNode New366594339
Title: Number of Imported Datasets
Definition: 0
NodeLocation: 1336,124,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Num_Seq_Index_Tabs1

FormNode New1440336163
Title: Categorical Index Import Settings
Definition: 0
NodeLocation: 1200,716,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: SeqInd_ImportSettin1

FormNode New903465251
Title: Data to Import
Definition: 0
NodeLocation: 1200,932,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: SeqIndexes_to_Impor1

FormNode New1977207075
Title: Categ Index Selection Subtable
Definition: 0
NodeLocation: 1200,828,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Seq_Index_Select_Su1

FormNode New232376611
Title: Pipe Separator
Definition: 0
NodeLocation: 400,852,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Pipe_Separator3

FormNode New1306118435
Title: Import Categorial Indexes?
Definition: 0
NodeLocation: 1572,108,1
NodeSize: 28,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Import_Categor_Inde1

FormNode New769247523
Title: Import Categorial Indexes?
Definition: 0
NodeLocation: 1716,108,1
NodeSize: 28,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Import_Sequent_Inde1

Decision Data_to_Import1
Title: Data to Import
Definition: subtable(Excel_Import_Setting[Excel_Import_Params=SubTab_Index])
NodeLocation: 88,768,1
NodeSize: 64,40
DefnState: 2,275,4,686,913,0,DFNM
Aliases: FormNode Fo1584253219, FormNode Fo1320012067
ReformDef: [SubTab_Index,Imported_Dataset_Num]
Att_EditSliceState: [Sys_LocalIndex('DomainIndex'),1,Imported_Dataset_Num,1,SubTab_Index,1]
{!40700|Att_CellFormat: CellFormats(CellSpan(Imported_Dataset_Num,CellFill(0xffffff80),21,header:0),CellSpan(Imported_Dataset_Num,CellFill(0xffffff80),18,header:0),CellSpan(Imported_Dataset_Num,CellFill(0xffffff80),10,12,header:0),CellSpan(Imported_Dataset_Num,CellFill(0xffffff80),8,header:0),CellSpan(Imported_Dataset_Num,CellFill(0xffffff80),6,header:0),CellSpan(Imported_Dataset_Num,CellFill(0xffffff80),2,4,header:0),CellSpan(Imported_Dataset_Num,CellFill(0xffffff80),40,44,header:0),CellSpan(Imported_Dataset_Num,CellFill(0xffffff80),74,75,header:0),CellSpan(Imported_Dataset_Num,CellFill(0xffffff80),83,header:0),CellSpan(Imported_Dataset_Num,CellFill(0xffffff80),79,header:0),CellSpan(Imported_Dataset_Num,CellFill(0xffffff80),80,81,header:0),CellSpan(Imported_Dataset_Num,CellFill(0xffffff80),56,header:0),CellSpan(Imported_Dataset_Num,CellFill(0xffffff80),58,header:0),CellSpan(Imported_Dataset_Num,CellFill(0xffffff80),55,header:0),CellSpan(Imported_Dataset_Num,CellFill(0xffffff80),50,header:0),CellSpan(Imported_Dataset_Num,CellFill(0xffffff80),87,header:0),CellSpan(Imported_Dataset_Num,CellFill(0xffffff80),73,header:0))}
{!50000|Att_ColumnWidths: [,SubTab_Index,\([,278])]}

Index SubTab_Index
Att_PrevIndexValue: ['Selected for Import','Tab Name']
Title: SubTab Index
Definition: MultiChoice(Excel_Import_Params,1,3)
NodeLocation: 88,968,1
NodeSize: 64,40

Index Categ_Table_Param
Title: Categ Table Param
Definition: MultiChoice(Categ_Index_Params,1,3)
NodeLocation: 872,1000,1
NodeSize: 64,40

Decision Categorical_Indexes_
Title: Categorical Indexes to Import
Definition: Subtable(CatInd_ImportSetting[Categ_Index_Params=Categ_Table_Param])/*MultiTable(Data_Selection_Optio)(Categ_Index_Tab_Opt1&"",CatIndex_Select_Sub1)
NodeLocation: 872,896,1
NodeSize: 64,40
DefnState: 2,680,392,638,222,0,DFNM
Aliases: FormNode Fo1920846115, FormNode Fo494782755
ReformDef: [Categ_Table_Param,Categ_Index_Tabs]
Att_EditSliceState: [Sys_LocalIndex('DomainIndex'),1,Categ_Index_Tabs,1,Categ_Table_Param,1]

FormNode Fo1920846115
Title: Categorical Indexes to Import
Definition: 0
NodeLocation: 872,948,1
NodeSize: 56,20
NodeInfo: 1,,,0
Original: Categorical_Indexes_

Index Sequence_Tab_Param
Title: Sequence Tab Param
Definition: MultiChoice(Seq_Index_Fix_Param1,1,3)
NodeLocation: 1336,1000,1
NodeSize: 64,40

Alias Al649390371
Title: Import from Excel
Definition: 1
NodeLocation: 1520,272,1
NodeSize: 64,40
Original: Import_from_Excel1

Close Import_Auxiliary_Var

Module Stored_Test_Data1
Title: Stored Test Data
Author: JamesMilford
Date: Fri, Dec 21, 2018 10:51 AM
NodeLocation: 368,184,1
NodeSize: 64,40
DiagState: 2,28,91,1075,485,17

Index Header_3
Att_PrevIndexValue: ['A','B','C','D','E','F','G']
Title: Header 1
Definition: ['A','B','C','D','E','F','G']
IndexVals: ['A','B','C','D','E','F','G']
NodeLocation: 112,64,1
NodeSize: 64,40

Constant Sheet1_Stored1
Title: Sheet1 Stored
Definition: Table(Header_3)(1,2,3,4,5,6,7)
NodeLocation: 256,64,1
NodeSize: 64,40
ValueState: 2,17,171,416,303,,MIDM

Index Header_4
Att_PrevIndexValue: [1,2]
Title: Header 2
Definition: [1,2]
IndexVals: [1,2,Null,Null,Null,Null,Null]
NodeLocation: 112,152,1
NodeSize: 64,40

Index ValueInd1
Att_PrevIndexValue: ['ValueCol1','ValueCol2']
Title: ValueInd
Definition: ['ValueCol1','ValueCol2']
IndexVals: ['ValueCol1','ValueCol2',Null,Null,Null,Null,Null]
NodeLocation: 248,152,1
NodeSize: 64,40

Constant Sheet2_Stored1
Title: Sheet2 Stored
Definition: Table(Header_3,Header_4)(~
1,Null,~
2,Null,~
3,Null,~
4,Null,~
5,Null,~
Null,Null,~
Null,Null)
NodeLocation: 392,64,1
NodeSize: 64,40
ValueState: 2,472,474,644,303,,MIDM

Constant Sheet3_Stored1
Title: Sheet3 Stored
Definition: Table(Header_3,Header_4,ValueInd1)(~
1,15,~
8,22,~
2,16,~
9,23,~
3,17,~
10,24,~
4,18,~
11,25,~
5,19,~
12,26,~
6,20,~
13,27,~
7,21,~
14,28)
NodeLocation: 392,152,1
NodeSize: 64,40
ValueState: 2,681,234,1057,417,,MIDM
Att_ResultSliceState: [ValueInd,1,Header_2,1,Header_1,1]

Constant Sheet4_Stored1
Title: Sheet4 Stored
Definition: 10
NodeLocation: 536,64,1
NodeSize: 64,40

Constant Sheet5_Stored1
Title: Sheet5 Stored
Definition: 10
NodeLocation: 536,152,1
NodeSize: 64,40

Constant Sheet6_Stored1
Title: Sheet6 Stored
Definition: 10
NodeLocation: 680,64,1
NodeSize: 64,40

Constant Sheet7_Stored1
Title: Sheet7 Stored
Definition: Table(Header_3,Header_4)(~
1,16,~
2,9,~
3,10,~
4,11,~
5,12,~
6,13,~
14,14)
NodeLocation: 680,152,1
NodeSize: 64,40

Constant Sheet8_Stored1
Title: Sheet8 Stored
Definition: Table(Header_3,Header_4,ValueInd1)(~
1,15,~
8,22,~
2,16,~
9,23,~
3,17,~
10,24,~
4,18,~
11,25,~
'a',19,~
12,1-Jan-2019,~
'b',20,~
13,27,~
'c',21,~
14,28)
NodeLocation: 824,64,1
NodeSize: 64,40
ValueState: 2,67,67,784,588,,MIDM

Constant Sheet9_Stored1
Title: Sheet9 Stored
Definition: Table(Header_3,Header_4,ValueInd1)(~
'a','o',~
'h','v',~
'b','p',~
'i','w',~
'c','q',~
'j','x',~
1-Jan-2019,'r',~
'k','y',~
'e','s',~
'l','z',~
'f','t',~
'm',27,~
'g','u',~
'n',28)
NodeLocation: 824,152,1
NodeSize: 64,40

Constant Sheet10_Stored1
Title: Sheet10 Stored
Definition: Table(Header_3,Header_4,ValueInd1)(~
1-Jan-2019,1-Mar-2020,~
1-Aug-2019,1-Oct-2020,~
1-Feb-2019,1-Apr-2020,~
1-Sep-2019,1-Nov-2020,~
1-Mar-2019,1-May-2020,~
1-Oct-2019,'12/1/2020',~
1-Apr-2019,1-Jun-2020,~
1-Nov-2019,1-Jan-2021,~
100,1-Jul-2020,~
1-Dec-2019,1-Feb-2021,~
1-Jun-2019,1-Aug-2020,~
1-Jan-2020,1-Mar-2021,~
1-Jul-2019,1-Sep-2020,~
1-Feb-2020,1-Apr-2021)
NodeLocation: 968,64,1
NodeSize: 72,40
ValueState: 2,446,106,785,301,,MIDM
Att_ResultSliceState: [ValueInd,2,Header_2,1,Header_1,1]

Constant Bldg_Stock_Start_Yr1
Title: Bldg Stock Start Yr
Definition: 1994
NodeLocation: 112,296,1
NodeSize: 64,40

Constant Bldg_Stock_End_Yr1
Title: Bldg Stock End Yr
Definition: 2030
NodeLocation: 264,296,1
NodeSize: 64,40

Constant Intercon_Start_Yr1
Title: Intercon Start Yr
Definition: 2009
NodeLocation: 112,392,1
NodeSize: 64,40

Constant Intercon_End_Yr2
Title: Intercon End Yr
Definition: 2018
NodeLocation: 256,392,1
NodeSize: 64,40

Index Bldg_Stock_Years1
Title: Bldg Stock Years
Definition: Sequence(Bldg_Stock_Start_Yr1, Bldg_Stock_End_Yr1, Months_per_Timestep1[Timestep_Opt1=Bldg_Stock_Timestep1] / 12)
NodeLocation: 544,296,1
NodeSize: 64,40
ValueState: 2,1130,14,416,871,,MIDM
NumberFormat: 2,F,4,2,0,0,4,0,$,0,"ABBREV",0,,,0,0,15

Index Intercon_Years1
Title: Intercon Years
Definition: Intercon_Start_Yr1..Intercon_End_Yr2
NodeLocation: 400,392,1
NodeSize: 64,40

Constant Bldg_Stock_Timestep1
Title: Bldg Stock Timestep
Definition: 'Month'
NodeLocation: 400,296,1
NodeSize: 64,40

Decision Months_per_Timestep1
Title: Months per Timestep
Units: months
Definition: Table(Timestep_Opt1)(1,4,6,12)
NodeLocation: 544,392,1
NodeSize: 64,40

Index Timestep_Opt1
Att_PrevIndexValue: ['Month','Quarter','Biannual','Year']
Title: Timestep Options
Definition: ['Month','Quarter','Biannual','Year']
NodeLocation: 688,392,1
NodeSize: 64,40

Close Stored_Test_Data1

Module Data_Import1
Title: Data Import
Author: JamesMilford
Date: Fri, Dec 21, 2018 10:51 AM
NodeLocation: 440,80,1
NodeSize: 64,40
DiagState: 2,95,10,1503,729,17,10

Variable Raw_Imported_Data1
Title: Raw Imported Data
Description: The raw imported data for the active dataset.
Definition: SpreadsheetRange( Active_Wkbk_Object1, sheet:Active_Tab_Name1  )
NodeLocation: 120,176,1
NodeSize: 64,40
ValueState: 2,4,122,1652,571,0,MIDM
Aliases: FormNode New1339672867, FormNode New1211746595

Variable End_Row
Title: End Row
Definition: IF Use_LibXl THEN EndRow_LibXl ELSE End_Row_Excel1
NodeLocation: 88,272,1
NodeSize: 64,40
ValueState: 2,612,406,416,303,,MIDM

Variable Atomic_Import1
Title: Atomic Import
Description: removed this capability
Definition: INDEX importInd:=CopyIndex(IndexesOf(Raw_Imported_Data1) & '');~
INDEX colSubset:=CopyIndex(Non_Null_Cols1);~
INDEX rowSubset:=IF Includes_Rows1 ~
   THEN Subset(Raw_Imported_Data1.Row>=Header_Start_Row1)~
   ELSE [Null];~
VAR colFlag:=Size(colSubset) > 1;~
VAR rowFlag:=Size(rowSubset) > 1;~
~
IF NOT Atomic_Flag1~
THEN Null~
ELSE IF colFlag AND rowFlag~
THEN MsgBox("The data on the tab '" & Active_Tab_Name1 & "' of workbook '" & Active_File_Path1 & "' has been specified to be dimensionless (i.e., a single cell). However, multiple rows and columns are populated below or to the right of the specified data start cell. Please check the data or the import settings for correctness.", 1, "Error Importing Dimensionless Data")~
ELSE IF colFlag AND Includes_Rows1~
THEN Raw_Imported_Data1[.Column=colSubset, @colSubset=2, .Row=Header_Start_Row1]~
ELSE IF colFlag AND (NOT Includes_Rows1)~
THEN Raw_Imported_Data1[.Column=colSubset, @colSubset=2]~
ELSE IF rowFlag AND Includes_Cols1~
THEN Raw_Imported_Data1[.Row=rowSubset, @rowSubset=2, .Column=Start_Col1]~
ELSE IF rowFlag AND (NOT Includes_Cols1)~
THEN Raw_Imported_Data1[.Row=rowSubset, @rowSubset=2]~
ELSE IF Includes_Rows1 AND Includes_Cols1~
THEN Raw_Imported_Data1[.Row=Header_Start_Row1, .Column=Start_Col1]~
ELSE IF Includes_Rows1 ~
THEN Raw_Imported_Data1[.Row=Header_Start_Row1]~
ELSE IF Includes_Cols1~
THEN Raw_Imported_Data1[.Column=Start_Col1]~
ELSE Raw_Imported_Data1
NodeLocation: 480,176,1
NodeSize: 64,40
ValueState: 2,650,391,416,315,,MIDM
NodeColor: 65535,1,1

Variable Flat_Import_Data1
Title: Flat Import Data
Definition: IF Use_LibXl THEN FlatImportDat_LibXl ELSE Flat_Import_Data_Exc
NodeLocation: 272,80,1
NodeSize: 64,40
ValueState: 2,292,82,1444,698,0,MIDM
ReformVal: [Expected_Cols,Populated_Rows]

Variable Format_Import_Data1
Title: Formatted Import Data
Description: The import dataset after proper row and column formatting have been applied, but prior to dimensionalizing the data with fact column indices and a value index.
Definition: Flat_Import_Data1~
/*removed this ability~
IF Atomic_Flag1 ~
THEN Atomic_Import1~
ELSE Flat_Import_Data1
NodeLocation: 480,80,1
NodeSize: 64,40
ValueState: 2,199,41,1414,804,0,MIDM
Aliases: FormNode New802801955, FormNode New674875683
ReformVal: [Expected_Cols,Populated_Rows]

Button Import_Data_Tabs1
Title: Import Data Tabs
Description: Initiate data import from Excel for the selected datasets.
NodeLocation: 688,184,1
NodeSize: 64,40
WindState: 2,118,538,720,350
Aliases: Alias New2144979235
OnClick: Read_and_Store_Data1()

Function Read_and_Store_Data1()
Title: Read and Store Data
Definition: Import_Reset1:=NOT Import_Reset1;~
Import_in_Progress:=1;~
VAR cnt:=0;~
VAR maxCnt:=Size(Selected_Import_Data);~
~
FOR J:=Selected_Import_Data DO (~
   cnt:=cnt+1;~
   Dataset_to_View1:=Tab_Names_by_Number[Imported_Dataset_Num=J];~
   ShowProgressBar("Excel Import Progress", "Importing tab '" & Active_Tab_Name1 & "'. Dataset " & cnt & " of " & maxCnt & ".", (cnt-0.1)/maxCnt);~
   Check_Index_Errors1;~
   Check_DataType_Erro1;~
   LocalAlias storeVar:=Active_StoreLocatio1;~
   storeVar:=Indexed_Import_Data1;~
);~
~
Last_Import_Time:=Today(withTime: True);~
Import_In_Progress:=0;~
Import_Reset1:=NOT Import_Reset1;~
MsgBox("Import of data tabs complete.", 0, "Import Complete");
NodeLocation: 688,80,1
NodeSize: 64,40
WindState: 2,169,46,720,597

Module Configuration_Param1
Title: Configuration Parameters
Author: JamesMilford
Date: Sun, Dec 16, 2018 8:07 AM
NodeLocation: 120,480,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,241,25,1136,749,17,10

Variable Active_Tab_Name1
Title: Active Tab Name
Description: The tab name for the dataset that is currently being imported.
Definition: Excel_Import_Setting[Excel_Import_Params=Tab_Name_Label, Imported_Dataset_Num=Active_Dataset_Num1]
NodeLocation: 296,224,1
NodeSize: 64,40
ValueState: 2,968,294,416,303,,MIDM

Variable Active_File_Path1
Title: Active File Path
Description: The file path for the dataset that is currently being imported.
Definition: Import_Reset1;~
Excel_Import_Setting[Excel_Import_Params=File_Path_Label, Imported_Dataset_Num=Active_Dataset_Num1]
NodeLocation: 296,128,1
NodeSize: 64,40
WindState: 2,102,82,1034,475
ValueState: 2,526,564,1073,178,,MIDM

Variable Active_Wkbk_Object1
Title: Active Workbook Object
Description: The workbook object for the dataset that is currently being imported.
Definition: SpreadsheetOpen(Active_File_Path1)
NodeLocation: 448,128,1
NodeSize: 64,40
ValueState: 2,280,282,416,303,,MIDM

Variable Active_Dataset_Num1
Title: Active Dataset Number
Description: The dataset number that is currently being imported.
Definition: SubIndex(Tab_Names_by_Number, Dataset_to_View1, Imported_Dataset_Num)
NodeLocation: 112,416,1
NodeSize: 64,40

Variable Active_Start_Cell1
Title: Active Start Cell
Description: The start cell for the dataset that is currently being imported.
Definition: Excel_Import_Setting[Excel_Import_Params=Start_Cell_Label, Imported_Dataset_Num=Active_Dataset_Num1]
NodeLocation: 296,320,1
NodeSize: 64,40

Variable Active_StoreLocatio1
Title: Active Store Location
Description: The handle to the object where the dataset that is currently being imported will be stored.
Definition: Excel_Import_Setting[Excel_Import_Params=Stored_Locat_Label, Imported_Dataset_Num=Active_Dataset_Num1]
NodeLocation: 296,608,1
NodeSize: 64,40
WindState: 2,18,191,720,350

Variable Active_Value_Index1
Title: Active Value Index
Description: The handle to the value index for the dataset that is currently being imported.
Definition: Excel_Import_Setting[Excel_Import_Params=Value_Index_Label, Imported_Dataset_Num=Active_Dataset_Num1]
NodeLocation: 296,704,1
NodeSize: 64,40
WindState: 2,18,191,720,350

Variable Active_Data_Default1
Title: Active Data Default
Description: The handle to the object where the dataset that is currently being imported will be stored.
Definition: Excel_Import_Setting[Excel_Import_Params=Data_Default_Label, Imported_Dataset_Num=Active_Dataset_Num1]
NodeLocation: 296,416,1
NodeSize: 64,40
WindState: 2,18,191,720,350

Variable Atomic_Flag1
Title: Atomic Flag
Description: If no fact columns or value index are specified, then the data is assumed to be atomic.
Definition: (Active_Value_Index1 = Null) AND (Size(Active_FactCol_Ind)=0)
NodeLocation: 448,704,1
NodeSize: 64,40
ValueState: 2,184,186,416,303,,MIDM

Variable Active_Data_Type1
Title: Active Data Type
Description: The data type for the dataset that is currently being imported.
Definition: Excel_Import_Setting[Excel_Import_Params=Data_Type_Label, Imported_Dataset_Num=Active_Dataset_Num1]
NodeLocation: 296,512,1
NodeSize: 64,40
WindState: 2,18,191,720,350

Variable Import_Reset1
Title: Import Reset
Definition: 1
NodeLocation: 144,128,1
NodeSize: 64,40

Decision Path_to_Global_Data1
Title: Path to Global Data
Description: The path to the spreadsheet whose data will be imported. ~
~
e.g. 'C:\Users\RickyBobby\Documents\Filename.xlsx'~
~
'C:\Users\cwelch\OneDrive - Resource-Innovations\Documents\General\Modeling Files\Data Templates\NYPA Model Data Cleanup.xlsx'
Definition: DetermTable(Select_Model_for_Dat)('C:\Users\cwelch\Documents\Repos\Nexant\SPIDER\JEA Specific\JEA Data File.xlsx')
NodeLocation: 144,224,1
NodeSize: 64,40
WindState: 2,98,82,720,547
DefnState: 2,318,269,1279,164,0,DFNM
ValueState: 2,500,506,969,193,,MIDM
Aliases: FormNode New1842989347, FormNode New1345964323, FormNode New809093411
TableCellDefault: 'C:\Documents\Filename.xlsx'

Decision Dataset_to_View1
Title: Dataset to View
Description: Select the tab name of the dataset you wish to view in greater detail.
Definition: Choice(Tab_Names,87,0)
NodeLocation: 112,520,1
NodeSize: 64,40
WindState: 2,7,277,720,350
Aliases: FormNode New500812067, FormNode New265931043, FormNode New138004771

Variable Start_Col1
Title: Start Col
Definition: local start_col:=Excel_Cell_Component(Active_Start_Cell1)[Excel_Components=Excel_Col_Label];~
IF start_col<>"A" THEN ~
(MsgBox("Current data import scripts must have the data start in Row A.",1);start_col) ELSE start_col
NodeLocation: 448,360,1
NodeSize: 64,40

Variable Data_Start_Row1
Title: Data Start Row
Definition: Header_Start_Row1 + 1
NodeLocation: 600,264,1
NodeSize: 64,40

FormNode New1842989347
Title: Path to Test File
Definition: 0
NodeLocation: 240,28,1
NodeSize: 216,20
NodeInfo: 1,,,,,,,144,,,0,,,0
Original: Path_to_Global_Data1

FormNode New500812067
Title: Dataset to View
Definition: 0
NodeLocation: 112,568,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,
Original: Dataset_to_View1

Variable Header_Start_Row1
Title: Header Start Row
Definition: Excel_Cell_Component(Active_Start_Cell1)[Excel_Components=Excel_Row_Label]
NodeLocation: 448,264,1
NodeSize: 64,40

Close Configuration_Param1

Module Import_Error_Checks1
Title: Import Error Checks
Author: JamesMilford
Date: Sun, Dec 16, 2018 8:07 AM
NodeLocation: 272,480,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,214,72,1000,465,17,10

Variable Missing_Subscripts1
Title: Missing Subscripts
Definition: VAR maxCnt:=0;~
VAR missingRef:=FOR J:=@Active_FactCol_Ind DO (~
   MetaVar indHandle:=Slice(Active_FactCol_Ind, J);~
   LocalAlias ind:=indHandle;~
   INDEX missingLabel:=Subset(NOT PositionInIndex(Flat_Import_Data1[Expected_Cols=indHandle], ind, Populated_Rows));~
   maxCnt:=MAX([maxCnt, Size(missingLabel)]);~
   \missingLabel~
);~
~
INDEX Number_Missing:=IF maxCnt = 0~
   THEN []~
   ELSE 1..maxCnt;~
~
IF maxCnt = 0~
THEN Null~
ELSE FOR K:=@Index_Titles DO (~
   INDEX deref:=CopyIndex(#missingRef[@Active_FactCol_Ind=K]);~
   Slice(deref, Number_Missing)~
   )~
~
~
~

NodeLocation: 272,208,1
NodeSize: 64,40
ValueState: 2,31,55,791,633,0,MIDM
ReformVal: [Sys_LocalIndex('Index_Names'),Sys_LocalIndex('Number_Missing')]
NumberFormat: 2,F,2,3,0,0,2,0,$,0,"ABBREV",0,,,0,0,15

Variable Incorrect_Subscript1
Title: Incorrect Subscripts
Definition: VAR maxCnt:=0;~
VAR incorrectRef:=FOR J:=@Active_FactCol_Ind DO (~
   MetaVar indHandle:=Slice(Active_FactCol_Ind, J);~
   LocalAlias ind:=indHandle;~
   INDEX all_labels:=CopyIndex(Flat_Import_Data1[Expected_Cols=indHandle]);~
   INDEX uniqueLabels:=Unique(all_labels);~
   INDEX incorrectLabel:=Subset(NOT Sum(uniqueLabels = ind, ind));~
   maxCnt:=MAX([maxCnt, Size(incorrectLabel)]);~
   \incorrectLabel~
);~
~
INDEX Number_Incorrect:=IF maxCnt = 0~
   THEN []~
   ELSE 1..maxCnt;~
~
IF maxCnt = 0~
THEN Null~
ELSE FOR K:=@Index_Titles DO (~
   INDEX deref:=CopyIndex(#incorrectRef[@Active_FactCol_Ind=K]);~
   Slice(deref, Number_Incorrect)~
   )~
~
~
~

NodeLocation: 272,304,1
NodeSize: 64,40
ValueState: 2,1244,265,612,287,0,MIDM
ReformVal: [Index_Titles,Sys_LocalIndex('Number_Incorrect')]
NumberFormat: 2,F,2,3,0,0,2,0,$,0,"ABBREV",0,,,0,0,15

Variable Repeat_Subscripts1
Title: Repeat Subscripts
Definition: INDEX subscripts:=CopyIndex(JoinText(Flat_Import_Data1[Expected_Cols=Active_FactCol_Ind], Active_FactCol_Ind, Pipe_Separator3));~
INDEX uniqSubs:=Unique(subscripts);~
INDEX repeatSubs:=Subset(Sum(subscripts = uniqSubs, subscripts) > 1);~
~
IF size(repeatSubs) = 0~
THEN Null~
ELSE CopyIndex(repeatSubs)
NodeLocation: 272,400,1
NodeSize: 64,40
WindState: 2,29,62,720,350
ValueState: 2,1098,189,675,474,0,MIDM

Decision Apply_Index_Checks1
Title: Apply Index Checks?
Description: Select the index error checks that will be applied.~
~
Missing Subscripts - indicates whether any combination of fact column coordinates/subscripts is missing. Combinations are often omitted when they are not applicable, so this does not necessarily indicate an error.~
~
Incorrect Subscripts - indicates when coordinates/subscripts in a given fact column do not match any of the elements of the index that is assigned to that fact column.~
~
Repeated Subscripts - indicates when a specific combination of coordinates/subscripts are repeated across two or more rows of the import data. In these instances, the model is not able to determine which row should be assigned to the coordinates, so it sums all rows having those coordinates.
Definition: Table(All_Index_Checks)(Checkbox(0),Checkbox(0),Checkbox(0))
NodeLocation: 496,64,1
NodeSize: 64,40
WindState: 2,36,91,978,453
Aliases: FormNode New1037682979, FormNode New3787043, FormNode New1480182051
TableCellDefault: Checkbox(1)

Objective Index_Error_Checks1
Title: Index Error Checks
Definition: Table(All_Index_Checks)(Handle(Missing_Subscripts1), Handle(Incorrect_Subscript1), Handle(Repeat_Subscripts1))
NodeLocation: 424,200,1
NodeSize: 64,40
NodeColor: 19661,48336,65535

Variable Check_Index_Errors1
Title: Check for Index Errors
Description: This performs checks to identify if there are any index errors with the imported data. Only the index error types selected by the user will be evaluated. If an error is found, a result window will open showing the coordinates/subscripts in the Excel data that don't align with the associated indices. If multiple error types are present, multiple result windows will open.
Definition: Import_Reset1;~
VAR result:='No Errors';~
~
IF Atomic_Flag1~
THEN Null~
ELSE (FOR J:=Index_Checks DO (~
   MetaVar errHandle:=Index_Error_Checks1[All_Index_Checks=J];~
   VAR ident:=Identifier of errHandle;~
   LocalAlias errResult:=errHandle;~
   IFONLY (Size(errResult) = 1) AND (errResult = Null)~
   THEN Null~
   ELSE (IF Import_in_Progress THEN MsgBox(Msgs_for_Index_Erro1[All_Index_Checks=J], 1, "Index Error Found") ELSE Null;~
              IF Open_Error_Results THEN Show_Result(ident) ELSE Null;~
		result:='Errors Found';~
             )~
   );~
   result~
)
NodeLocation: 584,200,1
NodeSize: 64,40
WindState: 2,26,148,1156,489
ValueState: 2,456,266,719,428,,MIDM
Aliases: FormNode New1876543779, FormNode New1748617507

Decision Msgs_for_Index_Erro1
Title: Messages for Index Errors
Definition: Table(All_Index_Checks)("The data on the tab '" & Active_Tab_Name1 & "' of workbook '" & Active_File_Path1 & "' is missing subscripts for the associated indexes. See 'Missing Subscripts' (Missing_Subscripts).","The data on the tab '" & Active_Tab_Name1 & "' of workbook '" & Active_File_Path1 & "' has incorrect subscripts for the associated indexes. See 'Incorrect Subscripts' (Incorrect_Subscripts).","The data on the tab '" & Active_Tab_Name1 & "' of workbook '" & Active_File_Path1 & "' has repeated subscripts for the associated indexes. See 'Repeated Subscripts' (Repeated_Subscripts).")
NodeLocation: 424,304,1
NodeSize: 64,40
WindState: 2,102,82,720,350
DefnState: 2,200,202,1306,719,,DFNM
ValueState: 2,162,155,1431,766,,MIDM
Aliases: FormNode New1574553891

Variable Non_Number_Rows1
Title: Non-Number Rows
Definition: VAR data:=Format_Import_Data1[Expected_Cols=Import_Value_Cols];~
Subset(Sum(((NOT IsNumber(data)) OR IsDateTime(data)) AND (data<>Null), Import_Value_Cols))
NodeLocation: 112,416,1
NodeSize: 64,40
WindState: 2,102,82,1479,350
ValueState: 2,252,460,416,303,0,MIDM

Decision Apply_DataType_Chec1
Title: Apply Data Type Checks?
Description: Check this option to test the data types of the imported data. For example, if a dataset has been specified to be of the "Number" data type, then error messages will be displayed if the imported data is not a number (e.g., text or dates).
Definition: Checkbox(0)
NodeLocation: 352,64,1
NodeSize: 64,40
Aliases: FormNode New2111424803, FormNode New1077528867, FormNode New943311139

Variable Non_Text_Rows1
Title: Non-Text Rows
Definition: VAR data:=Format_Import_Data1[Expected_Cols=Import_Value_Cols];~
Subset(Sum(NOT IsText(data) AND (data<>Null), Import_Value_Cols))
NodeLocation: 112,512,1
NodeSize: 64,40
WindState: 2,932,6,852,490
ValueState: 2,846,2,416,303,0,MIDM

Variable Non_Date_Rows1
Title: Non-Date Rows
Definition: VAR data:=Format_Import_Data1[Expected_Cols=Import_Value_Cols];~
Subset(Sum(NOT IsDateTime(data) AND (data<>Null), Import_Value_Cols))
NodeLocation: 112,608,1
NodeSize: 64,40
WindState: 2,696,221,1118,568
ValueState: 2,226,204,416,303,,MIDM

Objective DataType_Error_Chec1
Title: Data Type Error Checks
Definition: Table(Import_Data_Types)(Handle(Any_Type1),Handle(Non_Number_Rows1),Handle(Non_Text_Rows1),Handle(Non_Date_Rows1))
NodeLocation: 272,512,1
NodeSize: 64,40
WindState: 2,102,82,720,350
NodeColor: 19661,48336,65535

Variable Any_Type1
Title: Any Type
Definition: []
NodeLocation: 112,696,1
NodeSize: 64,40

Variable Check_DataType_Erro1
Title: Check for Data Type Errors
Description: This performs checks to identify if there are any data type errors with the imported data. This will only look for errors if the user has allowed data type checks to be performed. If an error is found, a result window will open showing the spreadsheet rows where the error occurs.
Definition: Import_Reset1;~
VAR result:='No Errors';~
~
IF NOT Apply_DataType_Chec1~
THEN Null~
ELSE (MetaVar errHandle:=DataType_Error_Chec1[Import_Data_Types=Active_Data_Type1];~
   VAR ident:=Identifier of errHandle;~
   LocalAlias errResult:=errHandle;~
   IF Size(errResult) = 0~
   THEN Null~
   ELSE (IF Import_In_Progress THEN MsgBox(Messages_for_Type_E1[Import_Data_Types=Active_Data_Type1], 1, "Data Type Error Found") ELSE Null;~
              IF Open_Error_Results THEN Show_Result(ident) ELSE Null;~
              result:='Errors Found';~
             )~
);~
~
result
NodeLocation: 536,512,1
NodeSize: 64,40
WindState: 2,17,273,1522,522
ValueState: 2,456,266,719,428,,MIDM
Aliases: FormNode New534366499, FormNode New406440227

Decision Messages_for_Type_E1
Title: Messages for Type Errors
Definition: Table(Import_Data_Types)(Null,"The tab '" & Active_Tab_Name1 & "' of workbook '" & Active_File_Path1 & "' includes data that are not numbers (the required data type). See 'Non-Number Rows' (Non_Number_Rows).","The tab '" & Active_Tab_Name1 & "' of workbook '" & Active_File_Path1 & "' includes data that are not text (the required data type). See 'Non-Text Rows' (Non_Text_Rows).","The tab '" & Active_Tab_Name1 & "' of workbook '" & Active_File_Path1 & "' includes data that are not dates (the required data type). See 'Non-Date Rows' (Non_Date_Rows).")
NodeLocation: 384,640,1
NodeSize: 64,40
WindState: 2,102,82,720,350
DefnState: 2,178,334,1306,719,0,DFNM
ValueState: 2,584,586,1043,303,,MIDM
Aliases: FormNode New64604451
{!50000|Att_ColumnWidths: [882]}

Variable Indexed_Import_Data1
Title: Indexed Import Data
Definition: LocalAlias valueInd:=IF Active_Value_Index1 = Null~
   THEN Return_Not_Specified()~
   ELSE Active_Value_Index1;~
~
IF Atomic_Flag1~
THEN Format_Import_Data1~
ELSE MdTable(Format_Import_Data1, Populated_Rows, Expected_Cols, Active_FactCol_Ind, 'min'  , Active_Data_Default1, valueInd)
NodeLocation: 584,304,1
NodeSize: 64,40
ValueState: 2,54,4,1670,784,0,MIDM
ReformVal: [0,0]
Att__TotalsIndex: [RET_or_MD]
Att_ResultSliceState: [RET_or_MD,0,All_Measures,1,Measure_Parameter,1]

FormNode New1574553891
Title: Messages for Index Errors
Definition: 0
NodeLocation: 424,356,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,70,0,,0,,,0
Original: Msgs_for_Index_Erro1

FormNode New1037682979
Title: Apply Index Checks?
Definition: 0
NodeLocation: 496,116,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Apply_Index_Checks1

FormNode New2111424803
Title: Apply Data Type Checks?
Definition: 0
NodeLocation: 404,92,1
NodeSize: 28,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Apply_DataType_Chec1

FormNode New64604451
Title: Messages for Index Errors
Definition: 0
NodeLocation: 384,692,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,70,0,,0,,,0
Original: Messages_for_Type_E1

Close Import_Error_Checks1

Variable Non_Null_Cols1
Title: Non-Null Cols
Definition: IF NOT Includes_Cols1~
THEN Null~
ELSE   (VAR colPos:=PositionInIndex(Raw_Imported_Data1.Column, Start_Col1, Raw_Imported_Data1.Column);~
	      INDEX colSub:=Subset(@Raw_Imported_Data1.Column >= colPos);~
            VAR colHeaders:=IF Includes_Rows1 THEN Raw_Imported_Data1[.Row=Header_Start_Row1, .Column=colSub] ELSE Raw_Imported_Data1[.Column=colSub];~
	     VAR nullFlag:=Cumulate(Cumulate(colHeaders = Null, colSub), colSub);   {Flag the first occurrence of a null header column with a 1}~
	     Subset(nullFlag = 0)~
	     )~

NodeLocation: 272,176,1
NodeSize: 64,40
ValueState: 2,495,284,676,516,0,MIDM

Variable Includes_Rows1
Title: Includes Rows
Definition: INDEX importInd:=CopyIndex(IndexesOf(Raw_Imported_Data1) & '');~
~
PositionInIndex(importInd, '.Row', importInd) > 0
NodeLocation: 272,272,1
NodeSize: 64,40

Variable Includes_Cols1
Title: Includes Cols
Definition: INDEX importInd:=CopyIndex(IndexesOf(Raw_Imported_Data1) & '');~
~
PositionInIndex(importInd, '.Column', importInd) > 0
NodeLocation: 272,368,1
NodeSize: 64,40

Index Model_for_Data_Impo1
Att_PrevIndexValue: ['SPIDER']
Title: Model for Data Import
Definition: ['SPIDER']
NodeLocation: 432,368,1
NodeSize: 64,40
WindState: 2,348,98,720,350
Aliases: FormNode Fo1124452643

Decision Select_Model_for_Dat
Title: Select Model for Data Import
Description: Choice(Model_for_Data_Impo1,1,0)
Definition: Choice(Model_for_Data_Impo1,1,0)
NodeLocation: 584,368,1
NodeSize: 64,40
Aliases: FormNode Fo1385416995
{!40300|DomainExpr: Model_for_Data_Impo1}

Variable Raw_Imp_Dat_LIbXl
Title: Raw Imp Dat LIbXl
Definition: SS_GetRange( Active_Workbook_Obje,  range:Active_Tab_Name1&"!"  )
NodeLocation: 752,568,1
NodeSize: 64,40
ValueState: 2,774,183,1058,801,0,MIDM

Variable Active_Workbook_Obje
Title: Active Workbook Object LibXl
Description: The workbook object for the dataset that is currently being imported.
Definition: LibXl_Reset;~
SS_Open(Active_File_Path1)
NodeLocation: 592,568,1
NodeSize: 64,40
ValueState: 2,280,282,416,303,,MIDM

Variable Va35
Definition: Active_Tab_Name1&"!A1:F91"
NodeLocation: 272,672,1
NodeSize: 64,40
ValueState: 2,387,403,416,303,,MIDM

Button Reset_LibXl
Title: Reset LibXl
NodeLocation: 816,400,1
NodeSize: 64,40
OnClick: LibXl_Reset:=Not LibXl_Reset

Variable LibXl_Reset
Title: LibXl Reset
Definition: 1
NodeLocation: 440,568,1
NodeSize: 64,40

Variable FlatImportDat_LibXl
Title: FlatImportDat LibXl
Definition: Raw_Imp_Dat_LIbXl[.Row=Populated_Rows, @.Column=@Expected_Cols]
NodeLocation: 920,568,1
NodeSize: 64,40
ValueState: 2,404,177,1159,507,0,MIDM
ReformVal: [Expected_Cols,Populated_Rows]

Alias Al246404387
Title: Release Spreadsheet
Definition: 1
NodeLocation: 960,400,1
NodeSize: 64,40
Original: Release_Spreadsheet

Index Exp_Cols_LibXl
Title: Exp Cols LibXl
Definition: Concat(Active_FactCol_Ind, Import_Value_Cols)
NodeLocation: 584,672,1
NodeSize: 64,40

Variable EndRow_LibXl
Title: EndRow LibXl
Definition: ArgMax(Sum(Raw_Imp_Dat_LIbXl<>NULL, Raw_Imp_Dat_LIbXl.Column)>0, Raw_Imp_Dat_LIbXl.Row)
NodeLocation: 752,688,1
NodeSize: 64,40

Variable End_Row_Excel1
Title: End Row Excel
Definition: ArgMax(Sum(Raw_Imported_Data1<>NULL, Raw_Imported_Data1.Column)>0, Raw_Imported_Data1.Row)
NodeLocation: 120,368,1
NodeSize: 64,40
ValueState: 2,612,406,416,303,,MIDM

Decision Use_LibXl
Title: Use LibXl
Definition: Checkbox(0)
NodeLocation: 592,472,1
NodeSize: 64,40
Aliases: FormNode Fo150983971

FormNode Fo150983971
Title: Use LibXl
Definition: 0
NodeLocation: 736,480,1
NodeSize: 56,16
Original: Use_LibXl

Variable Flat_Import_Data_Exc
Title: Flat Import Data Excel
Definition: VAR colOffset:=PositionInIndex(Raw_Imported_Data1.Column, Start_Col1, Raw_Imported_Data1.Column)-1;~
Raw_Imported_Data1[.Row=Populated_Rows, @.Column=@Expected_Cols+colOffset]
NodeLocation: 120,80,1
NodeSize: 64,40
ValueState: 2,292,82,1444,698,0,MIDM
ReformVal: [Expected_Cols,Populated_Rows]

Close Data_Import1

Module Categ_Index_Import1
Title: Categorical Index Import
Author: JamesMilford
Date: Fri, Dec 21, 2018 10:51 AM
NodeLocation: 136,80,1
NodeSize: 64,40
DiagState: 2,273,5,1157,749,17,10

Variable Categ_Index_Tab_Nam1
Title: Categ Index Tab Name
Description: The tab name for the dataset that is currently being imported.
Definition: CatInd_ImportSetting[Categ_Index_Params=Tab_Name_Label, Categ_Index_Tabs=Categ_Index_Tab_Num1]
NodeLocation: 552,168,1
NodeSize: 64,40

Variable Cat_Index_File_Path1
Title: Categ Index File Path
Description: The file path for the dataset that is currently being imported.
Definition: Import_Reset1; ~
CatInd_ImportSetting[Categ_Index_Params=File_Path_Label, Categ_Index_Tabs=Categ_Index_Tab_Num1]
NodeLocation: 400,72,1
NodeSize: 64,40
ValueState: 2,296,298,794,303,,MIDM

Variable Cat_Index_Workbook1
Title: Categ Index Workbook Object
Description: The workbook object for the dataset that is currently being imported.
Definition: SpreadsheetOpen(Cat_Index_File_Path1)
NodeLocation: 552,72,1
NodeSize: 64,40
ValueState: 2,280,282,416,303,,MIDM

Variable Categ_Index_Tab_Num1
Title: Categ Index Tab Number
Description: The dataset number that is currently being imported.
Definition: SubIndex(Categ_Index_Tab_Opt1, Cat_IndexTab_to_Vie1, Categ_Index_Tabs)
NodeLocation: 248,168,1
NodeSize: 64,40

Variable Cat_Index_Start_Cel1
Title: Categ Index Start Cell
Description: The start cell for the dataset that is currently being imported.
Definition: CatInd_ImportSetting[Categ_Index_Params=Start_Cell_Label, Categ_Index_Tabs=Categ_Index_Tab_Num1]
NodeLocation: 400,264,1
NodeSize: 64,40

Variable Cat_Index_Start_Row1
Title: Categ Index Start Row
Definition: Excel_Cell_Component(Cat_Index_Start_Cel1)[Excel_Components=Excel_Row_Label] + 1
NodeLocation: 560,336,1
NodeSize: 64,40

Decision Cat_IndexTab_to_Vie1
Title: Categ Index Tab to View
Description: Select the tab name of the categorical index data you wish to view in greater detail.
Definition: Choice(Cat_Index_Tab_Names,1,0)
NodeLocation: 248,272,1
NodeSize: 64,40
WindState: 2,7,277,720,350
Aliases: FormNode New1138346275, FormNode New869910819

Variable Categ_Index_Tab_Opt1
Title: Categ Index Tab Options
Definition: CatInd_ImportSetting[Categ_Index_Params=Tab_Name_Label]
NodeLocation: 96,168,1
NodeSize: 64,40
ValueState: 2,22,239,479,384,0,MIDM

Variable Raw_Categ_Index_Dat1
Title: Raw Category Index Data
Description: The raw imported data for the active category index tab.
Definition: SpreadsheetRange(Cat_Index_Workbook1, sheet: Categ_Index_Tab_Nam1)
NodeLocation: 704,72,1
NodeSize: 64,40
ValueState: 2,32,21,1725,669,0,MIDM
Aliases: FormNode New1943652643

Variable Categ_Index_End_Row1
Title: Categ Index End Row
Definition: ArgMax(Sum(Raw_Categ_Index_Dat1<>NULL, Raw_Categ_Index_Dat1.Column)>0, Raw_Categ_Index_Dat1.Row)
NodeLocation: 704,168,1
NodeSize: 64,40
ValueState: 2,612,406,416,303,,MIDM

Variable Format_CategInd_Dat1
Title: Formatted Category Index Data
Description: The import categorical indexes after proper row and column formatting have been applied. Click on the blue index names to view the actual indices.
Definition: VAR colOffset:=PositionInIndex(Raw_Categ_Index_Dat1.Column, CategIndex_Start_Co1, Raw_Categ_Index_Dat1.Column)-1;~
Raw_Categ_Index_Dat1[.Row=Categ_Index_Rows, @.Column=@Categ_Index_Handles+colOffset]
NodeLocation: 856,72,1
NodeSize: 64,40
ValueState: 2,191,56,1135,497,0,MIDM
Aliases: FormNode New198822179
ReformVal: [Categ_Index_Handles,Categ_Index_Rows]

Variable CategIndex_Start_Co1
Title: Categ Index Start Col
Definition: Excel_Cell_Component(Cat_Index_Start_Cel1)[Excel_Components=Excel_Col_Label]
NodeLocation: 704,264,1
NodeSize: 64,40

Button Import_Categ_Indexe1
Title: Import Categorical Indexes
Description: Initiate import from Excel for the selected categorical index tabs.
NodeLocation: 1016,176,1
NodeSize: 64,40
WindState: 2,118,247,720,350
Aliases: Alias New1272564003
OnClick: Read_Store_Cat_Inde1()

Function Read_Store_Cat_Inde1()
Title: Read and Store Categ Indexes
Definition: Import_Reset1:=NOT Import_Reset1;~
VAR cnt:=0;~
VAR maxCnt:=Size(Select_Categ_Indexes);~
~
FOR J:=Select_Categ_Indexes DO (~
   cnt:=cnt+1;~
   Cat_IndexTab_to_Vie1:=Categ_Index_Tab_Opt1[Categ_Index_Tabs=J];~
   ShowProgressBar("Categorical Index Import Progress", "Importing tab '" & Categ_Index_Tab_Nam1 & "'. Tab " & cnt & " of " & maxCnt & ".", (cnt-0.1)/maxCnt);~
   FOR K:=@Categ_Index_Handles DO (~
      LocalAlias storeVar:=Slice(Categ_Index_Handles, K);~
      INDEX indexData:=CopyIndex(Format_CategInd_Dat1[@Categ_Index_Handles=K]);~
      storeVar:=Subset(indexData <> Null);~
      Null   {return a null value to avoid issues with implicit indexes}~
   );~
);~
~
Last_Import_Time:=Today(withTime: True);~
Import_Reset1:=NOT Import_Reset1;~
MsgBox("Import of categorical indexes complete.", 0, "Import Complete");
NodeLocation: 1016,72,1
NodeSize: 64,40
WindState: 2,33,70,804,643

FormNode New1138346275
Title: Dataset to View
Definition: 0
NodeLocation: 248,320,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,
Original: Cat_IndexTab_to_Vie1

Close Categ_Index_Import1

Module Seq_Index_Import1
Title: Sequence Index Import
Author: JamesMilford
Date: Fri, Dec 21, 2018 10:51 AM
NodeLocation: 288,80,1
NodeSize: 64,40
DiagState: 2,64,359,1428,430,17

Variable Seq_Index_Tab_Name1
Title: Sequence Index Tab Name
Description: The tab name for the data that is currently being imported.
Definition: SeqInd_ImportSettin1[Seq_Index_Params1=Tab_Name_Label, Seq_Index_Tabs1=Seq_Index_Tab_Num1]
NodeLocation: 552,168,1
NodeSize: 64,40

Variable Seq_Index_File_Path1
Title: Sequence Index File Path
Description: The file path for the parameter that is currently being imported.
Definition: Import_Reset1; ~
SeqInd_ImportSettin1[Seq_Index_Params1=File_Path_Label, Seq_Index_Tabs1=Seq_Index_Tab_Num1]
NodeLocation: 400,72,1
NodeSize: 64,40
ValueState: 2,296,298,794,303,,MIDM

Variable Seq_Index_Workbook1
Title: Seq Index Workbook Object
Description: The workbook object for the data that is currently being imported.
Definition: SpreadsheetOpen(Seq_Index_File_Path1)
NodeLocation: 552,72,1
NodeSize: 64,40
ValueState: 2,280,282,416,303,,MIDM

Variable Seq_Index_Tab_Num1
Title: Sequence Index Tab Number
Description: The sequence parameter number that is currently being imported.
Definition: SubIndex(Seq_Index_Tab_Opt1, Seq_IndexTab_to_Vie1, Seq_Index_Tabs1)
NodeLocation: 248,168,1
NodeSize: 64,40

Variable Seq_Index_Start_Cel1
Title: Sequence Index Start Cell
Description: The start cell for the parameter that is currently being imported.
Definition: SeqInd_ImportSettin1[Seq_Index_Params1=Start_Cell_Label, Seq_Index_Tabs1=Seq_Index_Tab_Num1]
NodeLocation: 400,264,1
NodeSize: 64,40

Variable Seq_Index_Start_Row1
Title: Sequence Index Start Row
Definition: Excel_Cell_Component(Seq_Index_Start_Cel1)[Excel_Components=Excel_Row_Label]
NodeLocation: 560,336,1
NodeSize: 64,40

Decision Seq_IndexTab_to_Vie1
Title: Seq Index Tab to View
Description: Select the tab name of the sequence index data you wish to view in greater detail.
Definition: Choice(Seq_Index_Tab_Names1,1,0)
NodeLocation: 248,272,1
NodeSize: 64,40
WindState: 2,7,277,720,350
Aliases: FormNode New601475363, FormNode New1742326051

Variable Seq_Index_Tab_Opt1
Title: Sequence Index Tab Options
Definition: SeqInd_ImportSettin1[Seq_Index_Params1=Tab_Name_Label]
NodeLocation: 96,168,1
NodeSize: 64,40
ValueState: 2,22,239,479,384,,MIDM

Variable Raw_Seq_Index_Data1
Title: Raw Sequence Index Data
Description: The raw imported data for the active sequence index tab.
Definition: SpreadsheetRange(Seq_Index_Workbook1, sheet: Seq_Index_Tab_Name1)
NodeLocation: 704,72,1
NodeSize: 64,40
ValueState: 2,32,21,670,234,0,MIDM
Aliases: FormNode New1205455139

Variable Seq_Index_End_Row1
Title: Sequence Index End Row
Definition: ArgMax(Sum(Raw_Seq_Index_Data1<>NULL, Raw_Seq_Index_Data1.Column)>0, Raw_Seq_Index_Data1.Row)
NodeLocation: 704,168,1
NodeSize: 64,40
ValueState: 2,612,406,416,303,,MIDM

Variable Format_Seq_Ind_Data1
Title: Formatted Sequence Index Data
Description: The imported sequence index parameters after proper row and column formatting have been applied. Click on the blue variable names to view the actual model parameters.
Definition: Raw_Seq_Index_Data1[.Row=Seq_Index_Rows1, @Seq_Index_Rows1=@Seq_Index_Handles1, @.Column=2]
NodeLocation: 856,72,1
NodeSize: 64,40
ValueState: 2,532,397,534,436,,MIDM
Aliases: FormNode New668584227
ReformVal: [Undefined,Seq_Index_Handles1]

Variable Seq_Index_Start_Col1
Title: Sequence Index Start Col
Definition: Excel_Cell_Component(Seq_Index_Start_Cel1)[Excel_Components=Excel_Col_Label]
NodeLocation: 704,264,1
NodeSize: 64,40
ValueState: 2,426,510,416,303,,MIDM

Button Import_Seq_Index1
Title: Import Sequence Indexes
Description: Initiate import from Excel for the selected sequence index tabs.
NodeLocation: 1016,176,1
NodeSize: 64,40
WindState: 2,118,538,720,350
Aliases: Alias New131713315
OnClick: Read_Store_Seq_Inde1()

Function Read_Store_Seq_Inde1()
Title: Read and Store Seq Indexes
Definition: Import_Reset1:=NOT Import_Reset1;~
VAR cnt:=0;~
VAR maxCnt:=Size(Select_Seq_Indexes1);~
~
FOR J:=Select_Seq_Indexes1 DO (~
   cnt:=cnt+1;~
   Seq_IndexTab_to_Vie1:=Seq_Index_Tab_Opt1[Seq_Index_Tabs1=J];~
   ShowProgressBar("Sequence Index Import Progress", "Importing tab '" & Seq_Index_Tab_Name1 & "'. Tab " & cnt & " of " & maxCnt & ".", (cnt-0.1)/maxCnt);~
   FOR K:=@Seq_Index_Handles1 DO (~
      LocalAlias storeVar:=Slice(Seq_Index_Handles1, K);~
      VAR indexData:=Format_Seq_Ind_Data1[@Seq_Index_Handles1=K];~
      storeVar:=indexData;~
   );~
);~
~
Last_Import_Time:=Today(withTime: True);~
Import_Reset1:=NOT Import_Reset1;~
MsgBox("Import of sequence indexes complete.", 0, "Import Complete");
NodeLocation: 1016,72,1
NodeSize: 64,40
WindState: 2,-1,51,804,643

FormNode New601475363
Title: Dataset to View
Definition: 0
NodeLocation: 248,320,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,
Original: Seq_IndexTab_to_Vie1

Close Seq_Index_Import1

Close Excel_Import_Logic

Text Te31050019
Title: Structural Settings for Data Import~

Description: Warning: Changes to these settings can corrupt previously defined configurations.
NodeLocation: 1152,648,-1
NodeSize: 216,104
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Text Te1104791843
Title: Inspect Categorical Indexes
NodeLocation: 256,288,-1
NodeSize: 216,104
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Text Te567920931
Title: Import Categorical Indexes
Description: Warning: Updating these indexes may modify or corrupt pre-existing data tables.
NodeLocation: 256,92,-1
NodeSize: 216,84
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Text Te1641662755
Title: Structural Settings for Categorical Index Import~

Description: Warning: Changes to these settings can corrupt previously defined configurations.
NodeLocation: 256,504,-1
NodeSize: 216,104
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Text Te299485475
Title: Inspect Sequence Indexes
NodeLocation: 704,288,-1
NodeSize: 216,104
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Text Te1373227299
Title: Import Sequence Indexes
Description: Warning: Updating these indexes may modify or corrupt pre-existing data tables.
NodeLocation: 704,92,-1
NodeSize: 216,84
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Text Te836356387
Title: Structural Settings for Sequence Index Import~

Description: Warning: Changes to these settings can corrupt previously defined configurations.
NodeLocation: 704,504,-1
NodeSize: 216,104
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Text Te1910098211
Title: Inspect Data Import
NodeLocation: 1152,400,-1
NodeSize: 216,136
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Text Te165267747
Title: Import Data Tabs
Description: Warning: Updating these datasets may modify or corrupt pre-existing data tables.
NodeLocation: 1152,132,-1
NodeSize: 216,124
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Text Te1239009571
Title: Sequentially Import Indexes Then Data
Description: Warning: Updating these datasets may modify or corrupt pre-existing data tables.
NodeLocation: 1600,160,-1
NodeSize: 216,152
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

FormNode New1675217187
Title: Excel Import Configuration
Definition: 0
NodeLocation: 1156,644,1
NodeSize: 212,20
NodeColor: 49344,49344,49344
Original: Excel_Import_Setting

FormNode New333039907
Title: Max Imported Dimensions
Definition: 0
NodeLocation: 1156,724,1
NodeSize: 212,20
NodeColor: 49344,49344,49344
Original: Max_Imported_Dim

FormNode New1406781731
Title: Number of Imported Datasets
Definition: 0
NodeLocation: 1156,684,1
NodeSize: 212,20
NodeColor: 49344,49344,49344
Original: Number_of_Datasets

FormNode New869910819
Title: Categ Index Tab to View
Definition: 0
NodeLocation: 260,244,1
NodeSize: 212,20
NodeInfo: 1,,,,,,0,198,,,,,,0
Original: Cat_IndexTab_to_Vie1

FormNode New1943652643
Title: Raw Category Index Data
Definition: 1
NodeLocation: 260,284,1
NodeSize: 212,20
NodeColor: 65278,37008,6168
Original: Raw_Categ_Index_Dat1

FormNode New198822179
Title: Formatted Category Index Data
Definition: 1
NodeLocation: 260,324,1
NodeSize: 212,20
NodeColor: 65278,37008,6168
Original: Format_CategInd_Dat1

Alias New1272564003
Title: Import Categorical Indexes
Definition: 1
NodeLocation: 336,152,1
NodeSize: 112,16
Original: Import_Categ_Indexe1

FormNode New735693091
Title: Max Imported Indexes
Definition: 0
NodeLocation: 260,580,1
NodeSize: 212,20
NodeColor: 49344,49344,49344
Original: Max_Imported_Indexes

FormNode New1809434915
Title: Number of Categorical Index Tabs
Definition: 0
NodeLocation: 260,540,1
NodeSize: 212,20
NodeColor: 49344,49344,49344
Original: Num_Categ_Index_Tabs

FormNode New467257635
Title: Categorical Index Import Settings
Definition: 0
NodeLocation: 260,500,2
NodeSize: 212,20
NodeColor: 49344,49344,49344
Original: CatInd_ImportSetting

Alias New1004128547
Title: Release Spreadsheet
Definition: 1
NodeLocation: 336,368,1
NodeSize: 112,16
Original: Release_Spreadsheet

FormNode New2077870371
Title: Sequence Index Import Settings
Definition: 0
NodeLocation: 708,496,1
NodeSize: 212,20
NodeColor: 49344,49344,49344
Original: SeqInd_ImportSettin1

Alias New131713315
Title: Import Sequence Indexes
Definition: 1
NodeLocation: 784,152,1
NodeSize: 112,16
Original: Import_Seq_Index1

FormNode New1205455139
Title: Raw Sequence Index Data
Definition: 1
NodeLocation: 708,280,1
NodeSize: 212,20
NodeColor: 65278,37008,6168
Original: Raw_Seq_Index_Data1

FormNode New668584227
Title: Formatted Sequence Index Data
Definition: 1
NodeLocation: 708,320,1
NodeSize: 212,20
NodeColor: 65278,37008,6168
Original: Format_Seq_Ind_Data1

FormNode New1742326051
Title: Sequence Index Tab to View
Definition: 0
NodeLocation: 708,240,1
NodeSize: 212,20
NodeInfo: 1,,,,,,0,198,,,,,,0
Original: Seq_IndexTab_to_Vie1

FormNode New400148771
Title: Max Imported Sequence Params
Definition: 0
NodeLocation: 708,576,1
NodeSize: 212,20
NodeColor: 49344,49344,49344
Original: Max_Import_Seq_Para1

FormNode New1473890595
Title: Number of Sequence Index Tabs
Definition: 0
NodeLocation: 708,536,1
NodeSize: 212,20
NodeColor: 49344,49344,49344
Original: Num_Seq_Index_Tabs1

FormNode New937019683
Title: Sequence Params to Import
Definition: 0
NodeLocation: 708,104,1
NodeSize: 212,20
NodeColor: 49344,49344,49344
Original: SeqIndexes_to_Impor1

Alias New2010761507
Title: Release Spreadsheet
Definition: 1
NodeLocation: 784,368,1
NodeSize: 112,16
Original: Release_Spreadsheet

FormNode New265931043
Title: Dataset to View
Definition: 0
NodeLocation: 1156,308,1
NodeSize: 212,20
NodeInfo: 1,,,,,,0,198,,,,,,0
Original: Dataset_to_View1

FormNode New1339672867
Title: Raw Imported Data
Definition: 1
NodeLocation: 1156,348,1
NodeSize: 212,20
NodeInfo: 1,,,,,,0,72,,,,,,0
NodeColor: 65278,37008,6168
Original: Raw_Imported_Data1

FormNode New802801955
Title: Cleaned Import Data
Definition: 1
NodeLocation: 1156,388,1
NodeSize: 212,20
NodeInfo: 1,,,,,,0,72,,,,,,0
NodeColor: 65278,37008,6168
Original: Format_Import_Data1

FormNode New1876543779
Title: Check for Index Errors
Definition: 1
NodeLocation: 1156,428,1
NodeSize: 212,20
NodeInfo: 1,,,,,,0,72,,,,,,0
NodeColor: 65278,37008,6168
Original: Check_Index_Errors1

FormNode New534366499
Title: Check for Data Type Errors
Definition: 1
NodeLocation: 1156,468,1
NodeSize: 212,20
NodeInfo: 1,,,,,,0,72,,,,,,0
NodeColor: 65278,37008,6168
Original: Check_DataType_Erro1

Alias New1608108323
Title: Release Spreadsheet
Definition: 1
NodeLocation: 1232,512,1
NodeSize: 112,16
Original: Release_Spreadsheet

Alias New2144979235
Title: Import from Excel
Definition: 1
NodeLocation: 1232,236,1
NodeSize: 112,16
Original: Import_Data_Tabs1

FormNode New3787043
Title: Apply Index Checks?
Definition: 0
NodeLocation: 1156,188,1
NodeSize: 212,20
NodeColor: 49344,49344,49344
Original: Apply_Index_Checks1

FormNode New1077528867
Title: Apply Data Type Checks?
Definition: 0
NodeLocation: 1156,148,1
NodeSize: 212,20
NodeColor: 49344,49344,49344
Original: Apply_DataType_Chec1

FormNode New540657955
Title: Import Categorial Indexes
Definition: 0
NodeLocation: 1604,148,1
NodeSize: 212,20
Original: Import_Categor_Inde1

FormNode New1614399779
Title: Import Sequential Indexes?
Definition: 0
NodeLocation: 1604,188,1
NodeSize: 212,20
Original: Import_Sequent_Inde1

Alias New272222499
Title: Import from Excel
Definition: 1
NodeLocation: 1696,232,1
NodeSize: 112,16
Original: Import_from_Excel1

FormNode New1345964323
Title: Path to Test File
Definition: 0
NodeLocation: 1604,108,1
NodeSize: 212,20
NodeInfo: 1,,,,,,,72,,,0,,,0,,,,
NodeColor: 49344,49344,49344
Original: Path_to_Global_Data1

FormNode Fo1584253219
Title: Data to Import
Definition: 0
NodeLocation: 1156,108,1
NodeSize: 212,20
NodeColor: 49344,49344,49344
Original: Data_to_Import1

FormNode Fo494782755
Title: Categorical Indexes to Import
Definition: 0
NodeLocation: 260,112,1
NodeSize: 212,20
NodeColor: 49344,49344,49344
Original: Categorical_Indexes_

Alias New1397893411
Title: Release Spreadsheet
Definition: 1
NodeLocation: 1696,272,1
NodeSize: 112,16
Original: Release_Spreadsheet

Close Structural_Settings_

Button Import_from_Excel1
Title: Import from Excel
Description: Press this button to import data from Excel. If selected, this will read the categorical and/or sequential indexes before importing the data tabs.
NodeLocation: 672,60,1
NodeSize: 64,36
Aliases: Alias Al649390371, Alias New272222499
OnClick: Release_Spreadsheet;~
IF Import_Categor_Inde1 THEN Import_Categ_Indexe1 ELSE Null;   {Import categorical indexes if desired}~
IF Import_Sequent_Inde1 THEN Import_Seq_Index1 ELSE Null;   {Import sequential indexes if desired}~
Import_Data_Tabs1;   {Import selected data tabs}~


Button Clear_Imported_Vari1
Title: Clear Imported Variables
Description: Press this button to clear data that had been previously imported. Only the datasets selected in "Data to Import" (Data_to_Import) will be cleared.
NodeLocation: 536,60,1
NodeSize: 64,36
WindState: 2,238,420,720,350
OnClick: FOR J:=@Stored_Vars_Selected DO (~
   MetaVar varHandle:=Slice(Stored_Vars_Selected, J);~
   LocalAlias var:=varHandle;~
   (var:=0);~
)

Text Te702138659
Title: Import Data from Spreadsheets
NodeLocation: 400,192,-1
NodeSize: 376,176
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

Text Te1775880483
Title: Inspect Imported Data
NodeLocation: 400,504,-1
NodeSize: 376,128
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
NodeColor: 65535,65535,65535

FormNode New809093411
Title: Path to Test File
Definition: 0
NodeLocation: 176,128,1
NodeSize: 136,24
NodeInfo: 1,,,,,,,70,,,0,,,0
NodeColor: 49344,49344,49344
Original: Path_to_Global_Data1

FormNode New138004771
Title: Dataset to View
Definition: 0
NodeLocation: 240,436,1
NodeSize: 200,20
NodeInfo: 1,,,,,,0,239,,,,,,0
Original: Dataset_to_View1

FormNode New1211746595
Title: Raw Imported Data
Definition: 1
NodeLocation: 240,476,1
NodeSize: 200,20
NodeInfo: 1,,,,,,0,72,,,,,,0
NodeColor: 65278,37008,6168
Original: Raw_Imported_Data1

FormNode New674875683
Title: Cleaned Import Data
Definition: 1
NodeLocation: 240,516,1
NodeSize: 200,20
NodeInfo: 1,,,,,,0,72,,,,,,0
NodeColor: 65278,37008,6168
Original: Format_Import_Data1

FormNode New1748617507
Title: Check for Index Errors
Definition: 1
NodeLocation: 240,556,1
NodeSize: 200,20
NodeInfo: 1,,,,,,0,72,,,,,,0
NodeColor: 65278,37008,6168
Original: Check_Index_Errors1

FormNode New406440227
Title: Check for Data Type Errors
Definition: 1
NodeLocation: 240,596,1
NodeSize: 200,20
NodeInfo: 1,,,,,,0,72,,,,,,0
NodeColor: 65278,37008,6168
Original: Check_DataType_Erro1

FormNode New1480182051
Title: Apply Index Checks?
Definition: 0
NodeLocation: 176,332,1
NodeSize: 136,20
NodeColor: 49344,49344,49344
Original: Apply_Index_Checks1

FormNode New943311139
Title: Apply Data Type Checks?
Definition: 0
NodeLocation: 176,292,1
NodeSize: 136,20
NodeColor: 49344,49344,49344
Original: Apply_DataType_Chec1

FormNode New2017052963
Title: Last Import Time
Definition: 1
NodeLocation: 456,320,1
NodeSize: 120,16
NodeInfo: 1,,,,,,0,72,,,,,,0
NodeColor: 65278,37008,6168
Original: Last_Import_Time

FormNode New70895907
Title: Import Categorial Indexes
Definition: 0
NodeLocation: 176,172,1
NodeSize: 136,20
Original: Import_Categor_Inde1

FormNode New1144637731
Title: Import Sequential Indexes?
Definition: 0
NodeLocation: 176,212,1
NodeSize: 136,20
Original: Import_Sequent_Inde1

FormNode Fo1124452643
Title: Model
Definition: 0
NodeLocation: 176,88,1
NodeSize: 136,16
NodeColor: 49344,49344,49344
Original: Model_for_Data_Impo1

FormNode Fo1320012067
Title: Data to Import
Definition: 0
NodeLocation: 176,252,1
NodeSize: 136,20
NodeColor: 49344,49344,49344
Original: Data_to_Import1

FormNode Fo1385416995
Title: Model for Data Import
Definition: 0
NodeLocation: 524,128,1
NodeSize: 212,24
NodeInfo: 1,,,,,,,167,,,,,,0
Original: Select_Model_for_Dat

FormNode New194800931
Title: Excel Import Configuration
Definition: 0
NodeLocation: 524,252,1
NodeSize: 212,20
NodeColor: 49344,49344,49344
Original: Excel_Import_Setting

FormNode New1268542755
Title: Categorical Index Import Settings
Definition: 0
NodeLocation: 524,172,2
NodeSize: 212,20
NodeColor: 49344,49344,49344
Original: CatInd_ImportSetting

FormNode New731671843
Title: Sequence Index Import Settings
Definition: 0
NodeLocation: 524,212,1
NodeSize: 212,20
NodeColor: 49344,49344,49344
Original: SeqInd_ImportSettin1

Close Import_Worksheets

