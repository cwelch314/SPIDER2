{ Analytica Model Global_Indexes, encoding="UTF-8" }
SoftwareVersion 6.3.6

{!-60000|Attribute AcpStyles}


LinkModule Global_Indexes
Title: Global Indexes
Author: Cory Welch
Date: Sun, Dec 24, 2017 12:32 PM
DefaultSize: 64,40
NodeSize: 80,56
DiagState: 2,12,0,1454,681,17,10
DiagramColor: 52428,52428,52428
Pict: (000000000000003C003C00048608000089504E470D0A1A0A0000000D494844520000003C0000003C08060000003AFCD972000000017352474200AECE1CE90000000467414D410000B18F0BFC6105000000097048597300000EC300000EC301C76FA8640000080B494441546843E59A4DA85555148085226CE620CA46392A47A183D241848481F026D6E835111D080F1A240DE28DD489BC4181F5885E64F87859993F712DA31B425AE40FA6F4C84A93A417863CCBF0A7C89F907B3ADFBE679DB7CEB9EB9CB3CF3E870636F8DEBB77ED7D7ED65E7BFDECBDEFBC288AFE5798C23B1953D81ABF7FBFA4F7C3076B7BC75EDE0CD1DE670F0D7064CB986BFFE6AD0DD1AF475698F7691153D8085EFAE04B13BDED8FCDF45E5D18D5E1E7F1FBA2DDDB1EB8FE6667D9F4E1AF378E45B76FCE379FD10053589BBF7F5B181D7861B237F1C8154B91DEB64767538B7EB971ABB3766C59BECFEC7EFAF8F8D4835787A6EE8A96EE9897B27EFB3D51EFF5876E44DD919DCC14F3B90198426F6E5E5BE0A664FC62190563EB62E5B229FAD1B9C9B5C39F2C99D64A0A433BE6FFD37D634166D09CE2D7CE2FB2EE55075358493CD5F0B98C45E3CF58AFCA1A3F5E9E5EF2CCC78BCFE4955C7F60C5A1774F6FDD3073F5CC62D7F7F24F8B9D6FC7B3237D0616E719CCA8DC7D7D3185A5C4A3DC7B6FE574C84B7C36B37378D9FBF36F8892439D4533DBBF1B1BFDE3FA6CF1B5F12C728AE7073730C099C242E287E807E3B7BED30CCB89B24FEE5A70056B5AFD0A6140F17F711FFE9F9A1A31FB96600A2DB8B91EE1DEB9EE6AAB5F116F7EBB6933CAAEDCBB70F6C25F33E1BE387B72B99EE62E56D488E6A6700046569425200544CD4D47D74EA2F0E857C33BADF65AE4DC2ADAF75CD7576953A871C1496E4C5A21321BFDAA202A8B85FFBC75C5DD8300B6E7ECC4481AA8EA808271E4BEF4DAFD2E85EDD9F7D451B35F0E5328F47E39B82AA3ACD1C71794141F264AEB488DBC34709530FEE1D2D3EE9E537747AE5A33FA684CA183B420018A691C6859CD910BDD553A4A6BB61C1F99B0AEA962CDA78F1FE7FA4D6FDFDB77B9D848563FC114BA3CFBCE1367DC0D4801B1F266BF0098BE4C6F821803804FF3C2CF7FBEAA6BF52F039790013B3CF9F0459FF73585AE7AE2628F116B8A446F72B2D55E860442E2825BA824292BDABFAE63F58741619CEFD20B2928F2ED2D230AAFE92E3F66B517A1ADFBCAC90DEE3D3301B620930C08D2144405E559C2E9692A5055597DF3F0B2BC74DD29CD0089756FDDBED14F49B86292A38B826C56C0B49011F2B02E3E280FB6E0651808EB5A41A625FFAD760BB9060E9EEF640A206D65AB38CA7C21AFB98E2CE72AAC2B535183822C02009F4446544669AC406A3A71F1D00AAEC5A2949872AD4CCB32B807D7C9356611A303EEAEA10137C976943A95F5AAEA94478A08209F8A42BA0FDFB542555080C8B5F8270350B47C0414CF3F5370BB2C8995F3B5FE5CA7D8FC69A792B04E81208AF042523559D0575B44832B907B511405E94F2C78F18BD51DABBF667C7A74AC4859072B2C315EAE1899EBC48E051DE2E9A03BE4912003F2A255C85416AC3EC87551824BF02CB98678812B7897A1717DED8C970B5EE907A9AADCD68BEAA06154E5A5B084D52714AC2DCA72EF520B7AA05777BA4AEC77609D2B8DF1F24B1AF31011E5A57CADEB0B4B46F1D94CAA09857A22D1099F16B9FB938672A2B35C6020D3191FB6DA9BA28B091DC4429125A44EB1FD4629252BFC9774C3CBB43D9D35F28CBA959789F8311B8089ACDF9004ACAA25A0E456A2A4D5DE06EC7189957121BE3308412E64E8D56F8805AE813D2AE96C20E9A8F67E540D88C2A2B086C1AEEBD76EF38F99CBF23691F51B92CAA42C42832CDA7DAAA22630A0920D1864F94C6AB2FA1791466AD60589ACDF209B6227C647A5C142D6AE28DE388A7A420EE79990AF9BABC8545C89ACDF20E740152525232C0F276F9655596DA17DBAEE3650A1C2BE3E0C45A5A2862073EAD2B1C27CEE0B814AA673C86E67A10FCB2AC96D77260D453095CB9684022FEA5D061A50884856A010099A4D9C62A2B05A35F51B64D11F27EAB473054C2F56492CF4A5DE05EADDA6E527CAE95D4DEE6BF5AB64FFBA8E33A4DAF2717F085679D33741EA622C63B597C10C92E203AA36104A1157E5742291B93F99A5610B47929485A1D6D18B08668BD5C70BBDBE574BC4D2C650F49A192BFB4657FC5694ADB3E5635164C4B94E05EBC750740AF3F565AD70D98E861705EBFBF443266779EE5656A173A8EF892175BA5C135CC23263E5D424575BCC75625B245138E4DCD5425749757C59D25E6894CF9C89E5F6A7331D25AAB9F4148F52A62D001DBC7C2CCC0049F90AC1412B714F2BEB64BEE89D8F368297EC609053AD760DE9870027CA86062D1DAC2C1D325F1C49B276BB1F0DAC4C649697AFF2452C297D01DFB7FAF9901E9417145103027DFAD0C4CA5AE1AA659DF82CA564931A3C63DDF8B3D56740E09013088E1E1B1422BEC1474AD14685064157567D2525B229743B7E12D6C9638187E1D4D962E5A22D1A7D8A11BC138AEB49C08592235E530899D0EEB18AB2A07090406459995425D6F5096C85C8AA082A36314CA1800FA74A079E156B2B5354F09DA9AB170894A1BE85499ECC3BAADDC9224C61063D7A153B2245E8E3CD3CA4AED0E55FE6B763AC793DB28A29CCC04D2491C7B8B5654D9F666AEB9D12A62FDFEBEE51A5F04EDA1014189EE5B0291C800748310E44C11696914130D83A4061D91A06308545687F71515C9DD9FC17B83C2BA927C6EDC1794C638D292CC3456F4959C09E7641926F0D4ADED892E93321B02832859570602E25A8C00BB5AD383F1156F1C341E9D8E0A754A6D01B6BE4A9CEF0F7B39DE1BAD30D9C320424391C1098CADCD3B8A60EA6B02E79DF4AE188831D144A55F6888159C040E11A89CCF9228148BB8A80E24CDF80C1B33085C1B0F04089E4AC2A18D20C3B8D4C69EB390D3085AD10A72D6799C47A9954A221ADD04E4CC0DA05BFA06B0B5378E712CDFB178327EFF1302840F10000000049454E44AE426082)
FontStyle: Arial Narrow,19
FileInfo: 0,LinkModule Global_Indexes,2,2,0,0,Global Indexes Module.ana
AcpStyles: Show_Object:no

Index Sequential_Index_Par
Title: Sequential Index Parameters
Description: Type in the name of the parameter you'd like to use to define the start and/or finish of a sequential index.
Definition: ['Building Stock Start Year','Building Stock End Year']
NodeLocation: 104,152,1
NodeSize: 56,40
WindState: 2,102,83,1156,563
ValueState: 2,632,66,558,303,0,MIDM
DisplayOutputs: Object Object, Object Alias

Variable Simulation_Start_Yr
Title: Simulation Start Year
Definition: Choice(Simulation_Date_Opti,1,0)
NodeLocation: 376,552,1
NodeSize: 56,32
WindState: 2,615,122,720,481
Aliases: FormNode Fo1515381817
NumberFormat: 2,F,4,4,0,0,4,0,$,0,"SHORT",0,,,0,0,15

Variable Simulation_End_Yr
Title: Simulation End Year
Definition: Choice(Simulation_Date_Opti,612,0)
NodeLocation: 512,552,1
NodeSize: 56,32
WindState: 2,98,82,720,464
Aliases: FormNode Fo1515381818
NumberFormat: 2,F,4,4,0,0,4,0,$,0,"SHORT",0,,,0,0,15

Index Simulation_Date_Opti
Att_PrevIndexValue: [1-Jan-2002,1-Feb-2002,1-Mar-2002,1-Apr-2002,1-May-2002,1-Jun-2002,1-Jul-2002,1-Aug-2002,1-Sep-2002,1-Oct-2002,1-Nov-2002,1-Dec-2002,1-Jan-2003,1-Feb-2003,1-Mar-2003,1-Apr-2003,1-May-2003,1-Jun-2003,1-Jul-2003,1-Aug-2003,1-Sep-2003,1-Oct-2003,1-Nov-2003,1-Dec-2003,1-Jan-2004,1-Feb-2004,1-Mar-2004,1-Apr-2004,1-May-2004,1-Jun-2004,1-Jul-2004,1-Aug-2004,1-Sep-2004,1-Oct-2004,1-Nov-2004,1-Dec-2004,1-Jan-2005,1-Feb-2005,1-Mar-2005,1-Apr-2005,1-May-2005,1-Jun-2005,1-Jul-2005,1-Aug-2005,1-Sep-2005,1-Oct-2005,1-Nov-2005,1-Dec-2005,1-Jan-2006,1-Feb-2006,1-Mar-2006,1-Apr-2006,1-May-2006,1-Jun-2006,1-Jul-2006,1-Aug-2006,1-Sep-2006,1-Oct-2006,1-Nov-2006,1-Dec-2006,1-Jan-2007,1-Feb-2007,1-Mar-2007,1-Apr-2007,1-May-2007,1-Jun-2007,1-Jul-2007,1-Aug-2007,1-Sep-2007,1-Oct-2007,1-Nov-2007,1-Dec-2007,1-Jan-2008,1-Feb-2008,1-Mar-2008,1-Apr-2008,1-May-2008,1-Jun-2008,1-Jul-2008,1-Aug-2008,1-Sep-2008,1-Oct-2008,1-Nov-2008,1-Dec-2008,1-Jan-2009,1-Feb-2009,1-Mar-2009,1-Apr-2009,1-May-2009,1-Jun-2009,1-Jul-2009,1-Aug-2009,1-Sep-2009,1-Oct-2009,1-Nov-2009,1-Dec-2009,1-Jan-2010,1-Feb-2010,1-Mar-2010,1-Apr-2010,1-May-2010,1-Jun-2010,1-Jul-2010,1-Aug-2010,1-Sep-2010,1-Oct-2010,1-Nov-2010,1-Dec-2010,1-Jan-2011,1-Feb-2011,1-Mar-2011,1-Apr-2011,1-May-2011,1-Jun-2011,1-Jul-2011,1-Aug-2011,1-Sep-2011,1-Oct-2011,1-Nov-2011,1-Dec-2011,1-Jan-2012,1-Feb-2012,1-Mar-2012,1-Apr-2012,1-May-2012,1-Jun-2012,1-Jul-2012,1-Aug-2012,1-Sep-2012,1-Oct-2012,1-Nov-2012,1-Dec-2012,1-Jan-2013,1-Feb-2013,1-Mar-2013,1-Apr-2013,1-May-2013,1-Jun-2013,1-Jul-2013,1-Aug-2013,1-Sep-2013,1-Oct-2013,1-Nov-2013,1-Dec-2013,1-Jan-2014,1-Feb-2014,1-Mar-2014,1-Apr-2014,1-May-2014,1-Jun-2014,1-Jul-2014,1-Aug-2014,1-Sep-2014,1-Oct-2014,1-Nov-2014,1-Dec-2014,1-Jan-2015,1-Feb-2015,1-Mar-2015,1-Apr-2015,1-May-2015,1-Jun-2015,1-Jul-2015,1-Aug-2015,1-Sep-2015,1-Oct-2015,1-Nov-2015,1-Dec-2015,1-Jan-2016,1-Feb-2016,1-Mar-2016,1-Apr-2016,1-May-2016,1-Jun-2016,1-Jul-2016,1-Aug-2016,1-Sep-2016,1-Oct-2016,1-Nov-2016,1-Dec-2016,1-Jan-2017,1-Feb-2017,1-Mar-2017,1-Apr-2017,1-May-2017,1-Jun-2017,1-Jul-2017,1-Aug-2017,1-Sep-2017,1-Oct-2017,1-Nov-2017,1-Dec-2017,1-Jan-2018,1-Feb-2018,1-Mar-2018,1-Apr-2018,1-May-2018,1-Jun-2018,1-Jul-2018,1-Aug-2018,1-Sep-2018,1-Oct-2018,1-Nov-2018,1-Dec-2018,1-Jan-2019,1-Feb-2019,1-Mar-2019,1-Apr-2019,1-May-2019,1-Jun-2019,1-Jul-2019,1-Aug-2019,1-Sep-2019,1-Oct-2019,1-Nov-2019,1-Dec-2019,1-Jan-2020,1-Feb-2020,1-Mar-2020,1-Apr-2020,1-May-2020,1-Jun-2020,1-Jul-2020,1-Aug-2020,1-Sep-2020,1-Oct-2020,1-Nov-2020,1-Dec-2020,1-Jan-2021,1-Feb-2021,1-Mar-2021,1-Apr-2021,1-May-2021,1-Jun-2021,1-Jul-2021,1-Aug-2021,1-Sep-2021,1-Oct-2021,1-Nov-2021,1-Dec-2021,1-Jan-2022,1-Feb-2022,1-Mar-2022,1-Apr-2022,1-May-2022,1-Jun-2022,1-Jul-2022,1-Aug-2022,1-Sep-2022,1-Oct-2022,1-Nov-2022,1-Dec-2022,1-Jan-2023,1-Feb-2023,1-Mar-2023,1-Apr-2023,1-May-2023,1-Jun-2023,1-Jul-2023,1-Aug-2023,1-Sep-2023,1-Oct-2023,1-Nov-2023,1-Dec-2023,1-Jan-2024,1-Feb-2024,1-Mar-2024,1-Apr-2024,1-May-2024,1-Jun-2024,1-Jul-2024,1-Aug-2024,1-Sep-2024,1-Oct-2024,1-Nov-2024,1-Dec-2024,1-Jan-2025,1-Feb-2025,1-Mar-2025,1-Apr-2025,1-May-2025,1-Jun-2025,1-Jul-2025,1-Aug-2025,1-Sep-2025,1-Oct-2025,1-Nov-2025,1-Dec-2025,1-Jan-2026,1-Feb-2026,1-Mar-2026,1-Apr-2026,1-May-2026,1-Jun-2026,1-Jul-2026,1-Aug-2026,1-Sep-2026,1-Oct-2026,1-Nov-2026,1-Dec-2026,1-Jan-2027,1-Feb-2027,1-Mar-2027,1-Apr-2027,1-May-2027,1-Jun-2027,1-Jul-2027,1-Aug-2027,1-Sep-2027,1-Oct-2027,1-Nov-2027,1-Dec-2027,1-Jan-2028,1-Feb-2028,1-Mar-2028,1-Apr-2028,1-May-2028,1-Jun-2028,1-Jul-2028,1-Aug-2028,1-Sep-2028,1-Oct-2028,1-Nov-2028,1-Dec-2028,1-Jan-2029,1-Feb-2029,1-Mar-2029,1-Apr-2029,1-May-2029,1-Jun-2029,1-Jul-2029,1-Aug-2029,1-Sep-2029,1-Oct-2029,1-Nov-2029,1-Dec-2029,1-Jan-2030,1-Feb-2030,1-Mar-2030,1-Apr-2030,1-May-2030,1-Jun-2030,1-Jul-2030,1-Aug-2030,1-Sep-2030,1-Oct-2030,1-Nov-2030,1-Dec-2030,1-Jan-2031,1-Feb-2031,1-Mar-2031,1-Apr-2031,1-May-2031,1-Jun-2031,1-Jul-2031,1-Aug-2031,1-Sep-2031,1-Oct-2031,1-Nov-2031,1-Dec-2031,1-Jan-2032,1-Feb-2032,1-Mar-2032,1-Apr-2032,1-May-2032,1-Jun-2032,1-Jul-2032,1-Aug-2032,1-Sep-2032,1-Oct-2032,1-Nov-2032,1-Dec-2032,1-Jan-2033,1-Feb-2033,1-Mar-2033,1-Apr-2033,1-May-2033,1-Jun-2033,1-Jul-2033,1-Aug-2033,1-Sep-2033,1-Oct-2033,1-Nov-2033,1-Dec-2033,1-Jan-2034,1-Feb-2034,1-Mar-2034,1-Apr-2034,1-May-2034,1-Jun-2034,1-Jul-2034,1-Aug-2034,1-Sep-2034,1-Oct-2034,1-Nov-2034,1-Dec-2034,1-Jan-2035,1-Feb-2035,1-Mar-2035,1-Apr-2035,1-May-2035,1-Jun-2035,1-Jul-2035,1-Aug-2035,1-Sep-2035,1-Oct-2035,1-Nov-2035,1-Dec-2035,1-Jan-2036,1-Feb-2036,1-Mar-2036,1-Apr-2036,1-May-2036,1-Jun-2036,1-Jul-2036,1-Aug-2036,1-Sep-2036,1-Oct-2036,1-Nov-2036,1-Dec-2036,1-Jan-2037,1-Feb-2037,1-Mar-2037,1-Apr-2037,1-May-2037,1-Jun-2037,1-Jul-2037,1-Aug-2037,1-Sep-2037,1-Oct-2037,1-Nov-2037,1-Dec-2037,1-Jan-2038,1-Feb-2038,1-Mar-2038,1-Apr-2038,1-May-2038,1-Jun-2038,1-Jul-2038,1-Aug-2038,1-Sep-2038,1-Oct-2038,1-Nov-2038,1-Dec-2038,1-Jan-2039,1-Feb-2039,1-Mar-2039,1-Apr-2039,1-May-2039,1-Jun-2039,1-Jul-2039,1-Aug-2039,1-Sep-2039,1-Oct-2039,1-Nov-2039,1-Dec-2039,1-Jan-2040,1-Feb-2040,1-Mar-2040,1-Apr-2040,1-May-2040,1-Jun-2040,1-Jul-2040,1-Aug-2040,1-Sep-2040,1-Oct-2040,1-Nov-2040,1-Dec-2040,1-Jan-2041,1-Feb-2041,1-Mar-2041,1-Apr-2041,1-May-2041,1-Jun-2041,1-Jul-2041,1-Aug-2041,1-Sep-2041,1-Oct-2041,1-Nov-2041,1-Dec-2041,1-Jan-2042,1-Feb-2042,1-Mar-2042,1-Apr-2042,1-May-2042,1-Jun-2042,1-Jul-2042,1-Aug-2042,1-Sep-2042,1-Oct-2042,1-Nov-2042,1-Dec-2042,1-Jan-2043,1-Feb-2043,1-Mar-2043,1-Apr-2043,1-May-2043,1-Jun-2043,1-Jul-2043,1-Aug-2043,1-Sep-2043,1-Oct-2043,1-Nov-2043,1-Dec-2043,1-Jan-2044,1-Feb-2044,1-Mar-2044,1-Apr-2044,1-May-2044,1-Jun-2044,1-Jul-2044,1-Aug-2044,1-Sep-2044,1-Oct-2044,1-Nov-2044,1-Dec-2044,1-Jan-2045,1-Feb-2045,1-Mar-2045,1-Apr-2045,1-May-2045,1-Jun-2045,1-Jul-2045,1-Aug-2045,1-Sep-2045,1-Oct-2045,1-Nov-2045,1-Dec-2045,1-Jan-2046,1-Feb-2046,1-Mar-2046,1-Apr-2046,1-May-2046,1-Jun-2046,1-Jul-2046,1-Aug-2046,1-Sep-2046,1-Oct-2046,1-Nov-2046,1-Dec-2046,1-Jan-2047,1-Feb-2047,1-Mar-2047,1-Apr-2047,1-May-2047,1-Jun-2047,1-Jul-2047,1-Aug-2047,1-Sep-2047,1-Oct-2047,1-Nov-2047,1-Dec-2047,1-Jan-2048,1-Feb-2048,1-Mar-2048,1-Apr-2048,1-May-2048,1-Jun-2048,1-Jul-2048,1-Aug-2048,1-Sep-2048,1-Oct-2048,1-Nov-2048,1-Dec-2048,1-Jan-2049,1-Feb-2049,1-Mar-2049,1-Apr-2049,1-May-2049,1-Jun-2049,1-Jul-2049,1-Aug-2049,1-Sep-2049,1-Oct-2049,1-Nov-2049,1-Dec-2049,1-Jan-2050,1-Feb-2050,1-Mar-2050,1-Apr-2050,1-May-2050,1-Jun-2050,1-Jul-2050,1-Aug-2050,1-Sep-2050,1-Oct-2050,1-Nov-2050,1-Dec-2050,1-Jan-2051,1-Feb-2051,1-Mar-2051,1-Apr-2051,1-May-2051,1-Jun-2051,1-Jul-2051,1-Aug-2051,1-Sep-2051,1-Oct-2051,1-Nov-2051,1-Dec-2051,1-Jan-2052,1-Feb-2052,1-Mar-2052,1-Apr-2052,1-May-2052,1-Jun-2052,1-Jul-2052,1-Aug-2052,1-Sep-2052,1-Oct-2052,1-Nov-2052,1-Dec-2052]
Title: Simulation Date Options
Description: Note: ~
Need to separate this from the solar PV database import
Definition: Local start:= MakeDate(Bldg_Stock_Start_Yea,1,1);~
Local end:= MakeDate(Bldg_Stock_End_year,12,1);~
Sequence(start,end,step:Timestep_Months[Timestep_Options=dT_choice], dateUnit:'M')
NodeLocation: 624,56,1
NodeSize: 64,32
ValueState: 2,402,230,376,453,,MIDM
NumberFormat: 2,F,4,4,0,0,4,0,$,0,"M/yyyy",0,,,0,0,15

Alias Al1515102194
Title: Time
Definition: 1
NodeLocation: 992,56,1
NodeSize: 64,40
NodeInfo: 1,1,1,1,1,1,0,0,0,0,,0,1,0
Original: Time

Variable dT
Title: dT
Units: Years/period
Description: Timestep in numerical terms.
Definition: Timestep_Months[Timestep_Options=dT_choice] / 12
NodeLocation: 800,344,1
NodeSize: 64,40

Index Timestep_Options
Att_PrevIndexValue: ['Month','Quarter','Biannual','Annual']
Title: Timestep Options
Definition: ['Month','Quarter','Biannual','Annual']
NodeLocation: 656,152,1
NodeSize: 56,32

Decision dT_choice
Title: dT Choice
Description: Select the timestep to be used in the model.
Definition: Choice(Timestep_Options,1,0)
NodeLocation: 800,152,1
NodeSize: 56,32
WindState: 2,1143,376,720,350
Aliases: FormNode Fo1515252588

Variable Timestep_Months
Title: Timestep Months
Units: Months
Description: Translates the timestep from 'Y,' 'M,' or 'q,' to a numerical value in months.
Definition: Table(Timestep_Options)(1,3,6,12)
NodeLocation: 648,344,1
NodeSize: 64,40
ValueState: 2,36,42,416,303,0,MIDM

FormNode Fo1515252588
Title: dT
Definition: 0
NodeLocation: 796,192,1
NodeSize: 116,16
NodeInfo: 1,0,0,0,0,0,0,174,0,,0,,,0
Original: dT_choice

FormNode Fo1515381817
Title: Simulation Start Year
Definition: 0
NodeLocation: 484,600,1
NodeSize: 180,16
NodeInfo: 1,,,,,,0,166,,,,,,0
Original: Simulation_Start_Yr

FormNode Fo1515381818
Title: Simulation End Year
Definition: 0
NodeLocation: 484,640,1
NodeSize: 180,16
NodeInfo: 1,,,,,,0,166,,,,,,0
Original: Simulation_End_Yr

Variable Time_Year_Map
Title: Time Year Map
Definition: DatePart(Time,'Y')
NodeLocation: 992,232,1
NodeSize: 64,40
ValueState: 2,522,149,250,520,0,MIDM

Index Time_Annually
Title: Time - Annually
Definition: Unique(Time_Year_Map)
NodeLocation: 992,320,1
NodeSize: 64,40
ValueState: 2,472,208,416,569,0,MIDM
Att_GraphIndexRange: 1,0

Variable Spatial_IDs_with_PV_
Title: Spatial IDs with PV Data
Description: Returns a value of 1.0 if the spatial ID contains data in the dataset, or null otherwise
Definition: var x:=All_Spatial_ID[Stored_ID_Interconn=All_Spatial_ID];~
If x=null then null ELSE 1
NodeLocation: 232,568,1
NodeSize: 64,40
ValueState: 2,802,51,344,577,,MIDM
Att__TotalsIndex: []

Index All_Spatial_ID
Att_PrevIndexValue: ['Statewide','All_Utility','All']
Title: All Spatial ID
Description: This list is a superset of all possible spatial IDs to be considered in this analysis (e.g., if only analyzing a single utility, it should be the comprehensive list of spatial IDs for that utility. If analyzing multiple utilities, it should be the superset of all spatial IDs across all of those utilities).
Definition: Concat(Aggregate_Spatial_ID,Spatial_ID)
NodeLocation: 232,64,1
NodeSize: 64,40
WindState: 2,412,69,902,569
ValueState: 2,1275,23,429,412,0,MIDM
NumberFormat: 2,F,4,4,0,0,4,0,$,0,"MMM-yyyy",0,,,0,0,15
DisplayOutputs: Object Object, Object Function, Object Variable, Object Decision, Function Sequential_Opt_PV0, Function Aggregate_Optimizati, Function Set_Start_Coeff_PV0, Function Sequential_Opt_PV2, Function OG_Sequential_Optimi
{!40300|Att_SlicerPopupSize: 693,784}

Index Spatial_ID_of_Utilit
Title: Spatial ID of Utilities Selected
Description: The index of spatial IDs resulting from the user selecting which utilities it wishes to analyze
Definition: var x:= Spatial_ID_Applicabl[All_Utilities=Selected_Utility];{slices out only those utilities selected to be analyzed by the user input}~
var y:=MAX(x,Selected_Utility); {will return a value of 1 if a spatial ID value is 1 for ANY utility selected. Will return a value  of 1 for all spatial IDs if all utilities are selected -- temporary solution until a more robus calculation or input data for other utilities' applicable ZIP codes can be developed}~
var z:= IF sum(Select_Utility,All_Utilities)=size(All_Utilities) THEN (All_Spatial_ID=All_Spatial_ID) ELSE y ;~
subset(z)  {returns an index of only spatial IDs corresponding with the subset of utilities selected by the user}~

NodeLocation: 520,704,1
NodeSize: 56,40
WindState: 2,296,109,720,350
ValueState: 2,927,18,622,543,0,MIDM
NodeColor: 65535,1,1
ReformVal: [Selected_Utility,All_Spatial_ID]
Att__TotalsIndex: [All_Spatial_ID]
{!40300|Att_SlicerPopupSize: 402,1001}

Module Labels2
Title: Labels
Author: Cory Welch
Date: Fri, Jun 22, 2018 10:48 AM
NodeLocation: 448,352,1
NodeSize: 56,32
DiagState: 2,718,246,780,564,17

Close Labels2

Index DER
Att_PrevIndexValue: ['Solar PV','Electric Vehicles','Battery Storage','Energy Efficiency','Demand Response']
Title: DER
Description: An index of each of the DER types in the model
Definition: ['Solar PV','Electric Vehicles','Battery Storage','Energy Efficiency','Demand Response']
NodeLocation: 640,240,1
NodeSize: 56,32

Variable Total_Spatial_IDs
Title: Total Spatial IDs
Definition: size(All_Spatial_ID)
NodeLocation: 232,480,1
NodeSize: 64,40

Decision Select_Utility
Title: Select Utility
Description: Select which utilities you want to include in the model simulation.~
~
Old: Table(All_Utilities)(Checkbox(1))
Definition: Table(All_Utilities)(Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1))
NodeLocation: 368,712,1
NodeSize: 56,32
DefnState: 2,1215,270,232,190,,DFNM
Aliases: FormNode Fo1524781762
TableCellDefault: Checkbox(1)

FormNode Fo1524781762
Title: Select Utility
Definition: 0
NodeLocation: 96,580,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Select_Utility

Module Conversion_Factors
Title: Conversion Factors
Author: JamesMilford
Date: Tue, Aug 28, 2018 10:10 AM
NodeLocation: 752,464,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,0,0,955,606,17,10

Constant MW_per_kW
Title: MW per kW
Units: MW/kW
Description: The MW per kW.
Definition: .001
NodeLocation: 104,56,1
NodeSize: 64,40
NumberFormat: 2,F,2,4,0,0,2,0,$,0,"ABBREV",0,,,0,0,15

Constant kW_per_MW
Title: kW per MW
Units: kW/MW
Description: The kW per MW.
Definition: 1000
NodeLocation: 104,144,1
NodeSize: 64,40

Constant Months_per_Year
Title: Months per Year
Units: months/year
Description: The number of months per year.
Definition: 12
NodeLocation: 104,232,1
NodeSize: 64,40

Constant Hours_per_Year
Title: Hours per Year
Units: hours/year
Description: The number of hours per year, when considering leap years
Definition: 365.25 * 24
NodeLocation: 104,320,1
NodeSize: 64,40

Constant Days_Per_Month
Title: Days Per Month
Units: days
Description: The number of day in each month. February accounts for leap years occurring every 4 years.
Definition: Table(Month)(31,28.25,31,30,31,30,31,31,30,31,30,31)
NodeLocation: 264,56,1
NodeSize: 64,40
ValueState: 2,248,250,416,303,0,MIDM

Variable Weeks_Per_Month
Title: Weeks Per Month
Units: weeks/month
Description: The average number of weeks per month, which includes months in leap years.
Definition: Days_Per_Month / 7
NodeLocation: 416,56,1
NodeSize: 64,40
WindState: 2,378,419,720,350
ValueState: 2,136,138,1172,420,0,MIDM
ReformVal: [Month,Undefined]

Constant Avg_Days_per_Month
Title: Average Days per Month
Units: days/month
Description: The average number of days per month, which includes months in leap years.
Definition: 30.4375   {=365.25/12}
NodeLocation: 264,144,1
NodeSize: 64,40

Constant GW_per_kW
Title: GW per kW
Units: GW/kW
Description: The GW per kW.
Definition: 10^-6
NodeLocation: 264,320,1
NodeSize: 64,40
WindState: 2,338,40,720,350

Constant kW_per_W
Title: kW per W
Units: kW/W
Description: The kW per W.
Definition: 10^-3
NodeLocation: 104,408,1
NodeSize: 64,40
NumberFormat: 2,F,2,6,0,0,2,0,$,0,"ABBREV",0,,,0,0,15,

Constant DaysPerWeek_DayType
Title: Days Per Week by Day Type
Units: days/week
Description: The days per week by weekday/weekend.
Definition: Table(Weekday_or_Weekend)(5,2)
NodeLocation: 264,232,1
NodeSize: 64,40
ValueState: 2,449,7,571,549,0,MIDM

Variable DaysPerMonth_DayType
Title: Days Per Month by Day Type
Units: days/month
Description: The average number of weekdays and weekends per month, including months in leap years.
Definition: DaysPerWeek_DayType * DaysPerMonth_WeekDay
NodeLocation: 416,232,1
NodeSize: 64,40
ValueState: 2,548,60,1190,770,0,MIDM
Att__TotalsIndex: [Weekday_or_Weekend]

Variable DaysPerMonth_WeekDay
Title: Days Per Month by Week Day
Units: days/month
Description: The average number of days per month that a given day of the week occurs.
Definition: Days_Per_Month / 7
NodeLocation: 416,144,1
NodeSize: 64,40
ValueState: 2,634,143,915,524,0,MIDM
Att__TotalsIndex: [Day_of_Week]

Constant Hours_per_Week
Title: Hours per Week
Units: hours/week
Description: The number of hours per week.
Definition: 168
NodeLocation: 264,408,1
NodeSize: 64,40

Constant Hours_per_Day
Title: Hours per Day
Units: hours/day
Description: The number of hours per day.
Definition: 24
NodeLocation: 264,496,1
NodeSize: 64,40

Constant W_per_kW
Title: W per kW
Units: W/kW
Description: The W per kW.
Definition: 1000
NodeLocation: 104,496,1
NodeSize: 64,40

Close Conversion_Factors

Decision Aggregation_1_Label
Title: Aggregation 1 Label
Description: Select the timestep to be used in the model.
Definition: Choice(All_Spatial_ID,1,0)
NodeLocation: 232,256,1
NodeSize: 64,40
WindState: 2,542,374,720,350
Aliases: FormNode Fo1535656744

FormNode Fo1535656744
Title: dT
Definition: 0
NodeLocation: 244,304,1
NodeSize: 76,16
NodeInfo: 1,0,0,0,0,0,0,118,0,,0,,,0
Original: Aggregation_1_Label

Decision Aggregation_2_Label
Title: Aggregation 2 Label
Description: Select the timestep to be used in the model.
Definition: Choice(All_Spatial_ID,2,0)
NodeLocation: 232,368,1
NodeSize: 64,40
WindState: 2,542,374,720,350
Aliases: FormNode Fo1535656789
DisplayOutputs: Object Object, Object Function, Function MultiStage_CalibrPV0

FormNode Fo1535656789
Title: dT
Definition: 0
NodeLocation: 244,416,1
NodeSize: 76,16
NodeInfo: 1,0,0,0,0,0,0,118,0,,0,,,0
Original: Aggregation_2_Label

Module Old_Stuff
Title: Old Stuff
Author: JamesMilford
Date: Mon, Sep 24, 2018 11:54 AM
NodeLocation: 760,584,1
NodeSize: 64,40

Index Database_Rows
Title: Database Rows
Definition: dbQuery(db_Connection, "Select * FROM " & Table_to_Import;)
NodeLocation: 112,248,1
NodeSize: 56,32
DefnState: 2,624,339,416,303,,DFNM
ReformDef: [0,0]

Index Database_Cols
Att_PrevIndexValue: ['Application Id','Matched CSI Application Number','Application Status','Utility','Service City','Service Zip','Service County','Technology Type','System Size DC','System Size AC','Tilt','Azimuth','Mounting Method','Tracking','Customer Sector','App Received Date','App Complete Date','App Approved Date','Self Installer','Installer Name','Installer Phone','Installer City','Installer State','Installer Zip','CSLB Number','Third Party Owned','Third Party Owned Type','Third Party Name','Pace Financed','Pace Financier','Electric Vehicle','Electric Vehicle Count','System Output Monitoring','System Output Reports To Vendor?','System Output Monitoring Provider','Total System Cost','Itc Cost Basis','Previous Application','Previous Application Ids','NEM Tariff','VNEM','Project is VNEM','Module Model 1','Module Manufacturer 1','Module Quantity 1','Module Model 2','Module Manufacturer 2','Module Quantity 2','Module Model 3','Module Manufacturer 3','Module Quantity 3','Module Model 4','Module Manufacturer 4','Module Quantity 4','Module Model 5','Module Manufacturer 5','Module Quantity 5','Module Model 6','Module Manufacturer 6','Module Quantity 6','Module Model 7','Module Manufacturer 7','Module Quantity 7','Module Model 8','Module Manufacturer 8','Module Quantity 8','Module Model 9','Module Manufacturer 9','Module Quantity 9','Module Model 10','Module Manufacturer 10','Module Quantity 10','Inverter Model 1','Inverter Manufacturer 1','Inverter Quantity 1','Inverter Model 2','Inverter Manufacturer 2','Inverter Quantity 2','Inverter Model 3','Inverter Manufacturer 3','Inverter Quantity 3','Inverter Model 4','Inverter Manufacturer 4','Inverter Quantity 4','Inverter Model 5','Inverter Manufacturer 5','Inverter Quantity 5','Inverter Model 6','Inverter Manufacturer 6','Inverter Quantity 6','Inverter Model 7','Inverter Manufacturer 7','Inverter Quantity 7','Inverter Model 8','Inverter Manufacturer 8','Inverter Quantity 8','Inverter Model 9','Inverter Manufacturer 9','Inverter Quantity 9','Inverter Model 10','Inverter Manufacturer 10','Inverter Quantity 10','Inverter Model 11','Inverter Manufacturer 11','Inverter Quantity 11','Inverter Model 12','Inverter Manufacturer 12','Inverter Quantity 12','Inverter Model 13','Inverter Manufacturer 13','Inverter Quantity 13','Inverter Model 14','Inverter Manufacturer 14','Inverter Quantity 14','Field115','Field116']
Title: Database Cols
Definition: dbLabels(Database_Rows)
NodeLocation: 232,248,1
NodeSize: 56,32
ValueState: 2,184,186,758,422,,MIDM

Decision Select_Fields
Title: Select Fields
Description: Identifies which specific fields of the full interconnection database will actually be imported, since only a few fields are necessary for this model.
Definition: Table(Database_Cols)(Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(1),Checkbox(0),Checkbox(1),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(1),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(1),Checkbox(0),Checkbox(0),Checkbox(1),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0))
NodeLocation: 600,248,1
NodeSize: 56,32
DefnState: 2,990,69,474,568,,DFNM
ValueState: 2,627,176,312,482,,MIDM
Aliases: FormNode Fo1518114496
TableCellDefault: Checkbox(0)

Index Fields_Selected
Title: Fields Selected
Description: Choose this from a superset? Make user select which fields align with the chosen field?
Definition: Subset(Sel_Interconn_Fields)
NodeLocation: 744,144,1
NodeSize: 64,40
WindState: 2,775,130,720,350

Index Database_Drivers
Att_PrevIndexValue: ['SQL Server']
Title: Database Drivers
Definition: SqlDriverInfo()
NodeLocation: 120,432,1
NodeSize: 56,32
ValueState: 2,152,154,598,270,,MIDM

Constant Table_to_Import
Title: Table to Import
Description: Input the name of the database table to be imported. For an Access database, no dbo. prefix is needed. 
Definition: 'NEM_CurrentlyInterconnectedDataset'
NodeLocation: 256,432,1
NodeSize: 56,32

Constant Filename
Title: Filename
Description: Filename of the PV Interconnection Database, appended with *.accdb to designate it as an Access file. This is only the filename, not the full path. It assumes the file is located in the same folder as the model.
Definition: 'C:\Users\JamesMilford\OneDrive - Lumidyne Consulting LLC\Documents\SDGE_2018_SPIDER\FullDatabase_2017_12_31.accdb'
NodeLocation: 392,352,1
NodeSize: 56,32
ValueState: 2,536,538,722,303,,MIDM
Aliases: FormNode Fo1515167607

Variable db_Connection
Title: db Connection
Description: Calculates the connection string required as an input into the various dB functions.
Definition: {"Driver="&dB_Driver_Selected&"; Readonly=0; DBQ="& Full_dB_Path}~
{Fu1()}
NodeLocation: 536,432,1
NodeSize: 56,32
ValueState: 2,12,275,1591,303,,MIDM
{!50000|Att_ColumnWidths: [1338]}

Decision dB_Driver_Selected
Title: dB Driver Selected
Definition: Choice(Database_Drivers,2,0)
NodeLocation: 392,432,1
NodeSize: 56,32
Aliases: FormNode Fo1533481914

Variable Raw_Data
Title: Raw Data
Definition: dbTable(Database_Rows,Database_Cols)
NodeLocation: 128,352,1
NodeSize: 56,32
ValueState: 2,299,88,1084,707,,MIDM
ReformVal: [Database_Cols,Database_Rows]

Variable Filtered_Raw_Data
Title: Filtered Raw Data
Description: Includes only a subset of the total interconnection database, filtering to include only fields relevant for this model.
Definition: Raw_Data[Database_Cols=Fields_Selected,Database_Rows=Records]
NodeLocation: 264,352,1
NodeSize: 56,32
ValueState: 2,168,170,824,506,,MIDM
ReformVal: [Fields_Selected,Database_Rows]

Index Records
Title: Records
Description: Index of all database records including actual system installations. For the CA DGStats database, the last imported record is only a timestamp, and not an actual system installation. So, here we delete that row. 
Definition: VAR x:=Database_Rows<>size(Database_Rows); {assigns a value of zero to the last database row, and a value of 1 to all others}~
subset(x)  {creates an subset of the database_rows index containing only those values of x that equal 1}
NodeLocation: 472,248,1
NodeSize: 56,32

Button Store_Data1
Title: Store Data
NodeLocation: 400,232,1
NodeSize: 56,32
NodeColor: 65535,52427,52427
Script: (db_Fields:=copyindex(Fields_Selected));~
(db_Records:=copyindex(Records));~
(Interconnect_Data:=Filtered_Raw_Data[Fields_Selected=db_Fields,Records=db_Records])

FormNode Fo1515167607
Title: Database Path
Definition: 0
NodeLocation: 356,132,1
NodeSize: 308,20
NodeInfo: 1,,,,,,0,438,,,,,,0
Original: Filename

FormNode Fo1518114496
Title: Select Fields
Definition: 0
NodeLocation: 608,288,1
NodeSize: 56,16
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Select_Fields

Text Te1533481354
Title: Notes:
Description: 1. Need to have Access dB driver installed for this to work. <a href="https://www.microsoft.com/en-us/download/details.aspx?id=54920">Download Driver</a>~
2. Make top level user interface with only inputs & scripts
NodeLocation: 352,64,-1
NodeSize: 304,40
NodeColor: 65535,65535,65535

FormNode Fo1533481914
Title: dB Driver Selected
Definition: 0
NodeLocation: 356,168,1
NodeSize: 308,16
NodeInfo: 1,,,,,,0,436,,,,,,0
Original: dB_Driver_Selected

Variable Full_dB_Path
Title: Full dB Path
Definition: {CurrentModelFolder() &} Filename
NodeLocation: 536,352,1
NodeSize: 56,32
ValueState: 2,109,328,1299,218,,MIDM
{!50000|Att_ColumnWidths: [1152]}

Function Create_ODBC_Table1(connectionStr, path; sqlStr; tabName: Text )
Title: Create ODBC Table
Definition: VAR newConnectStr:=Driver_Info1 & PV_Interconnect_CSV_;~
VAR newSQLstr:=SQL_String1 & Interconnect_Tab_Nam & "$]";~
INDEX rows:=DBQuery(newConnectStr, newSQLstr);~
INDEX cols:=DBLabels(rows);~
DBTable(rows, cols)
NodeLocation: 744,232,1
NodeSize: 64,40
WindState: 2,491,164,720,350

Function Fu1()
Definition: "Driver="&dB_Driver_Selected&";DBQ="& Full_dB_Path
NodeLocation: 648,432,1
NodeSize: 56,32

Index All_PV_Records
Title: All PV Records
Definition: ['Empty']
NodeLocation: 752,64,1
NodeSize: 64,32

Close Old_Stuff

Module Cell_Fill_Examples
Title: Cell Fill Examples
Author: JamesMilford
Date: Thu, Oct 4, 2018 8:27 AM
NodeLocation: 768,672,1
NodeSize: 64,40
DiagState: 2,0,0,944,480,17,10

Index Cell_Colors
Att_PrevIndexValue: ['AliceBlue','AntiqueWhite','Aqua','Aquamarine','Azure','Beige','Bisque','Black','BlanchedAlmond','Blue','BlueViolet','Brown','BurlyWood','CadetBlue','Chartreuse','Chocolate','Coral','CornflowerBlue','Cornsilk','Crimson','Cyan','DarkBlue','DarkCyan','DarkGoldenrod','DarkGray','DarkGreen','DarkKhaki','DarkMagenta','DarkOliveGreen','DarkOrange','DarkOrchid','DarkRed','DarkSalmon','DarkSeaGreen','DarkSlateBlue','DarkSlateGray','DarkTurquoise','DarkViolet','DeepPink','DeepSkyBlue','DimGray','DodgerBlue','Firebrick','FloralWhite','ForestGreen','Fuchsia','Gainsboro','GhostWhite','Gold','Goldenrod','Gray','Green','GreenYellow','Honeydew','HotPink','IndianRed','Indigo','Ivory','Khaki','Lavender','LavenderBlush','LawnGreen','LemonChiffon','LightBlue','LightCoral','LightCyan','LightGray','LightGreen','LightPink','LightSalmon','LightSeaGreen','LightSkyBlue','LightSlateGray','LightSteelBlue','LightYellow','Lime','LimeGreen','Linen','Magenta','Maroon','MediumAquamarine','MediumBlue','MediumOrchid','MediumPurple','MediumSeaGreen','MediumSlateBlue','MediumSpringGreen','MediumTurquoise','MediumVioletRed','MidnightBlue','MintCream','MistyRose','Moccasin','NavajoWhite','Navy','OldLace','Olive','OliveDrab','Orange','OrangeRed','Orchid','PaleGoldenrod','PaleGreen','PaleTurquoise','PaleVioletRed','PapayaWhip','PeachPuff','PeaGreen','Peru','Pink','Plum','PowderBlue','Purple','Red','RedPeach','RosyBrown','RoyalBlue','SaddleBrown','Salmon','SandyBrown','SeaGreen','SeaShell','Sienna','Silver','SkyBlue','SlateBlue','SlateGray','SmoothBlue','Snow','SpringGreen','SteelBlue','Tan','Teal','Thistle','Tomato','Turquoise','Violet','Wheat','White','WhiteSmoke','Yellow','YellowGreen']
Title: Cell Colors
Definition: ['AliceBlue','AntiqueWhite','Aqua','Aquamarine','Azure','Beige','Bisque','Black','BlanchedAlmond','Blue','BlueViolet','Brown','BurlyWood','CadetBlue','Chartreuse','Chocolate','Coral','CornflowerBlue','Cornsilk','Crimson','Cyan','DarkBlue','DarkCyan','DarkGoldenrod','DarkGray','DarkGreen','DarkKhaki','DarkMagenta','DarkOliveGreen','DarkOrange','DarkOrchid','DarkRed','DarkSalmon','DarkSeaGreen','DarkSlateBlue','DarkSlateGray','DarkTurquoise','DarkViolet','DeepPink','DeepSkyBlue','DimGray','DodgerBlue','Firebrick','FloralWhite','ForestGreen','Fuchsia','Gainsboro','GhostWhite','Gold','Goldenrod','Gray','Green','GreenYellow','Honeydew','HotPink','IndianRed','Indigo','Ivory','Khaki','Lavender','LavenderBlush','LawnGreen','LemonChiffon','LightBlue','LightCoral','LightCyan','LightGray','LightGreen','LightPink','LightSalmon','LightSeaGreen','LightSkyBlue','LightSlateGray','LightSteelBlue','LightYellow','Lime','LimeGreen','Linen','Magenta','Maroon','MediumAquamarine','MediumBlue','MediumOrchid','MediumPurple','MediumSeaGreen','MediumSlateBlue','MediumSpringGreen','MediumTurquoise','MediumVioletRed','MidnightBlue','MintCream','MistyRose','Moccasin','NavajoWhite','Navy','OldLace','Olive','OliveDrab','Orange','OrangeRed','Orchid','PaleGoldenrod','PaleGreen','PaleTurquoise','PaleVioletRed','PapayaWhip','PeachPuff','PeaGreen','Peru','Pink','Plum','PowderBlue','Purple','Red','RedPeach','RosyBrown','RoyalBlue','SaddleBrown','Salmon','SandyBrown','SeaGreen','SeaShell','Sienna','Silver','SkyBlue','SlateBlue','SlateGray','SmoothBlue','Snow','SpringGreen','SteelBlue','Tan','Teal','Thistle','Tomato','Turquoise','Violet','Wheat','White','WhiteSmoke','Yellow','YellowGreen']
NodeLocation: 128,96,1
NodeSize: 64,40

Variable Cell_Colors_by_Name
Title: Cell Colors by Name
Definition: Table(Cell_Colors)(Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null)
NodeLocation: 272,96,1
NodeSize: 64,40
DefnState: 2,328,53,416,580,,DFNM
ValueState: 2,730,30,421,822,0,MIDM
TableCellDefault: Null
{!40700|CellFormatExpression: CellFill(color: Cell_Colors)}

Variable Cell_Expr_for_1_Colo
Title: Cell Expr for 1 Color Gradient
Definition: VAR minim:=MIN(Self, Month, Time_of_Day);~
VAR range:=MAX(Self, Month, Time_of_Day) - minim;~
VAR delta:=Self - minim;~
CellFill('Green', .8 -  .7*Divide(delta, range))
NodeLocation: 272,184,1
NodeSize: 64,40

Close Cell_Fill_Examples

Decision All_Label
Title: All Label
Definition: 'All'
NodeLocation: 88,696,1
NodeSize: 64,40
Aliases: FormNode Fo1533777359

FormNode Fo1533777359
Title: Period Label
Definition: 0
NodeLocation: 88,640,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,
Original: All_Label

Variable All_Agg_Spatial_IDs
Title: All Aggreg Spatial IDs
Description: Select the spatial ID's that represent aggregate values. This will be used to determine IDs that are not aggregated.
Definition: Table(All_Spatial_ID)(1,1,Checkbox(0))
NodeLocation: 232,152,1
NodeSize: 64,40
WindState: 2,0,-8,720,840
DefnState: 2,634,94,653,373,0,DFNM
ValueState: 2,1036,202,416,303,0,MIDM
Aliases: Alias Al1550775285, FormNode Fo1550775287
DisplayOutputs: Object Object, Object Decision
TableCellDefault: Checkbox(0)

Variable Time_EOP_Map
Title: Time EOP Map
Description: A mapping of end of period dates to the time index (which is expressed in beginning of period dates). 
Definition: VAR months:=DatePart(Time, 'M');~
VAR years:=DatePart(Time, 'Y');~
VAR days:=Floor(Days_Per_Month[@Month=months]);~
~
MakeDate(years, months, days)
NodeLocation: 992,144,1
NodeSize: 64,40
WindState: 2,1048,29,720,350
ValueState: 2,238,1,623,703,0,MIDM

Variable Equal_Prd_Time_Map
Att_PrevIndexValue: ['1920 x 1080','1600 x 900','1366 x 768','1280 x 1024','1280 x 800','1024 x 768','2400 x 1200','Custom']
Title: Equal Period Time Map
Description: Used to interpolate annual values to periodic values (eg, monthly, quarterly, biannually), while ensuring that periods are equal in sizes (eg, we don't want months to range between 28-31 days because it creates unsmooth flows).
Definition: INDEX yearsPlus:=(MIN(Time_Annually)-1)..MAX(Time_Annually);~
VAR annualTimeCnt:=@yearsPlus;~
VAR periodicTimeCnt:=1 + @Time * dT;~
VAR timeEOP:=MakeDate(yearsPlus, 12, 31);~
~
LinearInterp(annualTimeCnt, timeEOP, periodicTimeCnt, yearsPlus);~

NodeLocation: 992,408,1
NodeSize: 64,40
WindState: 2,5,123,916,563
ValueState: 2,443,0,899,909,0,MIDM

Text Te1544881292
Title: We should make theses aggregate node names more generic
NodeLocation: 88,328,-1
NodeSize: 72,88
NodeColor: 65535,65535,65535

Index Stock_Source
Att_PrevIndexValue: ['New Stock','Existing Stock','Demolished Stock','Total Stock']
Title: Stock Source
Definition: ['New Stock','Existing Stock','Demolished Stock','Total Stock']
NodeLocation: 512,240,1
NodeSize: 64,40

Index Spatial_ID
Att_PrevIndexValue: ['All']
Title: Spatial ID
Description: IMPORT THIS~
~
This index represents all spatial IDs excluding the "aggregate" spatial ID (e.g., statewide or service territory wide) that is used for calibration purposes).
Definition: ['All']
NodeLocation: 384,64,1
NodeSize: 64,40
WindState: 2,828,21,720,720
ValueState: 2,32,55,450,292,0,MIDM
DisplayOutputs: Object Object, Object Variable, Object Decision
{!50400|Att_AxisOrKeyTitle: ""}
{!40300|Att_SlicerPopupSize: 592,243}
{!40600|Att_ColorSequence: [0xff0f6689,0xff0f6689]}

Module Global_Calibration_L
Title: Global Calibration Logic
Author: JamesMilford
Date: Fri, Mar 22, 2019 10:15 AM
NodeLocation: 592,456,1
NodeSize: 64,40
DiagState: 2,305,57,1188,650,17
Aliases: Alias Al1553196427, Alias Al1553196433, Alias Al1572476319

Function Check_Sector(all_sectors: Index; all_index: Optional Index; der_sectors: Variable; der_index: Optional Variable)
Title: Check Sector
Description: This function checks to ensure that only one sector is chosen at a time when attempting to run the parameter calibration scripts. If more than one is selected, it returns an error message with instructions to only select one at a time.~
~
[all_sectors]: the index for all sectors.~
[all_index]: an optional generic static index in case the adoption logic is indexed by more than spatial IDs and sectors.~
[der_sectors]: the sector index for the DER considered in the calibration.~
[der_index]: an optional generic selectable index in case the adoption logic is indexed by more than spatial IDs and sectors. 
Definition: var x:=[];~
VAR ind_title:=Title of der_sectors;~
IF Size(der_sectors) > 1 ~
THEN (~
	x:=AskMsgChoice('Please select only one sector using the "' & ind_title & '" input setting before attempting to calibrate diffusion parameters.','Sector Selector Message', all_sectors, all_sectors[@all_sectors=1],False,False);~
	(der_sectors := x)~
);~
~
IF IsNotSpecified(all_index)~
THEN Null ~
ELSE (~
   ind_title:=Title of der_index;~
   IF Size(der_index) > 1~
   THEN (~
	x:=AskMsgChoice('Please select only one element using the "' & ind_title & '" input setting before attempting to calibrate diffusion parameters.','Index Selector Message', all_index, all_index[@all_index=1],False,False);~
	(der_index := x)~
   )~
);~

NodeLocation: 248,152,1
NodeSize: 64,40
WindState: 2,110,74,1618,776
DisplayOutputs: Object Object, Object Function, Function Sequential_Opt_PV0, Function Aggregate_Optimizati, Function Set_Start_Coeff_PV0, Function Sequential_Opt_PV2, Function OG_Sequential_Optimi

Function Check_SpatID_Sel_PV()
Title: Check Spatial ID Selection
Description: This function checks to ensure that only one spatial ID is selected when attempting to assign stored coefficients to the default values.  If more than one is selected, it returns an error message with instructions to only select one at a time.
Definition: var x:=[];~
IF size(PV_Spatial_ID)>1 THEN ~
	((x:=AskMsgChoice('Please select only one Spatial ID before attempting to assign a stored coefficient to the default values.','Spatial ID Selector Message', All_Spatial_ID, All_Spatial_ID[@All_Spatial_ID=1],False,False));~
	(PV_Spatial_ID := x))~

NodeLocation: 112,64,1
NodeSize: 64,40
WindState: 2,36,127,929,350

Function Set_Spat_ID_Fail_R2(failed_id: Index; der_spatial_id: Variable)
Title: Set Spat ID Fail R2 or Infeas
Description: Sets the Multichoice selector on Selected Spatial ID to all Spatial IDs that failed the goodness of fit R^2 test, or if a spatial ID has not yet returned a feasible solution from the optimization.~
~
[failed_id]: the spatial IDs that failed the goodness of fit test.~
[der_spatial_id]: the spatial ID index used for the DER considered in the calibration.
Definition: IF size(failed_id)<>0 ~
THEN (der_spatial_id:=failed_id)~
ELSE Null
NodeLocation: 248,64,1
NodeSize: 64,40
WindState: 2,118,70,951,499
DisplayOutputs: Object Object, Object Function, Function MultiStage_CalibrPV0, Function OG_Multi_Stage_Calib

Function Sequential_Opt(stage: Atom; select_decis, decis_handles, all_spatial_id, der_spatial_id, all_sectors: Index; all_index: Optional Index; ag_stage1, aggreg_level; der_sectors, stored_decis, stored_status, decis_switch: Variable; der_index: Optional Variable; optDef_handle: Handle)
Title: Sequential Optimization
Description: This function is called by a button script and sequentially optimizes each selected spatial ID's diffusion coefficients. This sequential operation facilitates interruption of the script during the optimization, if desired, and stores each value after its optimization, to avoid losing any coefficients already calculated (e.g., in the event of an abort of the optimization). It only walks through each selected spatial ID relevant to that DER. A separate function is called for the "aggregate calibration" step, which differs by DER. This function can be used for any DER. ~
~
[stage]: the current stage of the multistage calibration being called (an integer).~
[select_decis]: an index of the handles to only the decision variables used in this particular optimization (which can be a subset of all possible decision variables).~
[decis_handles]: an index of the handles of all possible decision variables in the optimization.~
[all_spatial_id]: the index of all spatial IDs.~
[der_spatial_id]: the spatial ID index used for the DER considered in the calibration.~
[all_sectors]: the index for all sectors.~
[all_index]: an optional generic static index in case the adoption logic is indexed by more than spatial IDs and sectors.~
[ag_stage1]: a boolean flag indicating whether the first calibration stage should set the spatial IDs to the selected aggregation level (as defined by aggreg_level) (true=stage1 uses aggregate label).~
[aggreg_level]: the label within the spatial ID index indicating the appropriate level of aggregation for the first stage of the calibration.~
[der_sectors]: the sector index for the DER considered in the calibration.~
[stored_decis]: the node where calibrated decision variables will be stored.~
[stored_status]: the node where the optimization status will be stored.~
[decis_switch]: a boolean flag indicating whether decision nodes or stored results will be used in the model logic (true=use decision nodes).~
[der_index]: an optional generic selectable index in case the adoption logic is indexed by more than spatial IDs and sectors.~
[optDef]: the handle to the variable where the optimization is defined.
Definition: (decis_switch:=1); {Ensures the optimization uses the actual decision variables when calculating the objective, rather than the stored coefficients}~
Check_Sector(all_sectors , all_index, der_sectors, der_index);  {Checks to ensure only one sector or generic index element is selected for the diffusion parameter calibration}~
{Check_Cost_Scenario(); }{Checks to ensure only one cost scenario is selected for the diffusion parameter calibration}~
~
{assign local variables for use in the function}~
local temp_stored_coeff:=stored_decis;~
local status:=stored_status;~
local solution :=0; {initializes a local variable storing an individual coefficient}~
~
{assign local indexes for use in the function}~
Index remaining_IDs := IF stage = 1~
   THEN CopyIndex([aggreg_level])~
   ELSE CopyIndex(der_spatial_id);~
local counter:=1;~
local maxcount:=size(remaining_IDs);~
~
For i:=remaining_IDs DO (	~
   ShowProgressBar('Parameter Optimization Status Bar', 'Calibration Stage: ' & stage & '.   Optimizing diffusion parameters for Spatial ID = ' & i & ':  Calculating ID # ' & counter & ' of ' & maxcount, p: ((counter - 0.01) / maxcount));~
~
   {Updates the local variable's stored decision value to the optimized solution, only for the slice that is the current spatial ID}~
   Local x[]:=select_decis DO (~
      LocalAlias optDefn:=optDef_handle;   {Assign the result, rather than the handle, of the optimization definition to this local Alias}~
      solution := IgnoreWarnings(OptSolution(IF (stage=1 AND NOT ag_stage1) THEN optDefn ELSE optDefn[der_spatial_id=i], x));~
      IF IsNotSpecified(all_index)   {If optimization is only over spatial ID and sector indices}~
      THEN (~
         status[all_spatial_id=i, all_sectors=Slice(der_sectors,1), All_Utilities=Selected_Utility] := OptStatusText(IF (stage=1 AND NOT ag_stage1) THEN optDefn ELSE optDefn[der_spatial_id=i]);~
         IF solution <> null THEN temp_stored_coeff[decis_handles=x, all_spatial_id=i, all_sectors=Slice(der_sectors,1), All_Utilities=Selected_Utility] := solution )~
      ELSE (  {Else if there's a third optimization index}~
         status[all_spatial_id=i, all_sectors=Slice(der_sectors,1), all_index=Slice(der_index,1), All_Utilities=Selected_Utility] := OptStatusText(IF (stage=1 AND NOT ag_stage1) THEN optDefn ELSE optDefn[der_spatial_id=i]);~
         IF solution <> null THEN temp_stored_coeff[decis_handles=x, all_spatial_id=i, all_sectors=Slice(der_sectors,1), all_index=Slice(der_index,1), All_Utilities=Selected_Utility] := solution )~
   );~
   (stored_decis:=temp_stored_coeff); {assigns the new solution for each spatial ID to ensure solutions are captured in the event of an abort}~
   (stored_status := status); ~
   counter:=counter+1;	 {increments a counter only for purposes of the ShowProgressBar calculation}	~
);~
~
(decis_switch:=0); {Returns the value of this input to zero to ensure stored coefficients are used in model calculations}
NodeLocation: 384,152,1
NodeSize: 64,40
WindState: 2,302,11,1405,828
DisplayOutputs: Object Object, Object Function, Function OG_Multi_Stage_Calib

Function Multi_Stage_Calibrat(select_stages, all_stages, all_spatial_id, nonAg_id, failed_id, calib_time, sim_time, select_decis, all_decis, decis_handles, all_sectors: Index; all_index: Optional Index; ag_stage1, trace_flag, calib_start, calib_end, dates_by_stage, decis_by_stage, setting_by_stage, aggreg_level; der_spatial_id, der_sectors, curr_stage, sim_start, sim_end, decis_switch, dates_in_opt, decis_in_opt, stored_decis, setting_in_opt, stored_status: Variable; der_index: Optional Variable; optDef_handle: Handle)
Title: Multi-Stage Calibration
Description: This script specifies the multi-state sequence of calibration scripts as follows:~
Step 1: start with calibrating the most aggregate data available (e.g., statewide, or service territory wide), using all historical dates (more data typically available at the aggregate level). Calculation diffusion coefficients (ad eff & WOM) for an assumed aggregate long run market share~
~
Step 2: .....~
~
[select_stages]: the calibration stages selected for the current calibration.~
[all_stages]: an index of all the calibration stages, not just those selected for this calibration.~
[all_spatial_id]: the index of all spatial IDs.~
[nonAg_id]: the index of all spatial IDs except aggregate values.~
[failed_id]: the spatial IDs that failed the goodness of fit test.~
[calib_time]: the calibration time index used for the DER considered in the calibration.~
[sim_time]: the simulation time index used for the DER considered in the calibration.~
[select_decis]: an index of handles to the decision variables selected for the optimization.~
[all_decis]: an index of the names of all decision variables.~
[decis_handles]: an index of handles to all decision variables that could be selected.~
[all_sectors]: the index for all sectors.~
[all_index]: an optional generic static index in case the adoption logic is indexed by more than spatial IDs and sectors.~
[ag_stage1]: a boolean flag indicating whether the first calibration stage should set the spatial IDs to the selected aggregation level (as defined by aggreg_level) (true=stage1 uses aggregate label).~
[trace_flag]: a boolean flag indicating whether the model will write to trace log during the calibration/optimization process (true=write).~
[calib_start]: the start period for the calibration time.~
[calib_end]: the end period for the calibration time.~
[dates_by_stage]: the dates that will be included in the objective function for each stage of the calibration.~
[decis_by_stage]: the decisions that will be included in the optimization for each stage of the calibration.~
[setting_by_stage]: the optimization engine settings for each stage of the calibration.~
[aggreg_level]: the label within the spatial ID index indicating the appropriate level of aggregation for the first stage of the calibration.~
[der_spatial_id]: the spatial ID index used for the DER considered in the calibration.~
[der_sectors]: the sector index for the DER considered in the calibration.~
[curr_stage]: the current stage being evaluated.~
[sim_start]: the start period for the simulation time of the DER considered in the calibration.~
[sim_end]: the end period for the simulation time of the DER considered in the calibration.~
[decis_switch]: a boolean flag indicating whether decision nodes or stored results will be used in the model logic (true=use decision nodes).~
[dates_in_opt]: the dates used in the current optimization.~
[decis_in_opt]: the decisions that are used in the current optimization.~
[stored_decis]: the node where calibrated decision variables will be stored.~
[setting_in_opt]: the optimization engine settings applied to the current optimization.~
[stored_status]: the node where the optimization status will be stored.~
[der_index]: an optional generic selectable index in case the adoption logic is indexed by more than spatial IDs and sectors.~
[optDef_handle]: the handle to the variable where the optimization is defined.
Definition: IF (trace_flag AND Size(select_stages)>1) THEN MsgBox('Optimization text trace is on. It will not work when optimizing more than one stage. Please turn it off and then re-run the calibration, or run only one stage.', 5, 'Optimization Trace Message' ) ;~
INDEX origIDs:=CopyIndex(der_spatial_id);   {Temporarily store the selected IDs}~
IF ag_stage1 AND (Slice(select_stages,1)=1) THEN (der_spatial_id:=aggreg_level) ELSE Null;   {If stage1 uses an aggregate element of the spatial ID and stage1 is included in calibration, then select that aggregate level}~
(sim_start:=calib_start); {Sets the start year for the simulation to the start time for the EV calibration}~
(sim_end:=calib_end); {Sets the end year for the simulation to the end time for the EV calibration}~
(decis_switch:=0); {Deselects the input that uses the decision variables in the model, so that R^2 failures can be calculated}~
Index stage:=CopyIndex(select_stages);~
~
For i:=stage DO (~
   (curr_stage:=i);   {Store the current stage in a global variable}~
   (dates_in_opt:=dates_by_stage[all_stages=i, calib_time=sim_time]); {Selects all dates for use in the calibration}~
   (decis_in_opt:=decis_by_stage[all_stages=i]); {Selects only those decision variables used in the given calibration stage}~
   (setting_in_opt:=setting_by_stage[all_stages=i]); {Adjusts the optimization engine settings per the calibration stage}~
   IF (Size(failed_id)<>0 OR curr_stage=1 OR Size(select_stages)=1) ~
   THEN Sequential_Opt(i, select_decis, decis_handles, all_spatial_id, der_spatial_id, all_sectors, all_index, ag_stage1, aggreg_level, der_sectors, stored_decis, stored_status, decis_switch, der_index, optDef_handle); {Runs the optimization and assigns best fit coefficients to the stored coefficients, but only if there are spatial IDs that have failed the goodness of fit test}~
   IF (ag_stage1 AND i=1) THEN (der_spatial_id:=nonAg_id) ELSE Null;   {If stage 1 uses an aggregate element of the spatial ID, then select all of the non-aggregate spatial IDs before calculating R2}~
   IF i=1 THEN Set_Starting_Coeff(all_sectors, all_spatial_id, der_spatial_id, all_index, aggreg_level, der_sectors, stored_decis, stored_status, der_index); {Sets starting coefficients for all spatial IDs to the value just calculated for the aggregate spatial ID that will be used for setting default coefficients. }~
   IF i>1 THEN Set_Spat_ID_Fail_R2(failed_id, der_spatial_id); {Set the spatial ID selector to all spatial IDs that failed the goodness of fit test, except for the "aggregate" calibration}	~
);~
~
(der_spatial_id:=CopyIndex(origIDs));   {Set the selected IDs back to their original values}~
(decis_in_opt:=@all_decis > 0);   {Select all decision variables again so that model can be manually forced to use decision variables by simply checking the box}
NodeLocation: 384,64,1
NodeSize: 64,40
WindState: 2,144,5,1689,846
DisplayOutputs: Object Object, Object Decision, Decision Dates_Incl_in_PV_Opt, Decision Opt_Settings_PV, Decision Opt_Settings_BESS

Function Set_Starting_Coeff(all_sectors, all_spatial_id, der_spatial_id: Index; all_index: Optional Index; aggreg_level; der_sectors, stored_decis, stored_status: Variable; der_index: Optional Variable)
Title: Set Starting Coeff
Description: This function sets the values of the starting coefficients for all Spatial IDs. This function is typically called AFTER calibrating aggregate adoption.~
~
This function must be called from within an optimization script to ensure that only one Sector & only one EV long run market share scenario are selected.~
~
[all_sectors]: the index for all sectors.~
[all_spatial_id]: the index for all spatial IDs.~
[der_spatial_id]: the spatial ID index used for the DER considered in the calibration.~
[all_index]: an optional generic static index in case the adoption logic is indexed by more than spatial IDs and sectors.~
[aggreg_level]: the label within the spatial ID index indicating the appropriate level of aggregation for the first stage of the calibration.~
[der_sectors]: the sector index for the DER considered in the calibration.~
[stored_decis]: the node where calibrated decision variables will be stored.~
[stored_status]: the node where the optimization status will be stored.~
[der_index]: an optional generic selectable index in case the adoption logic is indexed by more than spatial IDs and sectors.
Definition: Check_Sector(all_sectors , all_index, der_sectors, der_index);~
~
local coeff:=stored_decis;~
local status:=stored_status;~
~
local active_sector:=Slice(der_sectors,1);~
~
IF IsNotSpecified(all_index)~
THEN (~
   (coeff[all_sectors=active_sector, all_spatial_id=der_spatial_id]:=stored_decis[all_spatial_id=aggreg_level, all_sectors=active_sector]);~
   (status[all_sectors=active_sector, all_spatial_id=der_spatial_id]:='Not Yet Calibrated'))~
ELSE (~
   local active_element:=Slice(der_index,1);~
   (coeff[all_sectors=active_sector, all_spatial_id=der_spatial_id, all_index=active_element]:=stored_decis[all_spatial_id=aggreg_level, all_sectors=active_sector, all_index=active_element]);~
   (status[all_sectors=active_sector, all_spatial_id=der_spatial_id, all_index=active_element]:='Not Yet Calibrated') );~
~
(stored_decis:=coeff);~
(stored_status:=status);~

NodeLocation: 520,64,1
NodeSize: 64,40
WindState: 2,173,64,1520,764
DisplayOutputs: Object Object, Object Function, Function OG_Multi_Stage_Calib

Decision Infeasible_Label
Title: Infeasible Label
Definition: 'Feasible solution could not be found.'
NodeLocation: 256,256,1
NodeSize: 64,40
Aliases: FormNode Fo1553197083

Function Check_Stage_1(der_spatial_id, nonAg_spatial_id, select_stages: Index; aggreg_level)
Title: Check Stage 1
Description: Checks whether the user wishes to continue if stage 1 is included in the Stages to Calibration input AND not all relevant PV_Spatial_IDs are selected.~
~
[der_spatial_id]: the index of spatial IDs for the DER considered in the calibration.~
[nonAg_spatial_id]: a list of all non-aggregate spatial IDs.~
[select_stages]: a list of calibration stages selected for the calibration process.
Definition: INDEX nonAg_id:=Subset(der_spatial_id <> aggreg_level);~
IF (size(nonAg_id)<>size(nonAg_spatial_id) AND PositionInIndex(select_stages,1, select_stages))~
THEN MsgBox('You have selected to apply Calibration Stage 1, but fewer than all relevant spatial IDs are selected (normally all spatial IDs are selected for stage 1). Are you sure you wish to continue? If so, click OK. Otherwise, click Cancel.',1,'Stage 1 Message' )~
ELSE Null
NodeLocation: 656,64,1
NodeSize: 64,40
WindState: 2,1986,61,1007,504

Function Set_Simulation_Time(start, end; sim_start, sim_end: Variable)
Title: Set Simulation Time
Description: This sets the simulation start and end time periods to the desired start and end time periods, respectively.
Definition: (sim_start:=start); {Sets the start year for the simulation to the start time for the calibration}~
(sim_end:=end); {Sets the end year for the simulation to the end time for the calibration}~

NodeLocation: 112,152,1
NodeSize: 64,40
WindState: 2,749,219,1015,411

Function Check_DecVar_Switch(decis_switch: Variable)
Title: Check DecisVar Switch
Description: The Use DER Decision Variables box is typically only TRUE (checked) when the calibration scripts are physically running. If this box is inadvertently left checked (e.g., in the event of a calibration abort), this function will warn the user, who is most likely expecting to see the simulation results using stored coefficients, rather than whatever default value is in the Decision Variables (which are all scalars, not indexed by Spatial ID).
Definition: VAR var_title:=Title of decis_switch;~
~
IF decis_switch=1 THEN MsgBox('WARNING: The "' & var_title & '" box is checked (normally unchecked except in the middle of a calibration routine). This means that the simulation results shown in this output will not use the stored coefficients (which vary by Sector & Spatial ID) but rather a scalar default value. Click OK to proceed anyway, or click Cancel and then uncheck the"' & var_title & '" input in the appropriate Calibration Module ', 1, 'Decision Variable Warning')
NodeLocation: 520,152,1
NodeSize: 64,40
WindState: 2,39,89,1410,586

Index Act_vs_Sim
Att_PrevIndexValue: ['Actual','Simulated']
Title: Act vs Sim
Definition: ['Actual','Simulated']
IndexVals: ['item 1']
NodeLocation: 112,256,1
NodeSize: 64,40
DisplayOutputs: Object Object, Object Variable, Variable Sim_vs_Act_Vehicle_2, Variable Sim_vs_Act1, Variable Sim_vs_Act_Vehicle_3, Variable Sim_vs_Act_PV_Insta1
{!40300|Att_SlicerPopupSize: 297,56}

Decision Actual_Label
Title: Actual Label
Description: Select the method used for the optimization's objective function.
Definition: Choice(Act_vs_Sim,1,0)
NodeLocation: 112,448,1
NodeSize: 64,40
Aliases: FormNode Fo1535941782
DisplayOutputs: Object Object, Object Variable, Variable Sim_vs_Act_Vehicle_2, Variable Sim_vs_Act1, Variable Sim_vs_Act_Vehicle_3, Variable Sim_vs_Act_PV_Insta1

FormNode Fo1535941782
Title: Optimization Method
Definition: 0
NodeLocation: 116,496,1
NodeSize: 60,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,0
Original: Actual_Label

Decision Simulated_Label
Title: Simulated Label
Description: Select the method used for the optimization's objective function.
Definition: Choice(Act_vs_Sim,2,0)
NodeLocation: 112,344,1
NodeSize: 64,40
Aliases: FormNode Fo1535941833
DisplayOutputs: Object Object, Object Variable, Variable Sim_vs_Act_Vehicle_2, Variable Sim_vs_Act1, Variable Sim_vs_Act_Vehicle_3, Variable Sim_vs_Act_PV_Insta1

FormNode Fo1535941833
Title: Optimization Method
Definition: 0
NodeLocation: 116,384,1
NodeSize: 60,16
NodeInfo: 1,0,0,0,0,0,0,86,0,,0,,,0
Original: Simulated_Label

FormNode Fo1553197083
Title: Infeasible Label
Definition: 0
NodeLocation: 268,304,1
NodeSize: 68,16
NodeInfo: 1,0,0,0,0,0,0,102,0,,0,,,0
Original: Infeasible_Label

Close Global_Calibration_L

Variable Time_Fractional_Year
Title: Time Fractional Year
Description: The Time indexed expressed in fractional years.
Definition: VAR month:=DatePart(Time, 'M');~
VAR year:=DatePart(Time, 'Y');~
year + (month-1) * dT
NodeLocation: 992,496,1
NodeSize: 64,40
ValueState: 2,434,104,416,530,0,MIDM
Aliases: Alias Al130260515

Variable Timesteps_Per_Year
Title: Timesteps Per Year
Units: timesteps/year
Description: The number of timesteps per year for the system Time index.
Definition: Divide(1, dT, True)
NodeLocation: 992,584,1
NodeSize: 64,40

Variable Equal_Prd_in_Qtr_Map
Att_PrevIndexValue: ['1920 x 1080','1600 x 900','1366 x 768','1280 x 1024','1280 x 800','1024 x 768','2400 x 1200','Custom']
Title: Equal Period in Qtr Map
Description: Used to interpolate quarterly values to periodic values (eg, monthly), while ensuring that periods are equal in sizes (eg, we don't want months to range between 28-31 days because it creates unsmooth flows).
Definition: VAR start:=MakeDate(MIN(Time_Annually)-1, 12, 31);~
VAR end:=MakeDate(MAX(Time_Annually), 12, 31);~
INDEX quarters:=Sequence(start, end, step: Timestep_Months[Timestep_Options='Quarter'], dateUnit: 'M');~
VAR quarterlyTimeCnt:=@quarters;~
VAR periodicTimeCnt:=1 + @Time * dT * 12 / Timestep_Months[Timestep_Options='Quarter'];~
~
LinearInterp(quarterlyTimeCnt, quarters, periodicTimeCnt, quarters);~
~
~

NodeLocation: 1136,672,1
NodeSize: 64,40
WindState: 2,5,123,916,563
ValueState: 2,721,0,899,909,0,MIDM
{!50000|Att_ColumnWidths: [96]}

Variable Map_Time_to_Quarter
Title: Map Time to Quarter
Description: Maps months of the Time index to quarters.
Definition: VAR qtrStartMonth:=(Floor((DatePart(Time, 'M') - .1) / 3, 0) * 3) + 1;~
VAR year:=DatePart(Time, 'Y');~
~
MakeDate(year, qtrStartMonth, 1)
NodeLocation: 992,768,1
NodeSize: 64,40
ValueState: 2,420,119,416,706,0,MIDM

Variable Map_Time_to_EndOfQtr
Title: Map Time to End of Qtr
Description: Maps months in Time index to end of quarter.
Definition: VAR EOP_month:=DateAdd(Map_Time_to_Quarter, Timestep_Months[Timestep_Options='Quarter']- 1, 'M');~
VAR months:=DatePart(EOP_month, 'M');~
VAR years:=DatePart(EOP_month, 'Y');~
VAR days:=Floor(Days_Per_Month[@Month=months]);~
~
MakeDate(years, months, days)
NodeLocation: 992,672,1
NodeSize: 64,40
ValueState: 2,532,275,416,566,0,MIDM

Index Time_EOP
Title: Time EOP
Definition: CopyIndex(Time_EOP_Map)
NodeLocation: 1144,144,1
NodeSize: 64,40

Index Aggregate_Spatial_ID
Title: Aggregate Spatial IDs
Definition: ['Statewide','All_Utility']
NodeLocation: 776,56,1
NodeSize: 64,40

Constant Spatial_ID_Applicabl
Title: Spatial_ID_Applicable
Definition: Table(All_Spatial_ID,All_Utilities)(~
0,0,0,1,0,0,~
0,0,0,'Missing',0,0,~
0,0,0,0,0,0)
NodeLocation: 664,760,1
NodeSize: 96,40
DefnState: 2,641,497,419,216,0,DFNM
ValueState: 2,815,4,352,708,,MIDM
Aliases: FormNode Fo1529597917
NodeColor: 65535,1,1
ReformDef: [All_Utilities,All_Spatial_ID]
ReformVal: [Selected_Utility,All_Spatial_ID]
Att__TotalsIndex: [Selected_Utility,All_Spatial_ID]

Close Global_Indexes

