{ From user JamesMilford, Model PV_Calibration1 at 19-Mar-2019 5:37:41 PM, encoding="UTF-8" }
SoftwareVersion 5.1.6

{!-40203|Attribute CloudPlayerStyles}
Attribute UnoptimizedDef


AskAttribute UnoptimizedDef,Function,Yes
AskAttribute UnoptimizedDef,Module,Yes
AskAttribute UnoptimizedDef,Variable,Yes

LinkModule PV_Calibration1
Title: Calibration
Description: Fu4()
Author: Cory Welch
Date: Fri, Jun 22, 2018 10:48 AM
SaveAuthor: JamesMilford
SaveDate: Tue, Mar 19, 2019 5:37 PM
DefaultSize: 64,40
NodeSize: 72,64
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,14,-8,1823,890,17
WindState: 2,102,82,720,350
Pict: (0000000000000043006B0004F520000089504E470D0A1A0A0000000D494844520000006B0000004308060000009B40FB57000000017352474200AECE1CE90000000467414D410000B18F0BFC6105000000097048597300000EC300000EC301C76FA8640000207A49444154785EED5C775C54C7132726BFC4242A069566892DD6180BC50A8A8A5151890A7641C4868A8095A6A808A8F4AA74E9F5E81D698220BDF7DEE1E0E84787F7DB3938BDE0829A98089F4FFEF87A32B7BBEFBD9D9D99EFCCEE3B268220FEC3040156F81FC627B0C2FF303E8115FE87F109AC70A262606060929B8BE3717F2D31D7AA3083DB1D1D1D3FE2DA4D54608513116FDEBC596FAA74DC3D4A96B58F78C64110C61C44A5A960624DB2F7615CFB8908AC7022A1B4B474BE83EE6D9D20B9054D7D7AEC0461CE4910CF91B200169C4487163B51652FE6D95098B801D77F22012B9C0868696961F6B63594F1BDB5B6A8ED091B4D31A0A8A6C7AC84E3E565558687A71154A4289ADC0CC9B5E6536B7C15F59AEB4A17E2C69B08C00AC733060707BF0AF5231DF650DE195BFA80152962C8827A74D98948A55F2B5F3AE9DECCCFCF5F62686878555C7045A1EF45168230426D2C872CAED984BBB436DA4CBA8B3AF1E21956385E919A9CC0E3FDE4945BEA9D99436E0E14801411777B5EBB8FE175A38282825F18DB1715152D929595D595DAC1DE9C786B0641980E2996306427EAAD855E3765070B31B61FEFC00AC71BCACBCBE785592A6926292F6A02E2408B4B4849590AEC7DEEAA47BDE36363B6E0FAD1F1FAF5EB4D92A70E9394774FEBAF5545D608FD219EE9700CD4B848BA504A52B871FDC61BB0C2F182F6F6F629312423D90455EEC241200FC3F1A7E4DE2CC2E12E6F56B0274904D70F87BEBEBE6FBCBCBC842F1DDA15662A3A8DE8D17917E79A7517B555FB29EBB43654CDC1F51D2FC00ABF34202EA5467A1F8CD3DC15DBC2401E28E8FFAE577F2DDF2ACC51BFC2745AAB56F64DCDDACE8AB9B83170A00EB44F517492D359B87461F12981C5E501977E1A8A67303E72AB0D46DC25B5D11657A81DED5370FDBF34B0C22F899CD4B84DAF8D4E93CA68E4014D228A4B60559E5273DAAD1ECB1A411CF2C87139B295F453D3FA402662B7F7EC2AE77CC3ABDD7D5D9371E3D1E193E170E2B0D7CA2C5E7F26E271D8ADA7308ECCB5AB86E7B7B2B6D262A029BA1628CD0029CD4A28A63E3DE0006E9C2F09ACF04BA0B2AC78519283826E91EAFC767A8E04F1E9E5951983CFE545BDC3C3C30518DB173566AF508E127FC1E5CC44F0F8321112219B63A2ABFCF732B601A4172571C97A89BAAE7560227851BB0BE102E1392D093CF4EF615CB1237F782BFD3E6DA0FAD1BB78D6A5CDD94F76BFE0D4529EB68E71BC2F09ACF0DF04948472038DAE173E5D5B46230FA024B4CAD3D06AD7BBB825C9D9D1EE546F6FEFFF707D01AF2B827E3F13B8E935AF3713C1E5C644DC883C444A21BFE22B27972C50F595D15B6F3EB50D2C90CF755AAB55A6867C571FF5879163F4F4F47C6B676777EAE49EF54966C798891EED61D78BD28216FD25CDE410558D764A1D0A9A7FEEF76F032BFC370071A92CDE4BA4C858306100E548341AFE8C9328569C45184BAC2A36D57B22DFD0D080FC13BE3F237AFB7BBEF529B2113B11B42E99C7135990C377DD9B5E30B7AC4356B7D9FDC70ED537174C4B5A7297E1FA32A2BEBE9E554D4D4D517CC7A20A7F49949F69A3C56302F7C541343EDF984F8EB3B9D0DDDDFD1DAEEFBF01ACF09F464556DCE67CCB933E4D4FD10A1E763BCDEA6C84EEE9A9C40579FE98DCDC0F4FEC4850A9D41F1EFA5D355C6B8BDC2228CC8F89E0469F421E0B4AA2ABFDF7824271FD702093C9B34E4A88B84B5D9C4C1499A0F56200568660C841D45AED8F6ECC0A79CFDDFE1BC00AFF29902B0B97143ACB9AD73D99D7457B78A4A401441E1C4F4F271E48897AAEBDB5A0640572650AF1479DD3C9B11B71638C446155EE329D978A6A02169CD55CAE4CC43A149B2EBDDC196A9276F7E161CF5F33D73921F788E42791D5D9E668DDA8ED289F871B878EB296825F6C73B4AFEF232DCB5D6CC74408B84E228CCDA6100DB0B09E0FDD73BB16FB20D90DC5B38ACCD5B831FE2960859F1B6D4D0DB32A42B4956A7556D6D21F18E253E86516E2A6287786B5B5F519881B5164EF0307FD96E6AD0F602236B84CEED24EB8A155DE54B81837664E55DAEA8741978DF96D66368025F191A6B6C9450A7B05973A1FA5C7A5466A3D2B29D7FCDC092F9E8475765F0D72939888DF49B3AB9E24481B6437267277F675FC48ED6B9B5ADA92B734AACA67FFCD4811B79D24B63A6E0F649D1003DD9165FA2FCDBBEC266175428837D9FC2833D1092E1BEE1F7904AAD1F2464AA89A5A67F3BF13CFB0C2CF054844EBE21DC51BCDB6A51346C30F89985EAAFC4CE28EF0E2AA470FEFABD4D4D4A0C0F0AE4F63671D9B71AAB2EA26971F3B781131D8EAC442791479D9F84D51C436A0E7F18551FC0A016236EBAD7EECE04656C8EBF46D8F78C886B86BE1FB7C1FBC91B4507C7DD2FE66D46177D98803DEB75F89BA2AC69CB4BF16B6DF87CFFEA726B03A2E17E41EA19FC3B73D12415BA2C58336C60AB8CE6C00EB03A58392D6393211A2FEBF66DAE7E8CA52BAEA11452498E03EEFDDBBF7E038FFFCEA00B4C868CF438BB31C44AB395F4EC31BDBF36311A1CF01ACF073A0292F6A7BBDBD48682FBDF2801EAA448995B87F80BD4DEE8AA4655A5ADA982E249792B25625EE8CB580270B052C82D76672D76E979FCB785E4CEE82BF81F96D779D453EE8B52C57C0055997C3FF7A79BC86261BC0EBF30EA0045000C4B3B5F6A82F221EDCC86A68DFA13EA028900BFB2C2E54893D630D56D6DED3C28CBBAFD4D4D43517CE49585DDACAD299790BC53348AA91950D18B01364BB83E1CD791182B87E9F0358E1DF415B55F6AA068F2B36ED284FA1910784560D36C2488CA5F7B0C4EACCE0E0E05DB87EA3C138EEBECADA179306605261726996E1F04D1F7DE24109E0B660C2B9ECBFEEDFE4F463C716E769AD3BDCD8EA76BBCFADD8E9C651C3F5E29B3E502EC4AFF5D63F508FB8AD4B16F3DB187BD28B375EC08EB59EA63CB4002443F85E7D28A6D1111B1BBBF1D8A19D618FCF4F25C8F4FC0CA14387B3BFC1133D7F75CEAFB87E7F0758E15F0195523D8712A2FAB80DE52574F2D00FE4416C3AB165113375CE3116CA5AD2F79D8F33A44C8A5BB357E0C660447C45B88074D07E1F5EFB6F7BC06D1DF05E54A49F72E7B167A185E471FF75C9EB1CBF1A046A0E907AB92BD83AEBF19D880A2FE1DCA694B565AD794B3B7ADBA6527BDBA750FBDAA74464F9EF9570DE1EB6162996CBE9AB41C364453570A9FDFDFD5F97D5152F7C127C5373B3F54F4D6091BF7B7256930ACCCE0F12835FE1EE8B8EECB6785EF15081F085A628BE0A4EEEB3388CF2339D77F1ACCD6019851CA2F6A8A3B91E3113FC189F0AACF053D0DBD93EB5F58DB974BBE98642C6CA43D85516E234FF9C7A555555E58888886D925A87DD7FD5432B1BC5A19DDEB3C8CFD355EED77554BE57382DA464ADBC1B79C67A2D62624034767BCCA9B4CC7AA454D731540374CA3590E6739FD60A96B0D1E907AA6DB6F6F5BE810FC78AAEAEAEC9FAA1F71EACB59E3400941E14CFF87D6E55C6AA5B81C71DD741EC424ABB1D2DEA5AD956FCDE4665494BCE729538092B6E3764EDBE4CC441AF95594EAF9C8E417E7674D36C72D0E59F68CF4F77FDCDA69B721BE2ED24BBD1F5478EF5A9C00A3F169D397E873A1C8462196F0EC883E466E69EB367C46C929393DF966A60157B85B81F3E6AC81FB5C67A4811829E6C75BAC9373581A6D77754CD364D7D78779BEB8C468831FB7D1794BCC87E7A8B8A2C843E865596863CB841706987FC97E57E2CBD67845782C3097E7B140791EBD44EBEAE3DF2FBB0222F61119F9559509A12F65B541458EA781CE49054EB25DF7EB2C5756A1BDC3B109F67710FEF525A1B67D0FB26252571898B9DB23BBB695A6FB6D270BD1148883E3BD1E2241AD25A18B583DEF6AF002BFC10BACA1337B67B9CF1A49107F0D5661C44E54356425E700A21BA7F6798AFAFEF3EA850E0FA4279C923CAE184B89D4038B7D577DD60217C28C6EC26CDAD0025005D16F15F99F50C595E78A5E71FA9E4E82D990DF1BC2FB29EDEE276FCBA1F94050C503DE18A51527DE45632B51ADDC0FBD7190D94B68699EA81723A34A281AE6798AAA00EE343ADB1BEB59A1352887272F1C21B2F45DC680BC361D28078E0A6D7BBDC39ABC1E2F8DCA6B6A9C5499994538A16E1C687E7F6F6F63E7064DFF688077BA712F5EA0CF546C39FBB28BE3296ED3579CB717D3F04AC7034F4900B9651836E3DEB36F8B98B66492836B5A8B2113A42D306F7F1FD966D626222057B50B8BE3898463DBEC365F7753F9007501A90055A120B93344CA569E401C52500C4279A4287AD0B56FF7EBF0525F6393A721FAABAE7D4A6AE518BBE6CBCC7F5E7B2352F86AE47BB2E5A1C705D5EC432B7DBB3D7EE7759927FCE6F7B9888FBAA0C68472336500D41F7713A70FD9BBCC6D435B8F147A2ADAD6DAA9191D11551815F736D4E3013BD506F042B4373D666BC824C89D0BE4B6DA5BCB5CA8F01563812FDED64B69E385DA52E931564FA2AE9D366275CAE4E27764BFE8F38267DD4B9A9A909396B7CFF9168EF6D61B6CC5257D8EB33B70226EDB0CF8A6C874CFD6B8E8926525A91B79FDC0B97B4B8177ED6F261D4055389C02DD1901F81A236384EEE528E396DFB384EDAE06ED859CBB39E02E16021309952E13B430B9A33568DBC16E47AE6891AF21BEC7EEC00F7B5DEE9BBEEB3215BA2A5C3F7FA9FF5DD1AB9C60A291E2D0CC8B5F67B2D2CDEEA36BD19AEB7D9656ADB419FA57990AF5D79B9270014CAEF31AD552B494EA7A98B3C6BE4754643757535E7FDFBF7550EF3B035854AA1FC8C1E32507C6F32DF9AD99CEA3A66A19A1158211D83FDBDFFEB49B33BDF6BBB358B913C8422F27070F5CCB665A76657AD4474FAC0CB85C5E6390FEF923B3FEC92126AC3054E07F2C6C3C4ADB3FF6A502B514E672C57F6E8CDC5E760456001A6E9F755467E1F90E626B2CF71493E8C074C2E118D4FFFAEB9B579FA9DC0D3B6B45C0A295B3349460F2A178CFD15DDCE9BC1D8FBBCE797C65507EFAA682B5C9C467EBD0914DFD8598BFCFC503B8F3C0B49419406004112F15B991555E9BB8F719CD1401D689BAA9725AF31FFECCC860D1BB893A4056650739591AE8719F3A03E07417110096DC9FF703CC30A017D45A1425DAE8722185742EAED998418EFF7C436FE2DD10101017BF29B327F558995B0A2AD6E7F26629707478D65A6BA02E343D2D1D2436131485150E7417107DCD7B9906D1149B5915B47B663447099F351A0DBE00EA5C27E0FEAE9C757BCCBEB4AE79F77DE1DC88316CE76CF198D89F5E10270544DCA05517F647582DE6C75AF4699DCE6E6E6E9272DB746C2FD430A3030383009D70E50DA94BFE46684881B5C07DCB56EF2ADA7ADDDA37B14BF1CC7E3FB498B0BD7073311426831543495CFF3F3F3133AB49B2FE6FE9E290419E59F744F45D599D3DBE2236349ADCD1F359EBD2718A84DE3EEF33DEFDAAFCF314853125A01150F66118A823F12BCAB1617EBEAEACAC20332F649A98DD92CFB52D88B0B924EB4C2FFF05992EF98A77F0D6A6FF03DACC263FE6B5279D17790B45AA66BC877F78F1D63C04A0F782F2E04ABD8E1C15A5FD89C396692D9DED13E45C64DD415DAEFF5FCB94CCC95EF15C499DDDE9CD5A9F5D1631EA8292CCB5BBADD7C6E0558CDD304193D5C1B3A0606FABF76CC3490DEEA3AB4532D1EBC3136ADFEF526C636E995093CB2FE87DD697115911299A8FD3E05CDE9BFD1BF8790A1A3A323B77FD39212EB93283FA3D71BD15C773EFBADA6394A5BB997DAFA5E05E5DD1FAD658BFAC3E48DFA8D17B6D328A71107D1A08EC8C3C1A904D7E2994D70A4ABB0105F54A523B2C477DFA540C1105A3501DDA878E0C6D8BBAFC56CD63B22D687FEBE12BA3B30BBE1CF6E08074848EFC74A5AC064433F875C3D195CBB91E8ECECFC5ED643D415AE0D4A3BE0BBA82883FC663DAEED4884A7F9EF5D6FFB7D27C450DF62DBD3B8368CC8A3A4ADBE18BCE3255455B62086689AF1E05E4C69F0AE87E1979EADB1FC6A703DB25421DF79E52EF9C697FB91827163C0D139191919BDA31BD99B202FA51D0A42E90F61C241B4BED891DA9A4E82B4E12DABA6FD53974C3AD6A1FF4B0BF162484980C2BBB308FE5F26F78B8B8BBF484878B70DFE310829703FCC6737BD995E18859820172EEC0515055CFB9108287638C1E584924ED4FF32724D7D831F5F20550945316898E9DD8A1471C3B5190D46A1AACAB038043C66348E8C6DA3C13E5B5796D7F1DB1E5A5CB5F95F2FA41E7B7CE654EAA6DCD484DC11D76724607E4F9F3E6DFB5478DA209C69240C106829112711AB2914555C98BF04DAD11AE7A627F05A5F17884B5744816F58B3BD3AEC849F146B4F88D57DB54FA1E3F5D4AAD91AF1578C203F0106B7C59EB9854EC965913B88A90ED883EB47076C8908BAA09C064DF6768F59641CC31B0DFA710AEA608DFC4ED39BB739CD68DCECF97D6744A59730AE2D0EC01C6FFA1D7704F77632803BB1A59B82E81BBE2DA0B831779956EC4DCD4D0E53DA695E002D12804CC47E9FD69E3F878AB1D04EA9E1CCB49735CDBDCB3A403316C40FA85A6C84F93166E2FC21BED88C8CA13978DB01765A5D6C4C2FD94AAF2DA8551B3E5984B4DB89F283578FF8D263FC1D4E43C2486F8F835F91DDA97DDE0B4AE06177A08976CCD1BF56DB5E31D7264547EE80C710630356763DEA0F4F5C1CE9EEE9FEEE922F220AC8A2C0953AE519488F6C331A5EA469DE847E9BDDA7B427D545F193722C24C1AA8FFAAD4E835401D70787E60E0ACB496FC456D13328449F70E81D78FF99536B5E6F528A12B3D9E488D201D48EDF9DB90516A841B2BCC676B759642020227E2BB2C1438C55636C4524A838C4F87A8DDEEACAB76C1B29CBF7C24FC4C57D6BB2CDCCCCCE836BA7B77F6F80CACACA3936BA4A8F499717348275D1CC11A1E2212B11AE752828392E72DBC83E152D458B94A34FDBD256167203F231C79C0A1153646CD3D05EC76695FEE4F64E578E1A605E60754A3127EDA17A406FF320E0B23124BC30E97211C25E0383785F3F12BE7976A7A040BBC1FDDB9ED03277DA2B3E03C4C0A48B213B432176182629AA8DEC3316F26AD37FDBED36B70298E4D3C46BFA208363012F4B4987AE8608F981970046CBE7C2DCA29D725D3B87F2AEAC069EE0760C223A606908B29107BC199F918ECA044FD1CAE7820970F48DA624530E22E5CE4C4266CFBC7A6525A5475555EFBBD03FFDC188C4C4446EF37B624E61D7587B09E361B682B49F7D6F4E57D83369B3E261B2E155607B1A8AADEB8320575950125832544B1B0DE48E1A0E935495FBBB3C51CE82FA4092AA9D785D5B23444E076A86F08007BC161555B6E1CB3923915C1BC50F2B1B168A73AEF165C6EF32C9F1BC7CA429ED9BDCBFEF4C46D6C6F8DD87905615B7610F695E3978820771921612017CAF68A52EA440D180955916596A8A351D653FE3FA02024AEC4F1EF25D9E031BA810D3D4518E57DC56BC905292B1A6D456C2AD4393FD2DDBAE419E4C651F4BB7F405315BC67AEA48608574C09B84FEBEDEC296377F8FCA51643808894C35E72157B189D381C015108FBC7FA0AA265E30AD6DFFB8BD2040796BE1E2E799F71E6C759CD108134D63906832F85D995B3E76628B9B7396EFF35E580C6EE779DAFB0933E0599ACA7D48194EF8702776F67CFC9B2394CE3AB61BE18748706F103FE1F34CF0A6D741654EC79ABB3EEED415EC7A5B64AB2B6CF35950B2D1ED2BC2D2616569B3F6B246FA0B1240D9CD8E331352C704C3A19E0AF38D1B870EAC7024A0CEE56C6D72C5FEEA9AC25A7A6112AD88FE67EC04C98299D0743CE984EBF721D4D6D77088BB6C8B0097B80E290AAC6A9B2B0B0518565BF7D8011A12EFE37EEB92210EAABF9132C1B50140AE0764015C2F1C0FC0B56144696BDE524876F9918B0305415CDAEC3CB50DFE7FE7D51197B64F200E0028ECC6062A3F493161ED7B1B9710810B976621AE0AFF96F7ECD9B34B1F4BE0B0C2D1006F199A3FBDA3E92635AF8576700448881E27D1A2B1A0FD8DE171EFF4F857635624181198E526B2D7E69702703310E77691665749850A8640451D5CCD51DF35A9C1252E4770D57BA81A48BD140C81E02E17F187E768950D3A52EB6336F393A6B5C275AC93B56EE0DA5420B7AB977AEB29102370CF5B105179F4E6822924E38935915B457C576681851EF25B9E13533536A3A5A33821607FC9F37DD13D9A68AEE0FC215256AED24CE2F6BE398D2A4A779EC0DB31B87EA3012BFC10E2E3E3798DE58F9182AFCC18642C4765ABCCA3469ACB998C953C173466AC920F3D65070554D804041C0F5C9B02672EE0FBF8DA973B2EBEDCF192EE7AE4220E7AE434BEF3E3E4CE1A8E73C1DB226042258237C73477BFDB4F1A0B01250E2778DDBFEEE776FABADF33FB85385D0E07629E67DC57A129092983C7E19B3E38149ACB401A00B011298B724570B9BC2EDFF419A5293D1A8DDA5717A6AE2BB23BE7D4A0F16EBBBF51838D78223CBDFFEAD9A3AEC00770FD3E04ACF063009B893E1EEE22CF6504E2326807FB91D2E0C6503C4B79B8AA32D64DE73685F2EE612A5B8B171A242BA86F7566A10053025ABDDEE5DB1EED14399DE6EE3FC70028457915594940B90956F3669729EDE6198F9440A1E783B78781459D0CE24AAA6A2F59C0D8EF43B0C9D6BC49CB8790421CB30CA4A15201A531188F0729F16E8CF88B3CCAE85B20FD037DDFD86669DD808A0528F664205712634197525F3DBBC85B55ADE6E9E277471BF4D90947F1E9C425D16D312412E9D087E2D258C00A3F055027B431D5BD6E25F55B713DE467A0307493909FC56B08242587B91F35CDD0BFB6D3675E392D58232581EB938A100C795313BA1337261D508D87F8B1D9756A1BD065D8C60745C3164703A658FC3170CB7F7669A3CBE42E1AA141F70145E83B51C71D936B5EF1E1DAE390D390C4752D42C80FAC6C198AB50FE3A50D32220C6E54E86ECC63DC358F946121640EAC2CD4D3D39319594FFD2BC00AFF0AC0F53D53BFA1EB7AE9E7662A3D3F33E3206A5538FA751F4DEFDBEA368958E9FC6DCFD9B06D1181650E273EE538B377A1F5191EE76FFAC065722185CBBF3AE6F4B18C6C24E2AA4304779258EBC1CD020EF92CCF296ECAF94B3BB7F6F95612C76D585A3D6D98895E3DB6A1188E9EB9486516A12C3CBB49E9CE4D2D78B508D7F7AF002BFC3B805742756E1E23F94B0DBFA8064A43895FA1F14CC2589F3B33AF70ECEAF9484457F8EF3DE8BB340FDCD7097FAEA43D1EF3CA21213DE0B5B830A4D4E508AECF68B0CE7A727B83FB77DD9022C8851EF4900CE18F024BDFE335B702F2225C9FD150575AF44B354949B7D370493361849E113D6787261BA1F9C7B4C1EBE78EB8C7C5C57DF69F72C00AFF2EC02FBBBAB81CD1BDC497085939EDC8B43182EEDCDEECC7BC05095E8672B0DF84EB4B0754AA2DD2D415E0DC05B81B95D7125650362A41B9D5F5C83F3C69056264650AD1C71DCB5BFFFCE2F748C0814DD537E7CD609C8DAE93BB205E81BCB587C2A2117FD91858222C06282F7D281987374DF27D1EAB54682E27D3A8385893014A6124A713324736C7BBBABA8AFE9DB83416B0C2CF05201866064FE44DCF2DAF20D3E319423B8A67714F7724A4447888E0A8795973C12F37220FBBC3512F1EE7AFFBE14C2063E909FEEF9C677405CEA50339D8E5C159ED5D647D0657872B6DCE5B7A31748894ECF19C5BF1AAFCFD17EE7C8B6DC4769138ABA10D54637C8ADFB1453AA02E5AF0CA51AC48777336BC4D423B4F811661D2AD19C475E1A5659A9A4F6F7DCAD186BF02ACF073232F2F6FA9D103691327C9D9EDDD707064586995AAAC44BCC9298FDCB4376F5D867BAEE90541127B2DB02DD1C09559AFAB827E671C8B1165ADF94B145F9D70A05BC6EDE8232EE56DEFAC2CAAD44F689FEF5061195C5E71F3E8874BC13A211682B5D2C68A1275CD691972D965E9AFB61559880641259C461ED0BDC36BB40F84395A156E5C7DEF271DFE296085FF14E0B0A7A6CC41BF90CB283F837846CBCF3889E2870B5B939D95B46E851C775C8E268BCB6DD28046C265634AE7D04B011F824FE10B715A7D1229788FC7DC0AF7BCE7179FBF5155068A0E24422DE1D23338998BEBCB08B072DF221B3161BF65B9CB202EBACFAE8EB43FF092F278611B9D8AC3CF0B991EFB69405AFC0F9FC8C8B18F257C6E6085FF24E0CD412707BB533A17F912D3E4219E0D9310137622FEC54FC4B5176C4D9ED94EC7707DC742435735A74ACC594B285BD18EAA216ABEDEE5BB6EF77CD30BB8F663A1A03677D913F35505995628DF86FD3D58546871F95DFA89903DBA39C1C1C1E1C4977803122BFC37006F171AEBA82B1988FF525D0507FB6947093889418379DDF9C6A241B971819FF4EB2F102FD4A1726F3BE4C680E66F709ADCE59A6722D58792595C9F9100CB2A8CF514A978B6F73561B0904A6379683165A245A5707071D5D3C7EA0A1FFBEAEC3F01ACF0DF444E4ECE724DC54BE63667D83BBB2126D072154EA2E211FB40A2E959E7FC8CC4318F14C0047BC4DA9F14B25E964BCB9D1CBFE983B37D9A09B2BA5C8E930680355E0DDF13908D12595C7F3A8AD363B7E4599DF282DFDAA0C7D4467556E2C961B60E45B98B667FE5D5D9CF0DACF04B2024244450E3CABEE000DA0F630DEF9F997210058F16B624382A6B9697BFBF77949A97C475D541C46DB5D5D0A9AA63816B52198BAC1195DE0744037ECD0482B1C5656A9B5DA68E5C6FDF9FCF735495972CCC7191D7AF7EFC33951E977A75D9098BE3CCC4F5334241A1A1635759FE4D60855F0AB085FDC2CA42525D9C2703CE28BE7DA51551E5ACC7EB4AD203CCAEC05979480934BD951E6D3099DE4C3BDEE6FE03553FF5F6135C55030AB54F12A50D209681E55D0EDAEB9F464E5B4D69A2B0E4051ACB9569AF2B832D0BDA758C3988975759881BA23CE9565656128C5BEAE30158E19706BC12AAABA1F240FBE4A2DA2A861FC6EAD46423B20D845E5D7DCE93B2C49189588598A34CE43E5F38418B1B8711AF6B02771F0FDB10B702294CD276767DA6017F5A2FFC1E21E44B285EE6DD9D45281F5C54A3A6FAE0BD5767C70BB0C2F182F4F4F4DF546F9DB3B21463EDA2C20F630DC792264B56C2C0FC47C2F8E5EDA7B87EA321253570AFABF992EA5673B400C0E5A1B11A34D808BDA3AC9D8A32E72CE17AB87EE30558E178435050D0EFAA17F786FAD37E180B59C33334D1FA1C44ADD6DAF24C77B587B5B56357E06B6BAA6667BADED5ACD35C594718CE1EA4B9577D76C245623A71437C4FE8A7BE3AFBA580158E4740FCB0B6343BFFE8D4DADC345A3CA3E73FEC44AEF686BCCC10EB0B23630CC4B7AC60F3CBF95A3C858C5B1731B22CC41DD13539E6238E7A8D776085E3197054EEE943450DDD13F3C935F4788640D56627328DF647E62704EF813390F099632414DD85E4342521B757767F16A12A3ABFFE918AA23A8C831B7F3C032B9C0880ADF1FBB262F616A76675778242869556AB3EB72B455320193EE9B27644248C8ECEEA569016B387574971E34D04608513059010FBF8F8EC5710DF19E5738161FF8C7EC400517E77C9E9C41DF19D9163BD3A3B5180154E34C051391363E3CBCA477FCB4F827886E2127C2A1D5D9D678CE4F03DAEDF44035638510147BBD4946F6ACB0A2F2F79A47443E7538F7A8D776085131DF01E2F4E3ED18115FE87F109ACF03F8C47104CFF07D1F320BBE1CE51390000000049454E44AE426082)
FontStyle: Arial Narrow,19
FileInfo: 0,LinkModule PV_Calibration1,2,2,0,0,PV Calibration Module.ana
{!40400|CloudPlayerStyles: FrameNode: PVCalibr_Frame~
Show_Object:yes}
{!40204-40399|AWP_Attrib:FrameNode: PVCalibr_Frame~
Show_Object:yes}

FormNode Fo1535066206
Title: Sim vs Act EV Stock
Definition: 1
NodeLocation: 252,476,1
NodeSize: 212,20
NodeInfo: 1,,,,,,0,70,,,,,,0
NodeColor: 65278,37008,6168
Original: Sim_vs_Act_PV_System

FormNode Fo1535066207
Title: Sim vs Act Net EV Sales
Definition: 1
NodeLocation: 252,516,1
NodeSize: 212,20
NodeColor: 65278,37008,6168
Original: Sim_vs_Act_PV_Rate

FormNode Fo1535066230
Title: Use Decision Variables
Definition: 0
NodeLocation: 252,388,1
NodeSize: 212,20
NodeColor: 65278,37008,6168
Original: Use_PV_Decision_Var

FormNode Fo1535066238
Title: Sectors Selected
Definition: 0
NodeLocation: 252,228,1
NodeSize: 212,20
NodeInfo: 1,,,,,,0,198,,,,,,0
Original: PV_Sectors

FormNode Fo4
Title: All Stored Coefficients
Definition: 1
NodeLocation: 252,556,1
NodeSize: 212,20
NodeColor: 65278,37008,6168
Original: All_Stored_Coeffs_PV

FormNode Fo9
Title: PV Decision Variables by Stage
Definition: 0
NodeLocation: 692,68,1
NodeSize: 212,20
NodeInfo: 1,,,,,,0,78,,,,,,0
NodeColor: 49344,49344,49344
Original: PV_Decisions_by_Stg

FormNode Fo1535602755
Title: PV Opt Settings by Stage
Definition: 0
NodeLocation: 692,108,1
NodeSize: 212,20
NodeInfo: 1,,,,,,0,78,,,,,,0
NodeColor: 49344,49344,49344
Original: PV_OptSettings_byStg

FormNode Fo1535641289
Title: R^2 Threshold
Definition: 0
NodeLocation: 692,188,1
NodeSize: 212,20
NodeInfo: 1,,,,,,0,78,,,,,,0
NodeColor: 49344,49344,49344
Original: R2_Threshold1

FormNode Fo1535644418
Title: PV Dec Var Bounds
Definition: 0
NodeLocation: 692,228,1
NodeSize: 212,20
NodeInfo: 1,,,,,,0,78,,,,,,0
NodeColor: 49344,49344,49344
Original: PV_Dec_Var_Bounds

FormNode Fo1535655040
Title: PV Spatial ID
Definition: 0
NodeLocation: 252,268,1
NodeSize: 212,20
NodeInfo: 1,,,,,,0,198,,,,,,0
Original: PV_Spatial_ID

FormNode Fo1535660189
Title: PV Dates Included by Stage
Definition: 0
NodeLocation: 692,148,1
NodeSize: 212,20
NodeInfo: 1,,,,,,0,78,,,,,,0
NodeColor: 49344,49344,49344
Original: PV_Dates_Incl_by_Stg

FormNode Fo1542054649
Title: EV Calibration Start
Definition: 0
NodeLocation: 252,68,1
NodeSize: 212,20
NodeInfo: 1,0,0,1,0,1,0,198,0,,0,,,
NodeColor: 65535,65535,65535
Original: PV_Calibration_Start

FormNode Fo1542054650
Title: EV Calibration End
Definition: 0
NodeLocation: 252,108,1
NodeSize: 212,20
NodeInfo: 1,0,0,1,0,1,0,198,0,,0,,,
NodeColor: 65535,65535,65535
Original: PV_Calibration_End

FormNode Fo1542137498
Title: Vehicle Sim End Year
Definition: 0
NodeLocation: 252,188,1
NodeSize: 212,20
NodeInfo: 1,,,,,,0,198,,,,,,0
Original: PV_Sim_End_Year

FormNode Fo1542137499
Title: Vehicle Sim Start Year
Definition: 0
NodeLocation: 252,148,1
NodeSize: 212,20
NodeInfo: 1,,,,,,0,198,,,,,,0
Original: PV_Sim_Start_Year

FormNode Fo1542155941
Title: Stages to Calibrate
Definition: 0
NodeLocation: 252,308,1
NodeSize: 212,20
NodeInfo: 1,,,,,,0,198,,,,,,0
Original: Stages_to_Calibrate

FormNode Fo1542219554
Title: Select PV Constraints
Definition: 0
NodeLocation: 692,268,1
NodeSize: 212,20
NodeInfo: 1,,,,,,0,78,,,,,,0
NodeColor: 49344,49344,49344
Original: PV_Constraints_by_St

FormNode Fo1542404245
Title: PV Tolerance by Stage
Definition: 0
NodeLocation: 692,308,1
NodeSize: 212,20
NodeInfo: 1,,,,,,0,78,,,,,,0
NodeColor: 49344,49344,49344
Original: PV_Tolerance_by_Stag

FormNode Fo1542729201
Title: Number of PV Stages
Definition: 0
NodeLocation: 692,348,1
NodeSize: 212,20
NodeInfo: 1,,,,,,0,78,,,,,,0
NodeColor: 49344,49344,49344
Original: Maximum_PV_Calibrati

Module Calibration_Details
Title: Calibration Details
Author: coryw
Date: Tue, Nov 20, 2018 12:18 PM
NodeLocation: 120,728,1
NodeSize: 80,64
DiagState: 2,448,378,940,228,17
Pict: (0000000000000043006B0004F520000089504E470D0A1A0A0000000D494844520000006B0000004308060000009B40FB57000000017352474200AECE1CE90000000467414D410000B18F0BFC6105000000097048597300000EC300000EC301C76FA8640000207A49444154785EED5C775C54C7132726BFC4242A069566892DD6180BC50A8A8A5151890A7641C4868A8095A6A808A8F4AA74E9F5E81D698220BDF7DEE1E0E84787F7DB3938BDE0829A98089F4FFEF87A32B7BBEFBD9D9D99EFCCEE3B268220FEC3040156F81FC627B0C2FF303E8115FE87F109AC70A262606060929B8BE3717F2D31D7AA3083DB1D1D1D3FE2DA4D54608513116FDEBC596FAA74DC3D4A96B58F78C64110C61C44A5A960624DB2F7615CFB8908AC7022A1B4B474BE83EE6D9D20B9054D7D7AEC0461CE4910CF91B200169C4487163B51652FE6D95098B801D77F22012B9C0868696961F6B63594F1BDB5B6A8ED091B4D31A0A8A6C7AC84E3E565558687A71154A4289ADC0CC9B5E6536B7C15F59AEB4A17E2C69B08C00AC733060707BF0AF5231DF650DE195BFA80152962C8827A74D98948A55F2B5F3AE9DECCCFCF5F62686878555C7045A1EF45168230426D2C872CAED984BBB436DA4CBA8B3AF1E21956385E919A9CC0E3FDE4945BEA9D99436E0E14801411777B5EBB8FE175A38282825F18DB1715152D929595D595DAC1DE9C786B0641980E2996306427EAAD855E3765070B31B61FEFC00AC71BCACBCBE785592A6926292F6A02E2408B4B4849590AEC7DEEAA47BDE36363B6E0FAD1F1FAF5EB4D92A70E9394774FEBAF5545D608FD219EE9700CD4B848BA504A52B871FDC61BB0C2F182F6F6F629312423D90455EEC241200FC3F1A7E4DE2CC2E12E6F56B0274904D70F87BEBEBE6FBCBCBC842F1DDA15662A3A8DE8D17917E79A7517B555FB29EBB43654CDC1F51D2FC00ABF34202EA5467A1F8CD3DC15DBC2401E28E8FFAE577F2DDF2ACC51BFC2745AAB56F64DCDDACE8AB9B83170A00EB44F517492D359B87461F12981C5E501977E1A8A67303E72AB0D46DC25B5D11657A81DED5370FDBF34B0C22F899CD4B84DAF8D4E93CA68E4014D228A4B60559E5273DAAD1ECB1A411CF2C87139B295F453D3FA402662B7F7EC2AE77CC3ABDD7D5D9371E3D1E193E170E2B0D7CA2C5E7F26E271D8ADA7308ECCB5AB86E7B7B2B6D262A029BA1628CD0029CD4A28A63E3DE0006E9C2F09ACF04BA0B2AC78519283826E91EAFC767A8E04F1E9E5951983CFE545BDC3C3C30518DB173566AF508E127FC1E5CC44F0F8321112219B63A2ABFCF732B601A4172571C97A89BAAE7560227851BB0BE102E1392D093CF4EF615CB1237F782BFD3E6DA0FAD1BB78D6A5CDD94F76BFE0D4529EB68E71BC2F09ACF0DF04948472038DAE173E5D5B46230FA024B4CAD3D06AD7BBB825C9D9D1EE546F6FEFFF707D01AF2B827E3F13B8E935AF3713C1E5C644DC883C444A21BFE22B27972C50F595D15B6F3EB50D2C90CF755AAB55A6867C571FF5879163F4F4F47C6B676777EAE49EF54966C798891EED61D78BD28216FD25CDE410558D764A1D0A9A7FEEF76F032BFC370071A92CDE4BA4C858306100E548341AFE8C9328569C45184BAC2A36D57B22DFD0D080FC13BE3F237AFB7BBEF529B2113B11B42E99C7135990C377DD9B5E30B7AC4356B7D9FDC70ED537174C4B5A7297E1FA32A2BEBE9E554D4D4D517CC7A20A7F49949F69A3C56302F7C541343EDF984F8EB3B9D0DDDDFD1DAEEFBF01ACF09F464556DCE67CCB933E4D4FD10A1E763BCDEA6C84EEE9A9C40579FE98DCDC0F4FEC4850A9D41F1EFA5D355C6B8BDC2228CC8F89E0469F421E0B4AA2ABFDF7824271FD702093C9B34E4A88B84B5D9C4C1499A0F56200568660C841D45AED8F6ECC0A79CFDDFE1BC00AFF29902B0B97143ACB9AD73D99D7457B78A4A401441E1C4F4F271E48897AAEBDB5A0640572650AF1479DD3C9B11B71638C446155EE329D978A6A02169CD55CAE4CC43A149B2EBDDC196A9276F7E161CF5F33D73921F788E42791D5D9E668DDA8ED289F871B878EB296825F6C73B4AFEF232DCB5D6CC74408B84E228CCDA6100DB0B09E0FDD73BB16FB20D90DC5B38ACCD5B831FE2960859F1B6D4D0DB32A42B4956A7556D6D21F18E253E86516E2A6287786B5B5F519881B5164EF0307FD96E6AD0F602236B84CEED24EB8A155DE54B81837664E55DAEA8741978DF96D66368025F191A6B6C9450A7B05973A1FA5C7A5466A3D2B29D7FCDC092F9E8475765F0D72939888DF49B3AB9E24481B6437267277F675FC48ED6B9B5ADA92B734AACA67FFCD4811B79D24B63A6E0F649D1003DD9165FA2FCDBBEC266175428837D9FC2833D1092E1BEE1F7904AAD1F2464AA89A5A67F3BF13CFB0C2CF054844EBE21DC51BCDB6A51346C30F89985EAAFC4CE28EF0E2AA470FEFABD4D4D4A0C0F0AE4F63671D9B71AAB2EA26971F3B781131D8EAC442791479D9F84D51C436A0E7F18551FC0A016236EBAD7EECE04656C8EBF46D8F78C886B86BE1FB7C1FBC91B4507C7DD2FE66D46177D98803DEB75F89BA2AC69CB4BF16B6DF87CFFEA726B03A2E17E41EA19FC3B73D12415BA2C58336C60AB8CE6C00EB03A58392D6393211A2FEBF66DAE7E8CA52BAEA11452498E03EEFDDBBF7E038FFFCEA00B4C868CF438BB31C44AB395F4EC31BDBF36311A1CF01ACF073A0292F6A7BBDBD48682FBDF2801EAA448995B87F80BD4DEE8AA4655A5ADA982E249792B25625EE8CB580270B052C82D76672D76E979FCB785E4CEE82BF81F96D779D453EE8B52C57C0055997C3FF7A79BC86261BC0EBF30EA0045000C4B3B5F6A82F221EDCC86A68DFA13EA028900BFB2C2E54893D630D56D6DED3C28CBBAFD4D4D43517CE49585DDACAD299790BC53348AA91950D18B01364BB83E1CD791182B87E9F0358E1DF415B55F6AA068F2B36ED284FA1910784560D36C2488CA5F7B0C4EACCE0E0E05DB87EA3C138EEBECADA179306605261726996E1F04D1F7DE24109E0B660C2B9ECBFEEDFE4F463C716E769AD3BDCD8EA76BBCFADD8E9C651C3F5E29B3E502EC4AFF5D63F508FB8AD4B16F3DB187BD28B375EC08EB59EA63CB4002443F85E7D28A6D1111B1BBBF1D8A19D618FCF4F25C8F4FC0CA14387B3BFC1133D7F75CEAFB87E7F0758E15F0195523D8712A2FAB80DE52574F2D00FE4416C3AB165113375CE3116CA5AD2F79D8F33A44C8A5BB357E0C660447C45B88074D07E1F5EFB6F7BC06D1DF05E54A49F72E7B167A185E471FF75C9EB1CBF1A046A0E907AB92BD83AEBF19D880A2FE1DCA694B565AD794B3B7ADBA6527BDBA750FBDAA74464F9EF9570DE1EB6162996CBE9AB41C364453570A9FDFDFD5F97D5152F7C127C5373B3F54F4D6091BF7B7256930ACCCE0F12835FE1EE8B8EECB6785EF15081F085A628BE0A4EEEB3388CF2339D77F1ACCD6019851CA2F6A8A3B91E3113FC189F0AACF053D0DBD93EB5F58DB974BBE98642C6CA43D85516E234FF9C7A555555E58888886D925A87DD7FD5432B1BC5A19DDEB3C8CFD355EED77554BE57382DA464ADBC1B79C67A2D62624034767BCCA9B4CC7AA454D731540374CA3590E6739FD60A96B0D1E907AA6DB6F6F5BE810FC78AAEAEAEC9FAA1F71EACB59E3400941E14CFF87D6E55C6AA5B81C71DD741EC424ABB1D2DEA5AD956FCDE4665494BCE729538092B6E3764EDBE4CC441AF95594EAF9C8E417E7674D36C72D0E59F68CF4F77FDCDA69B721BE2ED24BBD1F5478EF5A9C00A3F169D397E873A1C8462196F0EC883E466E69EB367C46C929393DF966A60157B85B81F3E6AC81FB5C67A4811829E6C75BAC9373581A6D77754CD364D7D78779BEB8C468831FB7D1794BCC87E7A8B8A2C843E865596863CB841706987FC97E57E2CBD67845782C3097E7B140791EBD44EBEAE3DF2FBB0222F61119F9559509A12F65B541458EA781CE49054EB25DF7EB2C5756A1BDC3B109F67710FEF525A1B67D0FB26252571898B9DB23BBB695A6FB6D270BD1148883E3BD1E2241AD25A18B583DEF6AF002BFC10BACA1337B67B9CF1A49107F0D5661C44E54356425E700A21BA7F6798AFAFEF3EA850E0FA4279C923CAE184B89D4038B7D577DD60217C28C6EC26CDAD0025005D16F15F99F50C595E78A5E71FA9E4E82D990DF1BC2FB29EDEE276FCBA1F94050C503DE18A51527DE45632B51ADDC0FBD7190D94B68699EA81723A34A281AE6798AAA00EE343ADB1BEB59A1352887272F1C21B2F45DC680BC361D28078E0A6D7BBDC39ABC1E2F8DCA6B6A9C5499994538A16E1C687E7F6F6F63E7064DFF688077BA712F5EA0CF546C39FBB28BE3296ED3579CB717D3F04AC7034F4900B9651836E3DEB36F8B98B66492836B5A8B2113A42D306F7F1FD966D626222057B50B8BE3898463DBEC365F7753F9007501A90055A120B93344CA569E401C52500C4279A4287AD0B56FF7EBF0525F6393A721FAABAE7D4A6AE518BBE6CBCC7F5E7B2352F86AE47BB2E5A1C705D5EC432B7DBB3D7EE7759927FCE6F7B9888FBAA0C68472336500D41F7713A70FD9BBCC6D435B8F147A2ADAD6DAA9191D11551815F736D4E3013BD506F042B4373D666BC824C89D0BE4B6DA5BCB5CA8F01563812FDED64B69E385DA52E931564FA2AE9D366275CAE4E27764BFE8F38267DD4B9A9A909396B7CFF9168EF6D61B6CC5257D8EB33B70226EDB0CF8A6C874CFD6B8E8926525A91B79FDC0B97B4B8177ED6F261D4055389C02DD1901F81A236384EEE528E396DFB384EDAE06ED859CBB39E02E16021309952E13B430B9A33568DBC16E47AE6891AF21BEC7EEC00F7B5DEE9BBEEB3215BA2A5C3F7FA9FF5DD1AB9C60A291E2D0CC8B5F67B2D2CDEEA36BD19AEB7D9656ADB419FA57990AF5D79B9270014CAEF31AD552B494EA7A98B3C6BE4754643757535E7FDFBF7550EF3B035854AA1FC8C1E32507C6F32DF9AD99CEA3A66A19A1158211D83FDBDFFEB49B33BDF6BBB358B913C8422F27070F5CCB665A76657AD4474FAC0CB85C5E6390FEF923B3FEC92126AC3054E07F2C6C3C4ADB3FF6A502B514E672C57F6E8CDC5E760456001A6E9F755467E1F90E626B2CF71493E8C074C2E118D4FFFAEB9B579FA9DC0D3B6B45C0A295B3349460F2A178CFD15DDCE9BC1D8FBBCE797C65507EFAA682B5C9C467EBD0914DFD8598BFCFC503B8F3C0B49419406004112F15B991555E9BB8F719CD1401D689BAA9725AF31FFECCC860D1BB893A4056650739591AE8719F3A03E07417110096DC9FF703CC30A017D45A1425DAE8722185742EAED998418EFF7C436FE2DD10101017BF29B327F558995B0A2AD6E7F26629707478D65A6BA02E343D2D1D2436131485150E7417107DCD7B9906D1149B5915B47B663447099F351A0DBE00EA5C27E0FEAE9C757BCCBEB4AE79F77DE1DC88316CE76CF198D89F5E10270544DCA05517F647582DE6C75AF4699DCE6E6E6E9272DB746C2FD430A3030383009D70E50DA94BFE46684881B5C07DCB56EF2ADA7ADDDA37B14BF1CC7E3FB498B0BD7073311426831543495CFF3F3F3133AB49B2FE6FE9E290419E59F744F45D599D3DBE2236349ADCD1F359EBD2718A84DE3EEF33DEFDAAFCF314853125A01150F66118A823F12BCAB1617EBEAEACAC20332F649A98DD92CFB52D88B0B924EB4C2FFF05992EF98A77F0D6A6FF03DACC263FE6B5279D17790B45AA66BC877F78F1D63C04A0F782F2E04ABD8E1C15A5FD89C396692D9DED13E45C64DD415DAEFF5FCB94CCC95EF15C499DDDE9CD5A9F5D1631EA8292CCB5BBADD7C6E0558CDD304193D5C1B3A0606FABF76CC3490DEEA3AB4532D1EBC3136ADFEF526C636E995093CB2FE87DD697115911299A8FD3E05CDE9BFD1BF8790A1A3A323B77FD39212EB93283FA3D71BD15C773EFBADA6394A5BB997DAFA5E05E5DD1FAD658BFAC3E48DFA8D17B6D328A71107D1A08EC8C3C1A904D7E2994D70A4ABB0105F54A523B2C477DFA540C1105A3501DDA878E0C6D8BBAFC56CD63B22D687FEBE12BA3B30BBE1CF6E08074848EFC74A5AC064433F875C3D195CBB91E8ECECFC5ED643D415AE0D4A3BE0BBA82883FC663DAEED4884A7F9EF5D6FFB7D27C450DF62DBD3B8368CC8A3A4ADBE18BCE3255455B62086689AF1E05E4C69F0AE87E1979EADB1FC6A703DB25421DF79E52EF9C697FB91827163C0D139191919BDA31BD99B202FA51D0A42E90F61C241B4BED891DA9A4E82B4E12DABA6FD53974C3AD6A1FF4B0BF162484980C2BBB308FE5F26F78B8B8BBF484878B70DFE310829703FCC6737BD995E18859820172EEC0515055CFB9108287638C1E584924ED4FF32724D7D831F5F20550945316898E9DD8A1471C3B5190D46A1AACAB038043C66348E8C6DA3C13E5B5796D7F1DB1E5A5CB5F95F2FA41E7B7CE654EAA6DCD484DC11D76724607E4F9F3E6DFB5478DA209C69240C106829112711AB2914555C98BF04DAD11AE7A627F05A5F17884B5744816F58B3BD3AEC849F146B4F88D57DB54FA1E3F5D4AAD91AF1578C203F0106B7C59EB9854EC965913B88A90ED883EB47076C8908BAA09C064DF6768F59641CC31B0DFA710AEA608DFC4ED39BB739CD68DCECF97D6744A59730AE2D0EC01C6FFA1D7704F77632803BB1A59B82E81BBE2DA0B831779956EC4DCD4D0E53DA695E002D12804CC47E9FD69E3F878AB1D04EA9E1CCB49735CDBDCB3A403316C40FA85A6C84F93166E2FC21BED88C8CA13978DB01765A5D6C4C2FD94AAF2DA8551B3E5984B4DB89F283578FF8D263FC1D4E43C2486F8F835F91DDA97DDE0B4AE06177A08976CCD1BF56DB5E31D7264547EE80C710630356763DEA0F4F5C1CE9EEE9FEEE922F220AC8A2C0953AE519488F6C331A5EA469DE847E9BDDA7B427D545F193722C24C1AA8FFAAD4E835401D70787E60E0ACB496FC456D13328449F70E81D78FF99536B5E6F528A12B3D9E488D201D48EDF9DB90516A841B2BCC676B759642020227E2BB2C1438C55636C4524A838C4F87A8DDEEACAB76C1B29CBF7C24FC4C57D6BB2CDCCCCCE836BA7B77F6F80CACACA3936BA4A8F499717348275D1CC11A1E2212B11AE752828392E72DBC83E152D458B94A34FDBD256167203F231C79C0A1153646CD3D05EC76695FEE4F64E578E1A605E60754A3127EDA17A406FF320E0B23124BC30E97211C25E0383785F3F12BE7976A7A040BBC1FDDB9ED03277DA2B3E03C4C0A48B213B432176182629AA8DEC3316F26AD37FDBED36B70298E4D3C46BFA208363012F4B4987AE8608F981970046CBE7C2DCA29D725D3B87F2AEAC069EE0760C223A606908B29107BC199F918ECA044FD1CAE7820970F48DA624530E22E5CE4C4266CFBC7A6525A5475555EFBBD03FFDC188C4C4446EF37B624E61D7587B09E361B682B49F7D6F4E57D83369B3E261B2E155607B1A8AADEB8320575950125832544B1B0DE48E1A0E935495FBBB3C51CE82FA4092AA9D785D5B23444E076A86F08007BC161555B6E1CB3923915C1BC50F2B1B168A73AEF165C6EF32C9F1BC7CA429ED9BDCBFEF4C46D6C6F8DD87905615B7610F695E3978820771921612017CAF68A52EA440D180955916596A8A351D653FE3FA02024AEC4F1EF25D9E031BA810D3D4518E57DC56BC905292B1A6D456C2AD4393FD2DDBAE419E4C651F4BB7F405315BC67AEA48608574C09B84FEBEDEC296377F8FCA51643808894C35E72157B189D381C015108FBC7FA0AA265E30AD6DFFB8BD2040796BE1E2E799F71E6C759CD108134D63906832F85D995B3E76628B9B7396EFF35E580C6EE779DAFB0933E0599ACA7D48194EF8702776F67CFC9B2394CE3AB61BE18748706F103FE1F34CF0A6D741654EC79ABB3EEED415EC7A5B64AB2B6CF35950B2D1ED2BC2D2616569B3F6B246FA0B1240D9CD8E331352C704C3A19E0AF38D1B870EAC7024A0CEE56C6D72C5FEEA9AC25A7A6112AD88FE67EC04C98299D0743CE984EBF721D4D6D77088BB6C8B0097B80E290AAC6A9B2B0B0518565BF7D8011A12EFE37EEB92210EAABF9132C1B50140AE0764015C2F1C0FC0B56144696BDE524876F9918B0305415CDAEC3CB50DFE7FE7D51197B64F200E0028ECC6062A3F493161ED7B1B9710810B976621AE0AFF96F7ECD9B34B1F4BE0B0C2D1006F199A3FBDA3E92635AF8576700448881E27D1A2B1A0FD8DE171EFF4F857635624181198E526B2D7E69702703310E77691665749850A8640451D5CCD51DF35A9C1252E4770D57BA81A48BD140C81E02E17F187E768950D3A52EB6336F393A6B5C275AC93B56EE0DA5420B7AB977AEB29102370CF5B105179F4E6822924E38935915B457C576681851EF25B9E13533536A3A5A33821607FC9F37DD13D9A68AEE0FC215256AED24CE2F6BE398D2A4A779EC0DB31B87EA3012BFC10E2E3E3798DE58F9182AFCC18642C4765ABCCA3469ACB998C953C173466AC920F3D65070554D804041C0F5C9B02672EE0FBF8DA973B2EBEDCF192EE7AE4220E7AE434BEF3E3E4CE1A8E73C1DB226042258237C73477BFDB4F1A0B01250E2778DDBFEEE776FABADF33FB85385D0E07629E67DC57A129092983C7E19B3E38149ACB401A00B011298B724570B9BC2EDFF419A5293D1A8DDA5717A6AE2BB23BE7D4A0F16EBBBF51838D78223CBDFFEAD9A3AEC00770FD3E04ACF063009B893E1EEE22CF6504E2326807FB91D2E0C6503C4B79B8AA32D64DE73685F2EE612A5B8B171A242BA86F7566A10053025ABDDEE5DB1EED14399DE6EE3FC70028457915594940B90956F3669729EDE6198F9440A1E783B78781459D0CE24AAA6A2F59C0D8EF43B0C9D6BC49CB8790421CB30CA4A15201A531188F0729F16E8CF88B3CCAE85B20FD037DDFD86669DD808A0528F664205712634197525F3DBBC85B55ADE6E9E277471BF4D90947F1E9C425D16D312412E9D087E2D258C00A3F055027B431D5BD6E25F55B713DE467A0307493909FC56B08242587B91F35CDD0BFB6D3675E392D58232581EB938A100C795313BA1337261D508D87F8B1D9756A1BD065D8C60745C3164703A658FC3170CB7F7669A3CBE42E1AA141F70145E83B51C71D936B5EF1E1DAE390D390C4752D42C80FAC6C198AB50FE3A50D32220C6E54E86ECC63DC358F946121640EAC2CD4D3D39319594FFD2BC00AFF0AC0F53D53BFA1EB7AE9E7662A3D3F33E3206A5538FA751F4DEFDBEA368958E9FC6DCFD9B06D1181650E273EE538B377A1F5191EE76FFAC065722185CBBF3AE6F4B18C6C24E2AA4304779258EBC1CD020EF92CCF296ECAF94B3BB7F6F95612C76D585A3D6D98895E3DB6A1188E9EB9486516A12C3CBB49E9CE4D2D78B508D7F7AF002BFC3B805742756E1E23F94B0DBFA8064A43895FA1F14CC2589F3B33AF70ECEAF9484457F8EF3DE8BB340FDCD7097FAEA43D1EF3CA21213DE0B5B830A4D4E508AECF68B0CE7A727B83FB77DD9022C8851EF4900CE18F024BDFE335B702F2225C9FD150575AF44B354949B7D370493361849E113D6787261BA1F9C7B4C1EBE78EB8C7C5C57DF69F72C00AFF2EC02FBBBAB81CD1BDC497085939EDC8B43182EEDCDEECC7BC05095E8672B0DF84EB4B0754AA2DD2D415E0DC05B81B95D7125650362A41B9D5F5C83F3C69056264650AD1C71DCB5BFFFCE2F748C0814DD537E7CD609C8DAE93BB205E81BCB587C2A2117FD91858222C06282F7D281987374DF27D1EAB54682E27D3A8385893014A6124A713324736C7BBBABA8AFE9DB83416B0C2CF05201866064FE44DCF2DAF20D3E319423B8A67714F7724A4447888E0A8795973C12F37220FBBC3512F1EE7AFFBE14C2063E909FEEF9C677405CEA50339D8E5C159ED5D647D0657872B6DCE5B7A31748894ECF19C5BF1AAFCFD17EE7C8B6DC4769138ABA10D54637C8ADFB1453AA02E5AF0CA51AC48777336BC4D423B4F811661D2AD19C475E1A5659A9A4F6F7DCAD186BF02ACF073232F2F6FA9D103691327C9D9EDDD707064586995AAAC44BCC9298FDCB4376F5D867BAEE90541127B2DB02DD1C09559AFAB827E671C8B1165ADF94B145F9D70A05BC6EDE8232EE56DEFAC2CAAD44F689FEF5061195C5E71F3E8874BC13A211682B5D2C68A1275CD691972D965E9AFB61559880641259C461ED0BDC36BB40F84395A156E5C7DEF271DFE296085FF14E0B0A7A6CC41BF90CB283F837846CBCF3889E2870B5B939D95B46E851C775C8E268BCB6DD28046C265634AE7D04B011F824FE10B715A7D1229788FC7DC0AF7BCE7179FBF5155068A0E24422DE1D23338998BEBCB08B072DF221B3161BF65B9CB202EBACFAE8EB43FF092F278611B9D8AC3CF0B991EFB69405AFC0F9FC8C8B18F257C6E6085FF24E0CD412707BB533A17F912D3E4219E0D9310137622FEC54FC4B5176C4D9ED94EC7707DC742435735A74ACC594B285BD18EAA216ABEDEE5BB6EF77CD30BB8F663A1A03677D913F35505995628DF86FD3D58546871F95DFA89903DBA39C1C1C1E1C4977803122BFC37006F171AEBA82B1988FF525D0507FB6947093889418379DDF9C6A241B971819FF4EB2F102FD4A1726F3BE4C680E66F709ADCE59A6722D58792595C9F9100CB2A8CF514A978B6F73561B0904A6379683165A245A5707071D5D3C7EA0A1FFBEAEC3F01ACF0DF444E4ECE724DC54BE63667D83BBB2126D072154EA2E211FB40A2E959E7FC8CC4318F14C0047BC4DA9F14B25E964BCB9D1CBFE983B37D9A09B2BA5C8E930680355E0DDF13908D12595C7F3A8AD363B7E4599DF282DFDAA0C7D4467556E2C961B60E45B98B667FE5D5D9CF0DACF04B2024244450E3CABEE000DA0F630DEF9F997210058F16B624382A6B9697BFBF77949A97C475D541C46DB5D5D0A9AA63816B52198BAC1195DE0744037ECD0482B1C5656A9B5DA68E5C6FDF9FCF735495972CCC7191D7AF7EFC33951E977A75D9098BE3CCC4F5334241A1A1635759FE4D60855F0AB085FDC2CA42525D9C2703CE28BE7DA51551E5ACC7EB4AD203CCAEC05979480934BD951E6D3099DE4C3BDEE6FE03553FF5F6135C55030AB54F12A50D209681E55D0EDAEB9F464E5B4D69A2B0E4051ACB9569AF2B832D0BDA758C3988975759881BA23CE9565656128C5BEAE30158E19706BC12AAABA1F240FBE4A2DA2A861FC6EAD46423B20D845E5D7DCE93B2C49189588598A34CE43E5F38418B1B8711AF6B02771F0FDB10B702294CD276767DA6017F5A2FFC1E21E44B285EE6DD9D45281F5C54A3A6FAE0BD5767C70BB0C2F182F4F4F4DF546F9DB3B21463EDA2C20F630DC792264B56C2C0FC47C2F8E5EDA7B87EA321253570AFABF992EA5673B400C0E5A1B11A34D808BDA3AC9D8A32E72CE17AB87EE30558E178435050D0EFAA17F786FAD37E180B59C33334D1FA1C44ADD6DAF24C77B587B5B56357E06B6BAA6667BADED5ACD35C594718CE1EA4B9577D76C245623A71437C4FE8A7BE3AFBA580158E4740FCB0B6343BFFE8D4DADC345A3CA3E73FEC44AEF686BCCC10EB0B23630CC4B7AC60F3CBF95A3C858C5B1731B22CC41DD13539E6238E7A8D776085E3197054EEE943450DDD13F3C935F4788640D56627328DF647E62704EF813390F099632414DD85E4342521B757767F16A12A3ABFFE918AA23A8C831B7F3C032B9C0880ADF1FBB262F616A76675778242869556AB3EB72B455320193EE9B27644248C8ECEEA569016B387574971E34D04608513059010FBF8F8EC5710DF19E5738161FF8C7EC400517E77C9E9C41DF19D9163BD3A3B5180154E34C051391363E3CBCA477FCB4F827886E2127C2A1D5D9D678CE4F03DAEDF44035638510147BBD4946F6ACB0A2F2F79A47443E7538F7A8D776085131DF01E2F4E3ED18115FE87F109ACF03F8C47104CFF07D1F320BBE1CE51390000000049454E44AE426082)
{!40400|CloudPlayerStyles: Show_object: no}
{!40204-40399|AWP_Attrib:Show_object: no}

Module Select_Decision_Var1
Att_PrevIndexValue: [0.25,0.5,0.75]
Title: Select Decision Variables
Author: Cory Welch
Date: Tue, Jun 26, 2018 2:35 PM
NodeLocation: 408,112,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,2659,9,1046,774,17

Decision PV_Decis_Vars_in_Opt
Title: PV Decision Vars in Opt
Description: The decision variables considered in the current PV optimization. Certain functions called by the optimization routine will automatically change these selections.
Definition: Table(All_PV_Decisions)(Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1))
NodeLocation: 96,352,1
NodeSize: 64,40
WindState: 2,2106,105,1001,709
DefnState: 2,1970,40,405,292,0,DFNM
ValueState: 2,2852,240,416,303,,MIDM
Aliases: FormNode Fo1535066211
TableCellDefault: Checkbox(1)

Index Selected_PV_Decision
Title: Selected PV Decision Variables
Description: The handles to decision variables selected for the current optimization.
Definition: INDEX selectDecisions:=Subset(PV_Decis_Vars_in_Opt);~
CopyIndex(Handles_for_PV_Decis[All_PV_Decisions=selectDecisions])
NodeLocation: 256,64,1
NodeSize: 64,40
WindState: 2,425,97,720,350
ValueState: 2,1969,376,332,309,0,MIDM
Aliases: Alias Al1542407785
DisplayOutputs: Function OG_Multi_Stage_Calib
MetaOnly: 1

FormNode Fo1535066211
Title: Select Decision Vars
Definition: 0
NodeLocation: 104,396,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: PV_Decis_Vars_in_Opt

Variable Include_Ad_Effect
Title: Include Ad Effect
Units: binary
Description: This node evaluates to 1.0 if the Ad Effectiveness decision variable is selected to be included in the optimization, and to 0.0 otherwise.
Definition: PV_Decis_Vars_in_Opt[All_PV_Decisions=PVAdEff_Label];
NodeLocation: 256,176,1
NodeSize: 64,40
WindState: 2,2240,72,720,350
DisplayOutputs: Function Sequential_Opt_PV0, Function Sequential_Opt_PV2

Variable Include_Start_WOM
Title: Include Start WOM
Units: binary
Description: This node evaluates to 1.0 if the Word of Mouth decision variable is selected to be included in the optimization, and to 0.0 otherwise.
Definition: PV_Decis_Vars_in_Opt[All_PV_Decisions=PVStartWOM_Label];
NodeLocation: 256,272,1
NodeSize: 64,40
DisplayOutputs: Function Sequential_Opt_PV0, Function Sequential_Opt_PV2

Variable Include_LRMS
Title: Include LRMS
Units: binary
Description: This node evaluates to 1.0 if the long run market share decision variable is selected to be included in the optimization, and to 0.0 otherwise.
Definition: PV_Decis_Vars_in_Opt[All_PV_Decisions=PVLRMS_Label];
NodeLocation: 256,368,1
NodeSize: 64,40
WindState: 2,102,82,720,350
DisplayOutputs: Function Sequential_Opt_PV0, Function Sequential_Opt_PV2

Variable Include_End_WOM
Title: Include End WOM
Units: binary
Description: This node evaluates to 1.0 if the ending word-of-mouth decision variable is selected to be included in the optimization, and to 0.0 otherwise.
Definition: PV_Decis_Vars_in_Opt[All_PV_Decisions=PVEndWOM_Label];
NodeLocation: 256,464,1
NodeSize: 64,40
DisplayOutputs: Function Sequential_Opt_PV0, Function Sequential_Opt_PV2

Constant PV_Dec_Var_Bounds
Title: PV Dec Var Bounds
Units: various
Description: This input contains the upper and lower bounds on PV decision variables used in the parameter calibration process.
Definition: Table(All_PV_Decisions,Upper_Lower)(~
0,0.03,~
0,2,~
0,1,~
-0.3,-0.2,~
0,1,~
-5,0,~
-15,15,~
-15,15,~
-15,15)
NodeLocation: 480,80,1
NodeSize: 64,40
DefnState: 2,1001,294,629,341,0,DFNM
ValueState: 2,2029,186,592,304,,MIDM
Aliases: FormNode Fo1535644418, FormNode Fo1535066214
ReformDef: [Upper_Lower,All_PV_Decisions]
ReformVal: [0,0]

Variable PV_AdEff_Lwr_Bnd
Title: PV AdEff Lwr Bnd
Units: fraction/year
Description: The lower bound on the corresponding decision variable.
Definition: PV_Dec_Var_Bounds[All_PV_Decisions=PVAdEff_Label, Upper_Lower=Lower_Label]
NodeLocation: 408,176,1
NodeSize: 64,40
WindState: 2,103,62,720,350

FormNode Fo1535066214
Title: EV Dec Var Bounds
Definition: 0
NodeLocation: 488,28,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: PV_Dec_Var_Bounds

Variable PV_AdEff_Upr_Bnd
Title: PV AdEff Upr Bnd
Units: fraction/year
Description: The upper bound on the corresponding decision variable.
Definition: PV_Dec_Var_Bounds[All_PV_Decisions=PVAdEff_Label, Upper_Lower=Upper_Label]
NodeLocation: 560,176,1
NodeSize: 64,40

Variable PV_LRMS_Lwr_Bnd
Title: PV LRMS Lwr Bnd
Units: fraction
Description: The lower bound on the corresponding decision variable.
Definition: PV_Dec_Var_Bounds[All_PV_Decisions=PVLRMS_Label, Upper_Lower=Lower_Label]
NodeLocation: 408,368,1
NodeSize: 64,40
WindState: 2,102,82,832,350

Variable PV_LRMS_Upr_Bnd
Title: PV LRMS Upr Bnd
Units: fraction
Description: The upper bound on the corresponding decision variable.
Definition: PV_Dec_Var_Bounds[All_PV_Decisions=PVLRMS_Label, Upper_Lower=Upper_Label]
NodeLocation: 560,368,1
NodeSize: 64,40

Variable PV_EndWOM_Lwr_Bnd
Title: PV EndWOM Lwr Bnd
Units: fraction
Description: The lower bound on the corresponding decision variable.
Definition: PV_Dec_Var_Bounds[All_PV_Decisions=PVEndWOM_Label, Upper_Lower=Lower_Label]
NodeLocation: 408,464,1
NodeSize: 64,40

Variable PV_EndWOM_Upr_Bnd
Title: PV EndWOM Upr Bnd
Units: fraction
Description: The upper bound on the corresponding decision variable.
Definition: PV_Dec_Var_Bounds[All_PV_Decisions=PVEndWOM_Label, Upper_Lower=Upper_Label]
NodeLocation: 560,464,1
NodeSize: 64,40

Variable PV_StartWOM_Lwr_Bnd
Title: PV StartWOM Lwr Bnd
Units: fraction/year
Description: The lower bound on the corresponding decision variable.
Definition: PV_Dec_Var_Bounds[All_PV_Decisions=PVStartWOM_Label,Upper_Lower=Lower_Label]
NodeLocation: 408,272,1
NodeSize: 64,40

Variable PV_StartWOM_Upr_Bnd
Title:  PV StartWOM Upr Bnd
Units: fraction/year
Description: The upper bound on the corresponding decision variable.
Definition: PV_Dec_Var_Bounds[All_PV_Decisions=PVStartWOM_Label, Upper_Lower=Upper_Label]
NodeLocation: 560,272,1
NodeSize: 64,40

Decision PVAdEff_Label
Title: PVAdEff Label
Definition: Choice(All_PV_Decisions,1,0)
NodeLocation: 760,176,1
NodeSize: 64,40
Aliases: FormNode Fo1535066215
{!40200|Att_ChoiceIndexes: Index All_PV_Decisions}

FormNode Fo1535066215
Title: EVAdEff Label
Definition: 0
NodeLocation: 764,212,1
NodeSize: 140,12
NodeInfo: 1,0,0,0,0,0,0,238,0,,0,,,0
Original: PVAdEff_Label

Decision PVStartWOM_Label
Title: PVStartWOM Label
Definition: Choice(All_PV_Decisions,2,0)
NodeLocation: 760,272,1
NodeSize: 64,40
Aliases: FormNode Fo1535066216
{!40200|Att_ChoiceIndexes: Index All_PV_Decisions}

FormNode Fo1535066216
Title: EVAdEff Label
Definition: 0
NodeLocation: 764,308,1
NodeSize: 140,12
NodeInfo: 1,0,0,0,0,0,0,238,0,,0,,,0
Original: PVStartWOM_Label

Decision PVLRMS_Label
Title: PVLRMS Label
Definition: Choice(All_PV_Decisions,5,0)
NodeLocation: 760,368,1
NodeSize: 64,40
Aliases: FormNode Fo1535066217
{!40200|Att_ChoiceIndexes: Index All_PV_Decisions}

FormNode Fo1535066217
Title: EVAdEff Label
Definition: 0
NodeLocation: 764,404,1
NodeSize: 140,12
NodeInfo: 1,0,0,0,0,0,0,238,0,,0,,,0
Original: PVLRMS_Label

Decision PVEndWOM_Label
Title: PVEndWOM Label
Definition: Choice(All_PV_Decisions,3,0)
NodeLocation: 768,464,1
NodeSize: 64,40
Aliases: FormNode Fo1535066218
{!40200|Att_ChoiceIndexes: Index All_PV_Decisions}

FormNode Fo1535066218
Title: EVAdEff Label
Definition: 0
NodeLocation: 772,500,1
NodeSize: 140,12
NodeInfo: 1,0,0,0,0,0,0,238,0,,0,,,0
Original: PVEndWOM_Label

Decision Handles_for_PV_Decis
Title: Handles for PV Decisions
Description: The handles to decision variables considered in the PV optimization.
Definition: Table(All_PV_Decisions)(handle(PV_Ad_Effectiveness),handle(PV_Word_of_Mouth),handle(PV_Ending_WOM),handle(PV_Payback_Coefficie),handle(PV_LongRun_Mkt_Share),handle(Logit_Price_Coeff),handle(Logit_Tech_Coeff),handle(Logit_Spatial_Coeff),handle(Payback_Spatial_Coef))
NodeLocation: 96,64,1
NodeSize: 64,40
WindState: 2,1797,101,1666,586
DefnState: 2,2475,158,487,287,0,DFNM
ValueState: 2,2400,538,578,283,,MIDM
Aliases: FormNode Fo1535564864, Alias Al1542407786, FormNode Fo1542407786

FormNode Fo1535564864
Title: Select Decision Vars
Definition: 0
NodeLocation: 104,108,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Handles_for_PV_Decis

Variable IncludeLogitPrice_Co
Title: IncludeLogitPrice Coeff
Units: binary
Description: This node evaluates to 1.0 if the decision variable is selected to be included in the optimization, and to 0.0 otherwise.
Definition: PV_Decis_Vars_in_Opt[All_PV_Decisions=PVLogitPriceCoef_Lab];
NodeLocation: 256,560,1
NodeSize: 80,40
DisplayOutputs: Function Sequential_Opt_PV0, Function Sequential_Opt_PV2

Variable PV_PriceCoef_Lwr_Bnd
Title: PV PriceCoef Lwr Bnd
Units: fraction
Description: The lower bound on the corresponding decision variable.
Definition: PV_Dec_Var_Bounds[All_PV_Decisions=PVLogitPriceCoef_Lab, Upper_Lower=Lower_Label]
NodeLocation: 408,560,1
NodeSize: 64,40

Variable PV_PriceCoef_Upr_Bnd
Title: PV PriceCoef Upr Bnd
Units: fraction
Description: The upper bound on the corresponding decision variable.
Definition: PV_Dec_Var_Bounds[All_PV_Decisions=PVLogitPriceCoef_Lab, Upper_Lower=Upper_Label]
NodeLocation: 560,560,1
NodeSize: 64,40

Decision PVLogitPriceCoef_Lab
Title: PVLogitPriceCoef Label
Definition: Choice(All_PV_Decisions,6,0)
NodeLocation: 768,560,1
NodeSize: 80,40
Aliases: FormNode Fo1539098335
{!40200|Att_ChoiceIndexes: Index All_PV_Decisions}

FormNode Fo1539098335
Title: EVAdEff Label
Definition: 0
NodeLocation: 772,596,1
NodeSize: 140,12
NodeInfo: 1,0,0,0,0,0,0,238,0,,0,,,0
Original: PVLogitPriceCoef_Lab

Variable IncludeLogSpatial_Co
Title: IncludeLogSpatial Coeff
Units: binary
Description: This node evaluates to 1.0 if the decision variable is selected to be included in the optimization, and to 0.0 otherwise.
Definition: PV_Decis_Vars_in_Opt[All_PV_Decisions=PVLogSpatCoef_Label];
NodeLocation: 256,656,1
NodeSize: 80,40
DisplayOutputs: Function Sequential_Opt_PV0, Function Sequential_Opt_PV2

Variable PVLogSpatCoef_Lwr_Bn
Title: PVLogSpatCoef Lwr Bnd
Units: fraction
Description: The lower bound on the corresponding decision variable.
Definition: PV_Dec_Var_Bounds[All_PV_Decisions=PVLogSpatCoef_Label, Upper_Lower=Lower_Label]
NodeLocation: 408,656,1
NodeSize: 72,40

Variable PVLogSpatCoef_Upr_Bn
Title: PVLogSpatCoef Upr Bnd
Units: fraction
Description: The upper bound on the corresponding decision variable.
Definition: PV_Dec_Var_Bounds[All_PV_Decisions=PVLogSpatCoef_Label, Upper_Lower=Upper_Label]
NodeLocation: 560,656,1
NodeSize: 72,40

Decision PVLogSpatCoef_Label
Title: PVLogSpatCoef Label
Definition: Choice(All_PV_Decisions,8,0)
NodeLocation: 768,656,1
NodeSize: 72,40
Aliases: FormNode Fo1539098429
{!40200|Att_ChoiceIndexes: Index All_PV_Decisions}

FormNode Fo1539098429
Title: EVAdEff Label
Definition: 0
NodeLocation: 772,692,1
NodeSize: 140,12
NodeInfo: 1,0,0,0,0,0,0,238,0,,0,,,0
Original: PVLogSpatCoef_Label

Variable IncludeLogTech_Coeff
Title: IncludeLogTech Coeff
Units: binary
Description: This node evaluates to 1.0 if the decision variable is selected to be included in the optimization, and to 0.0 otherwise.
Definition: PV_Decis_Vars_in_Opt[All_PV_Decisions=PVLogTechCoef_Label];
NodeLocation: 256,752,1
NodeSize: 72,40
DisplayOutputs: Function Sequential_Opt_PV0, Function Sequential_Opt_PV2

Variable PVLogTechCoef_Lwr_Bn
Title: PVLogTechCoef Lwr Bnd
Units: fraction
Description: The lower bound on the corresponding decision variable.
Definition: PV_Dec_Var_Bounds[All_PV_Decisions=PVLogTechCoef_Label, Upper_Lower=Lower_Label]
NodeLocation: 408,752,1
NodeSize: 72,40
WindState: 2,231,329,720,447

Variable PVLogTechCoef_Upr_Bn
Title: PVLogTechCoef Upr Bnd
Units: fraction
Description: The upper bound on the corresponding decision variable.
Definition: PV_Dec_Var_Bounds[All_PV_Decisions=PVLogTechCoef_Label, Upper_Lower=Upper_Label]
NodeLocation: 560,752,1
NodeSize: 72,40

Decision PVLogTechCoef_Label
Title: PVLogTechCoef Label
Definition: Choice(All_PV_Decisions,7,0)
NodeLocation: 768,752,1
NodeSize: 72,40
Aliases: FormNode Fo1539119962
{!40200|Att_ChoiceIndexes: Index All_PV_Decisions}

FormNode Fo1539119962
Title: EVAdEff Label
Definition: 0
NodeLocation: 772,788,1
NodeSize: 140,12
NodeInfo: 1,0,0,0,0,0,0,238,0,,0,,,0
Original: PVLogTechCoef_Label

Module Logit_Bound_Calcs
Title: Logit Bound Calcs
Author: JamesMilford
Date: Wed, Oct 10, 2018 9:00 AM
NodeLocation: 760,64,1
NodeSize: 64,40
DiagState: 2,160,99,672,385,17

Decision Market_Share_Swing
Title: Market Share Swing
Units: fraction
Description: The maximum amount that a technology's market share might need to swing (eg, go from 1% to 100% market share).
Definition: 99%
NodeLocation: 144,200,1
NodeSize: 64,40
Aliases: FormNode Fo1539125902
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15

Variable Price_Metric_Diff
Title: Price Metric Differential
Units: pre/post ratio
Description: The maximum differential between cost of electricity ratios across time and competing systems.
Definition: VAR nonZero:=IF Cost_of_Elect_Ratios[PV_Spatial_ID=Aggregation_2_Label] = 0~
   THEN Null~
   ELSE Cost_of_Elect_Ratios[PV_Spatial_ID=Aggregation_2_Label];~
VAR maxim:=MAX(nonZero, Competing_Systems);~
VAR minim:=MIN(nonZero, Competing_Systems);~
~
MAX(maxim - minim, Annual_PV_Time)
NodeLocation: 304,96,1
NodeSize: 64,40
WindState: 2,378,368,720,350
ValueState: 2,360,362,402,228,0,MIDM
Att_ResultSliceState: [Retrofit_System_Type,1,PV_Sectors,1,Annual_PV_Time,1]

Variable Price_Coeff_Bound
Title: Price Coeff Bound
Units: utility/ratio
Description: The value that can be used for upper (+) and lower (-) bounds on logit coefficients that are multiplied by a price metric (eg, price sensitivity coefficients).
Definition: Price_Metric_Diff * Log_Swing_Ratio
NodeLocation: 456,96,1
NodeSize: 64,40
ValueState: 2,408,323,416,390,,MIDM

Variable Log_Swing_Ratio
Title: Log Swing Ratio
Units: dmnls
Description: The natural log of the ratio between the max market share swing and its complement.
Definition: Ln(Market_Share_Swing / (1-Market_Share_Swing))
NodeLocation: 304,200,1
NodeSize: 64,40

Variable Non_Price_Coeff_Boun
Title: Non-Price Coeff Bound
Units: utility
Description: The value that can be used for upper (+) and lower (-) bounds on logit coefficients that are biases/offsets to the overall utility (eg, tech preference and spatial coefficients).
Definition: 2 * Log_Swing_Ratio
NodeLocation: 456,200,1
NodeSize: 64,40

FormNode Fo1539125902
Title: Market Share Swing
Definition: 0
NodeLocation: 144,252,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Market_Share_Swing

Close Logit_Bound_Calcs

Variable Include_Payback_Spat
Title: Include Payback Spat Coeff
Units: binary
Description: This node evaluates to 1.0 if the decision variable is selected to be included in the optimization, and to 0.0 otherwise.
Definition: PV_Decis_Vars_in_Opt[All_PV_Decisions=PVPaybkCoef_Spat_Lab];
NodeLocation: 256,856,1
NodeSize: 64,40
WindState: 2,102,82,720,478
DisplayOutputs: Function Sequential_Opt_PV0, Function Sequential_Opt_PV2

Variable PV_PaybkSpCoef_Lwr_B
Title: PV PaybkSpCoef Lwr Bnd
Units: fraction
Description: The lower bound on the corresponding decision variable.
Definition: PV_Dec_Var_Bounds[All_PV_Decisions=PVPaybkCoef_Spat_Lab, Upper_Lower=Lower_Label]
NodeLocation: 408,856,1
NodeSize: 64,40
WindState: 2,231,329,720,447

Variable PV_PaybSpkCoef_Upr_B
Title: PV PaybSpkCoef Upr Bnd
Units: fraction
Description: The upper bound on the corresponding decision variable.
Definition: PV_Dec_Var_Bounds[All_PV_Decisions=PVPaybkCoef_Spat_Lab, Upper_Lower=Upper_Label]
NodeLocation: 560,856,1
NodeSize: 64,40

Decision PVPaybkCoef_Spat_Lab
Title: PVPaybkCoef Spat Label
Definition: Choice(All_PV_Decisions,9,0)
NodeLocation: 768,856,1
NodeSize: 64,40
Aliases: FormNode Fo1542051313
{!40200|Att_ChoiceIndexes: Index All_PV_Decisions}

FormNode Fo1542051313
Title: EVAdEff Label
Definition: 0
NodeLocation: 772,892,1
NodeSize: 140,12
NodeInfo: 1,0,0,0,0,0,0,238,0,,0,,,0
Original: PVPaybkCoef_Spat_Lab

FormNode Fo1542129973
Title: EVAdEff Label
Definition: 0
NodeLocation: 772,996,2
NodeSize: 140,12
NodeInfo: 1,0,0,0,0,0,0,238,0,,0,,,0
Original: PV_PybkCoef_Label

Decision PV_PybkCoef_Label
Title: PV PybkCoef Label
Definition: Choice(All_PV_Decisions,4,0)
NodeLocation: 768,960,1
NodeSize: 64,40
Aliases: FormNode Fo1542129973
{!40200|Att_ChoiceIndexes: Index All_PV_Decisions}

Variable Include_Payback_Coef
Title: Include Payback Coeff
Definition: PV_Decis_Vars_in_Opt[All_PV_Decisions=PV_PybkCoef_Label];
NodeLocation: 256,960,1
NodeSize: 64,40
DisplayOutputs: Function Sequential_Opt_PV0, Function Sequential_Opt_PV2

Variable PV_PaybkCoef_Upr_Bn1
Title: PV PaybkCoef Upr Bnd
Units: fraction
Description: The upper bound on the corresponding decision variable.
Definition: PV_Dec_Var_Bounds[All_PV_Decisions=PV_PybkCoef_Label, Upper_Lower=Upper_Label]
NodeLocation: 568,960,1
NodeSize: 64,40

Variable PV_PaybkCoef_Lwr_Bn1
Title: PV PaybkCoef Lwr Bnd
Units: fraction
Description: The lower bound on the corresponding decision variable.
Definition: PV_Dec_Var_Bounds[All_PV_Decisions=PV_PybkCoef_Label, Upper_Lower=Lower_Label]
NodeLocation: 416,960,1
NodeSize: 64,40
WindState: 2,231,329,720,447

Close Select_Decision_Var1

Module Multi_Stage_Calibra2
Title: Multi-Stage Calibration Details
Author: coryw
Date: Sun, Aug 5, 2018 8:27 AM
NodeLocation: 120,112,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,77,5,1730,743,17

Button CALIBRATE
Title: CALIBRATE One Sector
Description: This script specifies the multi-state sequence of calibration scripts as follows: ~
~
Step 1: start with calibrating the most aggregate data available (e.g., statewide, or service territory wide), using all historical dates (more data typically available at the aggregate level). Calculation diffusion coefficients (ad eff & WOM) for an assumed aggregate long run market share~
~
Step 2: .....
NodeLocation: 984,528,1
NodeSize: 72,32
NodeInfo: 1,0,0,1,1,1,1,,1,,0,,,
WindState: 2,27,233,1902,588
Aliases: Alias Al1543514124
NodeColor: 49344,49344,49344
NodeFont: Calibri,24
OnClick: {Check_Calib_Dimensio(Indexes_of_Sim_vs_Ac,Required_Indexes_of_); }{checks to ensure extra dimensions are not contained in the output used for calibration, which would increase the dimensionality of stored coefficients}~
Check_Stage_1(PV_Spatial_ID, Spatial_ID, Stages_to_Calibrate); {checks whether all spatial IDs are selected if stage 1 is included in the calibration}~
Multi_Stage_Calibrat(Stages_to_Calibrate, PV_Calibration_Stage, All_Spatial_ID, Failed_Spat_ID, Time_PV_Calibration, Time_Solar_PV, Selected_PV_Decision, All_PV_Decisions, All_PV_Dec_Handles, All_Sectors, Use_Trace_Log, PV_Calibration_Start, PV_Calibration_End, PV_Dates_Incl_by_Stg, PV_Decisions_by_Stg, PV_OptSettings_byStg, Ag_Level_for_PV_Coef, PV_Spatial_ID, PV_Sectors, Current_Stage, PV_Sim_Start_Year, PV_Sim_End_Year, Use_PV_Decision_Var, Dates_Incl_in_PV_Opt, PV_Decis_Vars_in_Opt, Stored_PV_Dec_Vars, Opt_Settings_PV, Stored_Opt_Status_PV, Handle(Optimization_PV))

Button Set_Spatial_ID_to_Fa
Title: Set Spatial ID to Failed Calib
NodeLocation: 984,448,1
NodeSize: 72,32
NodeInfo: 1,0,0,1,1,1,1,,1,,0,,,
WindState: 2,675,5,720,350
Aliases: Alias Al1543514125
NodeColor: 49344,49344,49344
NodeFont: Calibri,19
OnClick: Check_Sector(All_Sectors, PV_Sectors); {checks to ensure only only sector is selected}~
{Check_Calib_Dimensio( Indexes_of_Sim_vs_Ac, Required_Indexes_of_);} {checks to ensure extra dimensions are not contained in the output used for calibration, which would increase the dimensionality of stored coefficients}~
{Check_Cost_Scenario(); }{checks to ensure only one cost scenario is selected}~
(Current_Stage:=2); {sets current stage to 2 so that the R^2 calculations vary by spatial ID, since stage 1 is an aggregate calculation}~
IF size(Failed_Spat_ID)<>0 ~
THEN (PV_Spatial_ID:=Failed_Spat_ID)

Function Check_Sector(all_sectors: Index; der_sectors: Variable)
Title: Check Sector
Description: This function checks to ensure that only one sector is chosen at a time when attempting to run the parameter calibration scripts. If more than one is selected, it returns an error message with instructions to only select one at a time.~
~
[all_sectors]: the index for all sectors.~
[der_sectors]: the sector index for the DER considered in the calibration.
Definition: var x:=[];~
VAR ind_title:=Title of der_sectors;~
IF size(der_sectors)>1 THEN ~
	((x:=AskMsgChoice('Please select only one sector using the "' & der_sectors & '" input setting before attempting to calibrate diffusion parameters.','Sector Selector Message', all_sectors, all_sectors[@all_sectors=1],False,False));~
	(der_sectors := x))~

NodeLocation: 264,528,1
NodeSize: 64,40
WindState: 2,171,237,1335,651
DisplayOutputs: Function Sequential_Opt_PV0, Function Set_Start_Coeff_PV0, Function Sequential_Opt_PV2, Function OG_Sequential_Optimi

Function Check_PV_LRMS_Scen()
Title: Check PV LRMS Scenario
Description: This function checks to ensure that only one PV long run market share scenario is chosen at a time when attempting to run the parameter calibration scripts. If more than one is selected, it returns an error message with instructions to only select one at a time.
Definition: var x:=[];~
IF size(Select_Ag_PV_LRMS)>1 THEN ~
	((x:=AskMsgChoice('Please select only one sector using the Selected PV LRMS Scen input table before attempting to calibrate diffusion parameters.','PV LRMS Selector Message', Aggreg_PV_LRMS, Aggreg_PV_LRMS[@Aggreg_PV_LRMS=1],False,False));~
	(Select_Ag_PV_LRMS := x))~

NodeLocation: 128,528,1
NodeSize: 64,40

Function Check_SpatID_Sel_PV()
Title: Check Spatial ID Selection
Description: This function checks to ensure that only one spatial ID is selected when attempting to assign stored coefficients to the default values.  If more than one is selected, it returns an error message with instructions to only select one at a time.
Definition: var x:=[];~
IF size(PV_Spatial_ID)>1 THEN ~
	((x:=AskMsgChoice('Please select only one Spatial ID before attempting to assign a stored coefficient to the default values.','Spatial ID Selector Message', All_Spatial_ID, All_Spatial_ID[@All_Spatial_ID=1],False,False));~
	(PV_Spatial_ID := x))~

NodeLocation: 128,440,1
NodeSize: 64,40
WindState: 2,36,127,929,350

Variable Qty_Fail_Spat_ID_PV
Title: Qty of Failed Spatial IDs
Description: The total number of Spatial IDs that failed the goodness of fit test (R^2 test).
Definition: sum(R2_Fails_PV[@PV_Sectors=1],PV_Spatial_ID)
NodeLocation: 688,304,1
NodeSize: 64,40
WindState: 2,524,317,720,350
DisplayOutputs: Function MultiStage_CalibrPV0

Index PV_Calibration_Stage
Title: PV Calibration Stage
Definition: 1..Maximum_PV_Calibrati
NodeLocation: 720,176,1
NodeSize: 64,40
ValueState: 2,792,295,416,303,,MIDM
DisplayOutputs: Function MultiStage_CalibrPV0, Function OG_Multi_Stage_Calib
Att_PrevIndexValue: [1,2,3,4,5]

Constant PV_Decisions_by_Stg
Title: PV Decision Variables by Stage
Units: varies
Description: The stored optimal solutions for each decision variable and stage of the optimization.
Definition: Table(All_PV_Decisions,PV_Calibration_Stage)(~
Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),~
Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),~
Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),~
Checkbox(1),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),~
Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),~
Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),~
Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),~
Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),Checkbox(0),~
Checkbox(0),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1))
NodeLocation: 128,64,1
NodeSize: 64,40
WindState: 2,2602,145,720,394
DefnState: 2,764,255,658,291,0,DFNM
ValueState: 2,2228,362,870,303,,MIDM
Aliases: FormNode Fo9, FormNode Fo1535066242
ReformDef: [PV_Calibration_Stage,All_PV_Decisions]
DisplayOutputs: Function MultiStage_CalibrPV0, Function OG_Multi_Stage_Calib
TableCellDefault: checkbox(0)

FormNode Fo1535066242
Title: Decision Variables by Stage
Definition: 0
NodeLocation: 136,108,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: PV_Decisions_by_Stg

Constant PV_Dates_Incl_by_Stg
Title: PV Dates Included by Stage
Description: The time periods considered in the objective function for each stage of the optimization.
Definition: Table(PV_Calibration_Stage,Time_PV_Calibration)(~
Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),~
Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),~
Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),~
Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),~
Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1))
NodeLocation: 264,64,1
NodeSize: 64,40
DefnState: 2,761,-18,723,877,0,DFNM
Aliases: FormNode Fo1535660189, FormNode Fo1535066243
ReformDef: [PV_Calibration_Stage,0]
DisplayOutputs: Function MultiStage_CalibrPV0, Function OG_Multi_Stage_Calib
TableCellDefault: Checkbox(1)

FormNode Fo1535066243
Title: Dates Included by Stage
Definition: 0
NodeLocation: 264,108,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: PV_Dates_Incl_by_Stg

Decision PV_Calibration_Start
Title: PV Calibration Start
Description: The time period for which PV calibration begin.
Definition: Choice(PV_Sim_Strt_Yr_Opt,37,0)
NodeLocation: 112,176,1
NodeSize: 64,40
Aliases: FormNode Fo1542054649, FormNode Fo1535066244
DisplayOutputs: Function MultiStage_CalibrPV0, Function OG_Multi_Stage_Calib
{!40200|Att_ChoiceIndexes: Index PV_Sim_Strt_Yr_Opt}

FormNode Fo1535066244
Title: EV Calibration Start
Definition: 0
NodeLocation: 116,228,1
NodeSize: 84,12
NodeInfo: 1,0,0,0,0,0,0,125,0,,0,,,0
Original: PV_Calibration_Start

Decision PV_Calibration_End
Title: PV Calibration End
Description: The time period for which PV calibration end.
Definition: Choice(PV_Sim_End_Yr_Option,116,0)
NodeLocation: 256,176,1
NodeSize: 64,40
Aliases: FormNode Fo1542054650, FormNode Fo1535066245
DisplayOutputs: Function MultiStage_CalibrPV0, Function OG_Multi_Stage_Calib
{!40200|Att_ChoiceIndexes: Index PV_Sim_End_Yr_Option}

FormNode Fo1535066245
Title: EV Calibration End
Definition: 0
NodeLocation: 260,228,1
NodeSize: 84,12
NodeInfo: 1,0,0,0,0,0,0,125,0,,0,,,0
Original: PV_Calibration_End

Index Time_PV_Calibration
Att_PrevIndexValue: [1-Jan-2012,1-Feb-2012,1-Mar-2012,1-Apr-2012,1-May-2012,1-Jun-2012,1-Jul-2012,1-Aug-2012,1-Sep-2012,1-Oct-2012,1-Nov-2012,1-Dec-2012,1-Jan-2013,1-Feb-2013,1-Mar-2013,1-Apr-2013,1-May-2013,1-Jun-2013,1-Jul-2013,1-Aug-2013,1-Sep-2013,1-Oct-2013,1-Nov-2013,1-Dec-2013,1-Jan-2014,1-Feb-2014,1-Mar-2014,1-Apr-2014,1-May-2014,1-Jun-2014,1-Jul-2014,1-Aug-2014,1-Sep-2014,1-Oct-2014,1-Nov-2014,1-Dec-2014,1-Jan-2015,1-Feb-2015,1-Mar-2015,1-Apr-2015,1-May-2015,1-Jun-2015,1-Jul-2015,1-Aug-2015,1-Sep-2015,1-Oct-2015,1-Nov-2015,1-Dec-2015,1-Jan-2016,1-Feb-2016,1-Mar-2016,1-Apr-2016,1-May-2016,1-Jun-2016,1-Jul-2016,1-Aug-2016,1-Sep-2016,1-Oct-2016,1-Nov-2016,1-Dec-2016,1-Jan-2017,1-Feb-2017,1-Mar-2017,1-Apr-2017,1-May-2017,1-Jun-2017,1-Jul-2017,1-Aug-2017,1-Sep-2017,1-Oct-2017,1-Nov-2017,1-Dec-2017,1-Jan-2018,1-Feb-2018,1-Mar-2018,1-Apr-2018,1-May-2018,1-Jun-2018,1-Jul-2018,1-Aug-2018]
Title: Time PV Calibration
Definition: Sequence(PV_Calibration_Start, PV_Calibration_End,step: Timestep_Months[Timestep_Options=PV_Data_dT_Choice],dateUnit: 'M')
NodeLocation: 848,176,1
NodeSize: 64,40
ValueState: 2,76,132,334,354,,MIDM
DisplayOutputs: Function MultiStage_CalibrPV0, Function OG_Multi_Stage_Calib

Constant PV_OptSettings_byStg
Title: PV Opt Settings by Stage
Description: The solver engine settings for each stage of the optimization.
Definition: Table(Opt_Settings_PV,PV_Calibration_Stage)(~
Checkbox(1),Checkbox(0),Checkbox(1),Checkbox(1),Checkbox(1),~
600,60,60,60,120)
NodeLocation: 400,64,1
NodeSize: 64,40
WindState: 2,102,82,720,541
DefnState: 2,644,333,556,180,0,DFNM
Aliases: FormNode Fo1535602755, FormNode Fo1535066246
DisplayOutputs: Function MultiStage_CalibrPV0, Function OG_Multi_Stage_Calib
TableCellDefault: PV_OptSetting_Deflt

FormNode Fo1535066246
Title: EV Opt Settings by Stage
Definition: 0
NodeLocation: 408,108,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: PV_OptSettings_byStg

Function Set_Spat_ID_Fail_R2(failed_id: Index; der_spatial_id: Variable)
Title: Set Spat ID Fail R2 or Infeas
Description: Sets the Multichoice selector on Selected Spatial ID to all Spatial IDs that failed the goodness of fit R^2 test, or if a spatial ID has not yet returned a feasible solution from the optimization.~
~
[failed_id]: the spatial IDs that failed the goodness of fit test.~
[der_spatial_id]: the spatial ID index used for the DER considered in the calibration.
Definition: IF size(failed_id)<>0 ~
THEN (der_spatial_id:=failed_id)~
ELSE Null
NodeLocation: 264,440,1
NodeSize: 64,40
WindState: 2,118,70,951,499
DisplayOutputs: Function MultiStage_CalibrPV0, Function OG_Multi_Stage_Calib

Index Spatial_ID_PV
Title: Spatial ID PV
Description: This index represents all spatial IDs excluding the "aggregate" spatial ID (e.g., statewide or service territory wide) that is used for calibration purposes).
Definition: subset(NOT All_Agg_Spatial_IDs)
NodeLocation: 720,64,1
NodeSize: 64,40
ValueState: 2,120,122,427,484,,MIDM

Decision Maximum_PV_Calibrati
Title: Maximum PV Calibration Stages
Description: The maximum possible number of PV Calibration stages. Not all of these stages need to be utilized, but this is the largest number for which there are defined input settings. If you increase this number, you must then fill out the remaining inputs below that define the settings for the new calibration stage.
Definition: 5
NodeLocation: 544,176,1
NodeSize: 64,40
Aliases: FormNode Fo1542729201, FormNode Fo1535641468
{!40200|Att_ChoiceIndexes: Index PV_Sim_Strt_Yr_Optio}

FormNode Fo1535641468
Title: EV Calibration Start
Definition: 0
NodeLocation: 544,220,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,72,0,,0,,,0
Original: Maximum_PV_Calibrati

Decision Current_Stage
Title: Current Stage
Units: stage #
Description: The current stage of the multi-stage optimization. This is used to trigger a different optimization objective when Stage 1 is performed and we need to sum over spatial IDs.
Definition: 5
NodeLocation: 544,304,1
NodeSize: 64,40
WindState: 2,325,429,720,350
Aliases: FormNode Fo1542064848, Alias Al1542089624, FormNode Fo1542096039, FormNode Fo1544581665
DisplayOutputs: Function OG_Multi_Stage_Calib
{!40200|Att_ChoiceIndexes: Index PV_Sim_Strt_Yr_Optio}

FormNode Fo1542064848
Title: EV Calibration Start
Definition: 0
NodeLocation: 544,348,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,72,0,,0,,,0
Original: Current_Stage

Decision PV_OptSetting_Deflt
Title: PV Opt Setting Default
Description: The default values for PV optimization settings.
Definition: Table(Opt_Settings_PV)(Checkbox(0),30)
NodeLocation: 400,176,1
NodeSize: 64,40
WindState: 2,-22,397,720,350

Decision Ag_Level_for_PV_Coef
Title: Ag Level for PV Coeff
Description: Select which element you wish to use to store the "aggregate" pv calibration coefficients.
Definition: Choice(All_Spatial_ID,2,0)
NodeLocation: 112,296,1
NodeSize: 64,40
Aliases: FormNode Fo1542127131
DisplayOutputs: Function Sequential_Opt_PV0, Function Set_Start_Coeff_PV0, Function Sequential_Opt_PV2, Function OG_Multi_Stage_Calib, Function OG_Sequential_Optimi
{!40200|Att_ChoiceIndexes: Index All_Spatial_ID}

FormNode Fo1542127131
Title: Element for Storing Aggregate PV Coeff
Definition: 0
NodeLocation: 120,340,1
NodeSize: 80,20
NodeInfo: 1,0,0,0,0,0,0,117,0,,0,,,
Original: Ag_Level_for_PV_Coef

Index Stages_to_Calibrate
Title: Stages to Calibrate
Description: This input allows you to run only certain stages of the multi-stage calibration. For instance, if you've already run stage 1, you need not re-run that stage if you want to keep those coefficients and only focus on subsequent stages for each spatial ID
Definition: MultiChoice(PV_Calibration_Stage,returnList:1)
NodeLocation: 856,64,1
NodeSize: 64,40
WindState: 2,104,268,720,350
Aliases: FormNode Fo1542155941, FormNode Fo1542155775
DisplayOutputs: Function MultiStage_CalibrPV0, Function OG_Multi_Stage_Calib
{!40200|Att_ChoiceIndexes: Index PV_Calibration_Stage}

FormNode Fo1542155775
Title: Stages to Calibrate
Definition: 0
NodeLocation: 860,108,1
NodeSize: 60,20
NodeInfo: 1,0,0,0,0,0,0,78,0,,0,,,
Original: Stages_to_Calibrate

Function Sequential_Opt(stage: Atom; select_decis, decis_handles, all_spatial_id, der_spatial_id, all_sectors: Index; aggreg_level; der_sectors, stored_decis, stored_status, decis_switch: Variable; optDef_handle: Handle)
Title: Sequential Optimization
Description: This function is called by a button script and sequentially optimizes each selected spatial ID's diffusion coefficients. This sequential operation facilitates interruption of the script during the optimization, if desired, and stores each value after its optimization, to avoid losing any coefficients already calculated (e.g., in the event of an abort of the optimization). It only walks through each selected spatial ID relevant to that DER. A separate function is called for the "aggregate calibration" step, which differs by DER. This function can be used for any DER. ~
~
[stage]: the current stage of the multistage calibration being called (an integer).~
[select_decis]: an index of the handles to only the decision variables used in this particular optimization (which can be a subset of all possible decision variables).~
[decis_handles]: an index of the handles of all possible decision variables in the optimization.~
[all_spatial_id]: the index of all spatial IDs.~
[der_spatial_id]: the spatial ID index used for the DER considered in the calibration.~
[all_sectors]: the index for all sectors.~
[aggreg_level]: the label within the spatial ID index indicating the appropriate level of aggregation for the first stage of the calibration.~
[der_sectors]: the sector index for the DER considered in the calibration.~
[stored_decis]: the node where calibrated decision variables will be stored.~
[stored_status]: the node where the optimization status will be stored.~
[decis_switch]: a boolean flag indicating whether decision nodes or stored results will be used in the model logic (true=use decision nodes).~
[optDef]: the handle to the variable where the optimization is defined.
Definition: (decis_switch:=1); {Ensures the optimization uses the actual decision variables when calculating the objective, rather than the stored coefficients}~
Check_Sector(all_sectors, der_sectors);  {Checks to ensure only one sector is selected for the diffusion parameter calibration}~
{Check_Cost_Scenario(); }{Checks to ensure only one cost scenario is selected for the diffusion parameter calibration}~
~
{assign local variables for use in the function}~
local counter:=1;~
local maxcount:=size(der_spatial_id);~
local temp_stored_coeff:=stored_decis;~
local status:=stored_status;~
local solution :=0; {initializes a local variable storing an individual coefficient}~
~
{assign local indexes for use in the function}~
Index orig_ID := IF stage = 1~
   THEN CopyIndex([aggreg_level])~
   ELSE CopyIndex(der_spatial_id);~
~
For i:=orig_ID DO~
	(	ShowProgressBar('Parameter Optimization Status Bar', 'Calibration Stage: ' & stage & '.   Optimizing diffusion parameters for Spatial ID = ' & i & ':  Calculating ID # ' & counter & ' of ' & maxcount, p: ((counter - 0.01) / maxcount));~
		~
		{Updates the local variable's stored decision value to the optimized solution, only for the slice that is the current spatial ID}~
		Local x[]:=select_decis DO~
			(LocalAlias optDefn:=optDef_handle;   {Assign the result, rather than the handle, of the optimization definition to this local Alias}~
                     solution := IgnoreWarnings(OptSolution(IF stage=1 THEN optDefn ELSE optDefn[der_spatial_id=i], x));~
			 status[all_spatial_id=i, all_sectors=der_sectors[@der_sectors=1]] := OptStatusText(IF stage=1 THEN optDefn ELSE optDefn[der_spatial_id=i]);~
			 IF solution <> null THEN temp_stored_coeff[decis_handles=x, all_spatial_id=i, all_sectors=der_sectors[@der_sectors=1]] := solution~
			);~
		(stored_decis:=temp_stored_coeff); {assigns the new solution for each spatial ID to ensure solutions are captured in the event of an abort}~
		(stored_status := status); ~
		counter:=counter+1;	 {increments a counter only for purposes of the ShowProgressBar calculation}~
	);~
~
(decis_switch:=0); {Returns the value of this input to zero to ensure stored coefficients are used in model calculations}
NodeLocation: 400,528,1
NodeSize: 64,40
WindState: 2,511,15,1167,738
DisplayOutputs: Function OG_Multi_Stage_Calib

Index All_PV_Dec_Handles
Att_PrevIndexValue: [PV_Ad_Effectiveness,PV_Word_of_Mouth,PV_Ending_WOM,PV_Payback_Coefficie,PV_LongRun_Mkt_Share,Logit_Price_Coeff,Logit_Tech_Coeff,Logit_Spatial_Coeff,Payback_Spatial_Coef]
Title: All PV Dec Handles
Definition: CopyIndex(Handles_for_PV_Decis)
NodeLocation: 992,64,1
NodeSize: 64,40
WindState: 2,480,227,720,505
ValueState: 2,2404,182,416,303,,MIDM
DisplayOutputs: Function OG_Multi_Stage_Calib
MetaOnly: 1

Alias Al1542407785
Title: Selected PV Decision Variables
Definition: 1
NodeLocation: 1000,176,1
NodeSize: 64,40
Original: Selected_PV_Decision

Alias Al1542407786
Title: Handles for PV Decisions
Definition: 1
NodeLocation: 256,296,1
NodeSize: 64,40
Original: Handles_for_PV_Decis

FormNode Fo1542407786
Title: Select Decision Vars
Definition: 0
NodeLocation: 256,340,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Handles_for_PV_Decis

Function Multi_Stage_Calibrat(select_stages, all_stages, all_spatial_id, failed_id, calib_time, sim_time, select_decis, all_decis, decis_handles, all_sectors: Index; trace_flag, calib_start, calib_end, dates_by_stage, decis_by_stage, setting_by_stage, aggreg_level; der_spatial_id, der_sectors, curr_stage, sim_start, sim_end, decis_switch, dates_in_opt, decis_in_opt, stored_decis, setting_in_opt, stored_status: Variable; optDef_handle: Handle)
Title: Multi-Stage Calibration
Description: This script specifies the multi-state sequence of calibration scripts as follows:~
Step 1: start with calibrating the most aggregate data available (e.g., statewide, or service territory wide), using all historical dates (more data typically available at the aggregate level). Calculation diffusion coefficients (ad eff & WOM) for an assumed aggregate long run market share~
~
Step 2: .....~
~
[select_stages]: the calibration stages selected for the current calibration.~
[all_stages]: an index of all the calibration stages, not just those selected for this calibration.~
[all_spatial_id]: the index of all spatial IDs.~
[failed_id]: the spatial IDs that failed the goodness of fit test.~
[calib_time]: the calibration time index used for the DER considered in the calibration.~
[sim_time]: the simulation time index used for the DER considered in the calibration.~
[select_decis]: an index of handles to the decision variables selected for the optimization.~
[all_decis]: an index of the names of all decision variables.~
[decis_handles]: an index of handles to all decision variables that could be selected.~
[all_sectors]: the index for all sectors.~
[trace_flag]: a boolean flag indicating whether the model will write to trace log during the calibration/optimization process (true=write).~
[calib_start]: the start period for the calibration time.~
[calib_end]: the end period for the calibration time.~
[dates_by_stage]: the dates that will be included in the objective function for each stage of the calibration.~
[decis_by_stage]: the decisions that will be included in the optimization for each stage of the calibration.~
[setting_by_stage]: the optimization engine settings for each stage of the calibration.~
[aggreg_level]: the label within the spatial ID index indicating the appropriate level of aggregation for the first stage of the calibration.~
[der_spatial_id]: the spatial ID index used for the DER considered in the calibration.~
[der_sectors]: the sector index for the DER considered in the calibration.~
[curr_stage]: the current stage being evaluated.~
[sim_start]: the start period for the simulation time of the DER considered in the calibration.~
[sim_end]: the end period for the simulation time of the DER considered in the calibration.~
[decis_switch]: a boolean flag indicating whether decision nodes or stored results will be used in the model logic (true=use decision nodes).~
[dates_in_opt]: the dates used in the current optimization.~
[decis_in_opt]: the decisions that are used in the current optimization.~
[stored_decis]: the node where calibrated decision variables will be stored.~
[setting_in_opt]: the optimization engine settings applied to the current optimization.~
[stored_status]: the node where the optimization status will be stored.~
[optDef_handle]: the handle to the variable where the optimization is defined.
Definition: IF (trace_flag AND size(select_stages)>1) THEN MsgBox('Optimization text trace is on. It will not work when optimizing more than one stage. Please turn it off and then re-run the calibration, or run only one stage.', 5, 'Optimization Trace Message' ) ;~
INDEX origIDs:=CopyIndex(der_spatial_id);   {Temporarily store the selected IDs}~
(sim_start:=calib_start); {Sets the start year for the simulation to the start time for the EV calibration}~
(sim_end:=calib_end); {Sets the end year for the simulation to the end time for the EV calibration}~
(decis_switch:=0); {Deselects the input that uses the decision variables in the model, so that R^2 failures can be calculated}~
Index stage:=CopyIndex(select_stages);~
~
For i:=stage DO (~
   (curr_stage:=i);   {Store the current stage in a global variable}~
   (dates_in_opt:=dates_by_stage[all_stages=i, calib_time=sim_time]); {Selects all dates for use in the calibration}~
   (decis_in_opt:=decis_by_stage[all_stages=i]); {Selects only those decision variables used in the given calibration stage}~
   (setting_in_opt:=setting_by_stage[all_stages=i]); {Adjusts the optimization engine settings per the calibration stage}~
   IF (size(failed_id)<>0 OR curr_stage=1 OR size(select_stages)=1) ~
   THEN Sequential_Opt(i,  select_decis, decis_handles, all_spatial_id, der_spatial_id, all_sectors ,aggreg_level, der_sectors, stored_decis, stored_status, decis_switch, optDef_handle); {Runs the optimization and assigns best fit coefficients to the stored coefficients, but only if there are spatial IDs that have failed the goodness of fit test}~
   IF i=1 THEN Set_Starting_Coeff(all_sectors, all_spatial_id, der_spatial_id, aggreg_level, der_sectors, stored_decis, stored_status); {Sets starting coefficients for all spatial IDs to the value just calculated for the aggregate spatial ID that will be used for setting default coefficients. }~
   IF i>=2 THEN Set_Spat_ID_Fail_R2(failed_id, der_spatial_id); {Set the spatial ID selector to all spatial IDs that failed the goodness of fit test, except for the "aggregate" calibration and for the very first calibration (stage 2) of all spatial IDs}	~
);~
~
(der_spatial_id:=CopyIndex(origIDs));   {Set the selected IDs back to their original values}~
(decis_in_opt:=@all_decis > 0);   {Select all decision variables again so that model can be manually forced to use decision variables by simply checking the box}
NodeLocation: 400,440,1
NodeSize: 64,40
WindState: 2,41,-1,1370,922
DisplayOutputs: Decision Dates_Incl_in_PV_Opt, Decision Opt_Settings_PV

Function Set_Starting_Coeff(all_sectors, all_spatial_id, der_spatial_id: Index; aggreg_level; der_sectors, stored_decis, stored_status: Variable)
Title: Set Starting Coeff
Description: This function sets the values of the starting coefficients for all Spatial IDs. This function is typically called AFTER calibrating aggregate adoption.~
~
This function must be called from within an optimization script to ensure that only one Sector & only one EV long run market share scenario are selected.~
~
[all_sectors]: the index for all sectors.~
[all_spatial_id]: the index for all spatial IDs.~
[der_spatial_id]: the spatial ID index used for the DER considered in the calibration.~
[aggreg_level]: the label within the spatial ID index indicating the appropriate level of aggregation for the first stage of the calibration.~
[der_sectors]: the sector index for the DER considered in the calibration.~
[stored_decis]: the node where calibrated decision variables will be stored.~
[stored_status]: the node where the optimization status will be stored.
Definition: Check_Sector(all_sectors, der_sectors);~
~
local coeff:=stored_decis;~
local status:=stored_status;~
~
local active_sector:=Slice(der_sectors,1);~
~
(coeff[all_sectors=active_sector, all_spatial_id=der_spatial_id]:=stored_decis[all_spatial_id=aggreg_level, all_sectors=active_sector]);~
(status[all_sectors=active_sector, all_spatial_id=der_spatial_id]:='Not Yet Calibrated');~
~
(stored_decis:=coeff);~
(stored_status:=status);~

NodeLocation: 528,440,1
NodeSize: 64,40
WindState: 2,58,81,1322,764
DisplayOutputs: Function OG_Multi_Stage_Calib

Module OLD1
Title: OLD
Author: coryw
Date: Mon, Nov 19, 2018 11:20 AM
NodeLocation: 128,760,1
NodeSize: 64,40

Module Old
Title: Old
Author: coryw
Date: Wed, Nov 14, 2018 4:10 PM
NodeLocation: 144,80,1
NodeSize: 64,40

Button Set_ID_to_FailR2_PV
Title: Set Spatial ID Selected to Failed R2
Description: Sets the Multichoice selector on Selected Spatial ID to all Spatial IDs that failed the goodness of fit R^2 test.
NodeLocation: 464,64,1
NodeSize: 64,40
WindState: 2,32,478,720,350
OnClick: Set_Spat_ID_Fail_R2(Failed_Spat_ID, PV_Spatial_ID)

Function Sequential_Opt_PV0(stage: optional number)
Title: Sequential Optimization
Description: This function is called by a button script and sequentially optimizes each selected spatial ID's diffusion coefficients. This sequential operation facilitates interruption of the script during the optimization, if desired, and stores each value after its optimization, to avoid losing any coefficients already calculated (e.g., in the event of an abort of the optimization). ~
~
input stage = atomic, optional (which stage of the calibration, when running script from a multistage calibration script)~

Definition: (Use_PV_Decision_Var:=1); {Ensures the optimization uses the actual decision variables when calculating the objective, rather than the stored coefficients}~
Check_Sector();  {Checks to ensure only one sector is selected for the diffusion parameter calibration}~
local AdEff := Stored_AdEff_PV;~
local LRMS := Stored_LRMS_PV;~
local WOM := Stored_WOM_PV;~
local InitFam := Stored_End_WOM_PV;~
local priceCoef := Stored_Logit_Price_C;~
local techCoef := Stored_Tech_Coeff;~
local spatialCoef := Stored_Spatial_Coeff;~
local paybkSpatCoef := Stored_Pybk_SpatCoef;~
local paybkCoef := Stored_Payback_Coeff;~
local Status := Stored_Opt_Status_PV;~
All_Stored_Coeffs_PV;  {Forces recompute of all stored decision variables}~
local counter:=1;~
Index orig_ID := CopyIndex(PV_Spatial_ID);~
Index ID := IF stage = 1~
   THEN CopyIndex([Ag_Level_for_PV_Coef])~
   ELSE CopyIndex(PV_Spatial_ID);~
local maxcount:=size(ID);~
~
For i:=ID DO~
	(~
			~
		ShowProgressBar('Parameter Optimization Status Bar', 'Calibration Stage: ' & stage & '.   Optimizing diffusion parameters for Spatial ID = ' & i & ':  Calculating ID # ' & counter & ' of ' & maxcount, p: ((counter - 0.01) / maxcount));~
		IF stage <> 1 THEN (PV_Spatial_ID := [i]);  {re-assignes the value ot the spatial ID index to be a single element}~
		~
		{Updates the local variable's stored decision value to the optimized solution, only for the slice that is the current spatial ID}~
		IF Include_Ad_Effect THEN (AdEff[All_Spatial_ID=i, All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(Optimization_PV[PV_Spatial_ID=i], PV_Ad_Effectiveness)) ;~
		IF Include_LRMS THEN (LRMS[All_Spatial_ID=i, All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(Optimization_PV[PV_Spatial_ID=i], PV_LongRun_Mkt_Share));  {already check to ensure only 1 EV LRMS scenario selected, so this just reduces from a list to a scalar}~
 		IF Include_Start_WOM THEN (WOM[All_Spatial_ID=i, All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(Optimization_PV[PV_Spatial_ID=i], PV_Word_of_Mouth));~
		IF Include_End_WOM THEN (InitFam[All_Spatial_ID=i, All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(Optimization_PV[PV_Spatial_ID=i], PV_Ending_WOM));~
		IF IncludeLogitPrice_Co THEN (priceCoef[All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(Optimization_PV[PV_Spatial_ID=i], Logit_Price_Coeff));~
		IF IncludeLogTech_Coeff THEN (techCoef[All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(Optimization_PV[PV_Spatial_ID=i], Logit_Tech_Coeff));~
		IF IncludeLogSpatial_Co THEN (spatialCoef[All_Spatial_ID=i, All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(Optimization_PV[PV_Spatial_ID=i], Logit_Spatial_Coeff));~
		IF Include_Payback_Spat THEN (paybkSpatCoef[All_Spatial_ID=i, All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(Optimization_PV[PV_Spatial_ID=i], Payback_Spatial_Coef));~
		IF Include_Payback_Coef THEN (paybkCoef[All_Spatial_ID=i, All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(Optimization_PV[PV_Spatial_ID=i], PV_Payback_Coefficie));~
~
		Status[All_Spatial_ID=i, All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptStatusText(Optimization_PV[PV_Spatial_ID=i]);~
~
		{Code below assigns the global stored decision variable data to the value of the local variable, which is updated after each spatial ID optimization}~
		{We do this inside the For Loop rather than after in case the optimization has to be aborted, to avoid losing previously calculated parameters after the abort}~
~
		(Stored_AdEff_PV:= AdEff);~
		(Stored_LRMS_PV:= LRMS);~
		(Stored_WOM_PV:= WOM);~
		(Stored_End_WOM_PV:= InitFam);~
             (Stored_Logit_Price_C:= priceCoef);~
             (Stored_Tech_Coeff:= techCoef);~
		(Stored_Pybk_SpatCoef:= paybkSpatCoef);~
		(Stored_Opt_Status_PV:= Status);~
		(Stored_Payback_Coeff:=paybkCoef);~
~
~
		counter:=counter+1;	~
	);~
(PV_Spatial_ID:=CopyIndex(orig_ID)); {sets the selected spatial ID back to its original value at the beginning of the optimization}~
(Use_PV_Decision_Var:=0); {Returns the value of this input to zero to ensure stored coefficients are used in model calculations}~

NodeLocation: 608,288,1
NodeSize: 64,40
WindState: 2,124,16,1552,780
DisplayInputs: Index All_Spatial_ID, Index All_Sectors, Variable Include_Ad_Effect, Variable Include_Start_WOM, Variable Include_LRMS, Variable Include_End_WOM, Variable IncludeLogitPrice_Co, Variable IncludeLogSpatial_Co, Variable IncludeLogTech_Coeff, Variable Include_Payback_Spat, Variable Include_Payback_Coef, Function Check_Sector, Decision Ag_Level_for_PV_Coef, Variable Optimization_PV, Variable Stored_AdEff_PV, Variable Stored_LRMS_PV, Variable Stored_WOM_PV, Variable Stored_End_WOM_PV, Variable All_Stored_Coeffs_PV, Constant Stored_Opt_Status_PV, Variable Stored_Spatial_Coeff, Variable Stored_Logit_Price_C, Variable Stored_Tech_Coeff, Variable Stored_Pybk_SpatCoef, Variable Stored_Payback_Coeff, Index PV_Sectors, Index PV_Spatial_ID

Function Aggregate_Optimizati()
Title: Aggregate Optimization
Description: This function is called by a button script and optimizes a single set of coefficients that will be used for all PV Spatial IDs to get the starting point estimate for 3 key coefficients: ~
1. Payback price coefficient (or logit coefficients??)~
2. WOM~
3. Ad Effectiveness~
~

Definition: (Use_PV_Decision_Var:=1); {Ensures the optimization uses the actual decision variables when calculating the objective, rather than the stored coefficients}~
Check_Sector(All_Sectors, PV_Sectors);  {Checks to ensure only one sector is selected for the diffusion parameter calibration}~
(Current_Stage:=1); {Sets current stage to 1 to ensure that the objective function sums over all selected PV spatial IDs}~
(PV_Decis_Vars_in_Opt:= PV_Decisions_by_Stg[PV_Calibration_Stage=1]);  {assigns which decision variables are to be used in the aggregate calibration, which is the first stage of the optimization}~
Index orig_ID := CopyIndex(PV_Spatial_ID);  {temporarily stores the originally selected PV spatial ID elements, for re-assignment later}~
(PV_Spatial_ID:=Spatial_ID_PV);  {Selects all non-aggregate spatial ID elements. This could be changed in the future if we want to use a different set of spatial IDs for the aggregate calibration step}~
(Opt_Settings_PV:=PV_OptSettings_byStg[PV_Calibration_Stage=1]); {Adjusts the optimization engine settings per the calibration stage}~
~
{section below stores locally all of the currently stored PV coefficients to facilitate assigning the aggregate solution to just the aggregate element of those stored coefficients}~
local AdEff := Stored_AdEff_PV;~
local LRMS := Stored_LRMS_PV;~
local WOM := Stored_WOM_PV;~
local InitFam := Stored_End_WOM_PV;~
local priceCoef := Stored_Logit_Price_C;~
local techCoef := Stored_Tech_Coeff;~
local spatialCoef := Stored_Spatial_Coeff;~
local paybkSpatCoef := Stored_Pybk_SpatCoef;~
local paybkCoef := Stored_Payback_Coeff;~
local Status := Stored_Opt_Status_PV;~
All_Stored_Coeffs_PV;  {Forces recompute of all stored decision variables}~
local i:= Ag_Level_for_PV_Coef; {just to simplify the code below, assigns to a local variable the value of the element selected for storing the aggregate coefficients}~
		~
{Updates the local variable's stored decision value to the optimized solution, only for the slice that is the selected element for storing the aggregate solution}~
IF Include_Ad_Effect THEN (AdEff[All_Spatial_ID=i, All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(Optimization_PV, PV_Ad_Effectiveness)) ;~
IF Include_LRMS THEN (LRMS[All_Spatial_ID=i, All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(Optimization_PV, PV_LongRun_Mkt_Share));  {already check to ensure only 1 EV LRMS scenario selected, so this just reduces from a list to a scalar}~
 IF Include_Start_WOM THEN (WOM[All_Spatial_ID=i, All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(Optimization_PV, PV_Word_of_Mouth));~
IF Include_End_WOM THEN (InitFam[All_Spatial_ID=i, All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(Optimization_PV, PV_Ending_WOM));~
IF IncludeLogitPrice_Co THEN (priceCoef[All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(Optimization_PV, Logit_Price_Coeff));~
IF IncludeLogTech_Coeff THEN (techCoef[All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(Optimization_PV, Logit_Tech_Coeff));~
IF IncludeLogSpatial_Co THEN (spatialCoef[All_Spatial_ID=i, All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(Optimization_PV, Logit_Spatial_Coeff));~
IF Include_Payback_Spat THEN (paybkSpatCoef[All_Spatial_ID=i, All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(Optimization_PV, Payback_Spatial_Coef));~
IF Include_Payback_Coef THEN (paybkCoef[All_Spatial_ID=i, All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(Optimization_PV, PV_Payback_Coefficie));~
Status[All_Spatial_ID=i, All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptStatusText(Optimization_PV);~
~
{Code below assigns the global stored decision variable data to the value of the local variable, which is updated after each spatial ID optimization}~
~
(Stored_AdEff_PV:= AdEff);~
(Stored_LRMS_PV:= LRMS);~
(Stored_WOM_PV:= WOM);~
(Stored_End_WOM_PV:= InitFam);~
(Stored_Logit_Price_C:= priceCoef);~
(Stored_Tech_Coeff:= techCoef);~
(Stored_Pybk_SpatCoef:= paybkSpatCoef);~
(Stored_Opt_Status_PV:= Status);~
(Stored_Payback_Coeff:=paybkCoef);~
~
(PV_Spatial_ID:=CopyIndex(orig_ID)); {sets the selected spatial ID back to its original value at the beginning of the optimization}~
(Use_PV_Decision_Var:=0); {Returns the value of this input to zero to ensure stored coefficients are used in model calculations}~

NodeLocation: 448,288,1
NodeSize: 64,40
WindState: 2,125,10,1511,758

Button Run_Aggregate_Calibr
Title: Run Aggregate Calibration
NodeLocation: 256,64,1
NodeSize: 64,40
OnClick: Aggregate_Optimizati()

Button Run_1_Cal_PV
Title: Run 1 Cal PV
NodeLocation: 304,256,1
NodeSize: 64,40
WindState: 2,130,373,1271,381
OnClick: {runs through an optimization for each spatial ID and assigned the results to the relevant stored coefficient node}~
Sequential_Opt(Current_Stage, Selected_PV_Decision,  All_PV_Dec_Handles, All_Spatial_ID, PV_Spatial_ID, All_Sectors, Ag_Level_for_PV_Coef, PV_Sectors, Stored_PV_Dec_Vars, Stored_Opt_Status_PV, Use_PV_Decision_Var, Handle(Optimization_PV));~
~


Button Run_Single_Optimizat
Title: Run Single Optimization
NodeLocation: 112,152,1
NodeSize: 64,40
WindState: 2,12,349,1352,535
OnClick: Sequential_Opt(Current_Stage, Selected_PV_Decision,  All_PV_Dec_Handles, All_Spatial_ID, PV_Spatial_ID, All_Sectors, Ag_Level_for_PV_Coef, PV_Sectors, Stored_PV_Dec_Vars, Stored_Opt_Status_PV, Use_PV_Decision_Var, Handle(Optimization_PV));

Button Set_Starting_Coeff1
Title: Set Starting Coeff
NodeLocation: 288,144,1
NodeSize: 64,40
WindState: 2,932,27,720,350
OnClick: Set_Starting_Coeff(All_Sectors, All_Spatial_ID, PV_Spatial_ID, Ag_Level_for_PV_Coef, PV_Sectors, Stored_PV_Dec_Vars, Stored_Opt_Status_PV)

Close Old

Function MultiStage_CalibrPV0()
Title: Multi-Stage Calibration
Description: This script specifies the multi-state sequence of calibration scripts as follows: ~
~
Step 1: start with calibrating the most aggregate data available (e.g., statewide, or service territory wide), using all historical dates (more data typically available at the aggregate level). Calculation diffusion coefficients (ad eff & WOM) for an assumed aggregate long run market share~
~
Step 2: .....~

Definition: INDEX origIDs:=CopyIndex(PV_Spatial_ID);   {Temporarily store the selected IDs}~
(PV_Sim_Start_Year:=PV_Calibration_Start); {Sets the start year for the simulation to the start time for the EV calibration}~
(PV_Sim_End_Year:=PV_Calibration_End); {Sets the end year for the simulation to the end time for the EV calibration}~
(Use_PV_Decision_Var:=0); {Deselects the input that uses the decision variables in the model, so that R^2 failures can be calculated}~
Index stage:=CopyIndex(Stages_to_Calibrate);~
~
		For i:=stage DO~
		(~
                    (Current_Stage:=i);   {Store the current stage in a global variable}~
			(Dates_Incl_in_PV_Opt:=PV_Dates_Incl_by_Stg[PV_Calibration_Stage=i, Time_PV_Calibration=Time_Solar_PV]); {Selects all dates for use in the calibration}~
			(PV_Decis_Vars_in_Opt:=PV_Decisions_by_Stg[PV_Calibration_Stage=i]); {Selects only those decision variables used in the given calibration stage}~
			(Opt_Settings_PV:=PV_OptSettings_byStg[PV_Calibration_Stage=i]); {Adjusts the optimization engine settings per the calibration stage}~
			IF Qty_Fail_Spat_ID_PV<>0 THEN Sequential_Opt_PV2(i); {Runs the optimization and assigns best fit coefficients to the stored coefficients, but only if there are spatial IDs that have failed the goodness of fit test}~
			IF i=1 THEN Set_Start_Coeff_PV(); {Sets starting coefficients for all spatial IDs to the value just calculated for the aggregate spatial ID that will be used for setting default coefficients. }~
			(PV_Spatial_ID:=Subset(@origIDs<>Aggregation_2_Label)); {Selects all non-aggregated spatial IDs}~
			IF i>=2 THEN Set_Spat_ID_Fail_R2(); {Set the spatial ID selector to all spatial IDs that failed the goodness of fit test, except for the "aggregate" calibration and for the very first calibration (stage 2) of all spatial IDs}	~
		);~
~
(PV_Spatial_ID:=CopyIndex(origIDs));   {Set the selected IDs back to their original values}~
(PV_Decis_Vars_in_Opt:=@All_PV_Decisions > 0);   {Select all decision variables again so that model can be manually forced to use decision variables by simply checking the box}~

NodeLocation: 128,336,1
NodeSize: 64,40
WindState: 2,6,58,888,787
DisplayInputs: Decision Aggregation_2_Label, Variable Qty_Fail_Spat_ID_PV, Index PV_Calibration_Stage, Constant PV_Decisions_by_Stg, Constant PV_Dates_Incl_by_Stg, Decision PV_Calibration_Start, Decision PV_Calibration_End, Index Time_PV_Calibration, Constant PV_OptSettings_byStg, Function Set_Spat_ID_Fail_R2, Index Stages_to_Calibrate, Function Set_Start_Coeff_PV0, Function Sequential_Opt_PV2, Index All_PV_Decisions, Index Time_Solar_PV, Index PV_Spatial_ID

Button Run_MultistgCalib_PV
Title: Run Multistage Calibration
Description: This script specifies the multi-state sequence of calibration scripts as follows: ~
~
Step 1: start with calibrating the most aggregate data available (e.g., statewide, or service territory wide), using all historical dates (more data typically available at the aggregate level). Calculation diffusion coefficients (ad eff & WOM) for an assumed aggregate long run market share~
~
Step 2: .....
NodeLocation: 680,136,1
NodeSize: 64,40
WindState: 2,102,82,1000,391
OnClick: {Reset_All_Coeffs_PV;}~
MultiStage_CalibrPV0()

Button Set_Start_Coeffs_PV
Title: Set Starting Coeff
Description: This function sets the values of the starting coefficients for all Spatial IDs. This function is typically called AFTER calibrating aggregate adoption.~
~
This function must be called from within an optimization script to ensure that only one Sector & only one PV long run market share scenario are selected.
NodeLocation: 512,136,1
NodeSize: 64,40
OnClick: Set_Start_Coeff_PV0()

Function Set_Start_Coeff_PV0()
Title: Set Starting Coeff
Description: This function sets the values of the starting coefficients for all Spatial IDs. This function is typically called AFTER calibrating aggregate adoption.~
~
This function must be called from within an optimization script to ensure that only one Sector & only one EV long run market share scenario are selected.
Definition: Check_Sector();~
~
local AdEff:=Stored_AdEff_PV;~
local StartWOM:=Stored_WOM_PV;~
local EndWOM:=Stored_End_WOM_PV;~
local InitFam:=Stored_End_WOM_PV;~
local LRMS:=Stored_LRMS_PV;~
local priceCoef:=Stored_Logit_Price_C;~
local techCoef:=Stored_Tech_Coeff;~
local spatialCoef:=Stored_Spatial_Coeff;~
local paybkSpatCoef:=Stored_Pybk_SpatCoef;~
local paybkCoef:=Stored_Payback_Coeff;~
local status:=Stored_Opt_Status_PV;~
~
local Sector_Sel:=Slice(PV_Sectors,1);~
~
(AdEff[All_Sectors=Sector_Sel, All_Spatial_ID=PV_Spatial_ID]:=Stored_AdEff_PV[All_Spatial_ID=Ag_Level_for_PV_Coef, All_Sectors=Sector_Sel]);~
(StartWOM[All_Sectors=Sector_Sel, All_Spatial_ID=PV_Spatial_ID]:=Stored_WOM_PV[ All_Spatial_ID=Ag_Level_for_PV_Coef, All_Sectors=Sector_Sel]);~
(EndWOM[All_Sectors=Sector_Sel, All_Spatial_ID=PV_Spatial_ID]:=Stored_End_WOM_PV[ All_Spatial_ID=Ag_Level_for_PV_Coef, All_Sectors=Sector_Sel]);~
(InitFam[All_Sectors=Sector_Sel, All_Spatial_ID=PV_Spatial_ID]:=Stored_End_WOM_PV[All_Spatial_ID=Ag_Level_for_PV_Coef, All_Sectors=Sector_Sel]);~
(LRMS[All_Sectors=Sector_Sel, All_Spatial_ID=PV_Spatial_ID]:=Stored_LRMS_PV[All_Spatial_ID=Ag_Level_for_PV_Coef, All_Sectors=Sector_Sel]);~
(priceCoef[All_Sectors=Sector_Sel, All_Spatial_ID=PV_Spatial_ID]:=Stored_Logit_Price_C[All_Spatial_ID=Ag_Level_for_PV_Coef, All_Sectors=Sector_Sel]);~
(techCoef[All_Sectors=Sector_Sel, All_Spatial_ID=PV_Spatial_ID]:=Stored_Tech_Coeff[All_Spatial_ID=Ag_Level_for_PV_Coef, All_Sectors=Sector_Sel]);~
(spatialCoef[All_Sectors=Sector_Sel, All_Spatial_ID=PV_Spatial_ID]:=Stored_Spatial_Coeff[All_Spatial_ID=Ag_Level_for_PV_Coef, All_Sectors=Sector_Sel]);~
(paybkSpatCoef[All_Sectors=Sector_Sel, All_Spatial_ID=PV_Spatial_ID]:=Stored_Pybk_SpatCoef[All_Spatial_ID=Ag_Level_for_PV_Coef, All_Sectors=Sector_Sel]);~
(paybkCoef[All_Sectors=Sector_Sel, All_Spatial_ID=PV_Spatial_ID]:=Stored_Payback_Coeff[All_Spatial_ID=Ag_Level_for_PV_Coef, All_Sectors=Sector_Sel]);~
~
(status[All_Sectors=Sector_Sel, All_Spatial_ID=PV_Spatial_ID]:=Stored_Opt_Status_PV[All_Spatial_ID=Ag_Level_for_PV_Coef, All_Sectors=Sector_Sel]);~
~
(Stored_AdEff_PV:=AdEff);~
(Stored_WOM_PV:=StartWOM);~
(Stored_End_WOM_PV:=EndWOM);~
(Stored_End_WOM_PV:=InitFam);~
(Stored_LRMS_PV:=LRMS);~
(Stored_Logit_Price_C:=priceCoef);~
(Stored_Tech_Coeff:=techCoef);~
(Stored_Spatial_Coeff:=spatialCoef);~
(Stored_Pybk_SpatCoef:=paybkSpatCoef);~
(Stored_Payback_Coeff:=paybkCoef);~
(Stored_Opt_Status_PV:=status);~

NodeLocation: 272,216,1
NodeSize: 64,40
WindState: 2,229,108,1322,764
DisplayInputs: Index All_Spatial_ID, Index All_Sectors, Function Check_Sector, Decision Ag_Level_for_PV_Coef, Variable Stored_AdEff_PV, Variable Stored_LRMS_PV, Variable Stored_WOM_PV, Variable Stored_End_WOM_PV, Constant Stored_Opt_Status_PV, Variable Stored_Spatial_Coeff, Variable Stored_Logit_Price_C, Variable Stored_Tech_Coeff, Variable Stored_Pybk_SpatCoef, Variable Stored_Payback_Coeff, Index PV_Sectors, Index PV_Spatial_ID
DisplayOutputs: Function MultiStage_CalibrPV0

Function Sequential_Opt_PV2(stage: optional number)
Title: Sequential Optimization2
Description: This function is called by a button script and sequentially optimizes each selected spatial ID's diffusion coefficients. This sequential operation facilitates interruption of the script during the optimization, if desired, and stores each value after its optimization, to avoid losing any coefficients already calculated (e.g., in the event of an abort of the optimization). ~
~
input stage = atomic, optional (which stage of the calibration, when running script from a multistage calibration script)~

Definition: (Use_PV_Decision_Var:=1); {Ensures the optimization uses the actual decision variables when calculating the objective, rather than the stored coefficients}~
Check_Sector();  {Checks to ensure only one sector is selected for the diffusion parameter calibration}~
local AdEff := Stored_AdEff_PV;~
local LRMS := Stored_LRMS_PV;~
local WOM := Stored_WOM_PV;~
local InitFam := Stored_End_WOM_PV;~
local priceCoef := Stored_Logit_Price_C;~
local techCoef := Stored_Tech_Coeff;~
local spatialCoef := Stored_Spatial_Coeff;~
local paybkSpatCoef := Stored_Pybk_SpatCoef;~
local paybkCoef := Stored_Payback_Coeff;~
local Status := Stored_Opt_Status_PV;~
All_Stored_Coeffs_PV;  {Forces recompute of all stored decision variables}~
local counter:=1;~
Index orig_ID := CopyIndex(PV_Spatial_ID);~
Index ID := IF stage = 1~
   THEN CopyIndex([Ag_Level_for_PV_Coef])~
   ELSE CopyIndex(PV_Spatial_ID);~
local maxcount:=size(ID);~
~
For i:=ID DO~
	(~
			~
		ShowProgressBar('Parameter Optimization Status Bar', 'Calibration Stage: ' & stage & '.   Optimizing diffusion parameters for Spatial ID = ' & i & ':  Calculating ID # ' & counter & ' of ' & maxcount, p: ((counter - 0.01) / maxcount));~
		IF stage <> 1 THEN (PV_Spatial_ID := [i]);  {re-assignes the value ot the spatial ID index to be a single element}~
		~
		{Updates the local variable's stored decision value to the optimized solution, only for the slice that is the current spatial ID}~
		VAR current_status:= OptStatusNum(IF stage=1 THEN Optimization_PV ELSE Optimization_PV[PV_Spatial_ID=i]);~
		~
		IF current_status <>4 THEN BEGIN  {ensures non-null values will be returned for the coefficients, avoiding NULL coefficients if a feasible solution is not found}~
~
			IF Include_Ad_Effect THEN (AdEff[All_Spatial_ID=i, All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(IF stage=1 THEN Optimization_PV ELSE Optimization_PV[PV_Spatial_ID=i], PV_Ad_Effectiveness)) ;~
			IF Include_LRMS THEN (LRMS[All_Spatial_ID=i, All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(IF stage=1 THEN Optimization_PV ELSE Optimization_PV[PV_Spatial_ID=i], PV_LongRun_Mkt_Share));  {already check to ensure only 1 EV LRMS scenario selected, so this just reduces from a list to a scalar}~
	 		IF Include_Start_WOM THEN (WOM[All_Spatial_ID=i, All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(IF stage=1 THEN Optimization_PV ELSE Optimization_PV[PV_Spatial_ID=i], PV_Word_of_Mouth));~
			IF Include_End_WOM THEN (InitFam[All_Spatial_ID=i, All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(IF stage=1 THEN Optimization_PV ELSE Optimization_PV[PV_Spatial_ID=i], PV_Ending_WOM));~
			IF IncludeLogitPrice_Co THEN (priceCoef[All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(IF stage=1 THEN Optimization_PV ELSE Optimization_PV[PV_Spatial_ID=i], Logit_Price_Coeff));~
			IF IncludeLogTech_Coeff THEN (techCoef[All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(IF stage=1 THEN Optimization_PV ELSE Optimization_PV[PV_Spatial_ID=i], Logit_Tech_Coeff));~
			IF IncludeLogSpatial_Co THEN (spatialCoef[All_Spatial_ID=i, All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(IF stage=1 THEN Optimization_PV ELSE Optimization_PV[PV_Spatial_ID=i], Logit_Spatial_Coeff));~
			IF Include_Payback_Spat THEN (paybkSpatCoef[All_Spatial_ID=i, All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(IF stage=1 THEN Optimization_PV ELSE Optimization_PV[PV_Spatial_ID=i], Payback_Spatial_Coef));~
			IF Include_Payback_Coef THEN (paybkCoef[All_Spatial_ID=i, All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptSolution(IF stage=1 THEN Optimization_PV ELSE Optimization_PV[PV_Spatial_ID=i], PV_Payback_Coefficie));~
		~
		END;~
~
		Status[All_Spatial_ID=i, All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptStatusText(IF stage=1 THEN Optimization_PV ELSE Optimization_PV[PV_Spatial_ID=i]);~
~
		{Code below assigns the global stored decision variable data to the value of the local variable, which is updated after each spatial ID optimization}~
		{We do this inside the For Loop rather than after in case the optimization has to be aborted, to avoid losing previously calculated parameters after the abort}~
~
		(Stored_AdEff_PV:= AdEff);~
		(Stored_LRMS_PV:= LRMS);~
		(Stored_WOM_PV:= WOM);~
		(Stored_End_WOM_PV:= InitFam);~
             (Stored_Logit_Price_C:= priceCoef);~
             (Stored_Tech_Coeff:= techCoef);~
		(Stored_Pybk_SpatCoef:= paybkSpatCoef);~
		(Stored_Opt_Status_PV:= Status);~
		(Stored_Payback_Coeff:=paybkCoef);~
~
~
		counter:=counter+1;	~
	);~
(PV_Spatial_ID:=CopyIndex(orig_ID)); {sets the selected spatial ID back to its original value at the beginning of the optimization}~
(Use_PV_Decision_Var:=0); {Returns the value of this input to zero to ensure stored coefficients are used in model calculations}~

NodeLocation: 112,208,1
NodeSize: 64,40
WindState: 2,21,23,1717,780
DisplayInputs: Index All_Spatial_ID, Index All_Sectors, Variable Include_Ad_Effect, Variable Include_Start_WOM, Variable Include_LRMS, Variable Include_End_WOM, Variable IncludeLogitPrice_Co, Variable IncludeLogSpatial_Co, Variable IncludeLogTech_Coeff, Variable Include_Payback_Spat, Variable Include_Payback_Coef, Function Check_Sector, Decision Ag_Level_for_PV_Coef, Variable Optimization_PV, Variable Stored_AdEff_PV, Variable Stored_LRMS_PV, Variable Stored_WOM_PV, Variable Stored_End_WOM_PV, Variable All_Stored_Coeffs_PV, Constant Stored_Opt_Status_PV, Variable Stored_Spatial_Coeff, Variable Stored_Logit_Price_C, Variable Stored_Tech_Coeff, Variable Stored_Pybk_SpatCoef, Variable Stored_Payback_Coeff, Index PV_Sectors, Index PV_Spatial_ID
DisplayOutputs: Function MultiStage_CalibrPV0

Function OG_Multi_Stage_Calib()
Title: OG Multi-Stage Calibration3
Description: This script specifies the multi-state sequence of calibration scripts as follows: ~
~
Step 1: start with calibrating the most aggregate data available (e.g., statewide, or service territory wide), using all historical dates (more data typically available at the aggregate level). Calculation diffusion coefficients (ad eff & WOM) for an assumed aggregate long run market share~
~
Step 2: .....~

Definition: IF (Use_Trace_Log AND size(Stages_to_Calibrate)>1) THEN MsgBox('Optimization text trace is on. It will not work when optimizing more than one stage. Please turn it off and then re-run the calibration, or run only one stage.', 5, 'Optimization Trace Message' ) ;~
INDEX origIDs:=CopyIndex(PV_Spatial_ID);   {Temporarily store the selected IDs}~
(PV_Sim_Start_Year:=PV_Calibration_Start); {Sets the start year for the simulation to the start time for the EV calibration}~
(PV_Sim_End_Year:=PV_Calibration_End); {Sets the end year for the simulation to the end time for the EV calibration}~
(Use_PV_Decision_Var:=0); {Deselects the input that uses the decision variables in the model, so that R^2 failures can be calculated}~
Index stage:=CopyIndex(Stages_to_Calibrate);~
~
		For i:=stage DO~
		(~
                    (Current_Stage:=i);   {Store the current stage in a global variable}~
			(Dates_Incl_in_PV_Opt:=PV_Dates_Incl_by_Stg[PV_Calibration_Stage=i, Time_PV_Calibration=Time_Solar_PV]); {Selects all dates for use in the calibration}~
			(PV_Decis_Vars_in_Opt:=PV_Decisions_by_Stg[PV_Calibration_Stage=i]); {Selects only those decision variables used in the given calibration stage}~
			(Opt_Settings_PV:=PV_OptSettings_byStg[PV_Calibration_Stage=i]); {Adjusts the optimization engine settings per the calibration stage}~
			IF (size(Failed_Spat_ID)<>0 OR Current_Stage=1 OR size(Stages_to_Calibrate)=1) THEN (Sequential_Opt_PV3(i,  Selected_PV_Decision, All_PV_Dec_Handles, PV_Spatial_ID, Stored_PV_Dec_Vars, Stored_Opt_Status_PV  )); {Runs the optimization and assigns best fit coefficients to the stored coefficients, but only if there are spatial IDs that have failed the goodness of fit test}~
			IF i=1 THEN Set_Starting_Coeff2(); {Sets starting coefficients for all spatial IDs to the value just calculated for the aggregate spatial ID that will be used for setting default coefficients. }~
			(PV_Spatial_ID:=Subset(@origIDs<>Ag_Level_for_PV_Coef)); {Selects all non-aggregated spatial IDs. STILL NECESSARY?}~
			IF i>=2 THEN Set_Spat_ID_Fail_R2(); {Set the spatial ID selector to all spatial IDs that failed the goodness of fit test, except for the "aggregate" calibration and for the very first calibration (stage 2) of all spatial IDs}	~
		);~
~
(PV_Spatial_ID:=CopyIndex(origIDs));   {Set the selected IDs back to their original values}~
(PV_Decis_Vars_in_Opt:=@All_PV_Decisions > 0);   {Select all decision variables again so that model can be manually forced to use decision variables by simply checking the box}~

NodeLocation: 416,336,1
NodeSize: 64,40
WindState: 2,548,7,1208,922
NodeColor: 65535,1,1
DisplayInputs: Index Selected_PV_Decision, Index PV_Calibration_Stage, Constant PV_Decisions_by_Stg, Constant PV_Dates_Incl_by_Stg, Decision PV_Calibration_Start, Decision PV_Calibration_End, Index Time_PV_Calibration, Constant PV_OptSettings_byStg, Function Set_Spat_ID_Fail_R2, Decision Current_Stage, Decision Ag_Level_for_PV_Coef, Index Stages_to_Calibrate, Function Sequential_Opt, Index All_PV_Dec_Handles, Function Set_Starting_Coeff, Index All_PV_Decisions, Index Failed_Spat_ID, Decision Use_Trace_Log, Constant Stored_Opt_Status_PV, Constant Stored_PV_Dec_Vars, Index Time_Solar_PV, Index PV_Spatial_ID

Function OG_Sequential_Optimi(stage: atom; decision_vars, decision_var_super, der_spatial_id: index, stored_coeff: variable, stored_status: variable)
Title: OG Sequential Optimization3
Description: This function is called by a button script and sequentially optimizes each selected spatial ID's diffusion coefficients. This sequential operation facilitates interruption of the script during the optimization, if desired, and stores each value after its optimization, to avoid losing any coefficients already calculated (e.g., in the event of an abort of the optimization). It only walks through each selected spatial ID relevant to that DER. A separate function is called for the "aggregate calibration" step, which differs by DER. This function can be used for any DER. ~
~
~
stage = which stage of the multistage calibration is being called (an integer)~
decision_vars = an index of the handles to only the decision variables used in this particular optimization (which can be a subset of all possible decision variables)~
decision_var_superset = an index of the handles of all possible decision variables in the optimization~
der_spatial_ID = a subset of All_spatial_ID specific to that particular DER; ~
use_dec_var =  handle of a boolean input determining whether the decision variables or the stored coefficients are used in the simulation for a given DER~
stored_coeff = handle of constant node containing a table of stored coefficients indexed by he decision_var_superset index (a list of all handles), All_Spatial_ID, and All_Sectors~
~
~

Definition: (Use_PV_Decision_Var:=1); {Ensures the optimization uses the actual decision variables when calculating the objective, rather than the stored coefficients}~
Check_Sector();  {Checks to ensure only one sector is selected for the diffusion parameter calibration}~
{Check_Cost_Scenario(); }{Checks to ensure only one cost scenario is selected for the diffusion parameter calibration}~
~
{assign local variables for use in the function}~
local counter:=1;~
local maxcount:=size(der_spatial_id);~
local temp_stored_coeff:=Stored_PV_Dec_Vars;~
local status:=Stored_Opt_Status_PV;~
local solution :=0; {initializes a local variable storing an individual coefficient}~
~
{assign local indexes for use in the function}~
Index orig_ID := IF stage = 1~
   THEN CopyIndex([Ag_Level_for_PV_Coef])~
   ELSE CopyIndex(der_spatial_id);~
~
For i:=orig_ID DO~
	(	ShowProgressBar('Parameter Optimization Status Bar', 'Calibration Stage: ' & stage & '.   Optimizing diffusion parameters for Spatial ID = ' & i & ':  Calculating ID # ' & counter & ' of ' & maxcount, p: ((counter - 0.01) / maxcount));~
		~
		{Updates the local variable's stored decision value to the optimized solution, only for the slice that is the current spatial ID}~
		Local x[]:=decision_vars DO~
			( solution := OptSolution(IF stage=1 THEN Optimization_PV ELSE Optimization_PV[PV_Spatial_ID=i], x);~
			status[All_Spatial_ID=i, All_Sectors=PV_Sectors[@PV_Sectors=1]] := OptStatusText(IF stage=1 THEN Optimization_PV ELSE Optimization_PV[PV_Spatial_ID=i]);~
			IF solution <> null THEN 	temp_stored_coeff[decision_var_super=x, All_Spatial_ID=i, All_Sectors=PV_Sectors[@PV_Sectors=1]] := solution~
			);~
		(stored_coeff:=temp_stored_coeff); {assigns the new solution for each spatial ID to ensure solutions are captured in the event of an abort}~
		(stored_status := status); ~
		counter:=counter+1;	 {increments a counter only for purposes of the ShowProgressBar calculation}~
	);~
~
(Use_PV_Decision_Var:=0); {Returns the value of this input to zero to ensure stored coefficients are used in model calculations}
NodeLocation: 280,336,1
NodeSize: 64,40
WindState: 2,25,-1,926,920
DisplayInputs: Index All_Spatial_ID, Index All_Sectors, Function Check_Sector, Decision Ag_Level_for_PV_Coef, Variable Optimization_PV, Constant Stored_Opt_Status_PV, Constant Stored_PV_Dec_Vars, Index PV_Sectors, Index PV_Spatial_ID

Close OLD1

Index All_PV_Decisions
Title: All PV Decisions
Definition: ['PV Ad Effectiveness','PV WOM','PV Ending WOM','PV Payback Coefficient','PV Long Run Mkt Share','PV Logit Price Coeff','PV Logit Tech Coeff','PV Logit Spat Coeff','PV Payback Spat Coeff' ]
NodeLocation: 1128,64,1
NodeSize: 64,40
WindState: 2,246,-2,924,825
ValueState: 2,1020,194,416,303,,MIDM
DisplayOutputs: Function MultiStage_CalibrPV0, Function OG_Multi_Stage_Calib
Att_PrevIndexValue: ['PV Ad Effectiveness','PV WOM','PV Ending WOM','PV Payback Coefficient','PV Long Run Mkt Share','PV Logit Price Coeff','PV Logit Tech Coeff','PV Logit Spat Coeff','PV Payback Spat Coeff']

Decision Infeasible_Label
Title: Infeasible Label
Definition: 'Feasible solution could not be found.'
NodeLocation: 400,304,1
NodeSize: 64,40

Index Infeasible_Spatial_I
Title: Infeasible Spatial IDs
Definition: var x:=(Stored_Opt_Status_PV[All_Sectors=PV_Sectors, All_Spatial_ID=Spatial_ID] = Infeasible_Label);~
subset(x[@PV_Sectors=1])
NodeLocation: 1136,176,1
NodeSize: 64,40
ValueState: 2,2184,74,407,737,,MIDM
ReformVal: [PV_Sectors,All_Spatial_ID]

Alias Al1542734119
Title: R^2 Threshold Failure
Definition: 1
NodeLocation: 1264,64,1
NodeSize: 64,40
Original: R2_Thresh_Failure_PV

Alias Al1542734438
Title: R^2 Fails
Definition: 1
NodeLocation: 832,304,1
NodeSize: 64,40
Original: R2_Fails_PV

Index Failed_Spat_ID
Title: Failed Spat ID
Description: An index that is the union of two indexes: one that identifies whether a spatial ID failed the R^2 test, and the other identifying whether the spatial ID has not yet returned a feasible solution for the calibration parameters.
Definition: #SetUnion([\R2_Thresh_Failure_PV,\Infeasible_Spatial_I])
NodeLocation: 1272,176,1
NodeSize: 64,40
WindState: 2,110,89,720,350
ValueState: 2,889,132,889,629,0,MIDM
Aliases: FormNode Fo1542904764
DisplayOutputs: Function OG_Multi_Stage_Calib

Function Check_Cost_Scenario()
Title: Check Cost Scenario
Definition: var x:=[];~
IF size(Selected_PV_Cost_Sce)>1 THEN ~
	((x:=AskMsgChoice('Please select only one cost scenario before attempting to calibrate diffusion parameters.','Sector Selector Message', PV_Cost_Scenario=2], False, False));~
	(PV_Cost_Scenario := x))
NodeLocation: 528,528,1
NodeSize: 64,40
WindState: 2,385,353,993,350

Function Check_Stage_1(der_spatial_id, nonAg_spatial_id, select_stages: Index)
Title: Check Stage 1
Description: Checks whether the user wishes to continue if stage 1 is included in the Stages to Calibration input AND not all relevant PV_Spatial_IDs are selected.~
~
[der_spatial_id]: the index of spatial IDs for the DER considered in the calibration.~
[nonAg_spatial_id]: a list of all non-aggregate spatial IDs.~
[select_stages]: a list of calibration stages selected for the calibration process.
Definition: IF (size(der_spatial_id)<>size(nonAg_spatial_id) AND PositionInIndex(select_stages,1, select_stages))~
THEN MsgBox('You have selected to apply Calibration Stage 1, but fewer than all relevant spatial IDs are selected (normally all spatial IDs are selected for stage 1). Are you sure you wish to continue? If so, click OK. Otherwise, click Cancel.',1,'Stage 1 Message' )~
ELSE Null
NodeLocation: 656,440,1
NodeSize: 64,40
WindState: 2,1986,61,1007,504

Button Set_PV_Time_to_Cali1
Title: Set PV Time to Calib Time
NodeLocation: 832,440,1
NodeSize: 64,40
WindState: 2,22,479,720,350
Aliases: Alias Al1542999373
OnClick: Set_SimTime_CalTime(PV_Calibration_Start, PV_Calibration_End, PV_Sim_Start_Year, PV_Sim_End_Year)

Function Set_SimTime_CalTime(calib_start, calib_end; sim_start, sim_end: Variable)
Title: Set Time to Calibration Time
Description: This sets the simulation start and end time periods to the calibration start and end time periods, respectively.
Definition: (sim_start:=calib_start); {Sets the start year for the simulation to the start time for the calibration}~
(sim_end:=calib_end); {Sets the end year for the simulation to the end time for the calibration}
NodeLocation: 128,616,1
NodeSize: 64,40
WindState: 2,39,215,1015,411

Function Set_PV_Time_to_Forec(param1)
Title: Set PV Time to Forecast Only
NodeLocation: 264,616,1
NodeSize: 64,40

Function Check_DecVar_Switch(decis_switch: Variable)
Title: Check DecisVar Switch
Description: The Use DER Decision Variables box is typically only TRUE (checked) when the calibration scripts are physically running. If this box is inadvertently left checked (e.g., in the event of a calibration abort), this function will warn the user, who is most likely expecting to see the simulation results using stored coefficients, rather than whatever default value is in the Decision Variables (which are all scalars, not indexed by Spatial ID).
Definition: VAR var_title:=Title of decis_switch;~
~
IF decis_switch=1 THEN MsgBox('WARNING: The "' & var_title & '" box is checked (normally unchecked except in the middle of a calibration routine). This means that the simulation results shown in this output will not use the stored coefficients (which vary by Sector & Spatial ID) but rather a scalar default value. Click OK to proceed anyway, or click Cancel and then uncheck the"' & var_title & '" input in the appropriate Calibration Module ', 1, 'Decision Variable Warning')
NodeLocation: 400,616,1
NodeSize: 64,40
WindState: 2,39,89,1410,586

Button Calibrate_All_PV_Sec
Title: Calibrate All PV Sectors
NodeLocation: 984,376,1
NodeSize: 72,32
Aliases: Alias Al1552605730
NodeColor: 49344,49344,49344
OnClick: (PV_Spatial_ID:=Spatial_ID);  {Ensures all spatial IDs are checked}~
(Stages_to_Calibrate:=PV_Calibration_Stage); {Ensures all calibration stages are checked}~
(PV_Sectors:=Residential_Label);~
CALIBRATE;~
(PV_Sectors:=Non_Res_Label);~
CALIBRATE;~
Export_to_Tableau1

Close Multi_Stage_Calibra2

Module PV_Objective
Title:  PV Objective
Author: JamesMilford
Date: Wed, Aug 29, 2018 10:08 AM
NodeLocation: 264,112,1
NodeSize: 64,40
DiagState: 2,273,148,1503,707,17

Variable Act_PV_Install_Rate
Title: Actual PV Install Rate
Units: (systems or MW-AC)/year
Description: PV installation rate from interconnection data
Definition: VAR rates:=IF Stock_Basis_by_Sect[All_Sectors=PV_Sectors] = Bldg_Stocks_Label~
   THEN System_Installations~
   ELSE Capacity_Installs;~
~
Replace_X_with_Y(IgnoreWarnings(rates[Interconnect_Date=Time_Solar_PV]), Null, 0) / dT_PV_Data
NodeLocation: 264,400,1
NodeSize: 64,40
WindState: 2,89,476,862,350
ValueState: 2,197,64,1181,781,1,MIDM
ReformVal: [Time_Solar_PV,Null]
Att__TotalsIndex: []
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,135,Time_Solar_PV,1]
Att_ColorRole: Null

Variable Delta_PV_InstallRate
Title: Delta PV Install Rate
Units: systems/year
Description: The difference between the simulated rate of change of EV stock to the actual historical EV stock
Definition: ABS(Sim_PV_Install_Rate - Act_PV_Install_Rate)
NodeLocation: 424,400,1
NodeSize: 64,40
NodeInfo: 1,1,1,1,1,1,0,0,0,0,,0,1,0
ValueState: 2,321,33,1103,820,0,MIDM
ReformVal: [0,Self]
Att__TotalsIndex: []
Att_ResultSliceState: [Selected_Spatial_ID,76,Self,1,Time_Vehicles,1]

Variable Actual_Cumul_PV_Syst
Title: Actual Cumul PV Systems
Units: systems or MW-AC
Description: Historical cumulative PV systems installed.
Definition: VAR stocks:=IF Stock_Basis_by_Sect[All_Sectors=PV_Sectors] = Bldg_Stocks_Label~
   THEN Cumul_Syst_Installs~
   ELSE Cumul_Cap_Installs;~
~
Replace_X_with_Y(IgnoreWarnings(stocks[Interconnect_Date=Time_Solar_PV]), Null, 0)  {Ignore mismatch in time periods}
NodeLocation: 264,168,1
NodeSize: 64,40
NodeInfo: 1,1,1,1,1,1,0,,0,,0,,,
WindState: 2,58,461,969,548
ValueState: 2,12,30,1628,741,0,MIDM
ReformVal: [Time_Solar_PV,PV_Spatial_ID]
Att__TotalsIndex: [Time_Solar_PV]
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,1,Time_Solar_PV,1]
Att_ColorRole: Null

Variable Delta_PV_Systems
Title: Delta PV Systems
Units: systems
Description: The delta between the actual cumulative PV systems and the calibrated simulated cumulative PV systems.
Definition: VAR simulated := IF Current_Stage=1 THEN sum(Sim_Cumulative_PV, PV_Spatial_ID) ELSE Sim_Cumulative_PV;~
VAR actual := IF Current_Stage=1 THEN sum(Actual_Cumul_PV_Syst, PV_Spatial_ID) ELSE Actual_Cumul_PV_Syst;~
simulated - actual
NodeLocation: 424,168,1
NodeSize: 64,40
WindState: 2,306,62,720,350
ValueState: 2,255,41,1307,652,1,MIDM
ReformVal: [0,Null]
Att__TotalsIndex: []
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,15,Time_Solar_PV,1]
Att_ColorRole: Null

Objective Stock_Delta1
Title: Stock Delta
Units: systems or MW-AC
Description: The total difference in cumulative PV systems between actual and simulated data. This is limited to the the time periods considered in the optimization.
Definition: VAR delta:=sum(ABS(Delta_PV_Systems) * Dates_Incl_in_PV_Opt, Time_Solar_PV);~
~
IF Current_Stage = 1~
THEN Sum(delta * Non_Agg_Spatial_IDs, PV_Spatial_ID)~
ELSE delta
NodeLocation: 576,264,1
NodeSize: 64,40
ValueState: 2,956,109,670,532,,MIDM
ReformVal: [PV_Sectors,0]

Decision Dates_Incl_in_PV_Opt
Title: Dates Included in PV Optimization
Description: Select which historical dates you wish to include in the calculation of the cumulative delta between simulated and actual in the optimization of diffusion parameters. Any dates NOT checked will be ignored in the calculation of the objective function.~
~
 Change this to be indexed only by the calibration years
Definition: Table(Time_Solar_PV)(Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1),Checkbox(1))
NodeLocation: 576,360,1
NodeSize: 64,40
WindState: 2,435,78,1025,623
DefnState: 2,928,38,455,804,0,DFNM
ValueState: 2,2493,180,263,582,,MIDM
Aliases: FormNode Fo1535066204
DisplayInputs: Function Multi_Stage_Calibrat
TableCellDefault: checkbox(1)

Objective Sales_Delta1
Title: Sales Delta
Units: (systems or MW-AC)/year
Description: The total difference in PV installation rates between actual and simulated data. This is limited to the the time periods considered in the optimization.
Definition: VAR delta:=sum(Delta_PV_InstallRate * Dates_Incl_in_PV_Opt, Time_Solar_PV);~
~
IF Current_Stage = 1~
THEN Sum(delta * Non_Agg_Spatial_IDs, PV_Spatial_ID)~
ELSE delta
NodeLocation: 576,504,1
NodeSize: 64,40
WindState: 2,84,465,720,350
ValueState: 2,735,522,416,303,,MIDM
ReformVal: [PV_Sectors,0]

Decision Select_PV_Opt_Method
Title: Select PV Opt Method
Description: Select the method used for the PV optimization's objective function.
Definition: Choice(Optimization_Method1,1,0)
NodeLocation: 880,168,1
NodeSize: 64,40
Aliases: FormNode Fo1535066202
{!40200|Att_ChoiceIndexes: Index Optimization_Method1}

Variable Objective_PV
Title: Objective-PV
Units: varies
Description: This is the objective function of the PV optimization used to determine best-fit diffusion parameters. Its value depends on which optimization method is selected.
Definition: Table(Optimization_Method1)(Stock_Delta1)
NodeLocation: 728,264,1
NodeSize: 64,40
DefnState: 2,849,321,416,303,,DFNM
ValueState: 2,561,85,855,437,,MIDM
Att__TotalsIndex: []
Att_ResultSliceState: [PV_Sectors,2,Optimization_Method1,1,PV_Spatial_ID,1]

FormNode Fo1535066202
Title: Optimization Method
Definition: 0
NodeLocation: 884,116,1
NodeSize: 84,12
NodeInfo: 1,0,0,0,0,0,0,129,0,,0,,,
Original: Select_PV_Opt_Method

Variable Optimization_PV
Title: Optimization PV
Description: The definition of the PV optimization problem, which includes: the decision variables, objective function and context (ie, minimization or maximization), the constraints, and the solver settings.
Definition: DefineOptimization(~
Decisions: ...Selected_PV_Decision,~
Minimize: Obj_Selected_PV,~
Constraints: ...Selected_PV_Constrai,~
SettingValue: Opt_Settings_PV,~
TraceFile: Tracefile_Name {==this is only used for testing purposes, as writing additional data slows down the computation time somewhat. User input checkbox determines whether this is defined===}~
)
NodeLocation: 1032,264,1
NodeSize: 64,40
ValueState: 2,1427,177,274,280,0,MIDM
ReformVal: [0,Aggreg_PV_LRMS]
DisplayOutputs: Function Sequential_Opt_PV0, Function Sequential_Opt_PV2, Function OG_Sequential_Optimi

Variable Opt_Solution_PV
Title: Opt Solution PV
Description: The solution to the PV optimization of diffusion parameters.
Definition: OptSolution(Optimization_PV)
NodeLocation: 1184,264,1
NodeSize: 64,40
ValueState: 2,2093,396,1584,295,,MIDM
ReformVal: [Sys_LocalIndex('DecisionVector'),0]
Att__TotalsIndex: []

Variable Sim_vs_Act_PV_System
Title: Sim vs Act PV Systems
Units: systems or MW-AC
Description: Compares the simulated vs. actual historical PV systems~
Units:~
Residential: # of systems~
Commercial: MW-AC
Definition: Check_DecVar_Switch(Use_PV_Decision_Var); {checks whether the stored decision variables will actually be shown in the output}~
VAR actual:=IF PositionInIndex(Interconnect_Date, Time_Solar_PV, Interconnect_Date)~
   THEN Actual_Cumul_PV_Syst~
   ELSE Null;~
~
Array(Act_vs_Sim, [actual ,Sim_Cumulative_PV])
NodeLocation: 424,264,1
NodeSize: 64,40
WindState: 2,605,108,1049,435
ValueState: 2,637,24,809,698,1,MIDM
Aliases: FormNode Fo1535066206
GraphSetup: Att_ContLineStyle Graph_Primary_Valdim:5~
Grid:0~
Graph_SymbolSizeKey:0~
Graph_SymbolKey:1~
Att_GraphValueRange Sim_vs_Act_PV_System:1,,1,1,,,,0,8,0|1:1,,0,,,,,0,400,0|2:1,,0,,,,,0,400,0~
SymbolSize:7~
Graph_LineThickness:2~
Att_CatLineStyle Graph_Primary_Valdim:5~
Att_GraphIndexRange PV_Spatial_ID:1,1
ReformVal: [Time_Solar_PV,Act_vs_Sim]
NumberFormat: 2,F,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: []
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,4,Act_vs_Sim,2,Time_Solar_PV,1]
Att_SymbolRole: Null
{!40200|Att_GraphSetupSlices: [3,1,Act_vs_Sim,2,2,Act_vs_Sim,1]}

Variable Sim_vs_Act_PV_Rate
Title: Sim vs Act PV Install Rate
Units: (systems or MW-AC)/year
Description: Compares actual vs simulated rate of PV system installations.~
Units:~
Residential: # of systems/year~
Commercial: MW-AC/year
Definition: Check_DecVar_Switch(Use_PV_Decision_Var); {checks whether the stored decision variables will actually be shown in the output}~
VAR actual:=IF PositionInIndex(Interconnect_Date, Time_Solar_PV, Interconnect_Date)~
   THEN Act_PV_Install_Rate~
   ELSE Null;~
~
Array(Act_vs_Sim, [actual ,Sim_PV_Install_Rate])
NodeLocation: 424,504,1
NodeSize: 64,40
WindState: 2,49,333,1170,556
ValueState: 2,550,28,874,840,1,MIDM
Aliases: FormNode Fo1535066207
GraphSetup: Grid:0~
Graph_SymbolKey:0~
Att_GraphIndexRange Time_Vehicles1:1,,1,,,,,38.717K,42.369K,0~
SymbolSize:12
ReformVal: [Time_Solar_PV,Act_vs_Sim]
NumberFormat: 2,F,4,0,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,0,Act_vs_Sim,2,Time_Solar_PV,1]

Variable Opt_Status_PV
Title: Opt Status PV
Description: The status of the solution to PV parameter optimization.
Definition: OptStatusText(Optimization_PV)
NodeLocation: 1184,360,1
NodeSize: 64,40
ValueState: 2,631,354,702,381,,MIDM

Decision Opt_Settings_PV
Att_PrevIndexValue: ['Multistart','MaxTime']
Title: Opt Settings PV
Description: Settings for the PV optimization engine. ~
~
--Multistart can improve the likelihood of finding a global (rather than local) min/max, but it may take longer.~
--MaxTime indicates how many seconds the solver will run before timing out if an optimal value is not yet found.
Definition: Table(Self)(Checkbox(1),120)
IndexVals: ['Multistart','MaxTime']
NodeLocation: 1032,360,1
NodeSize: 64,40
WindState: 2,379,220,720,350
DefnState: 2,789,495,596,188,0,DFNM
Aliases: FormNode Fo1535066203
DisplayInputs: Function Multi_Stage_Calibrat
{!40700|Att_CellFormat: CellSpan(Opt_Settings_PV,CellAlignment('Center'),2,header:0)}

FormNode Fo1535066203
Title: Opt Settings EVs
Definition: 0
NodeLocation: 1036,400,1
NodeSize: 60,16
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Opt_Settings_PV

FormNode Fo1535066204
Title: Dates Included in Optimization
Definition: 0
NodeLocation: 576,408,1
NodeSize: 56,16
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Dates_Incl_in_PV_Opt

Objective PV_OptSoln_All_DVs
Title: PV OptSolution All DVs
Units: various
Description: The optimal solutions found by the solver for each of the decision variables.
Definition: Table(All_PV_Decisions)(OptSolution(Optimization_PV,PV_Ad_Effectiveness),0e+000,0e+000,0e+000,0e+000,0e+000,0e+000,0e+000,0e+000)
NodeLocation: 1184,168,1
NodeSize: 64,40
WindState: 2,102,82,903,487
DefnState: 2,359,440,800,329,0,DFNM
ValueState: 2,138,320,911,195,,MIDM
NodeColor: 19661,48336,65535

Constant Use_PV_Decision_Var
Title: Use PV Decision Variables
Units: normally unchecked
Description: The normal value for this box is UNCHECKED. ~
~
Only check this box to use Decision Variables, rather than the stored coefficients, in running the model. This box must be checked to run the optimization of coefficients, and the scripts for running the optimization automatically check this box and then un-check it after the optimization is complete, so that the stored results of the optimization are used in running the model forecast.
Definition: Checkbox(1)
NodeLocation: 880,360,1
NodeSize: 64,40
WindState: 2,20,81,1176,579
Aliases: FormNode Fo1535066230, FormNode Fo1535487622

Objective R_2_Stock_Delta
Title: R^2 Stock Delta
Units: dmnls
Description: This value calculates the traditional R^2 value often used in linear regression. It calculates the value based on the cumulative PV systems (simulated vs. actual).
Definition: var SS_Residuals := sum((Delta_PV_Systems * Dates_Incl_in_PV_Opt)^2, Time_Solar_PV);~
var MeanValue := ZIDZ(Sum(Actual_Cumul_PV_Syst * Dates_Incl_in_PV_Opt, Time_Solar_PV), sum(Dates_Incl_in_PV_Opt, Time_Solar_PV));~
var SS_total := sum((Actual_Cumul_PV_Syst * Dates_Incl_in_PV_Opt - MeanValue)^2, Time_Solar_PV);~
var rsquared := 1 - ZIDZ(SS_Residuals , SS_total);~
{[SS_Residuals, MeanValue, SS_total, rsquared]}~
rsquared
NodeLocation: 576,168,1
NodeSize: 64,40
WindState: 2,45,320,1125,350
ValueState: 2,313,132,1248,508,0,MIDM
ReformVal: [EV_LRMS_Scenario,0]
NumberFormat: 2,F,6,6,0,0,6,0,$,0,"ABBREV",0,,,0,0,15

Constant R2_Threshold1
Title: R^2 Threshold
Units: dmnl
Description: Input the minimum desired value of the R-squared metric indicating the closeness of fit between historic data and calibrated results. If a calibration stage returns a fit that does not meet this R-squared threshold, more decision variables will be considered in the optimization (e.g., when there is not a good fit using only the long-run market share as the only decision variable, the user can choose to add decision variables to the optimization only for those spatial IDs that do not have a good enough fit).
Definition: Table(PV_Calibration_Stage,All_Sectors)(~
0.95,0.7,0.9,~
0.9,0.6,0.9,~
0.8,0.5,0.9,~
0.7,0.5,0.9,~
0.5,0.5,0.5)
NodeLocation: 112,152,1
NodeSize: 64,40
WindState: 2,317,127,1114,627
DefnState: 2,823,429,882,172,0,DFNM
Aliases: FormNode Fo1535641289, FormNode Fo1535066231
NumberFormat: 2,F,4,7,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
{!50000|Att_ColumnWidths: [,PV_Calibration_Stage,\([,,,64])]}

FormNode Fo1535066231
Title: R^2 Threshold
Definition: 0
NodeLocation: 108,208,1
NodeSize: 60,16
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: R2_Threshold1

Variable R2_Fails_PV
Title: R^2 Fails
Units: boolean
Description: A flag indicating whether the calibration's R^2 value fails the threshold.~
~
1=fails~
0=passes
Definition: local x:=R_2_Applied < R2_Threshold1[All_Sectors=PV_Sectors, PV_Calibration_Stage=Current_Stage];~
x[@pv_sectors=1]  {can slice out just one element here (eliminating the PV Sectors index from the output), since only one element should be selected for the calibration -- scripts check for this]}
NodeLocation: 728,72,1
NodeSize: 64,40
WindState: 2,122,163,720,350
ValueState: 2,633,144,323,544,,MIDM
Aliases: Alias Al1542734438
ReformVal: [PV_Sectors,PV_Spatial_ID]
Att__TotalsIndex: []
Att_ResultSliceState: [PV_Sectors,1,Selected_Spatial_ID,1,Interconnect_Date,1]

Index R2_Thresh_Failure_PV
Title: R^2 Threshold Failure
Description: This index contains a set of spatial IDs that failed the R^2 test for goodness of fit.~
~
Fix R^2 calculation for cases where denominator is zero (i.e., zero adoption).
Definition: VAR failures:=R2_Fails_PV[@PV_Sectors=1];~
IF (Qty_Fail_Spat_ID_PV <>0 AND (Current_Stage<>1)) THEN   (Subset(failures))
NodeLocation: 112,400,1
NodeSize: 64,40
WindState: 2,43,529,1199,350
ValueState: 2,303,104,316,506,,MIDM
Aliases: Alias Al1542734119

Variable Obj_Selected_PV
Title: Objective Selected
Units: various
Description: The objective value selected by the user that will be used in the PV optimization.~
~
Note:~
Only one sector can be selected for an optimization.~
Only one long-run market share scenario can be selected for an optimization.~
The "Use PV Decision Variables" checkbox must be selected for the optimization to be meaningful.
Definition: IF size(PV_Sectors)>1 THEN MsgBox('When running an optimization, only one sector can be selected. You have more than one selected, so this node will slice out the first element. Please select only one Sector and recalculate.',1);~
~
IF Use_PV_Decision_Var=0 THEN msgbox( 'You must first check the Use PV Decision Variables box before this optimization definition has any meaning. Otherwise, it will not use the decision variables, but rather only stored coefficients.', 1, 'Decision Variable Message');~
~
Objective_PV[Optimization_Method1=Select_PV_Opt_Method, @PV_Sectors=1]
NodeLocation: 880,264,1
NodeSize: 64,40
WindState: 2,62,162,1067,469
ValueState: 2,990,418,416,303,,MIDM
ReformVal: [0,PV_Sectors]

Index Optimization_Method1
Att_PrevIndexValue: ['Stock Delta']
Title: Optimization Methods
Definition: ['Stock Delta']
NodeLocation: 1032,168,1
NodeSize: 64,40
ValueState: 2,505,196,416,303,,MIDM

Text Te1535066204
Title: Change this to be indexed by a static time index
NodeLocation: 672,432,-1
NodeSize: 72,32
NodeInfo: 1,0,0,1,1,1,1,,0,,0,,,
NodeColor: 65535,65531,1
NodeFont: Arial Narrow,13

Alias Al1535486018
Title: Total PV Install Rate
Definition: 1
NodeLocation: 264,504,1
NodeSize: 64,40
Original: Sim_PV_Install_Rate

Alias Al1535486026
Title: Simulated Cumulative Installs
Definition: 1
NodeLocation: 264,264,1
NodeSize: 64,40
NodeInfo: 1,1,1,1,1,1,0,,0,,0,,,
Original: Sim_Cumulative_PV

FormNode Fo1535487622
Title: Use PV Decision Variables
Definition: 0
NodeLocation: 940,332,1
NodeSize: 28,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Use_PV_Decision_Var

Module PV_Constraints
Title: PV Constraints
Author: JamesMilford
Date: Wed, Aug 29, 2018 10:00 PM
NodeLocation: 1032,472,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,148,169,1570,519,17

Constraint PV_Slope_Constraint
Title: PV Slope Constraint
Description: Constrains the difference between actual and simulated PV install rates in the chosen year to be within a given percentage-based tolerance.
Definition: (1 - PV_Slope_Tolerance)*Apply_Constraint <= PctError_InstallRate <= (1 + PV_Slope_Tolerance)*Apply_Constraint
NodeLocation: 552,224,1
NodeSize: 64,40
WindState: 2,102,82,1343,519
ValueState: 2,619,-13,635,942,,MIDM
ReformVal: [Slope_Offset,PV_Spatial_ID]

Variable PV_Slope_Tolerance
Title: PV Slope Error Tolerance
Units: fraction
Description: The percentage error (expressed in decimal form) that is tolerated between the actual and simulated PV install rates in a chosen year.
Definition: PV_Tolerance_by_Stag[Tolerance_Input=PV_Slope___Label, PV_Calibration_Stage=Current_Stage]
NodeLocation: 552,128,1
NodeSize: 64,40
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15

Decision PV_Period_for_Constr
Title: PV Period for Constraint
Description: Sets the time period at which the slope constraint applies.
Definition: PV_Calibration_End
NodeLocation: 256,312,1
NodeSize: 64,40
WindState: 2,723,288,720,350

Decision Num_of_Periods_Avg
Title: Number of Periods for Avg
Units: periods
Description: Specify the number of periods for which PV installations will be averaged. This average will be used in the slope constraint.
Definition: 4
NodeLocation: 88,192,1
NodeSize: 64,40
WindState: 2,0,264,720,350
Aliases: FormNode Fo1

FormNode Fo1
Title: Time for Constraint
Definition: 0
NodeLocation: 92,244,1
NodeSize: 76,12
NodeInfo: 1,0,0,0,0,0,0,113,0,,0,,,
Original: Num_of_Periods_Avg

Variable PctError_InstallRate
Title: Pct Error in Install Rate
Units: fraction
Description: The percentage error between actual and historic install rates near the end of the calibration horizon.
Definition: LOCAL simulated_install_rate:= IF Current_Stage=1 THEN sum(Sim_PV_Install_Rate[Time_Solar_PV=PV_Period_for_Constr], PV_Spatial_ID) ELSE Sim_PV_Install_Rate[Time_Solar_PV=PV_Period_for_Constr];~
VAR error:=Divide(simulated_install_rate, Avg_Historic_Install, True)[@PV_Sectors=1];~
~
error - Slope_Offset
NodeLocation: 400,264,1
NodeSize: 64,40
WindState: 2,102,82,1326,659
ValueState: 2,1100,194,304,566,,MIDM
NumberFormat: 2,%,4,2,0,0,4,0,$,0,"ABBREV",0,,,0,0,15

Variable Avg_Historic_Install
Title: Avg Historic Install Rate
Description: Original: ~
LOCAL endPosition:= PositionInIndex(Time_Solar_PV, PV_Period_for_Constr, Time_Solar_PV);   {Find the position of the period selected for the constraint}~
LOCALINDEX positions:= (endPosition - Num_of_Periods_Avg + 1)..endPosition;   {Create an index of positions that captures the number of periods chosen for the average}~
~
LOCAL install_rate:= IF Current_Stage=1 THEN sum(Act_PV_Install_Rate, PV_Spatial_ID) ELSE Act_PV_Install_Rate;~
~
Average(install_rate[@Time_Solar_PV=positions], Positions);   {Find the average historic install rate of the selected number of periods}
Definition: LOCAL endPosition:= PositionInIndex(Time_Solar_PV, PV_Period_for_Constr, Time_Solar_PV);   {Find the position of the period selected for the constraint}~
LOCALINDEX positions:= (endPosition - Num_of_Periods_Avg + 1)..endPosition;   {Create an index of positions that captures the number of periods chosen for the average}~
~
LOCAL install_rate:= IF Current_Stage=1 THEN sum(Act_PV_Install_Rate, PV_Spatial_ID) ELSE Act_PV_Install_Rate;~
~
Average(install_rate[@Time_Solar_PV=positions], Positions);   {Find the average historic install rate of the selected number of periods}~
~

NodeLocation: 256,192,1
NodeSize: 64,40
WindState: 2,102,82,1307,597
ValueState: 2,543,167,429,591,,MIDM
ReformVal: [PV_Sectors,PV_Spatial_ID]

Variable Apply_Constraint
Title: Apply Constraint
Units: boolean
Description: If no historic installations occurred during the period considered for the constraint, then we don't want to apply the slope constraint. This will return a flag indicating when the constraint should be applied.
Definition: VAR apply:=Avg_Historic_Install[@PV_Sectors=1] > 0;~
~
apply
NodeLocation: 400,168,1
NodeSize: 64,40
WindState: 2,318,251,1034,617
ValueState: 2,24,267,416,566,,MIDM
ReformVal: [PV_Sectors,PV_Spatial_ID]

Index All_PV_Constraints
Att_PrevIndexValue: ['PV Slope','PV Final Cumulative']
Title: All PV Constraints
Description: List of all possible PV constraints for the calibration
Definition: ['PV Slope','PV Final Cumulative']
NodeLocation: 808,112,1
NodeSize: 64,40
ValueState: 2,2020,154,658,303,,MIDM

Index Selected_PV_Constrai
Title: Selected PV Constraints
Description: The handles to constraints selected for the current optimization.
Definition: INDEX selectDecisions:=Subset(PV_Constraints_by_St[PV_Calibration_Stage=Current_Stage]);~
CopyIndex(Handles_of_PV_Constr[All_PV_Constraints=selectDecisions])
NodeLocation: 944,112,1
NodeSize: 64,40
ValueState: 2,1999,126,416,303,,MIDM

Constraint PV_Final_Cumul_Const
Title: PV Final Cumul Constraint
Description: Ensures the final value of the cumulative adoption for solar PV is within a specified tolerance range at the end of the calibration period. 
Definition: (1-PV_Final_Cumul_Toler) <= Relative_Error <= (1+PV_Final_Cumul_Toler)
NodeLocation: 552,480,1
NodeSize: 64,40
ValueState: 2,2530,41,501,536,,MIDM

Alias Al1542206762
Title: Simulated Cumulative PV
Definition: 1
NodeLocation: 248,480,1
NodeSize: 64,40
NodeInfo: 1,1,1,1,1,1,0,,0,,0,,,
Original: Sim_Cumulative_PV

Variable Relative_Error
Title: Relative Error
Definition: VAR Actual := IF Current_Stage=1 THEN sum(Actual_Cumul_PV_Syst[Time_Solar_PV=PV_Calibration_End],PV_Spatial_ID) ELSE Actual_Cumul_PV_Syst[Time_Solar_PV=PV_Calibration_End];~
VAR Simulated := IF Current_Stage=1 THEN sum(Sim_Cumulative_PV[Time_Solar_PV=PV_Calibration_End],PV_Spatial_ID) ELSE Sim_Cumulative_PV[Time_Solar_PV=PV_Calibration_End];~
VAR error:=Divide(Actual,Simulated, True)[@PV_Sectors=1];~
~
error
NodeLocation: 400,480,1
NodeSize: 64,40

Variable PV_Final_Cumul_Toler
Title: PV Final Cumul Tolerance
Definition: PV_Tolerance_by_Stag[Tolerance_Input=PV_Cumul___Label, PV_Calibration_Stage=Current_Stage]
NodeLocation: 552,584,1
NodeSize: 64,40
NumberFormat: 2,%,4,1,0,0,4,0,$,0,"ABBREV",0,,,0,0,15

Decision PV_Constraints_by_St
Title: PV Constraints by Stage
Description: Only the constraints selected will be included in the PV calibration optimization. In the calibration scripts, these boxes will be checked automatically consistent with the value of the PV Constraints by Stage input. 
Definition: Table(PV_Calibration_Stage,All_PV_Constraints)(~
Checkbox(1),Checkbox(1),~
Checkbox(1),Checkbox(1),~
Checkbox(1),Checkbox(1),~
Checkbox(1),Checkbox(1),~
Checkbox(0),Checkbox(0))
NodeLocation: 1096,360,1
NodeSize: 64,40
WindState: 2,1886,81,720,350
DefnState: 2,1031,162,380,297,0,DFNM
Aliases: FormNode Fo1542219554, FormNode Fo1542207817
ReformDef: [All_PV_Constraints,PV_Calibration_Stage]
TableCellDefault: checkbox(1)

Decision Handles_of_PV_Constr
Title: Handles of PV Constraints
Description: Handles of the selected PV constraints to be used in the optimization
Definition: Table(All_PV_Constraints)(handle(PV_Slope_Constraint),handle(PV_Final_Cumul_Const))
NodeLocation: 552,360,1
NodeSize: 64,40

FormNode Fo1542207817
Title: Select PV Constraints
Definition: 0
NodeLocation: 1104,408,1
NodeSize: 56,16
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: PV_Constraints_by_St

Index Tolerance_Input
Att_PrevIndexValue: ['Slope Tolerance %','Final Cumulative %']
Title: Tolerance Input
Definition: ['Slope Tolerance %','Final Cumulative %']
NodeLocation: 1080,112,1
NodeSize: 64,40

Constant PV_Tolerance_by_Stag
Title: PV Tolerance by Stage
Definition: Table(PV_Calibration_Stage,Tolerance_Input)(~
0.6,0.1,~
0.2,0.05,~
0.3,0.1,~
2,1,~
2,1)
NodeLocation: 712,360,1
NodeSize: 64,40
DefnState: 2,993,346,680,188,0,DFNM
Aliases: FormNode Fo1542404245, FormNode Fo1542733351
NumberFormat: 2,%,4,1,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
TableCellDefault: Default_PV_Tolerance

Constant Default_PV_Tolerance
Title: Default PV Tolerance by Stage
Definition: Table(Tolerance_Input)(0.3,0.02)
NodeLocation: 912,360,1
NodeSize: 64,40
Aliases: FormNode Fo1542404360
NumberFormat: 2,%,4,1,0,0,4,0,$,0,"ABBREV",0,,,0,0,15

FormNode Fo1542404360
Title: Default PV Tolerance by Stage
Definition: 0
NodeLocation: 916,408,1
NodeSize: 60,16
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Default_PV_Tolerance

Decision PV_Slope___Label
Title: PV Slope % Label
Definition: Choice(Tolerance_Input,1,0)
NodeLocation: 408,72,1
NodeSize: 64,40
{!40200|Att_ChoiceIndexes: Index Tolerance_Input}

Decision PV_Cumul___Label
Title: PV Cumul % Label
Definition: Choice(Tolerance_Input,2,0)
NodeLocation: 400,584,1
NodeSize: 64,40
{!40200|Att_ChoiceIndexes: Index Tolerance_Input}

FormNode Fo1542733351
Title: PV Tolerance by Stage
Definition: 0
NodeLocation: 720,408,1
NodeSize: 56,16
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: PV_Tolerance_by_Stag

Constant Slope_Offset
Title: Slope Offset
Description: User defined offset that can be used to adjust the final slope tolerance (i.e., to be somewhat higher or somewhat lower than the average slope at the end of the calibration, to account for trends or other information that are not fully accounted for in the simple moving average slope.
Definition: 10%
NodeLocation: 392,360,1
NodeSize: 64,40
Aliases: FormNode Fo1544716614
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15

FormNode Fo1544716614
Title: Slope Offset
Definition: 0
NodeLocation: 392,400,1
NodeSize: 56,16
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Slope_Offset

Close PV_Constraints

Alias Al1542089624
Title: Current Stage
Definition: 1
NodeLocation: 576,600,1
NodeSize: 64,40
Original: Current_Stage

FormNode Fo1542096039
Title: Current Stage
Definition: 0
NodeLocation: 584,644,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Current_Stage

Variable Tracefile_Name
Title: Tracefile Name
Definition: IF Use_Trace_Log THEN "trace.log" ELSE Undefined
NodeLocation: 880,472,1
NodeSize: 64,40

Decision Use_Trace_Log
Title: Use Trace Log
Description: Check this box only if you want to trace each guess of the calibration optimizer. This is used primarily for debugging of calibration scripts or to better understand why a calibration may not be providing good results.
Definition: Checkbox(0)
NodeLocation: 880,584,1
NodeSize: 64,32
NodeInfo: 1,1,1,1,1,1,0,0,0,0,,0,1,0
Aliases: FormNode Fo1542218103, FormNode Fo1542767189
DisplayOutputs: Function OG_Multi_Stage_Calib

FormNode Fo1542218103
Title: Use Analytica Text Trace Log
Definition: 0
NodeLocation: 924,600,1
NodeSize: 36,16
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: Use_Trace_Log

Objective R_2_Stock_Delta_for_
Title: R^2 Stock Delta for Aggregate
Definition: VAR actual := sum(Actual_Cumul_PV_Syst, PV_Spatial_ID);~
var SS_Residuals := sum((Delta_PV_Systems * Dates_Incl_in_PV_Opt)^2, Time_Solar_PV);~
var MeanValue := ZIDZ(Sum(actual * Dates_Incl_in_PV_Opt, Time_Solar_PV), sum(Dates_Incl_in_PV_Opt, Time_Solar_PV));~
var SS_total := sum((actual * Dates_Incl_in_PV_Opt - MeanValue)^2, Time_Solar_PV);~
var rsquared := 1 - ZIDZ(SS_Residuals , SS_total);~
rsquared
NodeLocation: 576,72,1
NodeSize: 64,40
ValueState: 2,456,458,1249,303,,MIDM

Objective R_2_Applied
Title: R^2 Applied
Definition: IF Current_Stage=1 THEN R_2_Stock_Delta_for_ ELSE MAX([R_2_Stock_Delta,0])  {zeros out negative R^2 values for plotting purposes}
NodeLocation: 728,168,1
NodeSize: 64,40
WindState: 2,102,82,720,488
ValueState: 2,112,166,1677,696,1,MIDM
Aliases: FormNode Fo1542904550
GraphSetup: Att_GraphIndexRange PV_Spatial_ID:1,1~
Att_CatLineStyle Graph_Primary_Valdim:5~
Att_GraphValueRange R_2_Applied:1,,1,1,,,,0,1,0
ReformVal: [PV_Spatial_ID,PV_Sectors]
NumberFormat: 2,F,4,2,0,0,4,1,$,0,"ABBREV",0,,,0,0,15
{!40700|CellFormatExpression: Cell_Fill_Examples}

Variable Setting_Info
Title: Setting Info
Definition: OptEngineInfo("GRG Nonlinear",['MaxSetting','Default','MinSetting'])
NodeLocation: 1184,464,1
NodeSize: 64,40
ValueState: 2,2250,42,510,623,,MIDM
ReformVal: [Self,Sys_LocalIndex('SettingName')]

Variable Smoothed_PV_Install_
Title: Smoothed PV Install Rate
Description: First order exponential smooth of the Actual PV Install rate, with a time constant of PV_Smooth_Time~
~
Not currently used.
Definition: Dynamic[Time_Solar_PV](Act_PV_Install_Rate[@Time_Solar_PV=1], self[Time_Solar_PV - 1] + dT_PV_Data * (Act_PV_Install_Rate[Time_Solar_PV - 1] - self[Time_Solar_PV - 1])/PV_Smooth_Time)
NodeLocation: 128,608,1
NodeSize: 64,40
ValueState: 2,216,218,416,303,1,MIDM

Constant PV_Smooth_Time
Title: PV Smooth Time
Units: Years
Description: Time constant on the exponential smoothing of PV Install rate.
Definition: 0.25
NodeLocation: 288,608,1
NodeSize: 64,40

Variable Compare1
Definition: [Act_PV_Install_Rate,Smoothed_PV_Install_]
NodeLocation: 128,712,1
NodeSize: 64,40
NodeInfo: 1,1,1,1,1,1,0,0,0,0,,0,1,0
ValueState: 2,251,124,1333,762,1,MIDM
ReformVal: [Time_Solar_PV,Self]
Att__TotalsIndex: [PV_Spatial_ID]
Att_ResultSliceState: [PV_Sectors,1,PV_Spatial_ID,0,PV_Smooth_Time,1,Self,1,Time_Solar_PV,1]

Close PV_Objective

Module Stored_Decison_Data
Title: Stored Decison Data
Author: JamesMilford
Date: Wed, Aug 29, 2018 10:00 PM
NodeLocation: 552,112,1
NodeSize: 64,40
DiagState: 2,84,4,1328,802,17

FormNode Fo1535066221
Title: Long-Run Mkt Share
Definition: 0
NodeLocation: 1044,580,1
NodeSize: 188,20
NodeInfo: 1,,,,,,0,72,,,,,,0
NodeColor: 49344,49344,49344
Original: PV_LongRun_Mkt_Share

FormNode Fo1535066222
Title: EV Ad Effectiveness
Definition: 0
NodeLocation: 1044,460,1
NodeSize: 188,20
NodeColor: 49344,49344,49344
Original: PV_Ad_Effectiveness

FormNode Fo1535066223
Title: EV Word of Mouth
Definition: 0
NodeLocation: 1044,500,1
NodeSize: 188,20
NodeColor: 49344,49344,49344
Original: PV_Word_of_Mouth

FormNode Fo1535066224
Title: Initial EV Familiarity
Definition: 0
NodeLocation: 1044,540,1
NodeSize: 188,20
NodeColor: 49344,49344,49344
Original: PV_Ending_WOM

FormNode Fo1535066225
Title: Default EVAdEff
Definition: 0
NodeLocation: 1036,36,1
NodeSize: 188,20
NodeColor: 49344,49344,49344
Original: Default_PVAdEff

FormNode Fo1535066226
Title: Default EV LRMS
Definition: 0
NodeLocation: 1036,156,1
NodeSize: 188,20
NodeColor: 49344,49344,49344
Original: Default_PV_LRMS

FormNode Fo1535066227
Title: Default EV WOM
Definition: 0
NodeLocation: 1036,76,1
NodeSize: 188,20
NodeColor: 49344,49344,49344
Original: Default_PV_WOM

FormNode Fo1535066228
Title: Default EV InitFam
Definition: 0
NodeLocation: 1036,116,1
NodeSize: 188,20
NodeColor: 49344,49344,49344
Original: Default_PV_End_WOM

Decision PV_Ad_Effectiveness
Title: PV Ad Effectiveness
Units: fraction/year
Description: Advertising effectiveness, also known as the "p" coefficient in the classic Bass diffusion model.
Definition: 0.005
NodeLocation: 264,72,1
NodeSize: 64,40
WindState: 2,36,8,1180,547
DefnState: 2,992,310,295,412,0,DFNM
Aliases: Alias Al2, FormNode Fo1535066222
Domain: DomContinuous
{!40300|DomainExpr: Continuous(PV_AdEff_Lwr_Bnd, PV_AdEff_Upr_Bnd)}
TableCellDefault: Default_PVAdEff
{!40300|OptInitialGuess: 0.001}
{!40400|CloudPlayerStyles: Show_object: no}
{!40204-40399|AWP_Attrib:Show_object: no}
UnoptimizedDef: 0.02

Decision PV_Word_of_Mouth
Title: PV Word of Mouth
Units: fraction/year
Description: The strength of word-of-mouth effectiveness, also known as the "q" parameter in the classic Bass diffusion model.
Definition: 0.1573
NodeLocation: 264,264,1
NodeSize: 64,40
WindState: 2,5,426,720,350
DefnState: 2,1002,261,455,530,0,DFNM
Aliases: Alias Al4, FormNode Fo1535066223
NumberFormat: 2,F,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
Domain: DomContinuous
{!40300|DomainExpr: Continuous(PV_StartWOM_Lwr_Bnd,PV_StartWOM_Upr_Bnd)}
TableCellDefault: Default_PV_WOM
{!40300|OptInitialGuess: 0.4}
{!40400|CloudPlayerStyles: Show_object: no}
{!40204-40399|AWP_Attrib:Show_object: no}
UnoptimizedDef: 0.50

Decision PV_Ending_WOM
Title: PV Ending WOM
Units: 1/year
Description: The final word-of-mouth strength for PV.
Definition: 0.375636397104541
NodeLocation: 264,360,1
NodeSize: 64,40
WindState: 2,84,343,736,426
DefnState: 2,419,199,359,678,,DFNM
Aliases: Alias Al1535640950, FormNode Fo1535066224
NumberFormat: 2,%,4,1,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
Domain: DomContinuous
{!40300|DomainExpr: Continuous(PV_EndWOM_Lwr_Bnd, PV_EndWOM_Upr_Bnd)}
TableCellDefault: Default_PV_End_WOM
{!40300|OptInitialGuess: 0}
{!40400|CloudPlayerStyles: Show_object: no}
{!40204-40399|AWP_Attrib:Show_object: no}
UnoptimizedDef: 0.05

Decision PV_LongRun_Mkt_Share
Title: PV LongRun Mkt Share
Units: fraction
Description: Long-run market share for PV systems
Definition: 0.7300390001060624
NodeLocation: 264,168,1
NodeSize: 64,40
WindState: 2,173,120,720,398
Aliases: Alias Al3, FormNode Fo1535066221
NumberFormat: 2,%,4,1,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
Domain: DomContinuous
{!40300|DomainExpr: Continuous(PV_LRMS_Lwr_Bnd, PV_LRMS_Upr_Bnd)}
TableCellDefault: Default_PV_LRMS
{!40300|OptInitialGuess: 0.6}
{!40400|CloudPlayerStyles: Show_object: no}
{!40204-40399|AWP_Attrib:Show_object: no}
UnoptimizedDef: 0.4949

Constant Default_PVAdEff
Title: Default PVAdEff
Units: fraction/year
Description: Default value for the corresponding decision variable.
Definition: 0.009802163617552323
NodeLocation: 112,72,1
NodeSize: 64,40
NodeInfo: 1,1,1,1,1,1,0,0,0,0,,0,1,0
Aliases: FormNode Fo1535066225

Constant Default_PV_LRMS
Title: Default PV LRMS
Units: fraction
Description: Default value for the corresponding decision variable.
Definition: 0.7300390001060624
NodeLocation: 112,168,1
NodeSize: 64,40
WindState: 2,102,82,720,350
Aliases: FormNode Fo1535066226
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15

Constant Default_PV_WOM
Title: Default PV WOM
Units: fraction/year
Description: Default value for the corresponding decision variable.
Definition: 0.349593249328413
NodeLocation: 112,264,1
NodeSize: 64,40
Aliases: FormNode Fo1535066227

Constant Default_PV_End_WOM
Title: Default PV Ending WOM
Units: 1/year
Description: Default value for the corresponding decision variable.
Definition: 0.375636397104541
NodeLocation: 112,360,1
NodeSize: 64,40
Aliases: FormNode Fo1535066228

Variable PV_Decision_Values
Title: PV Decision Values
Units: various
Description: The value of all decision variables
Definition: Table(All_PV_Decisions)(PV_Ad_Effectiveness,0e+000,0e+000,0e+000,0e+000,0e+000,0e+000,0e+000,0e+000)
NodeLocation: 424,224,1
NodeSize: 64,40
WindState: 2,102,82,1232,623
DefnState: 2,1099,248,416,303,,DFNM
ValueState: 2,226,164,849,513,,MIDM
NodeColor: 19661,42599,65535
ReformVal: [Self,0]

Variable Stored_AdEff_PV
Title: Stored AdEff PV
Units: fraction/year
Description: Stored optimal solutions for the corresponding decision variables.
Definition: Stored_PV_Dec_Vars[All_PV_Dec_Handles=Handle(PV_Ad_Effectiveness)]
NodeLocation: 592,72,1
NodeSize: 64,40
WindState: 2,273,212,1028,559
DefnState: 2,426,58,780,661,0,DFNM
ValueState: 2,400,276,868,601,,MIDM
Aliases: Alias Al1535520388
ReformDef: [All_Sectors,All_Spatial_ID]
ReformVal: [0,0]
DisplayOutputs: Function Sequential_Opt_PV0, Function Set_Start_Coeff_PV0, Function Sequential_Opt_PV2
TableCellDefault: Default_PVAdEff
Att_ResultSliceState: [All_Sectors,3,All_Spatial_ID,1,Aggregate_EV_LRMS,1]
Att_EditSliceState: [All_Sectors,3,All_Spatial_ID,1,Aggregate_EV_LRMS,1]
{!40700|CellFormatExpression: IF Self<>Self[@All_Spatial_ID=1] THEN CellFont(color: 'Red')}

Variable Stored_LRMS_PV
Title: Stored LRMS PV
Units: fraction
Description: Stored optimal solutions for the corresponding decision variables.
Definition: Stored_PV_Dec_Vars[All_PV_Dec_Handles=Handle(PV_LongRun_Mkt_Share)]
NodeLocation: 592,168,1
NodeSize: 64,40
DefnState: 2,244,90,987,486,0,DFNM
ValueState: 2,488,81,470,687,,MIDM
Aliases: Alias Al1535520789
ReformDef: [All_Sectors,All_Spatial_ID]
ReformVal: [All_Sectors,All_Spatial_ID]
NumberFormat: 2,%,4,4,0,0,4,0,$,0,"ABBREV",0,,,0,0,15
DisplayOutputs: Function Sequential_Opt_PV0, Function Set_Start_Coeff_PV0, Function Sequential_Opt_PV2
TableCellDefault: Default_PV_LRMS
Att_ResultSliceState: [All_Sectors,3,All_Spatial_ID,1,EV_Mkt_Share_Scen,1]
Att_EditSliceState: [All_Sectors,3,All_Spatial_ID,1,Aggregate_EV_LRMS,1]
{!40400|CloudPlayerStyles: Show_object: no}
{!40204-40399|AWP_Attrib:Show_object: no}
{!40700|CellFormatExpression: IF Self<>Self[@All_Spatial_ID=1] THEN CellFont(color: 'Red')}

Variable Stored_WOM_PV
Title: Stored WOM PV
Units: fraction/year
Description: Stored optimal solutions for the corresponding decision variables.
Definition: Stored_PV_Dec_Vars[All_PV_Dec_Handles=Handle(PV_Word_of_Mouth)]
NodeLocation: 592,264,1
NodeSize: 64,40
DefnState: 2,737,161,597,632,0,DFNM
ValueState: 2,374,399,972,303,,MIDM
Aliases: Alias Al1535520633
ReformDef: [All_Sectors,All_Spatial_ID]
DisplayOutputs: Function Sequential_Opt_PV0, Function Set_Start_Coeff_PV0, Function Sequential_Opt_PV2
TableCellDefault: Default_PV_WOM
{!40700|CellFormatExpression: IF Self<>Self[@All_Spatial_ID=1] THEN CellFont(color: 'Red')}

Variable Stored_End_WOM_PV
Title: Stored End WOM PV
Units: 1/year
Description: Stored optimal solutions for the corresponding decision variables.
Definition: Stored_PV_Dec_Vars[All_PV_Dec_Handles=Handle(PV_Ending_WOM)]
NodeLocation: 592,360,1
NodeSize: 64,40
DefnState: 2,1250,263,394,507,,DFNM
Aliases: Alias Al1535665647
ReformDef: [All_Sectors,All_Spatial_ID]
DisplayOutputs: Function Sequential_Opt_PV0, Function Set_Start_Coeff_PV0, Function Sequential_Opt_PV2
TableCellDefault: Default_PV_End_WOM
{!40700|CellFormatExpression: IF Self<>Self[@All_Spatial_ID=1] THEN CellFont(color: 'Red')}

Variable All_Stored_Coeffs_PV
Title: All Stored Coefficients
Description: This node is editable and shows the values stored for each diffusion coefficient, each of which are calculated and assigned through running the optimization script.~
~
IF isnull(self) THEN CellFont(color: 'Red') ELSE~
	(IF Relevant_Decision_Va=0 THEN CellFont(color: 'White') ELSE ~
		(IF self<>self[All_Spatial_ID=Element_for_Storing_] THEN CellFont(color: 'Blue'))~
)
Definition: Concat(Stored_PV_Dec_Vars, Stored_Opt_Status_PV, All_PV_Dec_Handles, Opt_Status_Label, Stored_Dec_Var_PV)
NodeLocation: 744,224,1
NodeSize: 64,40
WindState: 2,239,96,1095,616
DefnState: 2,101,37,1466,747,0,DFNM
ValueState: 2,157,38,1720,727,0,MIDM
Aliases: FormNode Fo4, FormNode Fo1535066210, FormNode Fo1535066247
NodeColor: 19661,42599,65535
GraphSetup: Grid:0~
Att_ContLineStyle Graph_Primary_Valdim:4~
Att_CatLineStyle Graph_Primary_Valdim:4~
Att_GraphIndexRange All_Spatial_ID:1,1
ReformDef: [Stored_Dec_Var_PV,All_Spatial_ID]
ReformVal: [Stored_Dec_Var_PV,All_Spatial_ID]
DisplayOutputs: Function Sequential_Opt_PV0, Function Sequential_Opt_PV2
Att__TotalsIndex: []
Att_ResultSliceState: [All_Sectors,1,All_Spatial_ID,1,Stored_Dec_Var_PV,9]
Att_EditSliceState: [All_Sectors,1,All_Spatial_ID,91,Stored_Dec_Var_PV,1]
Att_ColorRole: Null
{!40700|CellFormatExpression: ~
~
~
}
{!40700|Att_CellFormat: CellFormats(CellSpan(Stored_Dec_Var_PV,CellSpan(All_Spatial_ID,CellNumberFormat('Exponential',7,0,0,dateFormat:'ABBREV',fullPrecision:0,numbersAsDates:0,datesAsNumbers:0),3,11,header:0),9,header:0),CellSpan(Stored_Dec_Var_PV,CellSpan(All_Spatial_ID,CellNumberFormat('Exponential',7,0,0,dateFormat:'ABBREV',fullPrecision:0,numbersAsDates:0,datesAsNumbers:0),3,11,header:0),8,9,header:0),CellSpan(Stored_Dec_Var_PV,CellSpan(All_Spatial_ID,CellNumberFormat('Fixed Point',4,0,0,dateFormat:'ABBREV',fullPrecision:0,numbersAsDates:0,datesAsNumbers:0),3,11,header:0),9,header:0),CellSpan(Stored_Dec_Var_PV,CellSpan(All_Spatial_ID,CellNumberFormat('Fixed Point',4,1,0,dateFormat:'ABBREV',fullPrecision:0,numbersAsDates:0,datesAsNumbers:0),124,header:0),1,2,header:0),CellSpan(Stored_Dec_Var_PV,CellSpan(All_Spatial_ID,CellNumberFormat('Fixed Point',14,1,0,dateFormat:'ABBREV',fullPrecision:0,numbersAsDates:0,datesAsNumbers:0),124,header:0),1,2,header:0))}
{!50000|Att_ColumnWidths: [,Stored_Dec_Var_PV,\([,,,,37,33,37,37,174,604])]}

Index Stored_Dec_Var_PV
Title: Stored Dec Var
Definition: Concat(All_PV_Dec_Handles, Opt_Status_Label)
NodeLocation: 744,344,1
NodeSize: 64,40
ValueState: 2,46,379,416,303,,MIDM
MetaOnly: 1
{!40300|Att_SlicerPopupSize: 242,168}
Att_PrevIndexValue: [PV_Ad_Effectiveness,PV_Word_of_Mouth,PV_Ending_WOM,PV_Payback_Coefficie,PV_LongRun_Mkt_Share,Logit_Price_Coeff,Logit_Tech_Coeff,Logit_Spatial_Coeff,Payback_Spatial_Coef,'Opt Status']

FormNode Fo1535066210
Title: Va10
Definition: 0
NodeLocation: 752,172,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,,0,,0,,,
Original: All_Stored_Coeffs_PV

Constant Stored_Opt_Status_PV
Title: Stored Opt Status PV
Description: Stores the status of the optimization (e.g., whether an optimal solution was found, the optimization timed out, etc.)
Definition: Table(All_Spatial_ID,All_Sectors)(~
'Not Yet Solved.','Not Yet Solved.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Optimal solution has been found.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Probable global optimum reached. Returned when MSL (Bayesian) global optimality test has been satisfied.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Probable global optimum reached. Returned when MSL (Bayesian) global optimality test has been satisfied.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Optimal solution has been found.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Probable global optimum reached. Returned when MSL (Bayesian) global optimality test has been satisfied.','Not Yet Solved.',~
'Probable global optimum reached. Returned when MSL (Bayesian) global optimality test has been satisfied.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Optimal solution has been found.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','The Solver has converged to the current solution.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Optimal solution has been found.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Optimal solution has been found.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','The Solver has converged to the current solution.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Optimal solution has been found.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','The Solver has converged to the current solution.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Optimal solution has been found.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Probable global optimum reached. Returned when MSL (Bayesian) global optimality test has been satisfied.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Optimal solution has been found.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Probable global optimum reached. Returned when MSL (Bayesian) global optimality test has been satisfied.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','The Solver has converged to the current solution.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','The Solver has converged to the current solution.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Probable global optimum reached. Returned when MSL (Bayesian) global optimality test has been satisfied.','Not Yet Solved.',~
'Optimal solution has been found.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Probable global optimum reached. Returned when MSL (Bayesian) global optimality test has been satisfied.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Probable global optimum reached. Returned when MSL (Bayesian) global optimality test has been satisfied.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Probable global optimum reached. Returned when MSL (Bayesian) global optimality test has been satisfied.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Optimal solution has been found.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Optimal solution has been found.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Optimal solution has been found.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','The Solver has converged to the current solution.','Not Yet Solved.',~
'The Solver has converged to the current solution.','The Solver has converged to the current solution.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','The Solver has converged to the current solution.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Probable global optimum reached. Returned when MSL (Bayesian) global optimality test has been satisfied.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Probable global optimum reached. Returned when MSL (Bayesian) global optimality test has been satisfied.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','The Solver has converged to the current solution.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Probable global optimum reached. Returned when MSL (Bayesian) global optimality test has been satisfied.','Not Yet Solved.',~
'The Solver has converged to the current solution.','The Solver has converged to the current solution.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Probable global optimum reached. Returned when MSL (Bayesian) global optimality test has been satisfied.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Probable global optimum reached. Returned when MSL (Bayesian) global optimality test has been satisfied.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Probable global optimum reached. Returned when MSL (Bayesian) global optimality test has been satisfied.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Probable global optimum reached. Returned when MSL (Bayesian) global optimality test has been satisfied.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','The Solver has converged to the current solution.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Probable global optimum reached. Returned when MSL (Bayesian) global optimality test has been satisfied.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Probable global optimum reached. Returned when MSL (Bayesian) global optimality test has been satisfied.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Probable global optimum reached. Returned when MSL (Bayesian) global optimality test has been satisfied.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Probable global optimum reached. Returned when MSL (Bayesian) global optimality test has been satisfied.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Probable global optimum reached. Returned when MSL (Bayesian) global optimality test has been satisfied.','Not Yet Solved.',~
'The Solver has converged to the current solution.','Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Not Yet Solved.',~
'Time out status. Returned when the maximum allowed time has been exceeded. Indicates an early exit of the algorithm.','Probable global optimum reached. Returned when MSL (Bayesian) global optimality test has been satisfied.','Not Yet Solved.')
NodeLocation: 592,928,1
NodeSize: 64,40
DefnState: 2,377,97,1359,664,0,DFNM
ValueState: 2,221,72,1159,702,,MIDM
ReformDef: [All_Sectors,All_Spatial_ID]
ReformVal: [Undefined,All_Spatial_ID]
DisplayOutputs: Function Sequential_Opt_PV0, Function Set_Start_Coeff_PV0, Function Sequential_Opt_PV2, Function OG_Multi_Stage_Calib, Function OG_Sequential_Optimi
TableCellDefault: 'Not Yet Solved.'
{!40700|CellFormatExpression: IF Self<>Self[@All_Spatial_ID=1] THEN CellFont(color: 'Red')}

FormNode Fo1535066247
Title: All Stored Coefficients
Definition: 1
NodeLocation: 760,268,1
NodeSize: 56,12
NodeInfo: 1,0,0,0,0,0,0,78,0,,0,,,0
Original: All_Stored_Coeffs_PV

Decision Opt_Status_Label
Title: Opt Status Label
Definition: ['Opt Status']
NodeLocation: 744,928,1
NodeSize: 64,40

Decision Logit_Price_Coeff
Title: Logit Price Coefficient
Units: utility/ratio
Description: The amount of utility derived per unit of the cost of electricity ratio.
Definition: -2.3505896564342965
NodeLocation: 264,456,1
NodeSize: 64,40
WindState: 2,97,174,720,350
Aliases: Alias Al1539126683, FormNode Fo1539127221
Domain: DomContinuous
{!40300|DomainExpr: Continuous(PV_PriceCoef_Lwr_Bnd,PV_PriceCoef_Upr_Bnd)}

Decision Logit_Spatial_Coeff
Title: Logit Spatial Coefficient
Units: utility
Description: The amount of utility that describes geographic differences in logit adoption regardless of relative economics.
Definition: 0
NodeLocation: 264,648,1
NodeSize: 64,40
WindState: 2,50,84,720,350
Aliases: Alias Al1539126684, FormNode Fo1539127222
Domain: DomContinuous
{!40300|DomainExpr: Continuous(PVLogSpatCoef_Lwr_Bn,PVLogSpatCoef_Upr_Bn)}

Variable Stored_Spatial_Coeff
Title: Stored Spatial Coefficient
Units: utility
Description: The amount of utility that describes geographic differences in adoption regardless of relative economics. These are stored values found by the calibration optimization.
Definition: Stored_PV_Dec_Vars[All_PV_Dec_Handles=Handle(Logit_Spatial_Coeff)]
NodeLocation: 592,648,1
NodeSize: 64,40
ValueState: 2,2416,554,1061,303,,MIDM
Aliases: Alias Al1539126685
DisplayOutputs: Function Sequential_Opt_PV0, Function Set_Start_Coeff_PV0, Function Sequential_Opt_PV2
TableCellDefault: 0

Variable Stored_Logit_Price_C
Title: Stored Logit Price Coefficient
Units: utility/ratio
Description: The amount of utility derived per unit of the cost of electricity ratio. These are stored values found by the calibration optimization.
Definition: Stored_PV_Dec_Vars[All_PV_Dec_Handles=Handle(Logit_Price_Coeff)]
NodeLocation: 592,456,1
NodeSize: 64,40
DefnState: 2,2256,394,1178,303,,DFNM
Aliases: Alias Al1539126686
DisplayOutputs: Function Sequential_Opt_PV0, Function Set_Start_Coeff_PV0, Function Sequential_Opt_PV2
TableCellDefault: 0

Decision Logit_Tech_Coeff
Title: Logit Tech Coefficient
Units: utility
Description: The amount of utility explained by preference for a particular technology regardless of differences in economics.
Definition: 7.9865764817160425
NodeLocation: 264,552,1
NodeSize: 64,40
WindState: 2,57,96,720,350
Aliases: Alias Al1539126687, FormNode Fo1539127223
Domain: DomContinuous
{!40300|DomainExpr: Continuous(PVLogTechCoef_Lwr_Bn,PVLogTechCoef_Upr_Bn)}
{!40300|Att_SlicerPopupSize: 227,1001}

Variable Stored_Tech_Coeff
Title: Stored Tech Coefficient
Units: utility
Description: The amount of utility explained by preference for a particular technology regardless of differences in economics. These are stored values found by the calibration optimization.
Definition: Stored_PV_Dec_Vars[All_PV_Dec_Handles=Handle(Logit_Tech_Coeff)]
NodeLocation: 592,552,1
NodeSize: 64,40
Aliases: Alias Al1539126688
DisplayOutputs: Function Sequential_Opt_PV0, Function Set_Start_Coeff_PV0, Function Sequential_Opt_PV2
TableCellDefault: 0

Constant Default_PV_PriceCoef
Title: Default PV Price Coeff
Units: utility/ratio
Description: Default value for the corresponding decision variable.
Definition: -2.3505896564342965
NodeLocation: 112,456,1
NodeSize: 64,40
Aliases: FormNode Fo1539127120

Constant Default_PV_Tech_Coef
Title: Default PV Tech Coeff
Units: utility
Description: Default value for the corresponding decision variable.
Definition: 7.9865764817160425
NodeLocation: 112,552,1
NodeSize: 64,40
Aliases: FormNode Fo1539127121

Constant Default_PV_Spat_Coef
Title: Default PV Spatial Coeff
Units: utility
Description: Default value for the corresponding decision variable.
Definition: 0
NodeLocation: 112,648,1
NodeSize: 64,40
Aliases: FormNode Fo1539127122

FormNode Fo1539127120
Title: Default PV Price Coeff
Definition: 0
NodeLocation: 1036,196,1
NodeSize: 188,20
NodeColor: 49344,49344,49344
Original: Default_PV_PriceCoef

FormNode Fo1539127121
Title: Default PV Tech Coeff
Definition: 0
NodeLocation: 1036,236,1
NodeSize: 188,20
NodeColor: 49344,49344,49344
Original: Default_PV_Tech_Coef

FormNode Fo1539127122
Title: Default PV Spatial Coeff
Definition: 0
NodeLocation: 1036,276,1
NodeSize: 188,20
NodeColor: 49344,49344,49344
Original: Default_PV_Spat_Coef

FormNode Fo1539127221
Title: Logit Price Coefficient
Definition: 0
NodeLocation: 1044,620,1
NodeSize: 188,20
NodeInfo: 1,,,,,,,72,,,,,
NodeColor: 49344,49344,49344
Original: Logit_Price_Coeff

FormNode Fo1539127222
Title: Logit Spatial Coefficient
Definition: 0
NodeLocation: 1044,700,1
NodeSize: 188,20
NodeInfo: 1,,,,,,,72,,,,,
NodeColor: 49344,49344,49344
Original: Logit_Spatial_Coeff

FormNode Fo1539127223
Title: Logit Tech Coefficient
Definition: 0
NodeLocation: 1044,660,1
NodeSize: 188,20
NodeInfo: 1,,,,,,,72,,,,,
NodeColor: 49344,49344,49344
Original: Logit_Tech_Coeff

Decision Payback_Spatial_Coef
Title: Payback Spatial Coefficient
Units: years
Description: The payback adder that describes geographic differences in payback adoption regardless of relative economics.
Definition: 0
NodeLocation: 264,744,1
NodeSize: 64,40
WindState: 2,50,84,720,350
Aliases: Alias Al1542052311, FormNode Fo1542088631
Domain: DomContinuous
{!40300|DomainExpr: Continuous(PV_PaybkSpCoef_Lwr_B,PV_PaybSpkCoef_Upr_B)}
{!40400|CloudPlayerStyles: Show_object: no}
{!40204-40399|AWP_Attrib:Show_object: no}

Constant Default_PV_Pybk_Spat
Title: Default PV Pybk Spat Coeff
Units: utility
Description: Default value for the corresponding decision variable.
Definition: 00
NodeLocation: 112,744,1
NodeSize: 64,40
Aliases: FormNode Fo1542088632

Variable Stored_Pybk_SpatCoef
Title: Stored Payback Spat Coefficient
Units: years
Description: A payback adder that describes geographic differences in payback adoption regardless of relative economics. These are stored values found by the calibration optimization.
Definition: Stored_PV_Dec_Vars[All_PV_Dec_Handles=Handle(Payback_Spatial_Coef)]
NodeLocation: 592,744,1
NodeSize: 64,40
DefnState: 2,653,19,559,803,0,DFNM
ValueState: 2,308,57,759,603,,MIDM
Aliases: Alias Al1542052306
GraphSetup: Att_GraphIndexRange All_Spatial_ID:1,1~
Att_CatLineStyle Graph_Primary_Valdim:4~
Att_ContLineStyle Graph_Primary_Valdim:4
ReformDef: [All_Sectors,All_Spatial_ID]
ReformVal: [All_Spatial_ID,All_Sectors]
DisplayOutputs: Function Sequential_Opt_PV0, Function Set_Start_Coeff_PV0, Function Sequential_Opt_PV2
TableCellDefault: 0

FormNode Fo1542088631
Title: Payback Spatial Coefficient
Definition: 0
NodeLocation: 1044,740,1
NodeSize: 188,20
NodeInfo: 1,,,,,,,72,,,,,
NodeColor: 49344,49344,49344
Original: Payback_Spatial_Coef

FormNode Fo1542088632
Title: Default PV Payback Coeff
Definition: 0
NodeLocation: 1036,316,1
NodeSize: 188,20
NodeColor: 49344,49344,49344
Original: Default_PV_Pybk_Spat

Decision PV_Payback_Coefficie
Title: PV Payback Coefficient
Description: Coefficient on the payback acceptance curve for PV, which has the form: ~
~
EXP(PV_Payback_Coeff * Payback_time), where payback time is in years. ~

Definition: -0.3
NodeLocation: 264,840,1
NodeSize: 64,40
Aliases: Alias Al1542130160, FormNode Fo1542131035
Domain: DomContinuous
{!40300|DomainExpr: Continuous(PV_PaybkCoef_Lwr_Bn1,PV_PaybkCoef_Upr_Bn1)}
{!40400|CloudPlayerStyles: Show_object: no}
{!40204-40399|AWP_Attrib:Show_object: no}

Constant Default_PV_Pybk_Coef
Title: Default PV Pybk Coeff
Units: utility
Description: Default value for the corresponding decision variable.
Definition: -0.4
NodeLocation: 112,840,1
NodeSize: 64,40
Aliases: FormNode Fo1542161152

Variable Stored_Payback_Coeff
Title: Stored Payback Coefficient
Units: years
Description: A payback adder that describes geographic differences in payback adoption regardless of relative economics. These are stored values found by the calibration optimization.
Definition: Stored_PV_Dec_Vars[All_PV_Dec_Handles=Handle(PV_Payback_Coefficie)]
NodeLocation: 592,840,1
NodeSize: 64,40
DefnState: 2,653,19,559,803,0,DFNM
ValueState: 2,350,113,699,665,0,MIDM
Aliases: Alias Al1542302597
ReformDef: [All_Sectors,All_Spatial_ID]
ReformVal: [All_Sectors,All_Spatial_ID]
DisplayOutputs: Function Sequential_Opt_PV0, Function Set_Start_Coeff_PV0, Function Sequential_Opt_PV2
TableCellDefault: 0

FormNode Fo1542131035
Title: PV Payback Coefficient
Definition: 0
NodeLocation: 1044,780,1
NodeSize: 188,20
NodeColor: 49344,49344,49344
Original: PV_Payback_Coefficie

FormNode Fo1542161152
Title: Default PV Pybk Coeff
Definition: 0
NodeLocation: 1036,356,1
NodeSize: 188,20
NodeColor: 49344,49344,49344
Original: Default_PV_Pybk_Coef

Constant Stored_PV_Dec_Vars
Title: Stored PV Dec Vars
Definition: Table(All_Spatial_ID,All_Sectors,All_PV_Dec_Handles)(~
0,0,0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,0,0,~
0,0,0,0,0,0,0,0,0,~
0.014746382372574227,0.7252880274247999,0,-0.2999995650865975,0,0,0,0,0,~
0.0010476829039247188,0.2758962629607406,0,-0.2070920858414789,0,0,0,0,0,~
0,0,0,0,0,0,0,0,0,~
0.0010052993536203163,0.9152769394726903,0,-0.2999995650865975,0,0,0,0,-0.9491263060460127,~
0.0027042067429349165,0.469575052358062,0,-0.2070920858414789,0,0,0,0,6.531893258562655,~
0,0,0,0,0,0,0,0,0,~
0.0010049772152051172,0.8294719847817236,0,-0.2999995650865975,0,0,0,0,-0.9873336414526737,~
0.03,2,0,-0.2070920858414789,0,0,0,0,7.3035859164992925,~
0,0,0,0,0,0,0,0,0,~
0,1.3463688974376398,0,-0.2999995650865975,0,0,0,0,2.530586086390402,~
0.028723889088628062,2,0,-0.2070920858414789,0,0,0,0,-0.14183954676147964,~
0,0,0,0,0,0,0,0,0,~
0.0009966356634278524,0.8355352219732217,0,-0.2999995650865975,0,0,0,0,1.6221279269241324,~
0.03,2,0,-0.2070920858414789,0,0,0,0,-2.5936199821363606,~
0,0,0,0,0,0,0,0,0,~
0.001007414966571295,0.644933743611717,0,-0.2999995650865975,0,0,0,0,0.35002945612088227,~
0.001025845355201067,1.5900600109273,0,-0.2070920858414789,0,0,0,0,2.6369055133858414,~
0,0,0,0,0,0,0,0,0,~
0.0010101781424679825,0.6272962473272301,0,-0.2999995650865975,0,0,0,0,0.3665482462774385,~
0,0.18011804045680846,0,-0.2070920858414789,0,0,0,0,-4.1732727637512355,~
0,0,0,0,0,0,0,0,0,~
0.0010070593505532002,1.0184107994333198,0,-0.2999995650865975,0,0,0,0,0.7143614700255365,~
0.03,2,0,-0.2070920858414789,0,0,0,0,-4.323534152249983,~
0,0,0,0,0,0,0,0,0,~
0.0010122009012552484,1.0927047329579431,0,-0.2999995650865975,0,0,0,0,-0.4334622874542847,~
0.0022409958515429824,1.0077397290634067,0,-0.2070920858414789,0,0,0,0,1.7906672640012222,~
0,0,0,0,0,0,0,0,0,~
0,1.1550938899235992,0,-0.2999995650865975,0,0,0,0,1.5470216219746664,~
0.0010018583071297678,0.5485060251544773,0,-0.2070920858414789,0,0,0,0,-1.8414378713377844,~
0,0,0,0,0,0,0,0,0,~
0.0010202336864982187,0.7734450534423578,0,-0.2999995650865975,0,0,0,0,1.1361723000650787,~
0.0009786167263824347,0.5332830149149383,0,-0.2070920858414789,0,0,0,0,1.5755594321176354,~
0,0,0,0,0,0,0,0,0,~
0.0009737214856509547,0.8675232012999867,0,-0.2999995650865975,0,0,0,0,1.8730877960369035,~
0.0017263085174778555,2,0,-0.2070920858414789,0,0,0,0,0.9633904266493087,~
0,0,0,0,0,0,0,0,0,~
0.0033286166778488395,0,0,-0.2999995650865975,0,0,0,0,-8.184395435177732,~
0.001627481436683666,2,0,-0.2070920858414789,0,0,0,0,-2.3917301030830287,~
0,0,0,0,0,0,0,0,0,~
0.0009410635872052856,0.9263688550141943,0,-0.2999995650865975,0,0,0,0,2.1149866290176127,~
0.01645005823623402,0,0,-0.2070920858414789,0,0,0,0,-12.693306808727318,~
0,0,0,0,0,0,0,0,0,~
0.009583871754461595,0.0425304585211804,0,-0.2999995650865975,0,0,0,0,-5.469483049633989,~
0,0,0,-0.2070920858414789,0,0,0,0,15,~
0,0,0,0,0,0,0,0,0,~
0.0010041928770379471,0.8769676031645344,0,-0.2999995650865975,0,0,0,0,-1.5562651372663185,~
0.0009636519825536712,0,0,-0.2070920858414789,0,0,0,0,0.3613111872500656,~
0,0,0,0,0,0,0,0,0,~
0.0003076181940525571,0.9375933813788043,0,-0.2999995650865975,0,0,0,0,-0.3164297451208954,~
0,0,0,-0.2070920858414789,0,0,0,0,-6.145446474733272,~
0,0,0,0,0,0,0,0,0,~
1.2842718732663455e-007,0.7434589470451531,0,-0.2999995650865975,0,0,0,0,0.5414325598257308,~
0,0,0,-0.2070920858414789,0,0,0,0,-8.082098281814448,~
0,0,0,0,0,0,0,0,0,~
0.0010025803380343643,0.7446639632493868,0,-0.2999995650865975,0,0,0,0,0.45335645397836893,~
0,0,0,-0.2070920858414789,0,0,0,0,-7.8045442195865515,~
0,0,0,0,0,0,0,0,0,~
0,0,0,-0.2999995650865975,0,0,0,0,-10.754896107015618,~
0,0,0,-0.2070920858414789,0,0,0,0,15,~
0,0,0,0,0,0,0,0,0,~
0.001245963203699558,0.7306260092472507,0,-0.2999995650865975,0,0,0,0,2.1517222327666565,~
0.00125950910217404,0.8623159295546174,0,-0.2070920858414789,0,0,0,0,5.9520326325038875,~
0,0,0,0,0,0,0,0,0,~
0.0010095926061229248,0.6726428994180629,0,-0.2999995650865975,0,0,0,0,0.16513961332760901,~
0,0,0,-0.2070920858414789,0,0,0,0,15,~
0,0,0,0,0,0,0,0,0,~
0.01835463273356363,0,0,-0.2999995650865975,0,0,0,0,-8.500896026646032,~
0.00005175393434573187,1.9999982339981353,0,-0.2070920858414789,0,0,0,0,-1.1593435869085933,~
0,0,0,0,0,0,0,0,0,~
0.0009853345571635627,0.7244567658051466,0,-0.2999995650865975,0,0,0,0,-0.5658725148265563,~
0,0.7071897060677269,0,-0.2070920858414789,0,0,0,0,3.118950175908115,~
0,0,0,0,0,0,0,0,0,~
0.0010016812129454496,0.630869190675066,0,-0.2999995650865975,0,0,0,0,-0.42563249856891683,~
0,0.42484368823679547,0,-0.2070920858414789,0,0,0,0,-4.330279500840788,~
0,0,0,0,0,0,0,0,0,~
0,0,0,-0.2999995650865975,0,0,0,0,-11.355494952926177,~
0,0,0,-0.2070920858414789,0,0,0,0,4.931042509662195,~
0,0,0,0,0,0,0,0,0,~
0.0010011630984743352,0.7664049770853345,0,-0.2999995650865975,0,0,0,0,-1.0987015112421994,~
0.022670597206967385,2,0,-0.2070920858414789,0,0,0,0,0.690626688666359,~
0,0,0,0,0,0,0,0,0,~
0.0009890446823555606,0.4308343105769808,0,-0.2999995650865975,0,0,0,0,-1.2386437563452328,~
0.008464022249738638,0.7413922305718779,0,-0.2070920858414789,0,0,0,0,-3.568729308364897,~
0,0,0,0,0,0,0,0,0,~
0.0010033796922241701,0.6058744427651213,0,-0.2999995650865975,0,0,0,0,0.993676828893954,~
0,0.08579094702113538,0,-0.2070920858414789,0,0,0,0,6.016530651678085,~
0,0,0,0,0,0,0,0,0,~
0.001002710553836615,0.6957215915347571,0,-0.2999995650865975,0,0,0,0,0.9878242224468381,~
0,0.469194378226052,0,-0.2070920858414789,0,0,0,0,6.183757334578655,~
0,0,0,0,0,0,0,0,0,~
0.0010052096931927519,0.8209372908814772,0,-0.2999995650865975,0,0,0,0,-0.1960537948387557,~
0.003678411758365895,0.8695243833211068,0,-0.2070920858414789,0,0,0,0,3.444528461932403,~
0,0,0,0,0,0,0,0,0,~
0.0025671239683907536,0.7080311923991672,0,-0.2999995650865975,0,0,0,0,0.9824058391154048,~
0.0010071905271466523,1.0739451784181133,0,-0.2070920858414789,0,0,0,0,3.0095094623489604,~
0,0,0,0,0,0,0,0,0,~
0.001003353354353367,0.7438124296958204,0,-0.2999995650865975,0,0,0,0,1.013062149530971,~
0,0,0,-0.2070920858414789,0,0,0,0,1.0250346293208943,~
0,0,0,0,0,0,0,0,0,~
0.0010013180634431925,0.5110180909547027,0,-0.2999995650865975,0,0,0,0,0.3254049032091543,~
0.000965522720198346,0.3377906058108664,0,-0.2070920858414789,0,0,0,0,2.824363540581106,~
0,0,0,0,0,0,0,0,0,~
0.0010068843336194107,0.9604403187165382,0,-0.2999995650865975,0,0,0,0,-0.608848044922831,~
0,0.3370767520076572,0,-0.2070920858414789,0,0,0,0,-4.894457562792096,~
0,0,0,0,0,0,0,0,0,~
0.0009996825600733195,0.6884544861963033,0,-0.2999995650865975,0,0,0,0,-0.9381796267340776,~
0.001360077745186573,0.3270390256948845,0,-0.2070920858414789,0,0,0,0,2.9073560036852677,~
0,0,0,0,0,0,0,0,0,~
0.001000056563569202,0.7303581099394816,0,-0.2999995650865975,0,0,0,0,-1.2162463714276353,~
0.0010476829039247188,0.2758962629607406,0,-0.2070920858414789,0,0,0,0,0,~
0,0,0,0,0,0,0,0,0,~
0.00013327187151939064,0.6496152676206263,0,-0.2999995650865975,0,0,0,0,0.18233834921641714,~
0.0010003520604672316,0.4116886060028474,0,-0.2070920858414789,0,0,0,0,-0.0010890243128733993,~
0,0,0,0,0,0,0,0,0,~
0.0010027631962504107,0.735165146407985,0,-0.2999995650865975,0,0,0,0,-1.1939799273414444,~
0.0010476829039247188,0.2758962629607406,0,-0.2070920858414789,0,0,0,0,0,~
0,0,0,0,0,0,0,0,0,~
0.0009990092339596194,0.7079952852637408,0,-0.2999995650865975,0,0,0,0,-0.5485544780180803,~
0,0.7436762816223107,0,-0.2070920858414789,0,0,0,0,1.2089696799508134,~
0,0,0,0,0,0,0,0,0,~
0.0009945123332992314,0.7320870054555111,0,-0.2999995650865975,0,0,0,0,-1.310476297569173,~
0.0008430134827451556,0.23769459712247493,0,-0.2070920858414789,0,0,0,0,-2.9745112130437343,~
0,0,0,0,0,0,0,0,0,~
0.0010044316072050895,0.6380431872172077,0,-0.2999995650865975,0,0,0,0,-1.6244012285355618,~
0.019496956755409755,0.7124838231084447,0,-0.2070920858414789,0,0,0,0,-1.9131334501423636,~
0,0,0,0,0,0,0,0,0,~
0.0009980248489720612,0.6057196317107676,0,-0.2999995650865975,0,0,0,0,-1.7765480814714751,~
0.0015198307064898415,0.6328684523316883,0,-0.2070920858414789,0,0,0,0,5.327596844863788,~
0,0,0,0,0,0,0,0,0,~
0.0030401848376726956,0.12368012456868407,0,-0.2999995650865975,0,0,0,0,-15,~
0,0,0,-0.2070920858414789,0,0,0,0,-8.669800798731012,~
0,0,0,0,0,0,0,0,0,~
0.000958789190644887,0.7760805346735676,0,-0.2999995650865975,0,0,0,0,1.4210797272495443,~
0,0.12394256851847905,0,-0.2070920858414789,0,0,0,0,-0.1424817140115472,~
0,0,0,0,0,0,0,0,0,~
0.001005251903970922,1.0699842756561069,0,-0.2999995650865975,0,0,0,0,-1.072666791795266,~
0.0009316895367799304,0.821664348426891,0,-0.2070920858414789,0,0,0,0,10.570588800163451,~
0,0,0,0,0,0,0,0,0,~
0.0009990598977724276,0.4825808890569241,0,-0.2999995650865975,0,0,0,0,-0.14169544952969565,~
0.0007289297367765911,1.6458135012166961,0,-0.2070920858414789,0,0,0,0,6.063369839696423,~
0,0,0,0,0,0,0,0,0,~
0,0,0,-0.2999995650865975,0,0,0,0,-13.756317165101095,~
0.00315375380128937,2,0,-0.2070920858414789,0,0,0,0,6.940281611716126,~
0,0,0,0,0,0,0,0,0,~
0.0009937320971583165,0.7198298537280565,0,-0.2999995650865975,0,0,0,0,0.8986363483831082,~
0,1.4306694906605142,0,-0.2070920858414789,0,0,0,0,3.809100687306145,~
0,0,0,0,0,0,0,0,0,~
0.0010013027316649122,0.7513206302993128,0,-0.2999995650865975,0,0,0,0,0.49218516663904915,~
0.0008239730962625467,0.1509471848011571,0,-0.2070920858414789,0,0,0,0,-1.2979305418645537,~
0,0,0,0,0,0,0,0,0,~
0.0009943707816621968,0.6697916543684597,0,-0.2999995650865975,0,0,0,0,0.4245939089031814,~
0.025125629632803168,2,0,-0.2070920858414789,0,0,0,0,5.532346160016484,~
0,0,0,0,0,0,0,0,0,~
0.0010045049750764768,0.8357860763124902,0,-0.2999995650865975,0,0,0,0,-0.6369392894121694,~
0.00005073235651279959,0.3114823137875958,0,-0.2070920858414789,0,0,0,0,-1.676983115814813,~
0,0,0,0,0,0,0,0,0,~
0.001447439708839154,0.5477113820140266,0,-0.2999995650865975,0,0,0,0,5.966586439163852,~
0.00002919932697906152,2,0,-0.2070920858414789,0,0,0,0,7.84735317721632,~
0,0,0,0,0,0,0,0,0,~
0.0010235760303227575,0.7210835115636596,0,-0.2999995650865975,0,0,0,0,-2.848081608931068,~
0.000988112853198494,0.8960345632958806,0,-0.2070920858414789,0,0,0,0,-4.73021887225841,~
0,0,0,0,0,0,0,0,0,~
0.0010006658115861444,0.7757239539923273,0,-0.2999995650865975,0,0,0,0,-1.3694258972066304,~
0.02077107268042892,0.21044819910181134,0,-0.2070920858414789,0,0,0,0,-0.6299405546012362,~
0,0,0,0,0,0,0,0,0,~
0.0010081764206126326,0.9296584417495851,0,-0.2999995650865975,0,0,0,0,-1.5476771219736862,~
0.005074073249781572,0,0,-0.2070920858414789,0,0,0,0,-15,~
0,0,0,0,0,0,0,0,0,~
0.023494392833717105,0,0,-0.2999995650865975,0,0,0,0,-7.6947731007150555,~
0.000013000782124220468,1.9999891771789315,0,-0.2070920858414789,0,0,0,0,-9.272808664900971,~
0,0,0,0,0,0,0,0,0,~
0.0010021811153146972,0.6167502270235616,0,-0.2999995650865975,0,0,0,0,-1.0457825047563631,~
0.0010407258344274683,0.4054161509057595,0,-0.2070920858414789,0,0,0,0,1.0414867355679847,~
0,0,0,0,0,0,0,0,0,~
0.005374300938739581,1.5336358479846435,0,-0.2999995650865975,0,0,0,0,-10.442245628425034,~
0,0,0,-0.2070920858414789,0,0,0,0,15,~
0,0,0,0,0,0,0,0,0,~
0.0010059363819498487,0.8330670938011343,0,-0.2999995650865975,0,0,0,0,-0.41607427477368253,~
0,0,0,-0.2070920858414789,0,0,0,0,-7.792144264578976,~
0,0,0,0,0,0,0,0,0,~
0.029176195968963432,0.4255884153812344,0,-0.2999995650865975,0,0,0,0,-0.1005979694774111,~
0.005921568705875482,0.7257798646960586,0,-0.2070920858414789,0,0,0,0,14.989678096101457,~
0,0,0,0,0,0,0,0,0,~
0.001005243113350676,0.8362923665923407,0,-0.2999995650865975,0,0,0,0,-0.2512152411096586,~
0.0009987394669702643,0.30726155905574676,0,-0.2070920858414789,0,0,0,0,-0.46131083350121743,~
0,0,0,0,0,0,0,0,0,~
0.020302879223741067,0.7010355120063925,0,-0.2999995650865975,0,0,0,0,-9.684212708233023,~
0,0,0,-0.2070920858414789,0,0,0,0,15,~
0,0,0,0,0,0,0,0,0,~
0.001003689803355446,0.5921364351240712,0,-0.2999995650865975,0,0,0,0,0.542453262099123,~
0,0,0,-0.2070920858414789,0,0,0,0,-6.116422367836102,~
0,0,0,0,0,0,0,0,0,~
0.0009909683458484177,0.49656822365182773,0,-0.2999995650865975,0,0,0,0,-1.2343264916902226,~
0.006213611163382366,0.3987613723918748,0,-0.2070920858414789,0,0,0,0,4.542615132815714,~
0,0,0,0,0,0,0,0,0,~
0.00042292702969743936,0.7060156900147723,0,-0.2999995650865975,0,0,0,0,0.5388753710402665,~
0.0010373201599039534,0.5908304412224695,0,-0.2070920858414789,0,0,0,0,2.286866879388461,~
0,0,0,0,0,0,0,0,0,~
0.001005312018827875,0.8235462608530336,0,-0.2999995650865975,0,0,0,0,-1.554893545354534,~
0,0.10402548537997053,0,-0.2070920858414789,0,0,0,0,-4.3537793628761,~
0,0,0,0,0,0,0,0,0,~
0.0009569336729747004,0.7305460296155153,0,-0.2999995650865975,0,0,0,0,-0.06982695646460993,~
0,1.2589053324148591,0,-0.2070920858414789,0,0,0,0,6.015795527012762,~
0,0,0,0,0,0,0,0,0,~
0.0010014178908098494,0.6752098055474415,0,-0.2999995650865975,0,0,0,0,-1.202705666733784,~
0,0.2689374104392054,0,-0.2070920858414789,0,0,0,0,-4.646904411803862,~
0,0,0,0,0,0,0,0,0,~
0.0061704508290488505,1.79568982580476,0,-0.2999995650865975,0,0,0,0,-0.6203845588585288,~
0,0,0,-0.2070920858414789,0,0,0,0,15,~
0,0,0,0,0,0,0,0,0,~
0.016158396256318323,0.0007321030256445353,0,-0.2999995650865975,0,0,0,0,-10.200196772053928,~
0.024704441998481954,1.7038236631563972,0,-0.2070920858414789,0,0,0,0,1.8666808553193224,~
0,0,0,0,0,0,0,0,0,~
0.005138071769412413,0.1858453858475363,0,-0.2999995650865975,0,0,0,0,-6.916430625611212,~
0.007004338866584546,2,0,-0.2070920858414789,0,0,0,0,10.24111762149843,~
0,0,0,0,0,0,0,0,0,~
0,0,0,-0.2999995650865975,0,0,0,0,-12.020897100223646,~
0,0,0,-0.2070920858414789,0,0,0,0,14.999999999999998,~
0,0,0,0,0,0,0,0,0,~
0.02414355613484213,1.0875574020145262,0,-0.2999995650865975,0,0,0,0,-1.6891236355011916,~
0,0,0,-0.2070920858414789,0,0,0,0,15,~
0,0,0,0,0,0,0,0,0,~
0.012056545914177106,0.6709661123673274,0,-0.2999995650865975,0,0,0,0,-0.6203845588585288,~
0,0,0,-0.2070920858414789,0,0,0,0,15,~
0,0,0,0,0,0,0,0,0,~
0,0,0,-0.2999995650865975,0,0,0,0,-12.053068185715503,~
0.010175990845776195,0,0,-0.2070920858414789,0,0,0,0,-2.0578571316576713,~
0,0,0,0,0,0,0,0,0,~
0.0010022610347142948,0.5477617223719102,0,-0.2999995650865975,0,0,0,0,0.3692711677031439,~
0.0009905892326298855,0.05686877435582576,0,-0.2070920858414789,0,0,0,0,0.11344318385935916,~
0,0,0,0,0,0,0,0,0,~
0.001224308487120274,0.8001815674510437,0,-0.2999995650865975,0,0,0,0,1.9579604467080869,~
0.02566143492043491,2,0,-0.2070920858414789,0,0,0,0,9.548135667164857,~
0,0,0,0,0,0,0,0,0,~
0.0009975143224976901,0.3766945020240313,0,-0.2999995650865975,0,0,0,0,-0.568157435377945,~
0.025202314231905314,1.2971451185291754,0,-0.2070920858414789,0,0,0,0,9.130054732218735,~
0,0,0,0,0,0,0,0,0,~
0.001000942848664846,0.4811254003717407,0,-0.2999995650865975,0,0,0,0,-0.11350709289388397,~
0.0009449234652206136,0.733418460036241,0,-0.2070920858414789,0,0,0,0,2.339107565683631,~
0,0,0,0,0,0,0,0,0,~
0.0010019139227446748,0.7839477607248242,0,-0.2999995650865975,0,0,0,0,0.5153001300064882,~
0.0008287009311049157,0.05628673237653349,0,-0.2070920858414789,0,0,0,0,-2.200499892278264,~
0,0,0,0,0,0,0,0,0,~
0.0009934977396805363,0.4529779221774901,0,-0.2999995650865975,0,0,0,0,0.6264650724489169,~
0,0,0,-0.2070920858414789,0,0,0,0,0.35957314658030043,~
0,0,0,0,0,0,0,0,0,~
0.0027368794901675604,0,0,-0.2999995650865975,0,0,0,0,-13.463990831963713,~
0.02386315718146945,0,0,-0.2070920858414789,0,0,0,0,-0.3602249319235168,~
0,0,0,0,0,0,0,0,0,~
0.0010018816334453424,0.46396995170208233,0,-0.2999995650865975,0,0,0,0,0.12557742477981723,~
0.013432428342756915,0.052559823175683654,0,-0.2070920858414789,0,0,0,0,6.613733210983496,~
0,0,0,0,0,0,0,0,0,~
0.0008902492130554275,1.1433172076954583,0,-0.2999995650865975,0,0,0,0,1.621884950961788,~
0.0006961282272383192,0.0431326048913229,0,-0.2070920858414789,0,0,0,0,1.1969531275144547,~
0,0,0,0,0,0,0,0,0,~
0.0009255710072549503,0.6371944588100835,0,-0.2999995650865975,0,0,0,0,0.5970595124231063,~
0.0010035828556422186,0.469289143332895,0,-0.2070920858414789,0,0,0,0,2.1106135748943506,~
0,0,0,0,0,0,0,0,0,~
0.00676795687841622,1.500553664518778,0,-0.2999995650865975,0,0,0,0,-14.98880176338777,~
0.0014221786610853736,2,0,-0.2070920858414789,0,0,0,0,6.130303921206558,~
0,0,0,0,0,0,0,0,0,~
0,0.4608682126639762,0,-0.2999995650865975,0,0,0,0,-0.7250259513852111,~
0.0010476829039247188,0.2758962629607406,0,-0.2070920858414789,0,0,0,0,0,~
0,0,0,0,0,0,0,0,0,~
0.0001407098900421719,0.8918454746233708,0,-0.2999995650865975,0,0,0,0,0.28382914124696945,~
0,0.5102102515672987,0,-0.2070920858414789,0,0,0,0,-7.666325537120264,~
0,0,0,0,0,0,0,0,0,~
0.0009981651746809154,0.6267398498735198,0,-0.2999995650865975,0,0,0,0,-0.2412277292581357,~
0.000993969486101815,0.891896082501583,0,-0.2070920858414789,0,0,0,0,3.645377798094811,~
0,0,0,0,0,0,0,0,0,~
0.0009043811152001597,0.7235033140409934,0,-0.2999995650865975,0,0,0,0,1.51083015821686,~
0.029477458960375617,2,0,-0.2070920858414789,0,0,0,0,5.1302609675505195,~
0,0,0,0,0,0,0,0,0,~
0.0009991346546103506,0.5377188125487056,0,-0.2999995650865975,0,0,0,0,-0.12215174164495517,~
0.0005698777368308085,0.6711020988256506,0,-0.2070920858414789,0,0,0,0,7.905803683753738,~
0,0,0,0,0,0,0,0,0,~
0.0009795584662897223,1.3790244713015918,0,-0.2999995650865975,0,0,0,0,1.4344310878202746,~
0.01917307669542946,0.9846835381701645,0,-0.2070920858414789,0,0,0,0,9.015914465098303,~
0,0,0,0,0,0,0,0,0,~
0.0010057255717922401,0.7747807098040176,0,-0.2999995650865975,0,0,0,0,-0.25628342132011606,~
0.001340417146397167,0.8036630637658772,0,-0.2070920858414789,0,0,0,0,3.2101033293353525,~
0,0,0,0,0,0,0,0,0,~
0.0010035127439322075,0.7005939008817885,0,-0.2999995650865975,0,0,0,0,-0.279301731304367,~
0.0009975090704863992,0.16592052942662605,0,-0.2070920858414789,0,0,0,0,0.2669571972159617,~
0,0,0,0,0,0,0,0,0,~
0.001026209896794113,1.3623729298895102,0,-0.2999995650865975,0,0,0,0,0.4556854088433923,~
0,0,0,-0.2070920858414789,0,0,0,0,0.02882744224759021,~
0,0,0,0,0,0,0,0,0,~
0.0010040153237094202,0.8166113602189823,0,-0.2999995650865975,0,0,0,0,1.21196352009206,~
0,0.12062735355844754,0,-0.2070920858414789,0,0,0,0,-1.665049122650715,~
0,0,0,0,0,0,0,0,0,~
0,1.452393688479919,0,-0.2999995650865975,0,0,0,0,0.4241238389009276,~
0.029421028662536083,0.369837373337601,0,-0.2070920858414789,0,0,0,0,6.2908961723776295,~
0,0,0,0,0,0,0,0,0,~
0.0010124232007112225,1.7369190275786803,0,-0.2999995650865975,0,0,0,0,0.1514273085826292,~
0.0011775235243958223,0,0,-0.2070920858414789,0,0,0,0,-9.332898305415538,~
0,0,0,0,0,0,0,0,0,~
0.0010105695931642766,0.9322837464220735,0,-0.2999995650865975,0,0,0,0,0.8007715231766018,~
0.000999539094962632,0.3327987973981224,0,-0.2070920858414789,0,0,0,0,0.7176277898245822,~
0,0,0,0,0,0,0,0,0,~
0.0009996974011482723,0.6666409943075943,0,-0.2999995650865975,0,0,0,0,-1.239399049230477,~
0.02617127585921129,0.6663435592901626,0,-0.2070920858414789,0,0,0,0,7.755608139533775,~
0,0,0,0,0,0,0,0,0,~
0.001029627387775776,0.8016908546629811,0,-0.2999995650865975,0,0,0,0,1.2186367235900424,~
5.364242641075677e-010,0,0,-0.2070920858414789,0,0,0,0,-0.5401810912896313,~
0,0,0,0,0,0,0,0,0,~
0.0010043695576317689,0.7952136775713389,0,-0.2999995650865975,0,0,0,0,-0.4636243654452531,~
0,0,0,-0.2070920858414789,0,0,0,0,-4.269455768130313,~
0,0,0,0,0,0,0,0,0,~
0.001002238645505908,0.6452165834885715,0,-0.2999995650865975,0,0,0,0,-0.08240787322921878,~
0,0,0,-0.2070920858414789,0,0,0,0,-8.170601092534687,~
0,0,0,0,0,0,0,0,0,~
0.0010039433637091578,0.7920271778776856,0,-0.2999995650865975,0,0,0,0,-0.7607108191228463,~
0.029019265083309532,2,0,-0.2070920858414789,0,0,0,0,6.318364155066806,~
0,0,0,0,0,0,0,0,0,~
0.025470015348619788,1.7554762762763894,0,-0.2999995650865975,0,0,0,0,11.558420744984605,~
0,0,0,-0.2070920858414789,0,0,0,0,14.999999999999998,~
0,0,0,0,0,0,0,0,0,~
0.00017027613637039422,2,0,-0.2999995650865975,0,0,0,0,10.965010213547929,~
0.000430959283346821,2,0,-0.2070920858414789,0,0,0,0,-3.375653237001101,~
0,0,0,0,0,0,0,0,0,~
0.0010085377340347053,1.106132944656471,0,-0.2999995650865975,0,0,0,0,1.1653069897907977,~
0.00018673672410587596,1.5468465410784162,0,-0.2070920858414789,0,0,0,0,-4.583812973897844,~
0,0,0,0,0,0,0,0,0,~
0.03,2,0,-0.2999995650865975,0,0,0,0,7.164699890409772,~
0.00029720676995387036,2,0,-0.2070920858414789,0,0,0,0,12.902820167506652,~
0,0,0,0,0,0,0,0,0,~
0.0010706338058554723,1.6094916675284001,0,-0.2999995650865975,0,0,0,0,-4.3852523106081644,~
0,0,0,-0.2070920858414789,0,0,0,0,15,~
0,0,0,0,0,0,0,0,0,~
0.0008188876206021468,0.6957523790817913,0,-0.2999995650865975,0,0,0,0,0.2928220672034639,~
0.0010073154905368463,0.6844463513222747,0,-0.2070920858414789,0,0,0,0,2.6877556112498073,~
0,0,0,0,0,0,0,0,0,~
0.018049577138409753,1.950620638183607,0,-0.2999995650865975,0,0,0,0,-13.291507679173494,~
0,0,0,-0.2070920858414789,0,0,0,0,14.999999999999998,~
0,0,0,0,0,0,0,0,0,~
0.0096770008419068,1.8747674887417,0,-0.2999995650865975,0,0,0,0,-3.1956654266434,~
0,0,0,-0.2070920858414789,0,0,0,0,14.999999999999998,~
0,0,0,0,0,0,0,0,0,~
0.0010042364545162358,0.657804647186913,0,-0.2999995650865975,0,0,0,0,0.9525063693189011,~
0,0,0,-0.2070920858414789,0,0,0,0,-6.426617879886021,~
0,0,0,0,0,0,0,0,0,~
0.018267679413905,1.7073764408507,0,-0.2999995650865975,0,0,0,0,8.0068231294895,~
0.00007532976833412314,2,0,-0.2070920858414789,0,0,0,0,3.645698298226144,~
0,0,0,0,0,0,0,0,0,~
0.015766203620362,1.008510121614,0,-0.2999995650865975,0,0,0,0,-9.6473860482906,~
0.005583444650090972,0.5927606432664956,0,-0.2070920858414789,0,0,0,0,15,~
0,0,0,0,0,0,0,0,0,~
0.013924877901527,0.15567699175127,0,-0.2999995650865975,0,0,0,0,-8.0519945468064,~
0,0,0,-0.2070920858414789,0,0,0,0,15,~
0,0,0,0,0,0,0,0,0,~
0.0069157823932673055,0.14516830085564605,0,-0.2999995650865975,0,0,0,0,-12.039282609261239,~
0.03,2,0,-0.2070920858414789,0,0,0,0,0.5314478395240358,~
0,0,0,0,0,0,0,0,0,~
0.0011925961869798827,0.4551184771045267,0,-0.2999995650865975,0,0,0,0,2.610284766271266,~
0,0,0,-0.2070920858414789,0,0,0,0,15,~
0,0,0,0,0,0,0,0,0,~
0.0016034489613505683,0.700674557549704,0,-0.2999995650865975,0,0,0,0,4.780825664609755,~
0.012987860363081267,0,0,-0.2070920858414789,0,0,0,0,7.870462731829425,~
0,0,0,0,0,0,0,0,0,~
0.0011081136729064744,0.947006903518349,0,-0.2999995650865975,0,0,0,0,3.8944691458014207,~
0.009476335490209535,1.0673748116984403,0,-0.2070920858414789,0,0,0,0,15,~
0,0,0,0,0,0,0,0,0,~
0.0006992653005034363,0.7373379023916806,0,-0.2999995650865975,0,0,0,0,-0.4529956874995524,~
0,1.1487018752111346,0,-0.2070920858414789,0,0,0,0,3.090291300827452,~
0,0,0,0,0,0,0,0,0,~
0,0,0,-0.2999995650865975,0,0,0,0,-10.778165890731927,~
0.03,2,0,-0.2070920858414789,0,0,0,0,0.7578941911127486,~
0,0,0,0,0,0,0,0,0,~
0.0013858421453700892,0.5998714526745675,0,-0.2999995650865975,0,0,0,0,4.0108066377591856,~
0.000016708109962502527,1.3715483801956234,0,-0.2070920858414789,0,0,0,0,1.3131249287508178,~
0,0,0,0,0,0,0,0,0,~
0.0010049884503622291,0.80172181170947,0,-0.2999995650865975,0,0,0,0,0.9528968411573655,~
0.025292488034455145,2,0,-0.2070920858414789,0,0,0,0,3.2251873657218493,~
0,0,0,0,0,0,0,0,0,~
0.021114344038588,1.3656663332906,0,-0.2999995650865975,0,0,0,0,4.7718547143842,~
0,0,0,-0.2070920858414789,0,0,0,0,15,~
0,0,0,0,0,0,0,0,0,~
0.0009784374983369663,0.45586228185709915,0,-0.2999995650865975,0,0,0,0,-0.10906590119593966,~
0.0003983313277965906,0.7785963782946788,0,-0.2070920858414789,0,0,0,0,5.403352423987112,~
0,0,0,0,0,0,0,0,0,~
0.025613212313323,0.80793738123399,0,-0.2999995650865975,0,0,0,0,-12.471682740129,~
0,0,0,-0.2070920858414789,0,0,0,0,15,~
0,0,0,0,0,0,0,0,0,~
0.0011127149891379286,0.66526509794265,0,-0.2999995650865975,0,0,0,0,2.8145261349980184,~
0,0.7556283435961948,0,-0.2070920858414789,0,0,0,0,9.814640904295322,~
0,0,0,0,0,0,0,0,0,~
0.001011530162933129,0.8721863284065684,0,-0.2999995650865975,0,0,0,0,-0.8082984627018754,~
0,0,0,-0.2070920858414789,0,0,0,0,15,~
0,0,0,0,0,0,0,0,0,~
0,0.6884541838086964,0,-0.2999995650865975,0,0,0,0,-0.7206346648478646,~
0.009014503811745888,2,0,-0.2070920858414789,0,0,0,0,1.3644752502556365,~
0,0,0,0,0,0,0,0,0,~
0.021555344658697,1.425512425334,0,-0.2999995650865975,0,0,0,0,-12.573452497634,~
0,0,0,-0.2070920858414789,0,0,0,0,15,~
0,0,0,0,0,0,0,0,0,~
0.0012590642585722563,0.9553678586902706,0,-0.2999995650865975,0,0,0,0,2.3146738291970195,~
0,0.5664277398199518,0,-0.2070920858414789,0,0,0,0,0.932589581619309,~
0,0,0,0,0,0,0,0,0,~
0.0010107386002915287,0.833369899313442,0,-0.2999995650865975,0,0,0,0,1.4352701626603173,~
0,0.4813499346396234,0,-0.2070920858414789,0,0,0,0,9.063413460814262,~
0,0,0,0,0,0,0,0,0,~
0.0063991716487329,1.1052008453315,0,-0.2999995650865975,0,0,0,0,4.0946091195078,~
0,0,0,-0.2070920858414789,0,0,0,0,15,~
0,0,0,0,0,0,0,0,0,~
0.0010013462633097232,0.5380805743289736,0,-0.2999995650865975,0,0,0,0,-0.3604227689934666,~
0.028736385655545683,0.3024895419968381,0,-0.2070920858414789,0,0,0,0,3.3547151577392076,~
0,0,0,0,0,0,0,0,0,~
0.0033999056617729,1.5854678776048,0,-0.2999995650865975,0,0,0,0,-8.0294573414277,~
0,0,0,-0.2070920858414789,0,0,0,0,15,~
0,0,0,0,0,0,0,0,0)
NodeLocation: 432,64,1
NodeSize: 64,40
WindState: 2,12,101,720,350
DefnState: 2,121,75,1659,813,0,DFNM
ValueState: 2,223,145,1355,686,,MIDM
Aliases: FormNode Fo1543522440
ReformDef: [0,All_Spatial_ID]
ReformVal: [All_PV_Dec_Handles,All_Spatial_ID]
DisplayOutputs: Function OG_Multi_Stage_Calib, Function OG_Sequential_Optimi
Att_ResultSliceState: [All_Sectors,1,All_Spatial_ID,6,All_PV_Dec_Handle_Li,1]
Att_EditSliceState: [All_Sectors,2,All_Spatial_ID,1,All_PV_Dec_Handle_Li,1]
{!50000|Att_ColumnWidths: [,All_PV_Dec_Handles,\([,,,,92]),All_Spatial_ID,\([,,,,,,,,64])]}

Variable Stored_Coeff_for_PV_
Title: Stored Coeff for PV Spat ID
Definition: All_Stored_Coeffs_PV[All_Spatial_ID=PV_Spatial_ID]
NodeLocation: 744,72,1
NodeSize: 64,40
WindState: 2,315,105,720,350
ValueState: 2,12,5,1848,895,0,MIDM
Aliases: FormNode Fo1543000896
GraphSetup: Att_GraphIndexRange PV_Spatial_ID:1,1~
Att_CatLineStyle Graph_Primary_Valdim:4
ReformVal: [Stored_Dec_Var_PV,PV_Spatial_ID]
Att_ResultSliceState: [All_Sectors,1,Stored_Dec_Var_PV,9,PV_Spatial_ID,1]
Att_ColorRole: Null
{!40700|Att_CellFormat: CellSpan(Stored_Dec_Var_PV,CellNumberFormat('Fixed Point',7,1,0,dateFormat:'ABBREV',fullPrecision:0,numbersAsDates:0,datesAsNumbers:0),1,2,header:0)}
{!50000|Att_ColumnWidths: [,Stored_Dec_Var_PV,\([,,31,,34,34,34,34])]}

Close Stored_Decison_Data

Module Calibration_Results
Title: Calibration Results
Author: JamesMilford
Date: Thu, Oct 4, 2018 8:27 AM
NodeLocation: 696,112,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,
DiagState: 2,1,0,951,480,17

Variable Aggregated_Sim_vs_Ac
Title: Aggregated Sim vs Act PV Systems
Units: systems
Definition: Sum(Sim_vs_Act_PV_System[PV_Spatial_ID=Spatial_ID_PV], Spatial_ID_PV)
NodeLocation: 632,72,1
NodeSize: 64,40
ValueState: 2,-1,53,828,691,1,MIDM

Variable Aggregated_Sim_vs_A4
Title: Aggregated Sim vs Act PV Install Rate
Units: systems/year
Definition: Sum(Sim_vs_Act_PV_Rate[PV_Spatial_ID=Spatial_ID_PV], Spatial_ID_PV)
NodeLocation: 776,72,1
NodeSize: 64,40
ValueState: 2,841,54,797,691,1,MIDM

Variable Aggreg_Annual_Sim_vs
Title: Aggreg Annual Sim vs Act PV Systems
Units: systems
Definition: Aggregate(Aggregated_Sim_vs_Ac*dT_PV_Data, PV_Year_Map, Time_Solar_PV, Annual_PV_Time)
NodeLocation: 632,168,1
NodeSize: 64,40
ValueState: 2,-1,53,828,691,1,MIDM

Variable Aggreg_Annual_Sim_v1
Title: Aggreg Annual Sim vs Act PV Install Rate
Units: systems/year
Definition: Aggregate(Aggregated_Sim_vs_A4*dT_PV_Data, PV_Year_Map, Time_Solar_PV, Annual_PV_Time)
NodeLocation: 776,168,1
NodeSize: 64,40
ValueState: 2,140,9,1060,691,1,MIDM

Variable Sim_vs_Actual_Cumula
Title: Sim vs Actual Cumulative Adoption
Units: stock units
Description: A comparison of actual vs simulated cumulative DER adoption.
Definition: Table(DER_Types_Stk_Units)(Sim_vs_Act, Sim_vs_Act_Vehicle_S)
NodeLocation: 240,256,1
NodeSize: 64,40
ValueState: 2,73,39,1278,798,1,MIDM
GraphSetup: Att_Stacked_Lines Graph_Primary_Valdim:0~
Att_AreaFill Graph_Primary_Valdim:0~
SymbolSize:9
ReformVal: [Output_Time,Act_vs_Sim]
NumberFormat: 2,F,4,4,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: []
Att_ResultSliceState: [DER_Types_Stk_Units,1,Spatial_IDs_with_Agg,80,Act_vs_Sim,1,Output_Time,1]

Variable Sim_vs_Act_Vehicle_S
Title: Sim vs Act Vehicle Stock Output
Units: vehicles
Definition: VAR vehicles:=Sum(Sim_vs_Act_EV_Stock[EV_Spatial_ID=Spatial_IDs_with_Agg, @Sel_Ag_EV_LRMS=1], EV_Sectors);~
~
IF (Output_Time <= Max(Time_Vehicles)) AND (Act_vs_Sim = Simulated_Label)~
THEN LinearInterp(Time_Vehicles, vehicles, Output_Time, Time_Vehicles)~
ELSE IF Act_vs_Sim = Actual_Label ~
THEN IgnoreWarnings(vehicles[Time_Vehicles=Output_Time])~
ELSE Null
NodeLocation: 240,160,1
NodeSize: 64,40
WindState: 2,102,82,1050,513
ValueState: 2,324,78,1301,739,1,MIDM
ReformVal: [Output_Time,Act_vs_Sim]
Att__TotalsIndex: [Spatial_IDs]
Att_ResultSliceState: [Spatial_IDs,0,Act_vs_Sim,1,Output_Time,1]

Variable Sim_vs_Act
Title: Sim vs Act PV System Output
Units: systems
Definition: VAR systems:=Sum(Sim_vs_Act_PV_System[PV_Spatial_ID=Spatial_IDs_with_Agg], PV_Sectors);~
~
IF (Output_Time <= Max(Time_Solar_PV)) AND (Act_vs_Sim = Simulated_Label)~
THEN LinearInterp(Time_Solar_PV, systems, Output_Time, Time_Solar_PV)~
ELSE IF Act_vs_Sim = Actual_Label ~
THEN IgnoreWarnings(systems[Time_Solar_PV=Output_Time])~
ELSE Null~

NodeLocation: 240,72,1
NodeSize: 64,40
ValueState: 2,7,38,1380,691,1,MIDM
ReformVal: [Output_Time,Act_vs_Sim]
Att__TotalsIndex: [Spatial_IDs]
Att_ResultSliceState: [Spatial_IDs,0,Act_vs_Sim,1,Output_Time,1]

Index DER_Types_Stk_Units
Att_PrevIndexValue: ['Solar PV (systems)','Electric Vehicles (vehicles)']
Title: DER Types and Stock Units
Definition: ['Solar PV (systems)','Electric Vehicles (vehicles)']
NodeLocation: 80,256,1
NodeSize: 64,40
{!40300|Att_SlicerPopupSize: 237,56}

Variable Sim_vs_Actual_Annual
Title: Sim vs Actual Annual Adoption
Units: stock units/year
Description: A comparison of actual vs simulated annual DER adoption.
Definition: Table(DER_Types_Stk_Units)(Sim_vs_Act_PV_Instal, Sim_vs_Act_Vehicle_1)
NodeLocation: 384,256,1
NodeSize: 64,40
ValueState: 2,30,29,1278,798,1,MIDM
GraphSetup: SymbolSize:9~
Att_AreaFill Graph_Primary_Valdim:0~
Att_Stacked_Lines Graph_Primary_Valdim:0
ReformVal: [Output_Time,Act_vs_Sim]
NumberFormat: 2,F,4,4,1,0,4,0,$,0,"ABBREV",0,,,0,0,15
Att__TotalsIndex: []
Att_ResultSliceState: [DER_Types_Stk_Units,1,Spatial_IDs_with_Agg,2,Act_vs_Sim,1,Output_Time,1]

Variable Sim_vs_Act_Vehicle_1
Title: Sim vs Act Vehicle Sales Output
Units: vehicles/year
Definition: VAR vehicles:=Sum(Sim_vs_Act_EV_Sales[EV_Spatial_ID=Spatial_IDs_with_Agg, @Sel_Ag_EV_LRMS=1], EV_Sectors);~
~
IF (Output_Time <= Max(Time_Vehicles)) AND (Act_vs_Sim = Simulated_Label)~
THEN LinearInterp(Time_Vehicles, vehicles, Output_Time, Time_Vehicles)~
ELSE IF Act_vs_Sim = Actual_Label ~
THEN IgnoreWarnings(vehicles[Time_Vehicles=Output_Time])~
ELSE Null
NodeLocation: 384,160,1
NodeSize: 64,40
WindState: 2,102,82,1050,513
ValueState: 2,324,78,1301,739,1,MIDM
ReformVal: [Output_Time,Act_vs_Sim]
Att__TotalsIndex: [Spatial_IDs]
Att_ResultSliceState: [Spatial_IDs,0,Act_vs_Sim,1,Output_Time,1]

Variable Sim_vs_Act_PV_Instal
Title: Sim vs Act PV Install Output
Units: systems/year
Definition: VAR systems:=Sum(Sim_vs_Act_PV_Rate[PV_Spatial_ID=Spatial_IDs_with_Agg], PV_Sectors);~
~
IF (Output_Time <= Max(Time_Solar_PV)) AND (Act_vs_Sim = Simulated_Label)~
THEN LinearInterp(Time_Solar_PV, systems, Output_Time, Time_Solar_PV)~
ELSE IF Act_vs_Sim = Actual_Label ~
THEN IgnoreWarnings(systems[Time_Solar_PV=Output_Time])~
ELSE Null~

NodeLocation: 384,72,1
NodeSize: 64,40
ValueState: 2,7,38,1380,691,1,MIDM
ReformVal: [Output_Time,Act_vs_Sim]
Att__TotalsIndex: [Spatial_IDs]
Att_ResultSliceState: [Spatial_IDs,0,Act_vs_Sim,1,Output_Time,1]

Close Calibration_Results

Module Mo1
Author: coryw
Date: Tue, Nov 20, 2018 12:18 PM
NodeLocation: 840,112,1
NodeSize: 64,40
NodeInfo: 1,0,0,1,1,1,0,,0,,0,,,

Text Te1535066202
Title: Ideas: ~
sort by largest ZIP Codes first.~
Ensure everything works when a subset of decision variables is selected. ~
Calculate a mean coefficient to apply if little data for a fit. ~
Figure out how to cluster ZIP Codes?~
Set upper bound on InitFam to the initial maximum market share. ~
set up checks to ensure you either do or don't want to overwrite previously stored coefficients (assume you DO as default?)~
Come up with approach/process for calibrating coefficients at state level, and then only solving for equil market share.~
Adjust historical sales calculation by a multiplier given known actual sales. Calibrate vehicle lifetime to fit sales. ~
Add a warning, or disallow, when vehicle end time is longer than finish Time of the overall model. ~
~

NodeLocation: 268,724,-1
NodeSize: 204,236
NodeInfo: 1,0,0,1,0,0,1,,0,,0,,,
NodeFont: Arial,16

Index Aggreg_PV_LRMS
Att_PrevIndexValue: [0.25,0.5,0.75]
Title: Aggreg PV Long Run Mkt Share
Description: This is the scenario for assumed long run market share of the most aggregated output used for establishing default diffusion parameters. It is not necessarily the long run market share for any given spatial ID.
Definition: [0.25,0.5,0.75]
NodeLocation: 112,64,1
NodeSize: 64,40

Decision Spatial_ID_for_Assi1
Title: Spatial ID for Assigning Default Coeff
Description: Select which spatial ID you wish to use for assigning its values to the default coefficients.
Definition: Choice(All_Spatial_ID,1,0)
NodeLocation: 448,384,1
NodeSize: 72,40
Aliases: FormNode Fo1535066236
NodeColor: 65535,1,1
{!40200|Att_ChoiceIndexes: Index All_Spatial_ID}

Decision EV_LRMS_Scen_for_Th1
Title: EV LRMS Scen for Threshold
Description: Select which EV long run market share scenario you wish to use for calculating whether or not a particular spatial ID meets the R2 threshold for adding decision variables. 
Definition: Choice(EV_LRMS_Scenario,2,0)
NodeLocation: 192,160,1
NodeSize: 56,40
Aliases: FormNode Fo1535066232
{!40200|Att_ChoiceIndexes: Index EV_LRMS_Scenario}

FormNode Fo1535066232
Title: EV LRMS Scen for Threshold
Definition: 0
NodeLocation: 228,96,1
NodeSize: 164,16
NodeInfo: 1,,,,,,0,73,,,,,,0
Original: EV_LRMS_Scen_for_Th1

Text Te1535066203
Title: Old
NodeLocation: 280,236,-1
NodeSize: 232,212
NodeInfo: 1,0,0,1,1,0,0,,0,,0,,,

Button Assign_Stored_to_De1
Title: Assign Stored to Default Coeff
Description: Pushing this button will assign the selected stored coefficients (per the user-defined "Spatial ID for Assignment") to the default coefficient values.
NodeLocation: 216,284,1
NodeSize: 56,52
WindState: 2,102,82,1147,350
NodeColor: 65535,1,1
OnClick: (Default_PVAdEff:=Stored_AdEff_PV[All_Spatial_ID=Spatial_ID_for_Assi1, All_Sectors=Sector_for_Assignin1, Aggreg_PV_LRMS=EV_LRMS_for_Assigni1]);~
(Default_PV_WOM:=Stored_WOM_PV[ All_Spatial_ID=Spatial_ID_for_Assi1, All_Sectors=Sector_for_Assignin1, Aggreg_PV_LRMS=EV_LRMS_for_Assigni1]);~
(Default_PV_End_WOM:=Stored_End_WOM_PV[All_Spatial_ID=Spatial_ID_for_Assi1, All_Sectors=Sector_for_Assignin1, Aggreg_PV_LRMS=EV_LRMS_for_Assigni1]);~
(Default_PV_LRMS:=Stored_LRMS_PV[All_Spatial_ID=Spatial_ID_for_Assi1, All_Sectors=Sector_for_Assignin1, Aggreg_PV_LRMS=EV_LRMS_for_Assigni1]);~
{(Default_PV_Early_Ret:=StoredEV_EarlyRetir1[All_Spatial_ID=Spatial_ID_for_Assi1, All_Sectors=Sector_for_Assignin1, Aggregate_EV_LRMS1=EV_LRMS_for_Assigni1]);}

Button AssignDefaultCoeffPV
Title: Assign Default Coeff to Decision Variables
Description: Pushing this button will assign the default values for each EV diffusion coefficient to the actual decision variables used in the optimization of diffusion parameters. You'll likely want to do this when only a subset of the diffusion parameters are being optimized, since the optimization script will hold constant (at the value of the current input for the decision variable).
NodeLocation: 352,284,1
NodeSize: 64,52
NodeColor: 65535,1,1
OnClick: (PV_Ad_Effectiveness:=Default_PVAdEff);~
(PV_Word_of_Mouth:=Default_PV_WOM);~
(PV_Ending_WOM:=Default_PV_End_WOM);~
(PV_LongRun_Mkt_Share:=Default_PV_LRMS);~
{(Early_Retiremnt_Mul1:=Default_PV_Early_Ret);}

Decision Sector_for_Assignin1
Title: Sector for Assigning Default Coeff
Description: Select which sector you wish you use for the current value of the decision variables. Since "stored coefficients" are typically only used when running the model, this would likely be primarily for test purposes, if you chose to turn on "Use EV Decision Variables," for instance, and wished to see the impact of manually specifying a particular set of coefficients. ~
~
After selecting this value, you must run the "Assigned Default Coeff to Decision Variables" Script to assign the correct values.
Definition: Choice(All_Sectors,3,0)
NodeLocation: 448,152,1
NodeSize: 64,40
WindState: 2,201,201,720,350
Aliases: FormNode Fo1535066235
NodeColor: 65535,1,1
{!40200|Att_ChoiceIndexes: Index All_Sectors}

FormNode Fo1535066235
Title: Sector for Assigning Default Coeff
Definition: 0
NodeLocation: 456,208,1
NodeSize: 136,16
NodeInfo: 1,0,0,0,0,0,0,233,0,,0,,,
Original: Sector_for_Assignin1

FormNode Fo1535066236
Title: Spatial ID for Assigning Default Coeff
Definition: 0
NodeLocation: 452,432,1
NodeSize: 68,16
NodeInfo: 1,0,0,0,0,0,0,94,0,,0,,,
Original: Spatial_ID_for_Assi1

Index Select_Ag_PV_LRMS
Title: Selected Aggregate PV LRMS Scen
Description: User specified selected "aggregate" long run market share scenario
Definition: MultiChoice(Aggreg_PV_LRMS,2,returnList:1)
NodeLocation: 112,64,1
NodeSize: 64,40
WindState: 2,102,82,981,634
Aliases: FormNode Fo1535066240
{!40200|Att_ChoiceIndexes: Index Aggreg_PV_LRMS}
{!40300|Att_SlicerPopupSize: 232,70}

FormNode Fo1535066240
Title: Selected EV LRMS Scen
Definition: 0
NodeLocation: 492,464,1
NodeSize: 212,16
NodeInfo: 1,,,,,,0,120,,,,,,0
Original: Select_Ag_PV_LRMS

Decision EV_LRMS_for_Assigni1
Title: EV LRMS for Assigning Default Coeff
Definition: Choice(Aggreg_PV_LRMS,2,0)
NodeLocation: 600,384,1
NodeSize: 64,40
Aliases: FormNode Fo1535066241
NodeColor: 65535,1,1
{!40200|Att_ChoiceIndexes: Index Aggreg_PV_LRMS}

FormNode Fo1535066241
Title: EV LRMS for Assigning Default Coeff
Definition: 0
NodeLocation: 600,432,1
NodeSize: 64,16
NodeInfo: 1,0,0,0,0,0,0,73,0,,0,,,
Original: EV_LRMS_for_Assigni1

Close Mo1

Close Calibration_Details

Text Te1542730146
Title: Key Input
NodeLocation: 468,216,-1
NodeSize: 444,200
NodeInfo: 1,0,0,1,1,1,1,,0,,0,,,
WindState: 2,102,83,476,224
NodeFont: Arial,24

Text Te1542730147
Title: Key Output
NodeLocation: 468,608,-3
NodeSize: 444,192
NodeInfo: 1,0,0,1,1,1,1,,0,,0,,,
WindState: 2,102,83,476,224
NodeFont: Arial,24

FormNode Fo1542767189
Title: Use Analytica Text Trace Log
Definition: 0
NodeLocation: 252,348,1
NodeSize: 212,20
Original: Use_Trace_Log

FormNode Fo1542903863
Title: Share of Res Housing Units
Definition: 1
NodeLocation: 692,556,1
NodeSize: 212,20
NodeColor: 65278,37008,6168
Original: Share_of_Res_Housing

FormNode Fo1542903864
Title: Cumulative PV Installs by Type
Definition: 1
NodeLocation: 692,476,1
NodeSize: 212,20
NodeColor: 65278,37008,6168
Original: Cumulative_PV_Instal

FormNode Fo1542903862
Title: Installs by Type
Definition: 1
NodeLocation: 692,516,1
NodeSize: 212,20
NodeColor: 65278,37008,6168
Original: Installs_by_Type

FormNode Fo1542904550
Title: R^2 Applied
Definition: 1
NodeLocation: 692,596,1
NodeSize: 212,20
NodeColor: 65278,37008,6168
Original: R_2_Applied

FormNode Fo1542904764
Title: Failed Spat ID
Definition: 1
NodeLocation: 692,636,1
NodeSize: 212,20
NodeColor: 65278,37008,6168
Original: Failed_Spat_ID

Alias Al1542999373
Title: Set PV Time to Calib Time
Definition: 1
NodeLocation: 808,728,1
NodeSize: 72,32
NodeInfo: 1,0,0,1,1,1,1,,1,,0,,,
NodeColor: 49344,49344,49344
NodeFont: Calibri,19
Original: Set_PV_Time_to_Cali1

FormNode Fo1543000896
Title: Stored Coeff for PV Spat ID
Definition: 1
NodeLocation: 252,596,1
NodeSize: 212,20
NodeColor: 65278,37008,6168
Original: Stored_Coeff_for_PV_

Text Te1543284367
Title: Add in check to ensure only one PV Cost Scenario is selectec before calibration
NodeLocation: 1440,1152,-1
NodeSize: 200,40

FormNode Fo1543435608
Title: Retrofit Eligibility Factor
Definition: 1
NodeLocation: 1448,1096,1
NodeSize: 208,16
Original: Retrofit_Eligibility

Alias Al1543514124
Title: CALIBRATE
Definition: 1
NodeLocation: 456,728,1
NodeSize: 72,32
NodeInfo: 1,0,0,1,1,1,1,,1,,0,,,
NodeFont: Calibri,19
Original: CALIBRATE

Alias Al1543514125
Title: Set Spatial ID to Failed Calib
Definition: 1
NodeLocation: 648,728,1
NodeSize: 72,32
NodeInfo: 1,0,0,1,1,1,1,,1,,0,,,
NodeColor: 49344,49344,49344
NodeFont: Calibri,19
Original: Set_Spatial_ID_to_Fa

Variable Indexes_of_Sim_vs_Ac
Title: Indexes of Sim vs Act for Calibration
Definition: IndexesOf(Sim_vs_Act_PV_System)
NodeLocation: 96,1176,1
NodeSize: 64,40
ValueState: 2,408,494,359,214,,MIDM

Index Required_Indexes_of_
Title: Required Indexes of Calib Output
Description: This is a list of handles to the indexes expected for the Sim vs Act PV System output used in the calibration scripts. If the dimensionality is greater than expected, calibration scripts would increase the dimensionality of stored coefficients, which is not desired or expected.
Definition: [Time_Solar_PV,PV_Sectors,PV_Spatial_ID,Act_vs_Sim]
NodeLocation: 248,1176,1
NodeSize: 64,40
ValueState: 2,810,363,416,303,,MIDM
MetaOnly: 1

Function Check_Calib_Dimensio(actualIndexes, requiredIndexes: index)
Title: Check Calib Dimensionality
Description: This function checks whether the dimensionality of output feeding the calibration module is as expected (which may not be the case, for instance, if scenarios to be run for forecasting have selected more than one element). If the dimensionality is greater than expected, calibration scripts would increase the dimensionality of stored coefficients, which is not desired or expected.
Definition: IF actualIndexes<>requiredIndexes THEN Error( 'Calibration routines require dimensionality of output to be as expected. There is currently excess dimensionality in the output, perhaps due to more than one scenario being selected. Please select only one value for any scenario input, or otherwise investigate why the Required Indexes of Calib Output is not equal to the Actual Indexes of Sim vs Act for Calibration' )
NodeLocation: 408,1176,1
NodeSize: 72,40

Variable Va4
Definition: Indexes_of_Sim_vs_Ac=Required_Indexes_of_
NodeLocation: 560,1176,1
NodeSize: 64,40
ValueState: 2,376,378,608,200,,MIDM

Button Bu3
NodeLocation: 704,1176,1
NodeSize: 64,40
OnClick: (PV_Sectors:=Sectors_for_PV_Expor); {ensures the appropriate sectors are output to Excel}

FormNode Fo1543522440
Title: Stored PV Dec Vars
Definition: 0
NodeLocation: 252,636,1
NodeSize: 212,20
NodeColor: 49344,49344,49344
Original: Stored_PV_Dec_Vars

Constant Sectors_for_PV_Expor
Title: Sectors for PV Export
Description: This input defines which sectors of PV output will be exported to the Excel file.
Definition: MultiChoice(All_Sectors,1,2,returnList:1)
NodeLocation: 1712,1168,1
NodeSize: 64,40
Aliases: FormNode Fo1543526233
{!40200|Att_ChoiceIndexes: Index All_Sectors}

FormNode Fo1543526233
Title: Sectors for PV Export
Definition: 0
NodeLocation: 1024,1160,1
NodeSize: 216,16
NodeInfo: 1,,,,,,0,233,,,,,,0
Original: Sectors_for_PV_Expor

Text PVCalibr_Frame
NodeLocation: 1288,336,-1
NodeSize: 376,320
NodeInfo: 1,0,0,1,0,0,0,,0,,0,,,
{!40400|CloudPlayerStyles: Show_index_menus:yes~
Show_description:20}
{!40204-40399|AWP_Attrib:Show_index_menus:yes~
Show_description:20}

FormNode Fo1544581665
Title: Current Stage
Definition: 0
NodeLocation: 692,388,1
NodeSize: 212,20
NodeInfo: 1,,,,,,0,78,,,,,,0
NodeColor: 49344,49344,49344
Original: Current_Stage

Text Te1544718502
Title: Add dimensionality checks to calibration scripts
NodeLocation: 392,916,-1
NodeSize: 152,36

Alias Al1552605730
Title: Calibrate All PV Sectors
Definition: 1
NodeLocation: 288,728,1
NodeSize: 72,32
NodeColor: 49344,49344,49344
Original: Calibrate_All_PV_Sec

Close PV_Calibration1

